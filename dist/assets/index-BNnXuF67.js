function r2(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Ar=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function n2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function s2(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var Wg={exports:{}},Zc={},Hg={exports:{}},Ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Io=Symbol.for("react.element"),i2=Symbol.for("react.portal"),a2=Symbol.for("react.fragment"),o2=Symbol.for("react.strict_mode"),l2=Symbol.for("react.profiler"),c2=Symbol.for("react.provider"),u2=Symbol.for("react.context"),d2=Symbol.for("react.forward_ref"),f2=Symbol.for("react.suspense"),h2=Symbol.for("react.memo"),m2=Symbol.for("react.lazy"),Zh=Symbol.iterator;function p2(e){return e===null||typeof e!="object"?null:(e=Zh&&e[Zh]||e["@@iterator"],typeof e=="function"?e:null)}var zg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Vg=Object.assign,Gg={};function aa(e,t,r){this.props=e,this.context=t,this.refs=Gg,this.updater=r||zg}aa.prototype.isReactComponent={};aa.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};aa.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function qg(){}qg.prototype=aa.prototype;function cf(e,t,r){this.props=e,this.context=t,this.refs=Gg,this.updater=r||zg}var uf=cf.prototype=new qg;uf.constructor=cf;Vg(uf,aa.prototype);uf.isPureReactComponent=!0;var em=Array.isArray,Kg=Object.prototype.hasOwnProperty,df={current:null},Xg={key:!0,ref:!0,__self:!0,__source:!0};function Yg(e,t,r){var n,s={},i=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)Kg.call(t,n)&&!Xg.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Io,type:e,key:i,ref:a,props:s,_owner:df.current}}function g2(e,t){return{$$typeof:Io,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ff(e){return typeof e=="object"&&e!==null&&e.$$typeof===Io}function x2(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var tm=/\/+/g;function Ju(e,t){return typeof e=="object"&&e!==null&&e.key!=null?x2(""+e.key):t.toString(36)}function Bl(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Io:case i2:a=!0}}if(a)return a=e,s=s(a),e=n===""?"."+Ju(a,0):n,em(s)?(r="",e!=null&&(r=e.replace(tm,"$&/")+"/"),Bl(s,t,r,"",function(u){return u})):s!=null&&(ff(s)&&(s=g2(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(tm,"$&/")+"/")+e)),t.push(s)),1;if(a=0,n=n===""?".":n+":",em(e))for(var o=0;o<e.length;o++){i=e[o];var c=n+Ju(i,o);a+=Bl(i,t,r,c,s)}else if(c=p2(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=n+Ju(i,o++),a+=Bl(i,t,r,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function nl(e,t,r){if(e==null)return e;var n=[],s=0;return Bl(e,n,"","",function(i){return t.call(r,i,s++)}),n}function v2(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Yt={current:null},$l={transition:null},y2={ReactCurrentDispatcher:Yt,ReactCurrentBatchConfig:$l,ReactCurrentOwner:df};function Jg(){throw Error("act(...) is not supported in production builds of React.")}Ae.Children={map:nl,forEach:function(e,t,r){nl(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return nl(e,function(){t++}),t},toArray:function(e){return nl(e,function(t){return t})||[]},only:function(e){if(!ff(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ae.Component=aa;Ae.Fragment=a2;Ae.Profiler=l2;Ae.PureComponent=cf;Ae.StrictMode=o2;Ae.Suspense=f2;Ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=y2;Ae.act=Jg;Ae.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Vg({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=df.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)Kg.call(t,c)&&!Xg.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Io,type:e.type,key:s,ref:i,props:n,_owner:a}};Ae.createContext=function(e){return e={$$typeof:u2,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:c2,_context:e},e.Consumer=e};Ae.createElement=Yg;Ae.createFactory=function(e){var t=Yg.bind(null,e);return t.type=e,t};Ae.createRef=function(){return{current:null}};Ae.forwardRef=function(e){return{$$typeof:d2,render:e}};Ae.isValidElement=ff;Ae.lazy=function(e){return{$$typeof:m2,_payload:{_status:-1,_result:e},_init:v2}};Ae.memo=function(e,t){return{$$typeof:h2,type:e,compare:t===void 0?null:t}};Ae.startTransition=function(e){var t=$l.transition;$l.transition={};try{e()}finally{$l.transition=t}};Ae.unstable_act=Jg;Ae.useCallback=function(e,t){return Yt.current.useCallback(e,t)};Ae.useContext=function(e){return Yt.current.useContext(e)};Ae.useDebugValue=function(){};Ae.useDeferredValue=function(e){return Yt.current.useDeferredValue(e)};Ae.useEffect=function(e,t){return Yt.current.useEffect(e,t)};Ae.useId=function(){return Yt.current.useId()};Ae.useImperativeHandle=function(e,t,r){return Yt.current.useImperativeHandle(e,t,r)};Ae.useInsertionEffect=function(e,t){return Yt.current.useInsertionEffect(e,t)};Ae.useLayoutEffect=function(e,t){return Yt.current.useLayoutEffect(e,t)};Ae.useMemo=function(e,t){return Yt.current.useMemo(e,t)};Ae.useReducer=function(e,t,r){return Yt.current.useReducer(e,t,r)};Ae.useRef=function(e){return Yt.current.useRef(e)};Ae.useState=function(e){return Yt.current.useState(e)};Ae.useSyncExternalStore=function(e,t,r){return Yt.current.useSyncExternalStore(e,t,r)};Ae.useTransition=function(){return Yt.current.useTransition()};Ae.version="18.3.1";Hg.exports=Ae;var b=Hg.exports;const Ct=n2(b),G0=r2({__proto__:null,default:Ct},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w2=b,_2=Symbol.for("react.element"),E2=Symbol.for("react.fragment"),S2=Object.prototype.hasOwnProperty,T2=w2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,b2={key:!0,ref:!0,__self:!0,__source:!0};function Qg(e,t,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)S2.call(t,n)&&!b2.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:_2,type:e,key:i,ref:a,props:s,_owner:T2.current}}Zc.Fragment=E2;Zc.jsx=Qg;Zc.jsxs=Qg;Wg.exports=Zc;var l=Wg.exports,Zg={exports:{}},yr={},ex={exports:{}},tx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(W,G){var Z=W.length;W.push(G);e:for(;0<Z;){var Q=Z-1>>>1,k=W[Q];if(0<s(k,G))W[Q]=G,W[Z]=k,Z=Q;else break e}}function r(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var G=W[0],Z=W.pop();if(Z!==G){W[0]=Z;e:for(var Q=0,k=W.length,P=k>>>1;Q<P;){var I=2*(Q+1)-1,R=W[I],Y=I+1,ce=W[Y];if(0>s(R,Z))Y<k&&0>s(ce,R)?(W[Q]=ce,W[Y]=Z,Q=Y):(W[Q]=R,W[I]=Z,Q=I);else if(Y<k&&0>s(ce,Z))W[Q]=ce,W[Y]=Z,Q=Y;else break e}}return G}function s(W,G){var Z=W.sortIndex-G.sortIndex;return Z!==0?Z:W.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var c=[],u=[],d=1,f=null,h=3,p=!1,g=!1,m=!1,x=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(W){for(var G=r(u);G!==null;){if(G.callback===null)n(u);else if(G.startTime<=W)n(u),G.sortIndex=G.expirationTime,t(c,G);else break;G=r(u)}}function _(W){if(m=!1,y(W),!g)if(r(c)!==null)g=!0,le(C);else{var G=r(u);G!==null&&ee(_,G.startTime-W)}}function C(W,G){g=!1,m&&(m=!1,w(M),M=-1),p=!0;var Z=h;try{for(y(G),f=r(c);f!==null&&(!(f.expirationTime>G)||W&&!z());){var Q=f.callback;if(typeof Q=="function"){f.callback=null,h=f.priorityLevel;var k=Q(f.expirationTime<=G);G=e.unstable_now(),typeof k=="function"?f.callback=k:f===r(c)&&n(c),y(G)}else n(c);f=r(c)}if(f!==null)var P=!0;else{var I=r(u);I!==null&&ee(_,I.startTime-G),P=!1}return P}finally{f=null,h=Z,p=!1}}var E=!1,T=null,M=-1,A=5,B=-1;function z(){return!(e.unstable_now()-B<A)}function U(){if(T!==null){var W=e.unstable_now();B=W;var G=!0;try{G=T(!0,W)}finally{G?V():(E=!1,T=null)}}else E=!1}var V;if(typeof v=="function")V=function(){v(U)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,ne=pe.port2;pe.port1.onmessage=U,V=function(){ne.postMessage(null)}}else V=function(){x(U,0)};function le(W){T=W,E||(E=!0,V())}function ee(W,G){M=x(function(){W(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,le(C))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(W){switch(h){case 1:case 2:case 3:var G=3;break;default:G=h}var Z=h;h=G;try{return W()}finally{h=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,G){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Z=h;h=W;try{return G()}finally{h=Z}},e.unstable_scheduleCallback=function(W,G,Z){var Q=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?Q+Z:Q):Z=Q,W){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=Z+k,W={id:d++,callback:G,priorityLevel:W,startTime:Z,expirationTime:k,sortIndex:-1},Z>Q?(W.sortIndex=Z,t(u,W),r(c)===null&&W===r(u)&&(m?(w(M),M=-1):m=!0,ee(_,Z-Q))):(W.sortIndex=k,t(c,W),g||p||(g=!0,le(C))),W},e.unstable_shouldYield=z,e.unstable_wrapCallback=function(W){var G=h;return function(){var Z=h;h=G;try{return W.apply(this,arguments)}finally{h=Z}}}})(tx);ex.exports=tx;var k2=ex.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N2=b,xr=k2;function oe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var rx=new Set,lo={};function Zs(e,t){qi(e,t),qi(e+"Capture",t)}function qi(e,t){for(lo[e]=t,e=0;e<t.length;e++)rx.add(t[e])}var Sn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),q0=Object.prototype.hasOwnProperty,C2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,rm={},nm={};function j2(e){return q0.call(nm,e)?!0:q0.call(rm,e)?!1:C2.test(e)?nm[e]=!0:(rm[e]=!0,!1)}function A2(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function O2(e,t,r,n){if(t===null||typeof t>"u"||A2(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Jt(e,t,r,n,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var Ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ft[e]=new Jt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ft[t]=new Jt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ft[e]=new Jt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ft[e]=new Jt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ft[e]=new Jt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ft[e]=new Jt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ft[e]=new Jt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ft[e]=new Jt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ft[e]=new Jt(e,5,!1,e.toLowerCase(),null,!1,!1)});var hf=/[\-:]([a-z])/g;function mf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(hf,mf);Ft[t]=new Jt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(hf,mf);Ft[t]=new Jt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(hf,mf);Ft[t]=new Jt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ft[e]=new Jt(e,1,!1,e.toLowerCase(),null,!1,!1)});Ft.xlinkHref=new Jt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ft[e]=new Jt(e,1,!1,e.toLowerCase(),null,!0,!0)});function pf(e,t,r,n){var s=Ft.hasOwnProperty(t)?Ft[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(O2(t,r,s,n)&&(r=null),n||s===null?j2(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var On=N2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sl=Symbol.for("react.element"),Ei=Symbol.for("react.portal"),Si=Symbol.for("react.fragment"),gf=Symbol.for("react.strict_mode"),K0=Symbol.for("react.profiler"),nx=Symbol.for("react.provider"),sx=Symbol.for("react.context"),xf=Symbol.for("react.forward_ref"),X0=Symbol.for("react.suspense"),Y0=Symbol.for("react.suspense_list"),vf=Symbol.for("react.memo"),$n=Symbol.for("react.lazy"),ix=Symbol.for("react.offscreen"),sm=Symbol.iterator;function Sa(e){return e===null||typeof e!="object"?null:(e=sm&&e[sm]||e["@@iterator"],typeof e=="function"?e:null)}var tt=Object.assign,Qu;function Da(e){if(Qu===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Qu=t&&t[1]||""}return`
`+Qu+e}var Zu=!1;function e0(e,t){if(!e||Zu)return"";Zu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==i[o]){var c=`
`+s[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=o);break}}}finally{Zu=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Da(e):""}function F2(e){switch(e.tag){case 5:return Da(e.type);case 16:return Da("Lazy");case 13:return Da("Suspense");case 19:return Da("SuspenseList");case 0:case 2:case 15:return e=e0(e.type,!1),e;case 11:return e=e0(e.type.render,!1),e;case 1:return e=e0(e.type,!0),e;default:return""}}function J0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Si:return"Fragment";case Ei:return"Portal";case K0:return"Profiler";case gf:return"StrictMode";case X0:return"Suspense";case Y0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case sx:return(e.displayName||"Context")+".Consumer";case nx:return(e._context.displayName||"Context")+".Provider";case xf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case vf:return t=e.displayName||null,t!==null?t:J0(e.type)||"Memo";case $n:t=e._payload,e=e._init;try{return J0(e(t))}catch{}}return null}function P2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return J0(t);case 8:return t===gf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function us(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ax(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function D2(e){var t=ax(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function il(e){e._valueTracker||(e._valueTracker=D2(e))}function ox(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=ax(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Zl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Q0(e,t){var r=t.checked;return tt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function im(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=us(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function lx(e,t){t=t.checked,t!=null&&pf(e,"checked",t,!1)}function Z0(e,t){lx(e,t);var r=us(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ed(e,t.type,r):t.hasOwnProperty("defaultValue")&&ed(e,t.type,us(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function am(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ed(e,t,r){(t!=="number"||Zl(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ra=Array.isArray;function Ri(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+us(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function td(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(oe(91));return tt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function om(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(oe(92));if(Ra(r)){if(1<r.length)throw Error(oe(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:us(r)}}function cx(e,t){var r=us(t.value),n=us(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function lm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ux(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ux(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var al,dx=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(al=al||document.createElement("div"),al.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=al.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function co(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Ua={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},R2=["Webkit","ms","Moz","O"];Object.keys(Ua).forEach(function(e){R2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ua[t]=Ua[e]})});function fx(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Ua.hasOwnProperty(e)&&Ua[e]?(""+t).trim():t+"px"}function hx(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=fx(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var I2=tt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nd(e,t){if(t){if(I2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(oe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(oe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(oe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(oe(62))}}function sd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var id=null;function yf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ad=null,Ii=null,Li=null;function cm(e){if(e=Bo(e)){if(typeof ad!="function")throw Error(oe(280));var t=e.stateNode;t&&(t=su(t),ad(e.stateNode,e.type,t))}}function mx(e){Ii?Li?Li.push(e):Li=[e]:Ii=e}function px(){if(Ii){var e=Ii,t=Li;if(Li=Ii=null,cm(e),t)for(e=0;e<t.length;e++)cm(t[e])}}function gx(e,t){return e(t)}function xx(){}var t0=!1;function vx(e,t,r){if(t0)return e(t,r);t0=!0;try{return gx(e,t,r)}finally{t0=!1,(Ii!==null||Li!==null)&&(xx(),px())}}function uo(e,t){var r=e.stateNode;if(r===null)return null;var n=su(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(oe(231,t,typeof r));return r}var od=!1;if(Sn)try{var Ta={};Object.defineProperty(Ta,"passive",{get:function(){od=!0}}),window.addEventListener("test",Ta,Ta),window.removeEventListener("test",Ta,Ta)}catch{od=!1}function L2(e,t,r,n,s,i,a,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Wa=!1,ec=null,tc=!1,ld=null,M2={onError:function(e){Wa=!0,ec=e}};function B2(e,t,r,n,s,i,a,o,c){Wa=!1,ec=null,L2.apply(M2,arguments)}function $2(e,t,r,n,s,i,a,o,c){if(B2.apply(this,arguments),Wa){if(Wa){var u=ec;Wa=!1,ec=null}else throw Error(oe(198));tc||(tc=!0,ld=u)}}function ei(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function yx(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function um(e){if(ei(e)!==e)throw Error(oe(188))}function U2(e){var t=e.alternate;if(!t){if(t=ei(e),t===null)throw Error(oe(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return um(s),e;if(i===n)return um(s),t;i=i.sibling}throw Error(oe(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a)throw Error(oe(189))}}if(r.alternate!==n)throw Error(oe(190))}if(r.tag!==3)throw Error(oe(188));return r.stateNode.current===r?e:t}function wx(e){return e=U2(e),e!==null?_x(e):null}function _x(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=_x(e);if(t!==null)return t;e=e.sibling}return null}var Ex=xr.unstable_scheduleCallback,dm=xr.unstable_cancelCallback,W2=xr.unstable_shouldYield,H2=xr.unstable_requestPaint,at=xr.unstable_now,z2=xr.unstable_getCurrentPriorityLevel,wf=xr.unstable_ImmediatePriority,Sx=xr.unstable_UserBlockingPriority,rc=xr.unstable_NormalPriority,V2=xr.unstable_LowPriority,Tx=xr.unstable_IdlePriority,eu=null,an=null;function G2(e){if(an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(eu,e,void 0,(e.current.flags&128)===128)}catch{}}var Gr=Math.clz32?Math.clz32:X2,q2=Math.log,K2=Math.LN2;function X2(e){return e>>>=0,e===0?32:31-(q2(e)/K2|0)|0}var ol=64,ll=4194304;function Ia(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function nc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~s;o!==0?n=Ia(o):(i&=a,i!==0&&(n=Ia(i)))}else a=r&~s,a!==0?n=Ia(a):i!==0&&(n=Ia(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Gr(t),s=1<<r,n|=e[r],t&=~s;return n}function Y2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function J2(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-Gr(i),o=1<<a,c=s[a];c===-1?(!(o&r)||o&n)&&(s[a]=Y2(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}function cd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function bx(){var e=ol;return ol<<=1,!(ol&4194240)&&(ol=64),e}function r0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Lo(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Gr(t),e[t]=r}function Q2(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Gr(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function _f(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Gr(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var $e=0;function kx(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Nx,Ef,Cx,jx,Ax,ud=!1,cl=[],es=null,ts=null,rs=null,fo=new Map,ho=new Map,zn=[],Z2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fm(e,t){switch(e){case"focusin":case"focusout":es=null;break;case"dragenter":case"dragleave":ts=null;break;case"mouseover":case"mouseout":rs=null;break;case"pointerover":case"pointerout":fo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ho.delete(t.pointerId)}}function ba(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Bo(t),t!==null&&Ef(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function e_(e,t,r,n,s){switch(t){case"focusin":return es=ba(es,e,t,r,n,s),!0;case"dragenter":return ts=ba(ts,e,t,r,n,s),!0;case"mouseover":return rs=ba(rs,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return fo.set(i,ba(fo.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,ho.set(i,ba(ho.get(i)||null,e,t,r,n,s)),!0}return!1}function Ox(e){var t=Rs(e.target);if(t!==null){var r=ei(t);if(r!==null){if(t=r.tag,t===13){if(t=yx(r),t!==null){e.blockedOn=t,Ax(e.priority,function(){Cx(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ul(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=dd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);id=n,r.target.dispatchEvent(n),id=null}else return t=Bo(r),t!==null&&Ef(t),e.blockedOn=r,!1;t.shift()}return!0}function hm(e,t,r){Ul(e)&&r.delete(t)}function t_(){ud=!1,es!==null&&Ul(es)&&(es=null),ts!==null&&Ul(ts)&&(ts=null),rs!==null&&Ul(rs)&&(rs=null),fo.forEach(hm),ho.forEach(hm)}function ka(e,t){e.blockedOn===t&&(e.blockedOn=null,ud||(ud=!0,xr.unstable_scheduleCallback(xr.unstable_NormalPriority,t_)))}function mo(e){function t(s){return ka(s,e)}if(0<cl.length){ka(cl[0],e);for(var r=1;r<cl.length;r++){var n=cl[r];n.blockedOn===e&&(n.blockedOn=null)}}for(es!==null&&ka(es,e),ts!==null&&ka(ts,e),rs!==null&&ka(rs,e),fo.forEach(t),ho.forEach(t),r=0;r<zn.length;r++)n=zn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<zn.length&&(r=zn[0],r.blockedOn===null);)Ox(r),r.blockedOn===null&&zn.shift()}var Mi=On.ReactCurrentBatchConfig,sc=!0;function r_(e,t,r,n){var s=$e,i=Mi.transition;Mi.transition=null;try{$e=1,Sf(e,t,r,n)}finally{$e=s,Mi.transition=i}}function n_(e,t,r,n){var s=$e,i=Mi.transition;Mi.transition=null;try{$e=4,Sf(e,t,r,n)}finally{$e=s,Mi.transition=i}}function Sf(e,t,r,n){if(sc){var s=dd(e,t,r,n);if(s===null)f0(e,t,n,ic,r),fm(e,n);else if(e_(s,e,t,r,n))n.stopPropagation();else if(fm(e,n),t&4&&-1<Z2.indexOf(e)){for(;s!==null;){var i=Bo(s);if(i!==null&&Nx(i),i=dd(e,t,r,n),i===null&&f0(e,t,n,ic,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else f0(e,t,n,null,r)}}var ic=null;function dd(e,t,r,n){if(ic=null,e=yf(n),e=Rs(e),e!==null)if(t=ei(e),t===null)e=null;else if(r=t.tag,r===13){if(e=yx(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ic=e,null}function Fx(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(z2()){case wf:return 1;case Sx:return 4;case rc:case V2:return 16;case Tx:return 536870912;default:return 16}default:return 16}}var Kn=null,Tf=null,Wl=null;function Px(){if(Wl)return Wl;var e,t=Tf,r=t.length,n,s="value"in Kn?Kn.value:Kn.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===s[i-n];n++);return Wl=s.slice(e,1<n?1-n:void 0)}function Hl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ul(){return!0}function mm(){return!1}function wr(e){function t(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ul:mm,this.isPropagationStopped=mm,this}return tt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ul)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ul)},persist:function(){},isPersistent:ul}),t}var oa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bf=wr(oa),Mo=tt({},oa,{view:0,detail:0}),s_=wr(Mo),n0,s0,Na,tu=tt({},Mo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Na&&(Na&&e.type==="mousemove"?(n0=e.screenX-Na.screenX,s0=e.screenY-Na.screenY):s0=n0=0,Na=e),n0)},movementY:function(e){return"movementY"in e?e.movementY:s0}}),pm=wr(tu),i_=tt({},tu,{dataTransfer:0}),a_=wr(i_),o_=tt({},Mo,{relatedTarget:0}),i0=wr(o_),l_=tt({},oa,{animationName:0,elapsedTime:0,pseudoElement:0}),c_=wr(l_),u_=tt({},oa,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),d_=wr(u_),f_=tt({},oa,{data:0}),gm=wr(f_),h_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},m_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},p_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function g_(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=p_[e])?!!t[e]:!1}function kf(){return g_}var x_=tt({},Mo,{key:function(e){if(e.key){var t=h_[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Hl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?m_[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kf,charCode:function(e){return e.type==="keypress"?Hl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Hl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),v_=wr(x_),y_=tt({},tu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xm=wr(y_),w_=tt({},Mo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kf}),__=wr(w_),E_=tt({},oa,{propertyName:0,elapsedTime:0,pseudoElement:0}),S_=wr(E_),T_=tt({},tu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),b_=wr(T_),k_=[9,13,27,32],Nf=Sn&&"CompositionEvent"in window,Ha=null;Sn&&"documentMode"in document&&(Ha=document.documentMode);var N_=Sn&&"TextEvent"in window&&!Ha,Dx=Sn&&(!Nf||Ha&&8<Ha&&11>=Ha),vm=" ",ym=!1;function Rx(e,t){switch(e){case"keyup":return k_.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ix(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ti=!1;function C_(e,t){switch(e){case"compositionend":return Ix(t);case"keypress":return t.which!==32?null:(ym=!0,vm);case"textInput":return e=t.data,e===vm&&ym?null:e;default:return null}}function j_(e,t){if(Ti)return e==="compositionend"||!Nf&&Rx(e,t)?(e=Px(),Wl=Tf=Kn=null,Ti=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dx&&t.locale!=="ko"?null:t.data;default:return null}}var A_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!A_[e.type]:t==="textarea"}function Lx(e,t,r,n){mx(n),t=ac(t,"onChange"),0<t.length&&(r=new bf("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var za=null,po=null;function O_(e){Kx(e,0)}function ru(e){var t=Ni(e);if(ox(t))return e}function F_(e,t){if(e==="change")return t}var Mx=!1;if(Sn){var a0;if(Sn){var o0="oninput"in document;if(!o0){var _m=document.createElement("div");_m.setAttribute("oninput","return;"),o0=typeof _m.oninput=="function"}a0=o0}else a0=!1;Mx=a0&&(!document.documentMode||9<document.documentMode)}function Em(){za&&(za.detachEvent("onpropertychange",Bx),po=za=null)}function Bx(e){if(e.propertyName==="value"&&ru(po)){var t=[];Lx(t,po,e,yf(e)),vx(O_,t)}}function P_(e,t,r){e==="focusin"?(Em(),za=t,po=r,za.attachEvent("onpropertychange",Bx)):e==="focusout"&&Em()}function D_(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ru(po)}function R_(e,t){if(e==="click")return ru(t)}function I_(e,t){if(e==="input"||e==="change")return ru(t)}function L_(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Yr=typeof Object.is=="function"?Object.is:L_;function go(e,t){if(Yr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!q0.call(t,s)||!Yr(e[s],t[s]))return!1}return!0}function Sm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Tm(e,t){var r=Sm(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Sm(r)}}function $x(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?$x(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ux(){for(var e=window,t=Zl();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Zl(e.document)}return t}function Cf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function M_(e){var t=Ux(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&$x(r.ownerDocument.documentElement,r)){if(n!==null&&Cf(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=Tm(r,i);var a=Tm(r,n);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var B_=Sn&&"documentMode"in document&&11>=document.documentMode,bi=null,fd=null,Va=null,hd=!1;function bm(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;hd||bi==null||bi!==Zl(n)||(n=bi,"selectionStart"in n&&Cf(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Va&&go(Va,n)||(Va=n,n=ac(fd,"onSelect"),0<n.length&&(t=new bf("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=bi)))}function dl(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ki={animationend:dl("Animation","AnimationEnd"),animationiteration:dl("Animation","AnimationIteration"),animationstart:dl("Animation","AnimationStart"),transitionend:dl("Transition","TransitionEnd")},l0={},Wx={};Sn&&(Wx=document.createElement("div").style,"AnimationEvent"in window||(delete ki.animationend.animation,delete ki.animationiteration.animation,delete ki.animationstart.animation),"TransitionEvent"in window||delete ki.transitionend.transition);function nu(e){if(l0[e])return l0[e];if(!ki[e])return e;var t=ki[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Wx)return l0[e]=t[r];return e}var Hx=nu("animationend"),zx=nu("animationiteration"),Vx=nu("animationstart"),Gx=nu("transitionend"),qx=new Map,km="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xs(e,t){qx.set(e,t),Zs(t,[e])}for(var c0=0;c0<km.length;c0++){var u0=km[c0],$_=u0.toLowerCase(),U_=u0[0].toUpperCase()+u0.slice(1);xs($_,"on"+U_)}xs(Hx,"onAnimationEnd");xs(zx,"onAnimationIteration");xs(Vx,"onAnimationStart");xs("dblclick","onDoubleClick");xs("focusin","onFocus");xs("focusout","onBlur");xs(Gx,"onTransitionEnd");qi("onMouseEnter",["mouseout","mouseover"]);qi("onMouseLeave",["mouseout","mouseover"]);qi("onPointerEnter",["pointerout","pointerover"]);qi("onPointerLeave",["pointerout","pointerover"]);Zs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Zs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Zs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Zs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Zs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Zs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var La="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),W_=new Set("cancel close invalid load scroll toggle".split(" ").concat(La));function Nm(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,$2(n,t,void 0,e),e.currentTarget=null}function Kx(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==i&&s.isPropagationStopped())break e;Nm(s,o,u),i=c}else for(a=0;a<n.length;a++){if(o=n[a],c=o.instance,u=o.currentTarget,o=o.listener,c!==i&&s.isPropagationStopped())break e;Nm(s,o,u),i=c}}}if(tc)throw e=ld,tc=!1,ld=null,e}function Ge(e,t){var r=t[vd];r===void 0&&(r=t[vd]=new Set);var n=e+"__bubble";r.has(n)||(Xx(t,e,2,!1),r.add(n))}function d0(e,t,r){var n=0;t&&(n|=4),Xx(r,e,n,t)}var fl="_reactListening"+Math.random().toString(36).slice(2);function xo(e){if(!e[fl]){e[fl]=!0,rx.forEach(function(r){r!=="selectionchange"&&(W_.has(r)||d0(r,!1,e),d0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[fl]||(t[fl]=!0,d0("selectionchange",!1,t))}}function Xx(e,t,r,n){switch(Fx(t)){case 1:var s=r_;break;case 4:s=n_;break;default:s=Sf}r=s.bind(null,t,r,e),s=void 0,!od||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function f0(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;o!==null;){if(a=Rs(o),a===null)return;if(c=a.tag,c===5||c===6){n=i=a;continue e}o=o.parentNode}}n=n.return}vx(function(){var u=i,d=yf(r),f=[];e:{var h=qx.get(e);if(h!==void 0){var p=bf,g=e;switch(e){case"keypress":if(Hl(r)===0)break e;case"keydown":case"keyup":p=v_;break;case"focusin":g="focus",p=i0;break;case"focusout":g="blur",p=i0;break;case"beforeblur":case"afterblur":p=i0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=pm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=a_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=__;break;case Hx:case zx:case Vx:p=c_;break;case Gx:p=S_;break;case"scroll":p=s_;break;case"wheel":p=b_;break;case"copy":case"cut":case"paste":p=d_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=xm}var m=(t&4)!==0,x=!m&&e==="scroll",w=m?h!==null?h+"Capture":null:h;m=[];for(var v=u,y;v!==null;){y=v;var _=y.stateNode;if(y.tag===5&&_!==null&&(y=_,w!==null&&(_=uo(v,w),_!=null&&m.push(vo(v,_,y)))),x)break;v=v.return}0<m.length&&(h=new p(h,g,null,r,d),f.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==id&&(g=r.relatedTarget||r.fromElement)&&(Rs(g)||g[Tn]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=u,g=g?Rs(g):null,g!==null&&(x=ei(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=u),p!==g)){if(m=pm,_="onMouseLeave",w="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(m=xm,_="onPointerLeave",w="onPointerEnter",v="pointer"),x=p==null?h:Ni(p),y=g==null?h:Ni(g),h=new m(_,v+"leave",p,r,d),h.target=x,h.relatedTarget=y,_=null,Rs(d)===u&&(m=new m(w,v+"enter",g,r,d),m.target=y,m.relatedTarget=x,_=m),x=_,p&&g)t:{for(m=p,w=g,v=0,y=m;y;y=ui(y))v++;for(y=0,_=w;_;_=ui(_))y++;for(;0<v-y;)m=ui(m),v--;for(;0<y-v;)w=ui(w),y--;for(;v--;){if(m===w||w!==null&&m===w.alternate)break t;m=ui(m),w=ui(w)}m=null}else m=null;p!==null&&Cm(f,h,p,m,!1),g!==null&&x!==null&&Cm(f,x,g,m,!0)}}e:{if(h=u?Ni(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var C=F_;else if(wm(h))if(Mx)C=I_;else{C=D_;var E=P_}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=R_);if(C&&(C=C(e,u))){Lx(f,C,r,d);break e}E&&E(e,h,u),e==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&ed(h,"number",h.value)}switch(E=u?Ni(u):window,e){case"focusin":(wm(E)||E.contentEditable==="true")&&(bi=E,fd=u,Va=null);break;case"focusout":Va=fd=bi=null;break;case"mousedown":hd=!0;break;case"contextmenu":case"mouseup":case"dragend":hd=!1,bm(f,r,d);break;case"selectionchange":if(B_)break;case"keydown":case"keyup":bm(f,r,d)}var T;if(Nf)e:{switch(e){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Ti?Rx(e,r)&&(M="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(M="onCompositionStart");M&&(Dx&&r.locale!=="ko"&&(Ti||M!=="onCompositionStart"?M==="onCompositionEnd"&&Ti&&(T=Px()):(Kn=d,Tf="value"in Kn?Kn.value:Kn.textContent,Ti=!0)),E=ac(u,M),0<E.length&&(M=new gm(M,e,null,r,d),f.push({event:M,listeners:E}),T?M.data=T:(T=Ix(r),T!==null&&(M.data=T)))),(T=N_?C_(e,r):j_(e,r))&&(u=ac(u,"onBeforeInput"),0<u.length&&(d=new gm("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=T))}Kx(f,t)})}function vo(e,t,r){return{instance:e,listener:t,currentTarget:r}}function ac(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=uo(e,r),i!=null&&n.unshift(vo(e,i,s)),i=uo(e,t),i!=null&&n.push(vo(e,i,s))),e=e.return}return n}function ui(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Cm(e,t,r,n,s){for(var i=t._reactName,a=[];r!==null&&r!==n;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&u!==null&&(o=u,s?(c=uo(r,i),c!=null&&a.unshift(vo(r,c,o))):s||(c=uo(r,i),c!=null&&a.push(vo(r,c,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var H_=/\r\n?/g,z_=/\u0000|\uFFFD/g;function jm(e){return(typeof e=="string"?e:""+e).replace(H_,`
`).replace(z_,"")}function hl(e,t,r){if(t=jm(t),jm(e)!==t&&r)throw Error(oe(425))}function oc(){}var md=null,pd=null;function gd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var xd=typeof setTimeout=="function"?setTimeout:void 0,V_=typeof clearTimeout=="function"?clearTimeout:void 0,Am=typeof Promise=="function"?Promise:void 0,G_=typeof queueMicrotask=="function"?queueMicrotask:typeof Am<"u"?function(e){return Am.resolve(null).then(e).catch(q_)}:xd;function q_(e){setTimeout(function(){throw e})}function h0(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),mo(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);mo(t)}function ns(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Om(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var la=Math.random().toString(36).slice(2),rn="__reactFiber$"+la,yo="__reactProps$"+la,Tn="__reactContainer$"+la,vd="__reactEvents$"+la,K_="__reactListeners$"+la,X_="__reactHandles$"+la;function Rs(e){var t=e[rn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Tn]||r[rn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Om(e);e!==null;){if(r=e[rn])return r;e=Om(e)}return t}e=r,r=e.parentNode}return null}function Bo(e){return e=e[rn]||e[Tn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ni(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(oe(33))}function su(e){return e[yo]||null}var yd=[],Ci=-1;function vs(e){return{current:e}}function qe(e){0>Ci||(e.current=yd[Ci],yd[Ci]=null,Ci--)}function Ve(e,t){Ci++,yd[Ci]=e.current,e.current=t}var ds={},Ut=vs(ds),rr=vs(!1),zs=ds;function Ki(e,t){var r=e.type.contextTypes;if(!r)return ds;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function nr(e){return e=e.childContextTypes,e!=null}function lc(){qe(rr),qe(Ut)}function Fm(e,t,r){if(Ut.current!==ds)throw Error(oe(168));Ve(Ut,t),Ve(rr,r)}function Yx(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(oe(108,P2(e)||"Unknown",s));return tt({},r,n)}function cc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ds,zs=Ut.current,Ve(Ut,e),Ve(rr,rr.current),!0}function Pm(e,t,r){var n=e.stateNode;if(!n)throw Error(oe(169));r?(e=Yx(e,t,zs),n.__reactInternalMemoizedMergedChildContext=e,qe(rr),qe(Ut),Ve(Ut,e)):qe(rr),Ve(rr,r)}var gn=null,iu=!1,m0=!1;function Jx(e){gn===null?gn=[e]:gn.push(e)}function Y_(e){iu=!0,Jx(e)}function ys(){if(!m0&&gn!==null){m0=!0;var e=0,t=$e;try{var r=gn;for($e=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}gn=null,iu=!1}catch(s){throw gn!==null&&(gn=gn.slice(e+1)),Ex(wf,ys),s}finally{$e=t,m0=!1}}return null}var ji=[],Ai=0,uc=null,dc=0,Tr=[],br=0,Vs=null,xn=1,vn="";function Cs(e,t){ji[Ai++]=dc,ji[Ai++]=uc,uc=e,dc=t}function Qx(e,t,r){Tr[br++]=xn,Tr[br++]=vn,Tr[br++]=Vs,Vs=e;var n=xn;e=vn;var s=32-Gr(n)-1;n&=~(1<<s),r+=1;var i=32-Gr(t)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,xn=1<<32-Gr(t)+s|r<<s|n,vn=i+e}else xn=1<<i|r<<s|n,vn=e}function jf(e){e.return!==null&&(Cs(e,1),Qx(e,1,0))}function Af(e){for(;e===uc;)uc=ji[--Ai],ji[Ai]=null,dc=ji[--Ai],ji[Ai]=null;for(;e===Vs;)Vs=Tr[--br],Tr[br]=null,vn=Tr[--br],Tr[br]=null,xn=Tr[--br],Tr[br]=null}var gr=null,mr=null,Ye=!1,Ur=null;function Zx(e,t){var r=kr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Dm(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,gr=e,mr=ns(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,gr=e,mr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Vs!==null?{id:xn,overflow:vn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=kr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,gr=e,mr=null,!0):!1;default:return!1}}function wd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function _d(e){if(Ye){var t=mr;if(t){var r=t;if(!Dm(e,t)){if(wd(e))throw Error(oe(418));t=ns(r.nextSibling);var n=gr;t&&Dm(e,t)?Zx(n,r):(e.flags=e.flags&-4097|2,Ye=!1,gr=e)}}else{if(wd(e))throw Error(oe(418));e.flags=e.flags&-4097|2,Ye=!1,gr=e}}}function Rm(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;gr=e}function ml(e){if(e!==gr)return!1;if(!Ye)return Rm(e),Ye=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!gd(e.type,e.memoizedProps)),t&&(t=mr)){if(wd(e))throw e1(),Error(oe(418));for(;t;)Zx(e,t),t=ns(t.nextSibling)}if(Rm(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(oe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){mr=ns(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}mr=null}}else mr=gr?ns(e.stateNode.nextSibling):null;return!0}function e1(){for(var e=mr;e;)e=ns(e.nextSibling)}function Xi(){mr=gr=null,Ye=!1}function Of(e){Ur===null?Ur=[e]:Ur.push(e)}var J_=On.ReactCurrentBatchConfig;function Ca(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(oe(309));var n=r.stateNode}if(!n)throw Error(oe(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var o=s.refs;a===null?delete o[i]:o[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(oe(284));if(!r._owner)throw Error(oe(290,e))}return e}function pl(e,t){throw e=Object.prototype.toString.call(t),Error(oe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Im(e){var t=e._init;return t(e._payload)}function t1(e){function t(w,v){if(e){var y=w.deletions;y===null?(w.deletions=[v],w.flags|=16):y.push(v)}}function r(w,v){if(!e)return null;for(;v!==null;)t(w,v),v=v.sibling;return null}function n(w,v){for(w=new Map;v!==null;)v.key!==null?w.set(v.key,v):w.set(v.index,v),v=v.sibling;return w}function s(w,v){return w=os(w,v),w.index=0,w.sibling=null,w}function i(w,v,y){return w.index=y,e?(y=w.alternate,y!==null?(y=y.index,y<v?(w.flags|=2,v):y):(w.flags|=2,v)):(w.flags|=1048576,v)}function a(w){return e&&w.alternate===null&&(w.flags|=2),w}function o(w,v,y,_){return v===null||v.tag!==6?(v=_0(y,w.mode,_),v.return=w,v):(v=s(v,y),v.return=w,v)}function c(w,v,y,_){var C=y.type;return C===Si?d(w,v,y.props.children,_,y.key):v!==null&&(v.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===$n&&Im(C)===v.type)?(_=s(v,y.props),_.ref=Ca(w,v,y),_.return=w,_):(_=Yl(y.type,y.key,y.props,null,w.mode,_),_.ref=Ca(w,v,y),_.return=w,_)}function u(w,v,y,_){return v===null||v.tag!==4||v.stateNode.containerInfo!==y.containerInfo||v.stateNode.implementation!==y.implementation?(v=E0(y,w.mode,_),v.return=w,v):(v=s(v,y.children||[]),v.return=w,v)}function d(w,v,y,_,C){return v===null||v.tag!==7?(v=Us(y,w.mode,_,C),v.return=w,v):(v=s(v,y),v.return=w,v)}function f(w,v,y){if(typeof v=="string"&&v!==""||typeof v=="number")return v=_0(""+v,w.mode,y),v.return=w,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case sl:return y=Yl(v.type,v.key,v.props,null,w.mode,y),y.ref=Ca(w,null,v),y.return=w,y;case Ei:return v=E0(v,w.mode,y),v.return=w,v;case $n:var _=v._init;return f(w,_(v._payload),y)}if(Ra(v)||Sa(v))return v=Us(v,w.mode,y,null),v.return=w,v;pl(w,v)}return null}function h(w,v,y,_){var C=v!==null?v.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return C!==null?null:o(w,v,""+y,_);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case sl:return y.key===C?c(w,v,y,_):null;case Ei:return y.key===C?u(w,v,y,_):null;case $n:return C=y._init,h(w,v,C(y._payload),_)}if(Ra(y)||Sa(y))return C!==null?null:d(w,v,y,_,null);pl(w,y)}return null}function p(w,v,y,_,C){if(typeof _=="string"&&_!==""||typeof _=="number")return w=w.get(y)||null,o(v,w,""+_,C);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case sl:return w=w.get(_.key===null?y:_.key)||null,c(v,w,_,C);case Ei:return w=w.get(_.key===null?y:_.key)||null,u(v,w,_,C);case $n:var E=_._init;return p(w,v,y,E(_._payload),C)}if(Ra(_)||Sa(_))return w=w.get(y)||null,d(v,w,_,C,null);pl(v,_)}return null}function g(w,v,y,_){for(var C=null,E=null,T=v,M=v=0,A=null;T!==null&&M<y.length;M++){T.index>M?(A=T,T=null):A=T.sibling;var B=h(w,T,y[M],_);if(B===null){T===null&&(T=A);break}e&&T&&B.alternate===null&&t(w,T),v=i(B,v,M),E===null?C=B:E.sibling=B,E=B,T=A}if(M===y.length)return r(w,T),Ye&&Cs(w,M),C;if(T===null){for(;M<y.length;M++)T=f(w,y[M],_),T!==null&&(v=i(T,v,M),E===null?C=T:E.sibling=T,E=T);return Ye&&Cs(w,M),C}for(T=n(w,T);M<y.length;M++)A=p(T,w,M,y[M],_),A!==null&&(e&&A.alternate!==null&&T.delete(A.key===null?M:A.key),v=i(A,v,M),E===null?C=A:E.sibling=A,E=A);return e&&T.forEach(function(z){return t(w,z)}),Ye&&Cs(w,M),C}function m(w,v,y,_){var C=Sa(y);if(typeof C!="function")throw Error(oe(150));if(y=C.call(y),y==null)throw Error(oe(151));for(var E=C=null,T=v,M=v=0,A=null,B=y.next();T!==null&&!B.done;M++,B=y.next()){T.index>M?(A=T,T=null):A=T.sibling;var z=h(w,T,B.value,_);if(z===null){T===null&&(T=A);break}e&&T&&z.alternate===null&&t(w,T),v=i(z,v,M),E===null?C=z:E.sibling=z,E=z,T=A}if(B.done)return r(w,T),Ye&&Cs(w,M),C;if(T===null){for(;!B.done;M++,B=y.next())B=f(w,B.value,_),B!==null&&(v=i(B,v,M),E===null?C=B:E.sibling=B,E=B);return Ye&&Cs(w,M),C}for(T=n(w,T);!B.done;M++,B=y.next())B=p(T,w,M,B.value,_),B!==null&&(e&&B.alternate!==null&&T.delete(B.key===null?M:B.key),v=i(B,v,M),E===null?C=B:E.sibling=B,E=B);return e&&T.forEach(function(U){return t(w,U)}),Ye&&Cs(w,M),C}function x(w,v,y,_){if(typeof y=="object"&&y!==null&&y.type===Si&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case sl:e:{for(var C=y.key,E=v;E!==null;){if(E.key===C){if(C=y.type,C===Si){if(E.tag===7){r(w,E.sibling),v=s(E,y.props.children),v.return=w,w=v;break e}}else if(E.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===$n&&Im(C)===E.type){r(w,E.sibling),v=s(E,y.props),v.ref=Ca(w,E,y),v.return=w,w=v;break e}r(w,E);break}else t(w,E);E=E.sibling}y.type===Si?(v=Us(y.props.children,w.mode,_,y.key),v.return=w,w=v):(_=Yl(y.type,y.key,y.props,null,w.mode,_),_.ref=Ca(w,v,y),_.return=w,w=_)}return a(w);case Ei:e:{for(E=y.key;v!==null;){if(v.key===E)if(v.tag===4&&v.stateNode.containerInfo===y.containerInfo&&v.stateNode.implementation===y.implementation){r(w,v.sibling),v=s(v,y.children||[]),v.return=w,w=v;break e}else{r(w,v);break}else t(w,v);v=v.sibling}v=E0(y,w.mode,_),v.return=w,w=v}return a(w);case $n:return E=y._init,x(w,v,E(y._payload),_)}if(Ra(y))return g(w,v,y,_);if(Sa(y))return m(w,v,y,_);pl(w,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,v!==null&&v.tag===6?(r(w,v.sibling),v=s(v,y),v.return=w,w=v):(r(w,v),v=_0(y,w.mode,_),v.return=w,w=v),a(w)):r(w,v)}return x}var Yi=t1(!0),r1=t1(!1),fc=vs(null),hc=null,Oi=null,Ff=null;function Pf(){Ff=Oi=hc=null}function Df(e){var t=fc.current;qe(fc),e._currentValue=t}function Ed(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Bi(e,t){hc=e,Ff=Oi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(tr=!0),e.firstContext=null)}function Or(e){var t=e._currentValue;if(Ff!==e)if(e={context:e,memoizedValue:t,next:null},Oi===null){if(hc===null)throw Error(oe(308));Oi=e,hc.dependencies={lanes:0,firstContext:e}}else Oi=Oi.next=e;return t}var Is=null;function Rf(e){Is===null?Is=[e]:Is.push(e)}function n1(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,Rf(t)):(r.next=s.next,s.next=r),t.interleaved=r,bn(e,n)}function bn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Un=!1;function If(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function s1(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function yn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ss(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Pe&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,bn(e,r)}return s=n.interleaved,s===null?(t.next=t,Rf(n)):(t.next=s.next,s.next=t),n.interleaved=t,bn(e,r)}function zl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,_f(e,r)}}function Lm(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function mc(e,t,r,n){var s=e.updateQueue;Un=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var c=o,u=c.next;c.next=null,a===null?i=u:a.next=u,a=c;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;a=0,d=u=c=null,o=i;do{var h=o.lane,p=o.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,m=o;switch(h=t,p=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){f=g.call(p,f,h);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,h=typeof g=="function"?g.call(p,f,h):g,h==null)break e;f=tt({},f,h);break e;case 2:Un=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=p,c=f):d=d.next=p,a|=h;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;h=o,o=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(d===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);qs|=a,e.lanes=a,e.memoizedState=f}}function Mm(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(oe(191,s));s.call(n)}}}var $o={},on=vs($o),wo=vs($o),_o=vs($o);function Ls(e){if(e===$o)throw Error(oe(174));return e}function Lf(e,t){switch(Ve(_o,t),Ve(wo,e),Ve(on,$o),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:rd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=rd(t,e)}qe(on),Ve(on,t)}function Ji(){qe(on),qe(wo),qe(_o)}function i1(e){Ls(_o.current);var t=Ls(on.current),r=rd(t,e.type);t!==r&&(Ve(wo,e),Ve(on,r))}function Mf(e){wo.current===e&&(qe(on),qe(wo))}var Ze=vs(0);function pc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var p0=[];function Bf(){for(var e=0;e<p0.length;e++)p0[e]._workInProgressVersionPrimary=null;p0.length=0}var Vl=On.ReactCurrentDispatcher,g0=On.ReactCurrentBatchConfig,Gs=0,et=null,ht=null,gt=null,gc=!1,Ga=!1,Eo=0,Q_=0;function Rt(){throw Error(oe(321))}function $f(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Yr(e[r],t[r]))return!1;return!0}function Uf(e,t,r,n,s,i){if(Gs=i,et=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Vl.current=e===null||e.memoizedState===null?rE:nE,e=r(n,s),Ga){i=0;do{if(Ga=!1,Eo=0,25<=i)throw Error(oe(301));i+=1,gt=ht=null,t.updateQueue=null,Vl.current=sE,e=r(n,s)}while(Ga)}if(Vl.current=xc,t=ht!==null&&ht.next!==null,Gs=0,gt=ht=et=null,gc=!1,t)throw Error(oe(300));return e}function Wf(){var e=Eo!==0;return Eo=0,e}function tn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gt===null?et.memoizedState=gt=e:gt=gt.next=e,gt}function Fr(){if(ht===null){var e=et.alternate;e=e!==null?e.memoizedState:null}else e=ht.next;var t=gt===null?et.memoizedState:gt.next;if(t!==null)gt=t,ht=e;else{if(e===null)throw Error(oe(310));ht=e,e={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},gt===null?et.memoizedState=gt=e:gt=gt.next=e}return gt}function So(e,t){return typeof t=="function"?t(e):t}function x0(e){var t=Fr(),r=t.queue;if(r===null)throw Error(oe(311));r.lastRenderedReducer=e;var n=ht,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=a=null,c=null,u=i;do{var d=u.lane;if((Gs&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=f,a=n):c=c.next=f,et.lanes|=d,qs|=d}u=u.next}while(u!==null&&u!==i);c===null?a=n:c.next=o,Yr(n,t.memoizedState)||(tr=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,et.lanes|=i,qs|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function v0(e){var t=Fr(),r=t.queue;if(r===null)throw Error(oe(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);Yr(i,t.memoizedState)||(tr=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function a1(){}function o1(e,t){var r=et,n=Fr(),s=t(),i=!Yr(n.memoizedState,s);if(i&&(n.memoizedState=s,tr=!0),n=n.queue,Hf(u1.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||gt!==null&&gt.memoizedState.tag&1){if(r.flags|=2048,To(9,c1.bind(null,r,n,s,t),void 0,null),wt===null)throw Error(oe(349));Gs&30||l1(r,t,s)}return s}function l1(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=et.updateQueue,t===null?(t={lastEffect:null,stores:null},et.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function c1(e,t,r,n){t.value=r,t.getSnapshot=n,d1(t)&&f1(e)}function u1(e,t,r){return r(function(){d1(t)&&f1(e)})}function d1(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Yr(e,r)}catch{return!0}}function f1(e){var t=bn(e,1);t!==null&&qr(t,e,1,-1)}function Bm(e){var t=tn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:So,lastRenderedState:e},t.queue=e,e=e.dispatch=tE.bind(null,et,e),[t.memoizedState,e]}function To(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=et.updateQueue,t===null?(t={lastEffect:null,stores:null},et.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function h1(){return Fr().memoizedState}function Gl(e,t,r,n){var s=tn();et.flags|=e,s.memoizedState=To(1|t,r,void 0,n===void 0?null:n)}function au(e,t,r,n){var s=Fr();n=n===void 0?null:n;var i=void 0;if(ht!==null){var a=ht.memoizedState;if(i=a.destroy,n!==null&&$f(n,a.deps)){s.memoizedState=To(t,r,i,n);return}}et.flags|=e,s.memoizedState=To(1|t,r,i,n)}function $m(e,t){return Gl(8390656,8,e,t)}function Hf(e,t){return au(2048,8,e,t)}function m1(e,t){return au(4,2,e,t)}function p1(e,t){return au(4,4,e,t)}function g1(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function x1(e,t,r){return r=r!=null?r.concat([e]):null,au(4,4,g1.bind(null,t,e),r)}function zf(){}function v1(e,t){var r=Fr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&$f(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function y1(e,t){var r=Fr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&$f(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function w1(e,t,r){return Gs&21?(Yr(r,t)||(r=bx(),et.lanes|=r,qs|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,tr=!0),e.memoizedState=r)}function Z_(e,t){var r=$e;$e=r!==0&&4>r?r:4,e(!0);var n=g0.transition;g0.transition={};try{e(!1),t()}finally{$e=r,g0.transition=n}}function _1(){return Fr().memoizedState}function eE(e,t,r){var n=as(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},E1(e))S1(t,r);else if(r=n1(e,t,r,n),r!==null){var s=Kt();qr(r,e,n,s),T1(r,t,n)}}function tE(e,t,r){var n=as(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(E1(e))S1(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,o=i(a,r);if(s.hasEagerState=!0,s.eagerState=o,Yr(o,a)){var c=t.interleaved;c===null?(s.next=s,Rf(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=n1(e,t,s,n),r!==null&&(s=Kt(),qr(r,e,n,s),T1(r,t,n))}}function E1(e){var t=e.alternate;return e===et||t!==null&&t===et}function S1(e,t){Ga=gc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function T1(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,_f(e,r)}}var xc={readContext:Or,useCallback:Rt,useContext:Rt,useEffect:Rt,useImperativeHandle:Rt,useInsertionEffect:Rt,useLayoutEffect:Rt,useMemo:Rt,useReducer:Rt,useRef:Rt,useState:Rt,useDebugValue:Rt,useDeferredValue:Rt,useTransition:Rt,useMutableSource:Rt,useSyncExternalStore:Rt,useId:Rt,unstable_isNewReconciler:!1},rE={readContext:Or,useCallback:function(e,t){return tn().memoizedState=[e,t===void 0?null:t],e},useContext:Or,useEffect:$m,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Gl(4194308,4,g1.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Gl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Gl(4,2,e,t)},useMemo:function(e,t){var r=tn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=tn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=eE.bind(null,et,e),[n.memoizedState,e]},useRef:function(e){var t=tn();return e={current:e},t.memoizedState=e},useState:Bm,useDebugValue:zf,useDeferredValue:function(e){return tn().memoizedState=e},useTransition:function(){var e=Bm(!1),t=e[0];return e=Z_.bind(null,e[1]),tn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=et,s=tn();if(Ye){if(r===void 0)throw Error(oe(407));r=r()}else{if(r=t(),wt===null)throw Error(oe(349));Gs&30||l1(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,$m(u1.bind(null,n,i,e),[e]),n.flags|=2048,To(9,c1.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=tn(),t=wt.identifierPrefix;if(Ye){var r=vn,n=xn;r=(n&~(1<<32-Gr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Eo++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Q_++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},nE={readContext:Or,useCallback:v1,useContext:Or,useEffect:Hf,useImperativeHandle:x1,useInsertionEffect:m1,useLayoutEffect:p1,useMemo:y1,useReducer:x0,useRef:h1,useState:function(){return x0(So)},useDebugValue:zf,useDeferredValue:function(e){var t=Fr();return w1(t,ht.memoizedState,e)},useTransition:function(){var e=x0(So)[0],t=Fr().memoizedState;return[e,t]},useMutableSource:a1,useSyncExternalStore:o1,useId:_1,unstable_isNewReconciler:!1},sE={readContext:Or,useCallback:v1,useContext:Or,useEffect:Hf,useImperativeHandle:x1,useInsertionEffect:m1,useLayoutEffect:p1,useMemo:y1,useReducer:v0,useRef:h1,useState:function(){return v0(So)},useDebugValue:zf,useDeferredValue:function(e){var t=Fr();return ht===null?t.memoizedState=e:w1(t,ht.memoizedState,e)},useTransition:function(){var e=v0(So)[0],t=Fr().memoizedState;return[e,t]},useMutableSource:a1,useSyncExternalStore:o1,useId:_1,unstable_isNewReconciler:!1};function Mr(e,t){if(e&&e.defaultProps){t=tt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Sd(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:tt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var ou={isMounted:function(e){return(e=e._reactInternals)?ei(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Kt(),s=as(e),i=yn(n,s);i.payload=t,r!=null&&(i.callback=r),t=ss(e,i,s),t!==null&&(qr(t,e,s,n),zl(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Kt(),s=as(e),i=yn(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=ss(e,i,s),t!==null&&(qr(t,e,s,n),zl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Kt(),n=as(e),s=yn(r,n);s.tag=2,t!=null&&(s.callback=t),t=ss(e,s,n),t!==null&&(qr(t,e,n,r),zl(t,e,n))}};function Um(e,t,r,n,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,a):t.prototype&&t.prototype.isPureReactComponent?!go(r,n)||!go(s,i):!0}function b1(e,t,r){var n=!1,s=ds,i=t.contextType;return typeof i=="object"&&i!==null?i=Or(i):(s=nr(t)?zs:Ut.current,n=t.contextTypes,i=(n=n!=null)?Ki(e,s):ds),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ou,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Wm(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&ou.enqueueReplaceState(t,t.state,null)}function Td(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},If(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Or(i):(i=nr(t)?zs:Ut.current,s.context=Ki(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Sd(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&ou.enqueueReplaceState(s,s.state,null),mc(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Qi(e,t){try{var r="",n=t;do r+=F2(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function y0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function bd(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var iE=typeof WeakMap=="function"?WeakMap:Map;function k1(e,t,r){r=yn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){yc||(yc=!0,Rd=n),bd(e,t)},r}function N1(e,t,r){r=yn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){bd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){bd(e,t),typeof n!="function"&&(is===null?is=new Set([this]):is.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function Hm(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new iE;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=yE.bind(null,e,t,r),t.then(e,e))}function zm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Vm(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=yn(-1,1),t.tag=2,ss(r,t,1))),r.lanes|=1),e)}var aE=On.ReactCurrentOwner,tr=!1;function zt(e,t,r,n){t.child=e===null?r1(t,null,r,n):Yi(t,e.child,r,n)}function Gm(e,t,r,n,s){r=r.render;var i=t.ref;return Bi(t,s),n=Uf(e,t,r,n,i,s),r=Wf(),e!==null&&!tr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,kn(e,t,s)):(Ye&&r&&jf(t),t.flags|=1,zt(e,t,n,s),t.child)}function qm(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!Qf(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,C1(e,t,i,n,s)):(e=Yl(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:go,r(a,n)&&e.ref===t.ref)return kn(e,t,s)}return t.flags|=1,e=os(i,n),e.ref=t.ref,e.return=t,t.child=e}function C1(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(go(i,n)&&e.ref===t.ref)if(tr=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(tr=!0);else return t.lanes=e.lanes,kn(e,t,s)}return kd(e,t,r,n,s)}function j1(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ve(Pi,cr),cr|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ve(Pi,cr),cr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Ve(Pi,cr),cr|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Ve(Pi,cr),cr|=n;return zt(e,t,s,r),t.child}function A1(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function kd(e,t,r,n,s){var i=nr(r)?zs:Ut.current;return i=Ki(t,i),Bi(t,s),r=Uf(e,t,r,n,i,s),n=Wf(),e!==null&&!tr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,kn(e,t,s)):(Ye&&n&&jf(t),t.flags|=1,zt(e,t,r,s),t.child)}function Km(e,t,r,n,s){if(nr(r)){var i=!0;cc(t)}else i=!1;if(Bi(t,s),t.stateNode===null)ql(e,t),b1(t,r,n),Td(t,r,n,s),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var c=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=Or(u):(u=nr(r)?zs:Ut.current,u=Ki(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||c!==u)&&Wm(t,a,n,u),Un=!1;var h=t.memoizedState;a.state=h,mc(t,n,a,s),c=t.memoizedState,o!==n||h!==c||rr.current||Un?(typeof d=="function"&&(Sd(t,r,d,n),c=t.memoizedState),(o=Un||Um(t,r,o,n,h,c,u))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),a.props=n,a.state=c,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,s1(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:Mr(t.type,o),a.props=u,f=t.pendingProps,h=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=Or(c):(c=nr(r)?zs:Ut.current,c=Ki(t,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==f||h!==c)&&Wm(t,a,n,c),Un=!1,h=t.memoizedState,a.state=h,mc(t,n,a,s);var g=t.memoizedState;o!==f||h!==g||rr.current||Un?(typeof p=="function"&&(Sd(t,r,p,n),g=t.memoizedState),(u=Un||Um(t,r,u,n,h,g,c)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,g,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,g,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),a.props=n,a.state=g,a.context=c,n=u):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Nd(e,t,r,n,i,s)}function Nd(e,t,r,n,s,i){A1(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return s&&Pm(t,r,!1),kn(e,t,i);n=t.stateNode,aE.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=Yi(t,e.child,null,i),t.child=Yi(t,null,o,i)):zt(e,t,o,i),t.memoizedState=n.state,s&&Pm(t,r,!0),t.child}function O1(e){var t=e.stateNode;t.pendingContext?Fm(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Fm(e,t.context,!1),Lf(e,t.containerInfo)}function Xm(e,t,r,n,s){return Xi(),Of(s),t.flags|=256,zt(e,t,r,n),t.child}var Cd={dehydrated:null,treeContext:null,retryLane:0};function jd(e){return{baseLanes:e,cachePool:null,transitions:null}}function F1(e,t,r){var n=t.pendingProps,s=Ze.current,i=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Ve(Ze,s&1),e===null)return _d(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,i?(n=t.mode,i=t.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=uu(a,n,0,null),e=Us(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=jd(r),t.memoizedState=Cd,e):Vf(t,a));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return oE(e,t,a,n,o,s,r);if(i){i=n.fallback,a=t.mode,s=e.child,o=s.sibling;var c={mode:"hidden",children:n.children};return!(a&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=os(s,c),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=os(o,i):(i=Us(i,a,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,a=e.child.memoizedState,a=a===null?jd(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~r,t.memoizedState=Cd,n}return i=e.child,e=i.sibling,n=os(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Vf(e,t){return t=uu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function gl(e,t,r,n){return n!==null&&Of(n),Yi(t,e.child,null,r),e=Vf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function oE(e,t,r,n,s,i,a){if(r)return t.flags&256?(t.flags&=-257,n=y0(Error(oe(422))),gl(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=uu({mode:"visible",children:n.children},s,0,null),i=Us(i,s,a,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Yi(t,e.child,null,a),t.child.memoizedState=jd(a),t.memoizedState=Cd,i);if(!(t.mode&1))return gl(e,t,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(oe(419)),n=y0(i,n,void 0),gl(e,t,a,n)}if(o=(a&e.childLanes)!==0,tr||o){if(n=wt,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,bn(e,s),qr(n,e,s,-1))}return Jf(),n=y0(Error(oe(421))),gl(e,t,a,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=wE.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,mr=ns(s.nextSibling),gr=t,Ye=!0,Ur=null,e!==null&&(Tr[br++]=xn,Tr[br++]=vn,Tr[br++]=Vs,xn=e.id,vn=e.overflow,Vs=t),t=Vf(t,n.children),t.flags|=4096,t)}function Ym(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Ed(e.return,t,r)}function w0(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function P1(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(zt(e,t,n.children,r),n=Ze.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ym(e,r,t);else if(e.tag===19)Ym(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ve(Ze,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&pc(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),w0(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&pc(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}w0(t,!0,r,null,i);break;case"together":w0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ql(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function kn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),qs|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(oe(153));if(t.child!==null){for(e=t.child,r=os(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=os(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function lE(e,t,r){switch(t.tag){case 3:O1(t),Xi();break;case 5:i1(t);break;case 1:nr(t.type)&&cc(t);break;case 4:Lf(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Ve(fc,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Ve(Ze,Ze.current&1),t.flags|=128,null):r&t.child.childLanes?F1(e,t,r):(Ve(Ze,Ze.current&1),e=kn(e,t,r),e!==null?e.sibling:null);Ve(Ze,Ze.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return P1(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ve(Ze,Ze.current),n)break;return null;case 22:case 23:return t.lanes=0,j1(e,t,r)}return kn(e,t,r)}var D1,Ad,R1,I1;D1=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ad=function(){};R1=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Ls(on.current);var i=null;switch(r){case"input":s=Q0(e,s),n=Q0(e,n),i=[];break;case"select":s=tt({},s,{value:void 0}),n=tt({},n,{value:void 0}),i=[];break;case"textarea":s=td(e,s),n=td(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=oc)}nd(r,n);var a;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(lo.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(o=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(lo.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ge("scroll",e),i||o===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};I1=function(e,t,r,n){r!==n&&(t.flags|=4)};function ja(e,t){if(!Ye)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function It(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function cE(e,t,r){var n=t.pendingProps;switch(Af(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return It(t),null;case 1:return nr(t.type)&&lc(),It(t),null;case 3:return n=t.stateNode,Ji(),qe(rr),qe(Ut),Bf(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(ml(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ur!==null&&(Md(Ur),Ur=null))),Ad(e,t),It(t),null;case 5:Mf(t);var s=Ls(_o.current);if(r=t.type,e!==null&&t.stateNode!=null)R1(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(oe(166));return It(t),null}if(e=Ls(on.current),ml(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[rn]=t,n[yo]=i,e=(t.mode&1)!==0,r){case"dialog":Ge("cancel",n),Ge("close",n);break;case"iframe":case"object":case"embed":Ge("load",n);break;case"video":case"audio":for(s=0;s<La.length;s++)Ge(La[s],n);break;case"source":Ge("error",n);break;case"img":case"image":case"link":Ge("error",n),Ge("load",n);break;case"details":Ge("toggle",n);break;case"input":im(n,i),Ge("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Ge("invalid",n);break;case"textarea":om(n,i),Ge("invalid",n)}nd(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&hl(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&hl(n.textContent,o,e),s=["children",""+o]):lo.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Ge("scroll",n)}switch(r){case"input":il(n),am(n,i,!0);break;case"textarea":il(n),lm(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=oc)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ux(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[rn]=t,e[yo]=n,D1(e,t,!1,!1),t.stateNode=e;e:{switch(a=sd(r,n),r){case"dialog":Ge("cancel",e),Ge("close",e),s=n;break;case"iframe":case"object":case"embed":Ge("load",e),s=n;break;case"video":case"audio":for(s=0;s<La.length;s++)Ge(La[s],e);s=n;break;case"source":Ge("error",e),s=n;break;case"img":case"image":case"link":Ge("error",e),Ge("load",e),s=n;break;case"details":Ge("toggle",e),s=n;break;case"input":im(e,n),s=Q0(e,n),Ge("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=tt({},n,{value:void 0}),Ge("invalid",e);break;case"textarea":om(e,n),s=td(e,n),Ge("invalid",e);break;default:s=n}nd(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?hx(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&dx(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&co(e,c):typeof c=="number"&&co(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(lo.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ge("scroll",e):c!=null&&pf(e,i,c,a))}switch(r){case"input":il(e),am(e,n,!1);break;case"textarea":il(e),lm(e);break;case"option":n.value!=null&&e.setAttribute("value",""+us(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Ri(e,!!n.multiple,i,!1):n.defaultValue!=null&&Ri(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=oc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return It(t),null;case 6:if(e&&t.stateNode!=null)I1(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(oe(166));if(r=Ls(_o.current),Ls(on.current),ml(t)){if(n=t.stateNode,r=t.memoizedProps,n[rn]=t,(i=n.nodeValue!==r)&&(e=gr,e!==null))switch(e.tag){case 3:hl(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&hl(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[rn]=t,t.stateNode=n}return It(t),null;case 13:if(qe(Ze),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ye&&mr!==null&&t.mode&1&&!(t.flags&128))e1(),Xi(),t.flags|=98560,i=!1;else if(i=ml(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(oe(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(oe(317));i[rn]=t}else Xi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;It(t),i=!1}else Ur!==null&&(Md(Ur),Ur=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ze.current&1?mt===0&&(mt=3):Jf())),t.updateQueue!==null&&(t.flags|=4),It(t),null);case 4:return Ji(),Ad(e,t),e===null&&xo(t.stateNode.containerInfo),It(t),null;case 10:return Df(t.type._context),It(t),null;case 17:return nr(t.type)&&lc(),It(t),null;case 19:if(qe(Ze),i=t.memoizedState,i===null)return It(t),null;if(n=(t.flags&128)!==0,a=i.rendering,a===null)if(n)ja(i,!1);else{if(mt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=pc(e),a!==null){for(t.flags|=128,ja(i,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ve(Ze,Ze.current&1|2),t.child}e=e.sibling}i.tail!==null&&at()>Zi&&(t.flags|=128,n=!0,ja(i,!1),t.lanes=4194304)}else{if(!n)if(e=pc(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ja(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Ye)return It(t),null}else 2*at()-i.renderingStartTime>Zi&&r!==1073741824&&(t.flags|=128,n=!0,ja(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(r=i.last,r!==null?r.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=at(),t.sibling=null,r=Ze.current,Ve(Ze,n?r&1|2:r&1),t):(It(t),null);case 22:case 23:return Yf(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?cr&1073741824&&(It(t),t.subtreeFlags&6&&(t.flags|=8192)):It(t),null;case 24:return null;case 25:return null}throw Error(oe(156,t.tag))}function uE(e,t){switch(Af(t),t.tag){case 1:return nr(t.type)&&lc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ji(),qe(rr),qe(Ut),Bf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Mf(t),null;case 13:if(qe(Ze),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(oe(340));Xi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return qe(Ze),null;case 4:return Ji(),null;case 10:return Df(t.type._context),null;case 22:case 23:return Yf(),null;case 24:return null;default:return null}}var xl=!1,Lt=!1,dE=typeof WeakSet=="function"?WeakSet:Set,_e=null;function Fi(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){rt(e,t,n)}else r.current=null}function Od(e,t,r){try{r()}catch(n){rt(e,t,n)}}var Jm=!1;function fE(e,t){if(md=sc,e=Ux(),Cf(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,o=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var p;f!==r||s!==0&&f.nodeType!==3||(o=a+s),f!==i||n!==0&&f.nodeType!==3||(c=a+n),f.nodeType===3&&(a+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===e)break t;if(h===r&&++u===s&&(o=a),h===i&&++d===n&&(c=a),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(pd={focusedElem:e,selectionRange:r},sc=!1,_e=t;_e!==null;)if(t=_e,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,_e=e;else for(;_e!==null;){t=_e;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,x=g.memoizedState,w=t.stateNode,v=w.getSnapshotBeforeUpdate(t.elementType===t.type?m:Mr(t.type,m),x);w.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(_){rt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,_e=e;break}_e=t.return}return g=Jm,Jm=!1,g}function qa(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Od(t,r,i)}s=s.next}while(s!==n)}}function lu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Fd(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function L1(e){var t=e.alternate;t!==null&&(e.alternate=null,L1(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[rn],delete t[yo],delete t[vd],delete t[K_],delete t[X_])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function M1(e){return e.tag===5||e.tag===3||e.tag===4}function Qm(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||M1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Pd(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=oc));else if(n!==4&&(e=e.child,e!==null))for(Pd(e,t,r),e=e.sibling;e!==null;)Pd(e,t,r),e=e.sibling}function Dd(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Dd(e,t,r),e=e.sibling;e!==null;)Dd(e,t,r),e=e.sibling}var St=null,Br=!1;function Rn(e,t,r){for(r=r.child;r!==null;)B1(e,t,r),r=r.sibling}function B1(e,t,r){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(eu,r)}catch{}switch(r.tag){case 5:Lt||Fi(r,t);case 6:var n=St,s=Br;St=null,Rn(e,t,r),St=n,Br=s,St!==null&&(Br?(e=St,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):St.removeChild(r.stateNode));break;case 18:St!==null&&(Br?(e=St,r=r.stateNode,e.nodeType===8?h0(e.parentNode,r):e.nodeType===1&&h0(e,r),mo(e)):h0(St,r.stateNode));break;case 4:n=St,s=Br,St=r.stateNode.containerInfo,Br=!0,Rn(e,t,r),St=n,Br=s;break;case 0:case 11:case 14:case 15:if(!Lt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Od(r,t,a),s=s.next}while(s!==n)}Rn(e,t,r);break;case 1:if(!Lt&&(Fi(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){rt(r,t,o)}Rn(e,t,r);break;case 21:Rn(e,t,r);break;case 22:r.mode&1?(Lt=(n=Lt)||r.memoizedState!==null,Rn(e,t,r),Lt=n):Rn(e,t,r);break;default:Rn(e,t,r)}}function Zm(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new dE),t.forEach(function(n){var s=_E.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Dr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:St=o.stateNode,Br=!1;break e;case 3:St=o.stateNode.containerInfo,Br=!0;break e;case 4:St=o.stateNode.containerInfo,Br=!0;break e}o=o.return}if(St===null)throw Error(oe(160));B1(i,a,s),St=null,Br=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){rt(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)$1(t,e),t=t.sibling}function $1(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Dr(t,e),Qr(e),n&4){try{qa(3,e,e.return),lu(3,e)}catch(m){rt(e,e.return,m)}try{qa(5,e,e.return)}catch(m){rt(e,e.return,m)}}break;case 1:Dr(t,e),Qr(e),n&512&&r!==null&&Fi(r,r.return);break;case 5:if(Dr(t,e),Qr(e),n&512&&r!==null&&Fi(r,r.return),e.flags&32){var s=e.stateNode;try{co(s,"")}catch(m){rt(e,e.return,m)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=r!==null?r.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&lx(s,i),sd(o,a);var u=sd(o,i);for(a=0;a<c.length;a+=2){var d=c[a],f=c[a+1];d==="style"?hx(s,f):d==="dangerouslySetInnerHTML"?dx(s,f):d==="children"?co(s,f):pf(s,d,f,u)}switch(o){case"input":Z0(s,i);break;case"textarea":cx(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?Ri(s,!!i.multiple,p,!1):h!==!!i.multiple&&(i.defaultValue!=null?Ri(s,!!i.multiple,i.defaultValue,!0):Ri(s,!!i.multiple,i.multiple?[]:"",!1))}s[yo]=i}catch(m){rt(e,e.return,m)}}break;case 6:if(Dr(t,e),Qr(e),n&4){if(e.stateNode===null)throw Error(oe(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(m){rt(e,e.return,m)}}break;case 3:if(Dr(t,e),Qr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{mo(t.containerInfo)}catch(m){rt(e,e.return,m)}break;case 4:Dr(t,e),Qr(e);break;case 13:Dr(t,e),Qr(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Kf=at())),n&4&&Zm(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Lt=(u=Lt)||d,Dr(t,e),Lt=u):Dr(t,e),Qr(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(_e=e,d=e.child;d!==null;){for(f=_e=d;_e!==null;){switch(h=_e,p=h.child,h.tag){case 0:case 11:case 14:case 15:qa(4,h,h.return);break;case 1:Fi(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){rt(n,r,m)}}break;case 5:Fi(h,h.return);break;case 22:if(h.memoizedState!==null){tp(f);continue}}p!==null?(p.return=h,_e=p):tp(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=f.stateNode,c=f.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=fx("display",a))}catch(m){rt(e,e.return,m)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(m){rt(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Dr(t,e),Qr(e),n&4&&Zm(e);break;case 21:break;default:Dr(t,e),Qr(e)}}function Qr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(M1(r)){var n=r;break e}r=r.return}throw Error(oe(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(co(s,""),n.flags&=-33);var i=Qm(e);Dd(e,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,o=Qm(e);Pd(e,o,a);break;default:throw Error(oe(161))}}catch(c){rt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function hE(e,t,r){_e=e,U1(e)}function U1(e,t,r){for(var n=(e.mode&1)!==0;_e!==null;){var s=_e,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||xl;if(!a){var o=s.alternate,c=o!==null&&o.memoizedState!==null||Lt;o=xl;var u=Lt;if(xl=a,(Lt=c)&&!u)for(_e=s;_e!==null;)a=_e,c=a.child,a.tag===22&&a.memoizedState!==null?rp(s):c!==null?(c.return=a,_e=c):rp(s);for(;i!==null;)_e=i,U1(i),i=i.sibling;_e=s,xl=o,Lt=u}ep(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,_e=i):ep(e)}}function ep(e){for(;_e!==null;){var t=_e;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Lt||lu(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Lt)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Mr(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Mm(t,i,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Mm(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&mo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}Lt||t.flags&512&&Fd(t)}catch(h){rt(t,t.return,h)}}if(t===e){_e=null;break}if(r=t.sibling,r!==null){r.return=t.return,_e=r;break}_e=t.return}}function tp(e){for(;_e!==null;){var t=_e;if(t===e){_e=null;break}var r=t.sibling;if(r!==null){r.return=t.return,_e=r;break}_e=t.return}}function rp(e){for(;_e!==null;){var t=_e;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{lu(4,t)}catch(c){rt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){rt(t,s,c)}}var i=t.return;try{Fd(t)}catch(c){rt(t,i,c)}break;case 5:var a=t.return;try{Fd(t)}catch(c){rt(t,a,c)}}}catch(c){rt(t,t.return,c)}if(t===e){_e=null;break}var o=t.sibling;if(o!==null){o.return=t.return,_e=o;break}_e=t.return}}var mE=Math.ceil,vc=On.ReactCurrentDispatcher,Gf=On.ReactCurrentOwner,Cr=On.ReactCurrentBatchConfig,Pe=0,wt=null,ct=null,jt=0,cr=0,Pi=vs(0),mt=0,bo=null,qs=0,cu=0,qf=0,Ka=null,Zt=null,Kf=0,Zi=1/0,mn=null,yc=!1,Rd=null,is=null,vl=!1,Xn=null,wc=0,Xa=0,Id=null,Kl=-1,Xl=0;function Kt(){return Pe&6?at():Kl!==-1?Kl:Kl=at()}function as(e){return e.mode&1?Pe&2&&jt!==0?jt&-jt:J_.transition!==null?(Xl===0&&(Xl=bx()),Xl):(e=$e,e!==0||(e=window.event,e=e===void 0?16:Fx(e.type)),e):1}function qr(e,t,r,n){if(50<Xa)throw Xa=0,Id=null,Error(oe(185));Lo(e,r,n),(!(Pe&2)||e!==wt)&&(e===wt&&(!(Pe&2)&&(cu|=r),mt===4&&Vn(e,jt)),sr(e,n),r===1&&Pe===0&&!(t.mode&1)&&(Zi=at()+500,iu&&ys()))}function sr(e,t){var r=e.callbackNode;J2(e,t);var n=nc(e,e===wt?jt:0);if(n===0)r!==null&&dm(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&dm(r),t===1)e.tag===0?Y_(np.bind(null,e)):Jx(np.bind(null,e)),G_(function(){!(Pe&6)&&ys()}),r=null;else{switch(kx(n)){case 1:r=wf;break;case 4:r=Sx;break;case 16:r=rc;break;case 536870912:r=Tx;break;default:r=rc}r=X1(r,W1.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function W1(e,t){if(Kl=-1,Xl=0,Pe&6)throw Error(oe(327));var r=e.callbackNode;if($i()&&e.callbackNode!==r)return null;var n=nc(e,e===wt?jt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=_c(e,n);else{t=n;var s=Pe;Pe|=2;var i=z1();(wt!==e||jt!==t)&&(mn=null,Zi=at()+500,$s(e,t));do try{xE();break}catch(o){H1(e,o)}while(!0);Pf(),vc.current=i,Pe=s,ct!==null?t=0:(wt=null,jt=0,t=mt)}if(t!==0){if(t===2&&(s=cd(e),s!==0&&(n=s,t=Ld(e,s))),t===1)throw r=bo,$s(e,0),Vn(e,n),sr(e,at()),r;if(t===6)Vn(e,n);else{if(s=e.current.alternate,!(n&30)&&!pE(s)&&(t=_c(e,n),t===2&&(i=cd(e),i!==0&&(n=i,t=Ld(e,i))),t===1))throw r=bo,$s(e,0),Vn(e,n),sr(e,at()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(oe(345));case 2:js(e,Zt,mn);break;case 3:if(Vn(e,n),(n&130023424)===n&&(t=Kf+500-at(),10<t)){if(nc(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Kt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=xd(js.bind(null,e,Zt,mn),t);break}js(e,Zt,mn);break;case 4:if(Vn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var a=31-Gr(n);i=1<<a,a=t[a],a>s&&(s=a),n&=~i}if(n=s,n=at()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*mE(n/1960))-n,10<n){e.timeoutHandle=xd(js.bind(null,e,Zt,mn),n);break}js(e,Zt,mn);break;case 5:js(e,Zt,mn);break;default:throw Error(oe(329))}}}return sr(e,at()),e.callbackNode===r?W1.bind(null,e):null}function Ld(e,t){var r=Ka;return e.current.memoizedState.isDehydrated&&($s(e,t).flags|=256),e=_c(e,t),e!==2&&(t=Zt,Zt=r,t!==null&&Md(t)),e}function Md(e){Zt===null?Zt=e:Zt.push.apply(Zt,e)}function pE(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Yr(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Vn(e,t){for(t&=~qf,t&=~cu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Gr(t),n=1<<r;e[r]=-1,t&=~n}}function np(e){if(Pe&6)throw Error(oe(327));$i();var t=nc(e,0);if(!(t&1))return sr(e,at()),null;var r=_c(e,t);if(e.tag!==0&&r===2){var n=cd(e);n!==0&&(t=n,r=Ld(e,n))}if(r===1)throw r=bo,$s(e,0),Vn(e,t),sr(e,at()),r;if(r===6)throw Error(oe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,js(e,Zt,mn),sr(e,at()),null}function Xf(e,t){var r=Pe;Pe|=1;try{return e(t)}finally{Pe=r,Pe===0&&(Zi=at()+500,iu&&ys())}}function Ks(e){Xn!==null&&Xn.tag===0&&!(Pe&6)&&$i();var t=Pe;Pe|=1;var r=Cr.transition,n=$e;try{if(Cr.transition=null,$e=1,e)return e()}finally{$e=n,Cr.transition=r,Pe=t,!(Pe&6)&&ys()}}function Yf(){cr=Pi.current,qe(Pi)}function $s(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,V_(r)),ct!==null)for(r=ct.return;r!==null;){var n=r;switch(Af(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&lc();break;case 3:Ji(),qe(rr),qe(Ut),Bf();break;case 5:Mf(n);break;case 4:Ji();break;case 13:qe(Ze);break;case 19:qe(Ze);break;case 10:Df(n.type._context);break;case 22:case 23:Yf()}r=r.return}if(wt=e,ct=e=os(e.current,null),jt=cr=t,mt=0,bo=null,qf=cu=qs=0,Zt=Ka=null,Is!==null){for(t=0;t<Is.length;t++)if(r=Is[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}Is=null}return e}function H1(e,t){do{var r=ct;try{if(Pf(),Vl.current=xc,gc){for(var n=et.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}gc=!1}if(Gs=0,gt=ht=et=null,Ga=!1,Eo=0,Gf.current=null,r===null||r.return===null){mt=1,bo=t,ct=null;break}e:{var i=e,a=r.return,o=r,c=t;if(t=jt,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=o,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=zm(a);if(p!==null){p.flags&=-257,Vm(p,a,o,i,t),p.mode&1&&Hm(i,u,t),t=p,c=u;var g=t.updateQueue;if(g===null){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}else{if(!(t&1)){Hm(i,u,t),Jf();break e}c=Error(oe(426))}}else if(Ye&&o.mode&1){var x=zm(a);if(x!==null){!(x.flags&65536)&&(x.flags|=256),Vm(x,a,o,i,t),Of(Qi(c,o));break e}}i=c=Qi(c,o),mt!==4&&(mt=2),Ka===null?Ka=[i]:Ka.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var w=k1(i,c,t);Lm(i,w);break e;case 1:o=c;var v=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(is===null||!is.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var _=N1(i,o,t);Lm(i,_);break e}}i=i.return}while(i!==null)}G1(r)}catch(C){t=C,ct===r&&r!==null&&(ct=r=r.return);continue}break}while(!0)}function z1(){var e=vc.current;return vc.current=xc,e===null?xc:e}function Jf(){(mt===0||mt===3||mt===2)&&(mt=4),wt===null||!(qs&268435455)&&!(cu&268435455)||Vn(wt,jt)}function _c(e,t){var r=Pe;Pe|=2;var n=z1();(wt!==e||jt!==t)&&(mn=null,$s(e,t));do try{gE();break}catch(s){H1(e,s)}while(!0);if(Pf(),Pe=r,vc.current=n,ct!==null)throw Error(oe(261));return wt=null,jt=0,mt}function gE(){for(;ct!==null;)V1(ct)}function xE(){for(;ct!==null&&!W2();)V1(ct)}function V1(e){var t=K1(e.alternate,e,cr);e.memoizedProps=e.pendingProps,t===null?G1(e):ct=t,Gf.current=null}function G1(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=uE(r,t),r!==null){r.flags&=32767,ct=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{mt=6,ct=null;return}}else if(r=cE(r,t,cr),r!==null){ct=r;return}if(t=t.sibling,t!==null){ct=t;return}ct=t=e}while(t!==null);mt===0&&(mt=5)}function js(e,t,r){var n=$e,s=Cr.transition;try{Cr.transition=null,$e=1,vE(e,t,r,n)}finally{Cr.transition=s,$e=n}return null}function vE(e,t,r,n){do $i();while(Xn!==null);if(Pe&6)throw Error(oe(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(oe(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(Q2(e,i),e===wt&&(ct=wt=null,jt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||vl||(vl=!0,X1(rc,function(){return $i(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Cr.transition,Cr.transition=null;var a=$e;$e=1;var o=Pe;Pe|=4,Gf.current=null,fE(e,r),$1(r,e),M_(pd),sc=!!md,pd=md=null,e.current=r,hE(r),H2(),Pe=o,$e=a,Cr.transition=i}else e.current=r;if(vl&&(vl=!1,Xn=e,wc=s),i=e.pendingLanes,i===0&&(is=null),G2(r.stateNode),sr(e,at()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(yc)throw yc=!1,e=Rd,Rd=null,e;return wc&1&&e.tag!==0&&$i(),i=e.pendingLanes,i&1?e===Id?Xa++:(Xa=0,Id=e):Xa=0,ys(),null}function $i(){if(Xn!==null){var e=kx(wc),t=Cr.transition,r=$e;try{if(Cr.transition=null,$e=16>e?16:e,Xn===null)var n=!1;else{if(e=Xn,Xn=null,wc=0,Pe&6)throw Error(oe(331));var s=Pe;for(Pe|=4,_e=e.current;_e!==null;){var i=_e,a=i.child;if(_e.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(_e=u;_e!==null;){var d=_e;switch(d.tag){case 0:case 11:case 15:qa(8,d,i)}var f=d.child;if(f!==null)f.return=d,_e=f;else for(;_e!==null;){d=_e;var h=d.sibling,p=d.return;if(L1(d),d===u){_e=null;break}if(h!==null){h.return=p,_e=h;break}_e=p}}}var g=i.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var x=m.sibling;m.sibling=null,m=x}while(m!==null)}}_e=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,_e=a;else e:for(;_e!==null;){if(i=_e,i.flags&2048)switch(i.tag){case 0:case 11:case 15:qa(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,_e=w;break e}_e=i.return}}var v=e.current;for(_e=v;_e!==null;){a=_e;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,_e=y;else e:for(a=v;_e!==null;){if(o=_e,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:lu(9,o)}}catch(C){rt(o,o.return,C)}if(o===a){_e=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,_e=_;break e}_e=o.return}}if(Pe=s,ys(),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(eu,e)}catch{}n=!0}return n}finally{$e=r,Cr.transition=t}}return!1}function sp(e,t,r){t=Qi(r,t),t=k1(e,t,1),e=ss(e,t,1),t=Kt(),e!==null&&(Lo(e,1,t),sr(e,t))}function rt(e,t,r){if(e.tag===3)sp(e,e,r);else for(;t!==null;){if(t.tag===3){sp(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(is===null||!is.has(n))){e=Qi(r,e),e=N1(t,e,1),t=ss(t,e,1),e=Kt(),t!==null&&(Lo(t,1,e),sr(t,e));break}}t=t.return}}function yE(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Kt(),e.pingedLanes|=e.suspendedLanes&r,wt===e&&(jt&r)===r&&(mt===4||mt===3&&(jt&130023424)===jt&&500>at()-Kf?$s(e,0):qf|=r),sr(e,t)}function q1(e,t){t===0&&(e.mode&1?(t=ll,ll<<=1,!(ll&130023424)&&(ll=4194304)):t=1);var r=Kt();e=bn(e,t),e!==null&&(Lo(e,t,r),sr(e,r))}function wE(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),q1(e,r)}function _E(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(oe(314))}n!==null&&n.delete(t),q1(e,r)}var K1;K1=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||rr.current)tr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return tr=!1,lE(e,t,r);tr=!!(e.flags&131072)}else tr=!1,Ye&&t.flags&1048576&&Qx(t,dc,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;ql(e,t),e=t.pendingProps;var s=Ki(t,Ut.current);Bi(t,r),s=Uf(null,t,n,e,s,r);var i=Wf();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,nr(n)?(i=!0,cc(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,If(t),s.updater=ou,t.stateNode=s,s._reactInternals=t,Td(t,n,e,r),t=Nd(null,t,n,!0,i,r)):(t.tag=0,Ye&&i&&jf(t),zt(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(ql(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=SE(n),e=Mr(n,e),s){case 0:t=kd(null,t,n,e,r);break e;case 1:t=Km(null,t,n,e,r);break e;case 11:t=Gm(null,t,n,e,r);break e;case 14:t=qm(null,t,n,Mr(n.type,e),r);break e}throw Error(oe(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Mr(n,s),kd(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Mr(n,s),Km(e,t,n,s,r);case 3:e:{if(O1(t),e===null)throw Error(oe(387));n=t.pendingProps,i=t.memoizedState,s=i.element,s1(e,t),mc(t,n,null,r);var a=t.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Qi(Error(oe(423)),t),t=Xm(e,t,n,r,s);break e}else if(n!==s){s=Qi(Error(oe(424)),t),t=Xm(e,t,n,r,s);break e}else for(mr=ns(t.stateNode.containerInfo.firstChild),gr=t,Ye=!0,Ur=null,r=r1(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Xi(),n===s){t=kn(e,t,r);break e}zt(e,t,n,r)}t=t.child}return t;case 5:return i1(t),e===null&&_d(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,gd(n,s)?a=null:i!==null&&gd(n,i)&&(t.flags|=32),A1(e,t),zt(e,t,a,r),t.child;case 6:return e===null&&_d(t),null;case 13:return F1(e,t,r);case 4:return Lf(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Yi(t,null,n,r):zt(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Mr(n,s),Gm(e,t,n,s,r);case 7:return zt(e,t,t.pendingProps,r),t.child;case 8:return zt(e,t,t.pendingProps.children,r),t.child;case 12:return zt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,Ve(fc,n._currentValue),n._currentValue=a,i!==null)if(Yr(i.value,a)){if(i.children===s.children&&!rr.current){t=kn(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=yn(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Ed(i.return,r,t),o.lanes|=r;break}c=c.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(oe(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Ed(a,r,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}zt(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Bi(t,r),s=Or(s),n=n(s),t.flags|=1,zt(e,t,n,r),t.child;case 14:return n=t.type,s=Mr(n,t.pendingProps),s=Mr(n.type,s),qm(e,t,n,s,r);case 15:return C1(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Mr(n,s),ql(e,t),t.tag=1,nr(n)?(e=!0,cc(t)):e=!1,Bi(t,r),b1(t,n,s),Td(t,n,s,r),Nd(null,t,n,!0,e,r);case 19:return P1(e,t,r);case 22:return j1(e,t,r)}throw Error(oe(156,t.tag))};function X1(e,t){return Ex(e,t)}function EE(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kr(e,t,r,n){return new EE(e,t,r,n)}function Qf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function SE(e){if(typeof e=="function")return Qf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===xf)return 11;if(e===vf)return 14}return 2}function os(e,t){var r=e.alternate;return r===null?(r=kr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Yl(e,t,r,n,s,i){var a=2;if(n=e,typeof e=="function")Qf(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Si:return Us(r.children,s,i,t);case gf:a=8,s|=8;break;case K0:return e=kr(12,r,t,s|2),e.elementType=K0,e.lanes=i,e;case X0:return e=kr(13,r,t,s),e.elementType=X0,e.lanes=i,e;case Y0:return e=kr(19,r,t,s),e.elementType=Y0,e.lanes=i,e;case ix:return uu(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case nx:a=10;break e;case sx:a=9;break e;case xf:a=11;break e;case vf:a=14;break e;case $n:a=16,n=null;break e}throw Error(oe(130,e==null?e:typeof e,""))}return t=kr(a,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function Us(e,t,r,n){return e=kr(7,e,n,t),e.lanes=r,e}function uu(e,t,r,n){return e=kr(22,e,n,t),e.elementType=ix,e.lanes=r,e.stateNode={isHidden:!1},e}function _0(e,t,r){return e=kr(6,e,null,t),e.lanes=r,e}function E0(e,t,r){return t=kr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function TE(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=r0(0),this.expirationTimes=r0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=r0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Zf(e,t,r,n,s,i,a,o,c){return e=new TE(e,t,r,o,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=kr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},If(i),e}function bE(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ei,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Y1(e){if(!e)return ds;e=e._reactInternals;e:{if(ei(e)!==e||e.tag!==1)throw Error(oe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(nr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(oe(171))}if(e.tag===1){var r=e.type;if(nr(r))return Yx(e,r,t)}return t}function J1(e,t,r,n,s,i,a,o,c){return e=Zf(r,n,!0,e,s,i,a,o,c),e.context=Y1(null),r=e.current,n=Kt(),s=as(r),i=yn(n,s),i.callback=t??null,ss(r,i,s),e.current.lanes=s,Lo(e,s,n),sr(e,n),e}function du(e,t,r,n){var s=t.current,i=Kt(),a=as(s);return r=Y1(r),t.context===null?t.context=r:t.pendingContext=r,t=yn(i,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ss(s,t,a),e!==null&&(qr(e,s,a,i),zl(e,s,a)),a}function Ec(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ip(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function eh(e,t){ip(e,t),(e=e.alternate)&&ip(e,t)}function kE(){return null}var Q1=typeof reportError=="function"?reportError:function(e){console.error(e)};function th(e){this._internalRoot=e}fu.prototype.render=th.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(oe(409));du(e,t,null,null)};fu.prototype.unmount=th.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ks(function(){du(null,e,null,null)}),t[Tn]=null}};function fu(e){this._internalRoot=e}fu.prototype.unstable_scheduleHydration=function(e){if(e){var t=jx();e={blockedOn:null,target:e,priority:t};for(var r=0;r<zn.length&&t!==0&&t<zn[r].priority;r++);zn.splice(r,0,e),r===0&&Ox(e)}};function rh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function hu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ap(){}function NE(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var u=Ec(a);i.call(u)}}var a=J1(t,n,e,0,null,!1,!1,"",ap);return e._reactRootContainer=a,e[Tn]=a.current,xo(e.nodeType===8?e.parentNode:e),Ks(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var u=Ec(c);o.call(u)}}var c=Zf(e,0,!1,null,null,!1,!1,"",ap);return e._reactRootContainer=c,e[Tn]=c.current,xo(e.nodeType===8?e.parentNode:e),Ks(function(){du(t,c,r,n)}),c}function mu(e,t,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var o=s;s=function(){var c=Ec(a);o.call(c)}}du(t,a,e,s)}else a=NE(r,t,e,s,n);return Ec(a)}Nx=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ia(t.pendingLanes);r!==0&&(_f(t,r|1),sr(t,at()),!(Pe&6)&&(Zi=at()+500,ys()))}break;case 13:Ks(function(){var n=bn(e,1);if(n!==null){var s=Kt();qr(n,e,1,s)}}),eh(e,1)}};Ef=function(e){if(e.tag===13){var t=bn(e,134217728);if(t!==null){var r=Kt();qr(t,e,134217728,r)}eh(e,134217728)}};Cx=function(e){if(e.tag===13){var t=as(e),r=bn(e,t);if(r!==null){var n=Kt();qr(r,e,t,n)}eh(e,t)}};jx=function(){return $e};Ax=function(e,t){var r=$e;try{return $e=e,t()}finally{$e=r}};ad=function(e,t,r){switch(t){case"input":if(Z0(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=su(n);if(!s)throw Error(oe(90));ox(n),Z0(n,s)}}}break;case"textarea":cx(e,r);break;case"select":t=r.value,t!=null&&Ri(e,!!r.multiple,t,!1)}};gx=Xf;xx=Ks;var CE={usingClientEntryPoint:!1,Events:[Bo,Ni,su,mx,px,Xf]},Aa={findFiberByHostInstance:Rs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},jE={bundleType:Aa.bundleType,version:Aa.version,rendererPackageName:Aa.rendererPackageName,rendererConfig:Aa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:On.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=wx(e),e===null?null:e.stateNode},findFiberByHostInstance:Aa.findFiberByHostInstance||kE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yl.isDisabled&&yl.supportsFiber)try{eu=yl.inject(jE),an=yl}catch{}}yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CE;yr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!rh(t))throw Error(oe(200));return bE(e,t,null,r)};yr.createRoot=function(e,t){if(!rh(e))throw Error(oe(299));var r=!1,n="",s=Q1;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Zf(e,1,!1,null,null,r,!1,n,s),e[Tn]=t.current,xo(e.nodeType===8?e.parentNode:e),new th(t)};yr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(oe(188)):(e=Object.keys(e).join(","),Error(oe(268,e)));return e=wx(t),e=e===null?null:e.stateNode,e};yr.flushSync=function(e){return Ks(e)};yr.hydrate=function(e,t,r){if(!hu(t))throw Error(oe(200));return mu(null,e,t,!0,r)};yr.hydrateRoot=function(e,t,r){if(!rh(e))throw Error(oe(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=Q1;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=J1(t,null,e,1,r??null,s,!1,i,a),e[Tn]=t.current,xo(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new fu(t)};yr.render=function(e,t,r){if(!hu(t))throw Error(oe(200));return mu(null,e,t,!1,r)};yr.unmountComponentAtNode=function(e){if(!hu(e))throw Error(oe(40));return e._reactRootContainer?(Ks(function(){mu(null,null,e,!1,function(){e._reactRootContainer=null,e[Tn]=null})}),!0):!1};yr.unstable_batchedUpdates=Xf;yr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!hu(r))throw Error(oe(200));if(e==null||e._reactInternals===void 0)throw Error(oe(38));return mu(e,t,r,!1,n)};yr.version="18.3.1-next-f1338f8080-20240426";function Z1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Z1)}catch(e){console.error(e)}}Z1(),Zg.exports=yr;var AE=Zg.exports,ev,op=AE;ev=op.createRoot,op.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ko(){return ko=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ko.apply(this,arguments)}var Yn;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Yn||(Yn={}));const lp="popstate";function OE(e){e===void 0&&(e={});function t(n,s){let{pathname:i,search:a,hash:o}=n.location;return Bd("",{pathname:i,search:a,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:Sc(s)}return PE(t,r,null,e)}function ot(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function tv(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function FE(){return Math.random().toString(36).substr(2,8)}function cp(e,t){return{usr:e.state,key:e.key,idx:t}}function Bd(e,t,r,n){return r===void 0&&(r=null),ko({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?ca(t):t,{state:r,key:t&&t.key||n||FE()})}function Sc(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function ca(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function PE(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,a=s.history,o=Yn.Pop,c=null,u=d();u==null&&(u=0,a.replaceState(ko({},a.state,{idx:u}),""));function d(){return(a.state||{idx:null}).idx}function f(){o=Yn.Pop;let x=d(),w=x==null?null:x-u;u=x,c&&c({action:o,location:m.location,delta:w})}function h(x,w){o=Yn.Push;let v=Bd(m.location,x,w);u=d()+1;let y=cp(v,u),_=m.createHref(v);try{a.pushState(y,"",_)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;s.location.assign(_)}i&&c&&c({action:o,location:m.location,delta:1})}function p(x,w){o=Yn.Replace;let v=Bd(m.location,x,w);u=d();let y=cp(v,u),_=m.createHref(v);a.replaceState(y,"",_),i&&c&&c({action:o,location:m.location,delta:0})}function g(x){let w=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof x=="string"?x:Sc(x);return v=v.replace(/ $/,"%20"),ot(w,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,w)}let m={get action(){return o},get location(){return e(s,a)},listen(x){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(lp,f),c=x,()=>{s.removeEventListener(lp,f),c=null}},createHref(x){return t(s,x)},createURL:g,encodeLocation(x){let w=g(x);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:h,replace:p,go(x){return a.go(x)}};return m}var up;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(up||(up={}));function DE(e,t,r){return r===void 0&&(r="/"),RE(e,t,r,!1)}function RE(e,t,r,n){let s=typeof t=="string"?ca(t):t,i=nh(s.pathname||"/",r);if(i==null)return null;let a=rv(e);IE(a);let o=null;for(let c=0;o==null&&c<a.length;++c){let u=qE(i);o=VE(a[c],u,n)}return o}function rv(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,a,o)=>{let c={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};c.relativePath.startsWith("/")&&(ot(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=ls([n,c.relativePath]),d=r.concat(c);i.children&&i.children.length>0&&(ot(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),rv(i.children,t,d,u)),!(i.path==null&&!i.index)&&t.push({path:u,score:HE(u,i.index),routesMeta:d})};return e.forEach((i,a)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))s(i,a);else for(let c of nv(i.path))s(i,a,c)}),t}function nv(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let a=nv(n.join("/")),o=[];return o.push(...a.map(c=>c===""?i:[i,c].join("/"))),s&&o.push(...a),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function IE(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:zE(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const LE=/^:[\w-]+$/,ME=3,BE=2,$E=1,UE=10,WE=-2,dp=e=>e==="*";function HE(e,t){let r=e.split("/"),n=r.length;return r.some(dp)&&(n+=WE),t&&(n+=BE),r.filter(s=>!dp(s)).reduce((s,i)=>s+(LE.test(i)?ME:i===""?$E:UE),n)}function zE(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function VE(e,t,r){let{routesMeta:n}=e,s={},i="/",a=[];for(let o=0;o<n.length;++o){let c=n[o],u=o===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",f=fp({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!f&&u&&r&&!n[n.length-1].route.index&&(f=fp({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!f)return null;Object.assign(s,f.params),a.push({params:s,pathname:ls([i,f.pathname]),pathnameBase:JE(ls([i,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(i=ls([i,f.pathnameBase]))}return a}function fp(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=GE(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:h,isOptional:p}=d;if(h==="*"){let m=o[f]||"";a=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const g=o[f];return p&&!g?u[h]=void 0:u[h]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:a,pattern:e}}function GE(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),tv(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function qE(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return tv(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function nh(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function KE(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?ca(e):e;return{pathname:r?r.startsWith("/")?r:XE(r,t):t,search:QE(n),hash:ZE(s)}}function XE(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function S0(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function YE(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function sh(e,t){let r=YE(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function ih(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=ca(e):(s=ko({},e),ot(!s.pathname||!s.pathname.includes("?"),S0("?","pathname","search",s)),ot(!s.pathname||!s.pathname.includes("#"),S0("#","pathname","hash",s)),ot(!s.search||!s.search.includes("#"),S0("#","search","hash",s)));let i=e===""||s.pathname==="",a=i?"/":s.pathname,o;if(a==null)o=r;else{let f=t.length-1;if(!n&&a.startsWith("..")){let h=a.split("/");for(;h[0]==="..";)h.shift(),f-=1;s.pathname=h.join("/")}o=f>=0?t[f]:"/"}let c=KE(s,o),u=a&&a!=="/"&&a.endsWith("/"),d=(i||a===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const ls=e=>e.join("/").replace(/\/\/+/g,"/"),JE=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),QE=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ZE=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function eS(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const sv=["post","put","patch","delete"];new Set(sv);const tS=["get",...sv];new Set(tS);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function No(){return No=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},No.apply(this,arguments)}const ah=b.createContext(null),rS=b.createContext(null),ws=b.createContext(null),pu=b.createContext(null),Fn=b.createContext({outlet:null,matches:[],isDataRoute:!1}),iv=b.createContext(null);function nS(e,t){let{relative:r}=t===void 0?{}:t;ua()||ot(!1);let{basename:n,navigator:s}=b.useContext(ws),{hash:i,pathname:a,search:o}=ov(e,{relative:r}),c=a;return n!=="/"&&(c=a==="/"?n:ls([n,a])),s.createHref({pathname:c,search:o,hash:i})}function ua(){return b.useContext(pu)!=null}function da(){return ua()||ot(!1),b.useContext(pu).location}function av(e){b.useContext(ws).static||b.useLayoutEffect(e)}function Uo(){let{isDataRoute:e}=b.useContext(Fn);return e?vS():sS()}function sS(){ua()||ot(!1);let e=b.useContext(ah),{basename:t,future:r,navigator:n}=b.useContext(ws),{matches:s}=b.useContext(Fn),{pathname:i}=da(),a=JSON.stringify(sh(s,r.v7_relativeSplatPath)),o=b.useRef(!1);return av(()=>{o.current=!0}),b.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let f=ih(u,JSON.parse(a),i,d.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:ls([t,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[t,n,a,i,e])}const iS=b.createContext(null);function aS(e){let t=b.useContext(Fn).outlet;return t&&b.createElement(iS.Provider,{value:e},t)}function ov(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=b.useContext(ws),{matches:s}=b.useContext(Fn),{pathname:i}=da(),a=JSON.stringify(sh(s,n.v7_relativeSplatPath));return b.useMemo(()=>ih(e,JSON.parse(a),i,r==="path"),[e,a,i,r])}function oS(e,t){return lS(e,t)}function lS(e,t,r,n){ua()||ot(!1);let{navigator:s}=b.useContext(ws),{matches:i}=b.useContext(Fn),a=i[i.length-1],o=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=da(),d;if(t){var f;let x=typeof t=="string"?ca(t):t;c==="/"||(f=x.pathname)!=null&&f.startsWith(c)||ot(!1),d=x}else d=u;let h=d.pathname||"/",p=h;if(c!=="/"){let x=c.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(x.length).join("/")}let g=DE(e,{pathname:p}),m=hS(g&&g.map(x=>Object.assign({},x,{params:Object.assign({},o,x.params),pathname:ls([c,s.encodeLocation?s.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:ls([c,s.encodeLocation?s.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),i,r,n);return t&&m?b.createElement(pu.Provider,{value:{location:No({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Yn.Pop}},m):m}function cS(){let e=xS(),t=eS(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},t),r?b.createElement("pre",{style:s},r):null,null)}const uS=b.createElement(cS,null);class dS extends b.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?b.createElement(Fn.Provider,{value:this.props.routeContext},b.createElement(iv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function fS(e){let{routeContext:t,match:r,children:n}=e,s=b.useContext(ah);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),b.createElement(Fn.Provider,{value:t},n)}function hS(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=a.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);d>=0||ot(!1),a=a.slice(0,Math.min(a.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<a.length;d++){let f=a[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:p}=r,g=f.route.loader&&h[f.route.id]===void 0&&(!p||p[f.route.id]===void 0);if(f.route.lazy||g){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((d,f,h)=>{let p,g=!1,m=null,x=null;r&&(p=o&&f.route.id?o[f.route.id]:void 0,m=f.route.errorElement||uS,c&&(u<0&&h===0?(g=!0,x=null):u===h&&(g=!0,x=f.route.hydrateFallbackElement||null)));let w=t.concat(a.slice(0,h+1)),v=()=>{let y;return p?y=m:g?y=x:f.route.Component?y=b.createElement(f.route.Component,null):f.route.element?y=f.route.element:y=d,b.createElement(fS,{match:f,routeContext:{outlet:d,matches:w,isDataRoute:r!=null},children:y})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?b.createElement(dS,{location:r.location,revalidation:r.revalidation,component:m,error:p,children:v(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):v()},null)}var lv=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(lv||{}),Tc=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Tc||{});function mS(e){let t=b.useContext(ah);return t||ot(!1),t}function pS(e){let t=b.useContext(rS);return t||ot(!1),t}function gS(e){let t=b.useContext(Fn);return t||ot(!1),t}function cv(e){let t=gS(),r=t.matches[t.matches.length-1];return r.route.id||ot(!1),r.route.id}function xS(){var e;let t=b.useContext(iv),r=pS(Tc.UseRouteError),n=cv(Tc.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function vS(){let{router:e}=mS(lv.UseNavigateStable),t=cv(Tc.UseNavigateStable),r=b.useRef(!1);return av(()=>{r.current=!0}),b.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,No({fromRouteId:t},i)))},[e,t])}function yS(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function uv(e){let{to:t,replace:r,state:n,relative:s}=e;ua()||ot(!1);let{future:i,static:a}=b.useContext(ws),{matches:o}=b.useContext(Fn),{pathname:c}=da(),u=Uo(),d=ih(t,sh(o,i.v7_relativeSplatPath),c,s==="path"),f=JSON.stringify(d);return b.useEffect(()=>u(JSON.parse(f),{replace:r,state:n,relative:s}),[u,f,s,r,n]),null}function wS(e){return aS(e.context)}function _t(e){ot(!1)}function _S(e){let{basename:t="/",children:r=null,location:n,navigationType:s=Yn.Pop,navigator:i,static:a=!1,future:o}=e;ua()&&ot(!1);let c=t.replace(/^\/*/,"/"),u=b.useMemo(()=>({basename:c,navigator:i,static:a,future:No({v7_relativeSplatPath:!1},o)}),[c,o,i,a]);typeof n=="string"&&(n=ca(n));let{pathname:d="/",search:f="",hash:h="",state:p=null,key:g="default"}=n,m=b.useMemo(()=>{let x=nh(d,c);return x==null?null:{location:{pathname:x,search:f,hash:h,state:p,key:g},navigationType:s}},[c,d,f,h,p,g,s]);return m==null?null:b.createElement(ws.Provider,{value:u},b.createElement(pu.Provider,{children:r,value:m}))}function ES(e){let{children:t,location:r}=e;return oS($d(t),r)}new Promise(()=>{});function $d(e,t){t===void 0&&(t=[]);let r=[];return b.Children.forEach(e,(n,s)=>{if(!b.isValidElement(n))return;let i=[...t,s];if(n.type===b.Fragment){r.push.apply(r,$d(n.props.children,i));return}n.type!==_t&&ot(!1),!n.props.index||!n.props.children||ot(!1);let a={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=$d(n.props.children,i)),r.push(a)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ud(){return Ud=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ud.apply(this,arguments)}function SS(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function TS(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function bS(e,t){return e.button===0&&(!t||t==="_self")&&!TS(e)}const kS=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],NS="6";try{window.__reactRouterVersion=NS}catch{}const CS="startTransition",hp=G0[CS];function jS(e){let{basename:t,children:r,future:n,window:s}=e,i=b.useRef();i.current==null&&(i.current=OE({window:s,v5Compat:!0}));let a=i.current,[o,c]=b.useState({action:a.action,location:a.location}),{v7_startTransition:u}=n||{},d=b.useCallback(f=>{u&&hp?hp(()=>c(f)):c(f)},[c,u]);return b.useLayoutEffect(()=>a.listen(d),[a,d]),b.useEffect(()=>yS(n),[n]),b.createElement(_S,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:a,future:n})}const AS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",OS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mp=b.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:i,replace:a,state:o,target:c,to:u,preventScrollReset:d,viewTransition:f}=t,h=SS(t,kS),{basename:p}=b.useContext(ws),g,m=!1;if(typeof u=="string"&&OS.test(u)&&(g=u,AS))try{let y=new URL(window.location.href),_=u.startsWith("//")?new URL(y.protocol+u):new URL(u),C=nh(_.pathname,p);_.origin===y.origin&&C!=null?u=C+_.search+_.hash:m=!0}catch{}let x=nS(u,{relative:s}),w=FS(u,{replace:a,state:o,target:c,preventScrollReset:d,relative:s,viewTransition:f});function v(y){n&&n(y),y.defaultPrevented||w(y)}return b.createElement("a",Ud({},h,{href:g||x,onClick:m||i?n:v,ref:r,target:c}))});var pp;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(pp||(pp={}));var gp;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(gp||(gp={}));function FS(e,t){let{target:r,replace:n,state:s,preventScrollReset:i,relative:a,viewTransition:o}=t===void 0?{}:t,c=Uo(),u=da(),d=ov(e,{relative:a});return b.useCallback(f=>{if(bS(f,r)){f.preventDefault();let h=n!==void 0?n:Sc(u)===Sc(d);c(e,{replace:h,state:s,preventScrollReset:i,relative:a,viewTransition:o})}},[u,c,d,n,s,r,e,i,a,o])}let PS={data:""},DS=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||PS,RS=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,IS=/\/\*[^]*?\*\/|  +/g,xp=/\n+/g,Gn=(e,t)=>{let r="",n="",s="";for(let i in e){let a=e[i];i[0]=="@"?i[1]=="i"?r=i+" "+a+";":n+=i[1]=="f"?Gn(a,i):i+"{"+Gn(a,i[1]=="k"?"":t)+"}":typeof a=="object"?n+=Gn(a,t?t.replace(/([^,])+/g,o=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,o):o?o+" "+c:c)):i):a!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Gn.p?Gn.p(i,a):i+":"+a+";")}return r+(t&&s?t+"{"+s+"}":s)+n},fn={},dv=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+dv(e[r]);return t}return e},LS=(e,t,r,n,s)=>{let i=dv(e),a=fn[i]||(fn[i]=(c=>{let u=0,d=11;for(;u<c.length;)d=101*d+c.charCodeAt(u++)>>>0;return"go"+d})(i));if(!fn[a]){let c=i!==e?e:(u=>{let d,f,h=[{}];for(;d=RS.exec(u.replace(IS,""));)d[4]?h.shift():d[3]?(f=d[3].replace(xp," ").trim(),h.unshift(h[0][f]=h[0][f]||{})):h[0][d[1]]=d[2].replace(xp," ").trim();return h[0]})(e);fn[a]=Gn(s?{["@keyframes "+a]:c}:c,r?"":"."+a)}let o=r&&fn.g?fn.g:null;return r&&(fn.g=fn[a]),((c,u,d,f)=>{f?u.data=u.data.replace(f,c):u.data.indexOf(c)===-1&&(u.data=d?c+u.data:u.data+c)})(fn[a],t,n,o),a},MS=(e,t,r)=>e.reduce((n,s,i)=>{let a=t[i];if(a&&a.call){let o=a(r),c=o&&o.props&&o.props.className||/^go/.test(o)&&o;a=c?"."+c:o&&typeof o=="object"?o.props?"":Gn(o,""):o===!1?"":o}return n+s+(a??"")},"");function gu(e){let t=this||{},r=e.call?e(t.p):e;return LS(r.unshift?r.raw?MS(r,[].slice.call(arguments,1),t.p):r.reduce((n,s)=>Object.assign(n,s&&s.call?s(t.p):s),{}):r,DS(t.target),t.g,t.o,t.k)}let fv,Wd,Hd;gu.bind({g:1});let Nn=gu.bind({k:1});function BS(e,t,r,n){Gn.p=t,fv=e,Wd=r,Hd=n}function _s(e,t){let r=this||{};return function(){let n=arguments;function s(i,a){let o=Object.assign({},i),c=o.className||s.className;r.p=Object.assign({theme:Wd&&Wd()},o),r.o=/ *go\d+/.test(c),o.className=gu.apply(r,n)+(c?" "+c:"");let u=e;return e[0]&&(u=o.as||e,delete o.as),Hd&&u[0]&&Hd(o),fv(u,o)}return s}}var $S=e=>typeof e=="function",bc=(e,t)=>$S(e)?e(t):e,US=(()=>{let e=0;return()=>(++e).toString()})(),hv=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),WS=20,mv=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,WS)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:r}=t;return mv(e,{type:e.toasts.find(i=>i.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=t;return{...e,toasts:e.toasts.map(i=>i.id===n||n===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let s=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+s}))}}},Jl=[],Ms={toasts:[],pausedAt:void 0},ti=e=>{Ms=mv(Ms,e),Jl.forEach(t=>{t(Ms)})},HS={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},zS=(e={})=>{let[t,r]=b.useState(Ms),n=b.useRef(Ms);b.useEffect(()=>(n.current!==Ms&&r(Ms),Jl.push(r),()=>{let i=Jl.indexOf(r);i>-1&&Jl.splice(i,1)}),[]);let s=t.toasts.map(i=>{var a,o,c;return{...e,...e[i.type],...i,removeDelay:i.removeDelay||((a=e[i.type])==null?void 0:a.removeDelay)||(e==null?void 0:e.removeDelay),duration:i.duration||((o=e[i.type])==null?void 0:o.duration)||(e==null?void 0:e.duration)||HS[i.type],style:{...e.style,...(c=e[i.type])==null?void 0:c.style,...i.style}}});return{...t,toasts:s}},VS=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||US()}),Wo=e=>(t,r)=>{let n=VS(t,e,r);return ti({type:2,toast:n}),n.id},qt=(e,t)=>Wo("blank")(e,t);qt.error=Wo("error");qt.success=Wo("success");qt.loading=Wo("loading");qt.custom=Wo("custom");qt.dismiss=e=>{ti({type:3,toastId:e})};qt.remove=e=>ti({type:4,toastId:e});qt.promise=(e,t,r)=>{let n=qt.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(s=>{let i=t.success?bc(t.success,s):void 0;return i?qt.success(i,{id:n,...r,...r==null?void 0:r.success}):qt.dismiss(n),s}).catch(s=>{let i=t.error?bc(t.error,s):void 0;i?qt.error(i,{id:n,...r,...r==null?void 0:r.error}):qt.dismiss(n)}),e};var GS=(e,t)=>{ti({type:1,toast:{id:e,height:t}})},qS=()=>{ti({type:5,time:Date.now()})},Ya=new Map,KS=1e3,XS=(e,t=KS)=>{if(Ya.has(e))return;let r=setTimeout(()=>{Ya.delete(e),ti({type:4,toastId:e})},t);Ya.set(e,r)},YS=e=>{let{toasts:t,pausedAt:r}=zS(e);b.useEffect(()=>{if(r)return;let i=Date.now(),a=t.map(o=>{if(o.duration===1/0)return;let c=(o.duration||0)+o.pauseDuration-(i-o.createdAt);if(c<0){o.visible&&qt.dismiss(o.id);return}return setTimeout(()=>qt.dismiss(o.id),c)});return()=>{a.forEach(o=>o&&clearTimeout(o))}},[t,r]);let n=b.useCallback(()=>{r&&ti({type:6,time:Date.now()})},[r]),s=b.useCallback((i,a)=>{let{reverseOrder:o=!1,gutter:c=8,defaultPosition:u}=a||{},d=t.filter(p=>(p.position||u)===(i.position||u)&&p.height),f=d.findIndex(p=>p.id===i.id),h=d.filter((p,g)=>g<f&&p.visible).length;return d.filter(p=>p.visible).slice(...o?[h+1]:[0,h]).reduce((p,g)=>p+(g.height||0)+c,0)},[t]);return b.useEffect(()=>{t.forEach(i=>{if(i.dismissed)XS(i.id,i.removeDelay);else{let a=Ya.get(i.id);a&&(clearTimeout(a),Ya.delete(i.id))}})},[t]),{toasts:t,handlers:{updateHeight:GS,startPause:qS,endPause:n,calculateOffset:s}}},JS=Nn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,QS=Nn`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,ZS=Nn`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,eT=_s("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${JS} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${QS} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${ZS} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,tT=Nn`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,rT=_s("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${tT} 1s linear infinite;
`,nT=Nn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,sT=Nn`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,iT=_s("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${nT} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${sT} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,aT=_s("div")`
  position: absolute;
`,oT=_s("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,lT=Nn`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,cT=_s("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${lT} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,uT=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?b.createElement(cT,null,t):t:r==="blank"?null:b.createElement(oT,null,b.createElement(rT,{...n}),r!=="loading"&&b.createElement(aT,null,r==="error"?b.createElement(eT,{...n}):b.createElement(iT,{...n})))},dT=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,fT=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,hT="0%{opacity:0;} 100%{opacity:1;}",mT="0%{opacity:1;} 100%{opacity:0;}",pT=_s("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,gT=_s("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,xT=(e,t)=>{let r=e.includes("top")?1:-1,[n,s]=hv()?[hT,mT]:[dT(r),fT(r)];return{animation:t?`${Nn(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Nn(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},vT=b.memo(({toast:e,position:t,style:r,children:n})=>{let s=e.height?xT(e.position||t||"top-center",e.visible):{opacity:0},i=b.createElement(uT,{toast:e}),a=b.createElement(gT,{...e.ariaProps},bc(e.message,e));return b.createElement(pT,{className:e.className,style:{...s,...r,...e.style}},typeof n=="function"?n({icon:i,message:a}):b.createElement(b.Fragment,null,i,a))});BS(b.createElement);var yT=({id:e,className:t,style:r,onHeightUpdate:n,children:s})=>{let i=b.useCallback(a=>{if(a){let o=()=>{let c=a.getBoundingClientRect().height;n(e,c)};o(),new MutationObserver(o).observe(a,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return b.createElement("div",{ref:i,className:t,style:r},s)},wT=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},s=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:hv()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...s}},_T=gu`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,wl=16,ET=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:s,containerStyle:i,containerClassName:a})=>{let{toasts:o,handlers:c}=YS(r);return b.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:wl,left:wl,right:wl,bottom:wl,pointerEvents:"none",...i},className:a,onMouseEnter:c.startPause,onMouseLeave:c.endPause},o.map(u=>{let d=u.position||t,f=c.calculateOffset(u,{reverseOrder:e,gutter:n,defaultPosition:t}),h=wT(d,f);return b.createElement(yT,{id:u.id,key:u.id,onHeightUpdate:c.updateHeight,className:u.visible?_T:"",style:h},u.type==="custom"?bc(u.message,u):s?s(u):b.createElement(vT,{toast:u,position:d}))}))},we=qt;const pv=b.createContext(void 0);function ST({children:e}){const[t,r]=b.useState(null),[n,s]=b.useState(!1),i=o=>{console.log(":",o.name),r(o),s(!0),localStorage.setItem("currentUser",JSON.stringify(o))},a=()=>{console.log(""),r(null),s(!1),localStorage.removeItem("currentUser")};return b.useEffect(()=>{const o=localStorage.getItem("currentUser");if(o)try{const c=JSON.parse(o);r(c),s(!0),console.log(":",c.name)}catch(c){console.error(":",c),localStorage.removeItem("currentUser")}},[]),l.jsx(pv.Provider,{value:{currentUser:t,isAuthenticated:n,switchUser:i,logout:a},children:e})}function Wt(){const e=b.useContext(pv);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}const TT={sessionTimeout:480,maxLoginAttempts:5,lockoutDuration:30,passwordPolicy:{minLength:8,requireUppercase:!0,requireLowercase:!0,requireNumbers:!0,requireSpecialChars:!1},auditLogRetention:90},vp={president:{role:"president",permissions:["users:read","users:write","users:delete","users:manage_roles","groups:read","groups:write","groups:delete","groups:manage_members","equipment:read","equipment:write","equipment:delete","schedules:read","schedules:write","schedules:delete","schedules:read_all","schedules:manage_others","leave:read","leave:write","leave:approve","leave:read_all","admin:access","admin:system_settings","admin:audit_logs","system:backup","system:maintenance"],dataAccess:{canViewAllUsers:!0,canViewAllSchedules:!0,canViewAllLeaveRequests:!0,canModifyOthersData:!0}},admin:{role:"admin",permissions:["users:read","users:write","groups:read","groups:write","groups:delete","groups:manage_members","equipment:read","equipment:write","equipment:delete","schedules:read","schedules:write","schedules:delete","schedules:read_all","leave:read","leave:write","leave:approve","leave:read_all","admin:access"],dataAccess:{canViewAllUsers:!0,canViewAllSchedules:!0,canViewAllLeaveRequests:!0,canModifyOthersData:!1}},employee:{role:"employee",permissions:["users:read","groups:read","equipment:read","schedules:read","schedules:write","schedules:delete","leave:read","leave:write"],dataAccess:{canViewAllUsers:!1,canViewAllSchedules:!1,canViewAllLeaveRequests:!1,canModifyOthersData:!1}}},gv=b.createContext(void 0);function bT({children:e}){const{currentUser:t,isAuthenticated:r}=Wt(),[n,s]=b.useState(TT),[i,a]=b.useState(null),[o,c]=b.useState([]),u=t?vp[t.role]:vp.employee,d=u.permissions;b.useEffect(()=>{if(r&&t){const _=new Date,C=`session_${t.id}_${_.getTime()}`;a({id:C,userId:t.id,createdAt:_,lastActivity:_,expiresAt:new Date(_.getTime()+n.sessionTimeout*60*1e3),isActive:!0}),setTimeout(()=>{m({type:"login",action:"User logged in",severity:"low"})},0)}else i&&setTimeout(()=>{m({type:"logout",action:"User logged out",severity:"low"})},0),a(null)},[r,t]);const f=_=>!t||!r?!1:d.includes(_),h=_=>!t||!r?!1:_.some(C=>d.includes(C)),p=_=>!t||!r?!1:_.every(C=>d.includes(C)),g=(_,C,E)=>{if(!t||!r)return!1;if(t.role==="president")return!0;const T=E===t.id;switch(_){case"user":if(C==="read")return f("users:read");if(C==="write")return f("users:write")||T;if(C==="delete")return f("users:delete");if(C==="manage_roles")return f("users:manage_roles");break;case"schedule":if(C==="read")return f("schedules:read")&&(f("schedules:read_all")||T);if(C==="write")return f("schedules:write")&&(f("schedules:manage_others")||T);if(C==="delete")return f("schedules:delete")&&(f("schedules:manage_others")||T);break;case"leave_request":if(C==="read")return f("leave:read")&&(f("leave:read_all")||T);if(C==="write")return f("leave:write")||T;if(C==="approve")return f("leave:approve");break;case"group":if(C==="read")return f("groups:read");if(C==="write")return f("groups:write");if(C==="delete")return f("groups:delete");if(C==="manage_members")return f("groups:manage_members");break;case"equipment":if(C==="read")return f("equipment:read");if(C==="write")return f("equipment:write");if(C==="delete")return f("equipment:delete");break;default:return!1}return!1},m=_=>{if(!t)return;const C={id:`event_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date,userId:t.id,userEmail:t.email,userRole:t.role,..._};c(E=>[C,...E].slice(0,1e3))},x=_=>{if(!f("admin:system_settings")){m({type:"permission_denied",action:"Attempted to update security settings",severity:"medium"});return}s(C=>({...C,..._})),m({type:"admin_action",action:"Updated security settings",details:_,severity:"medium"})},w=()=>{if(!i||!i.isActive)return!1;const _=new Date;return _>i.expiresAt?(a(E=>E?{...E,isActive:!1}:null),setTimeout(()=>{m({type:"security_violation",action:"Session expired",severity:"medium"})},0),!1):(a(E=>E?{...E,lastActivity:_}:null),!0)},v=()=>{if(!i)return;const _=new Date;a(C=>C?{...C,lastActivity:_,expiresAt:new Date(_.getTime()+n.sessionTimeout*60*1e3)}:null)},y=_=>{if(!f("admin:audit_logs"))return m({type:"permission_denied",action:"Attempted to access audit logs",severity:"medium"}),[];let C=o;return _&&(C=o.filter(E=>Object.entries(_).every(([T,M])=>M===void 0?!0:E[T]===M))),C};return b.useEffect(()=>{const _=setInterval(()=>{i&&!w()&&(window.location.href="/login")},6e4);return()=>clearInterval(_)},[i]),l.jsx(gv.Provider,{value:{permissions:d,rolePermissions:u,securitySettings:n,sessionInfo:i,securityEvents:o,hasPermission:f,hasAnyPermission:h,hasAllPermissions:p,canAccessResource:g,logSecurityEvent:m,updateSecuritySettings:x,checkSessionValidity:w,extendSession:v,getAuditLogs:y},children:e})}function xv(){const e=b.useContext(gv);if(e===void 0)throw new Error("useSecurity must be used within a SecurityProvider");return e}function Ke(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function ln(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Mt(e,t){const r=Ke(e);return isNaN(t)?ln(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function kT(e,t){const r=+Ke(e);return ln(e,r+t)}const vv=6048e5,NT=864e5,CT=36e5;function jT(e,t){return kT(e,t*CT)}let AT={};function xu(){return AT}function At(e,t){var o,c,u,d;const r=xu(),n=(t==null?void 0:t.weekStartsOn)??((c=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,s=Ke(e),i=s.getDay(),a=(i<n?7:0)+i-n;return s.setDate(s.getDate()-a),s.setHours(0,0,0,0),s}function kc(e){return At(e,{weekStartsOn:1})}function yv(e){const t=Ke(e),r=t.getFullYear(),n=ln(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const s=kc(n),i=ln(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const a=kc(i);return t.getTime()>=s.getTime()?r+1:t.getTime()>=a.getTime()?r:r-1}function Nc(e){const t=Ke(e);return t.setHours(0,0,0,0),t}function yp(e){const t=Ke(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function OT(e,t){const r=Nc(e),n=Nc(t),s=+r-yp(r),i=+n-yp(n);return Math.round((s-i)/NT)}function FT(e){const t=yv(e),r=ln(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),kc(r)}function PT(e){return ln(e,Date.now())}function zd(e,t){const r=Nc(e),n=Nc(t);return+r==+n}function DT(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function RT(e){if(!DT(e)&&typeof e!="number")return!1;const t=Ke(e);return!isNaN(Number(t))}function vu(e){const t=Ke(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function yu(e,t){const r=Ke(e.start),n=Ke(e.end);let s=+r>+n;const i=s?+r:+n,a=s?n:r;a.setHours(0,0,0,0);let o=1;const c=[];for(;+a<=i;)c.push(Ke(a)),a.setDate(a.getDate()+o),a.setHours(0,0,0,0);return s?c.reverse():c}function wu(e){const t=Ke(e);return t.setDate(1),t.setHours(0,0,0,0),t}function IT(e){const t=Ke(e),r=ln(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}const LT={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},MT=(e,t,r)=>{let n;const s=LT[e];return typeof s=="string"?n=s:t===1?n=s.one:n=s.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Ui(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const BT={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},$T={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},UT={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},WT={date:Ui({formats:BT,defaultWidth:"full"}),time:Ui({formats:$T,defaultWidth:"full"}),dateTime:Ui({formats:UT,defaultWidth:"full"})},HT={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},zT=(e,t,r,n)=>HT[e];function nn(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):a;s=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[o]||e.values[a]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const VT={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},GT={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},qT={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},KT={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},XT={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},YT={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},JT=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},QT={ordinalNumber:JT,era:nn({values:VT,defaultWidth:"wide"}),quarter:nn({values:GT,defaultWidth:"wide",argumentCallback:e=>e-1}),month:nn({values:qT,defaultWidth:"wide"}),day:nn({values:KT,defaultWidth:"wide"}),dayPeriod:nn({values:XT,defaultWidth:"wide",formattingValues:YT,defaultFormattingWidth:"wide"})};function sn(e){return(t,r={})=>{const n=r.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const a=i[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(o)?eb(o,f=>f.test(a)):ZT(o,f=>f.test(a));let u;u=e.valueCallback?e.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const d=t.slice(a.length);return{value:u,rest:d}}}function ZT(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function eb(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function wv(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const s=n[0],i=t.match(e.parsePattern);if(!i)return null;let a=e.valueCallback?e.valueCallback(i[0]):i[0];a=r.valueCallback?r.valueCallback(a):a;const o=t.slice(s.length);return{value:a,rest:o}}}const tb=/^(\d+)(th|st|nd|rd)?/i,rb=/\d+/i,nb={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},sb={any:[/^b/i,/^(a|c)/i]},ib={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},ab={any:[/1/i,/2/i,/3/i,/4/i]},ob={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},lb={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},cb={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ub={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},db={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},fb={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},hb={ordinalNumber:wv({matchPattern:tb,parsePattern:rb,valueCallback:e=>parseInt(e,10)}),era:sn({matchPatterns:nb,defaultMatchWidth:"wide",parsePatterns:sb,defaultParseWidth:"any"}),quarter:sn({matchPatterns:ib,defaultMatchWidth:"wide",parsePatterns:ab,defaultParseWidth:"any",valueCallback:e=>e+1}),month:sn({matchPatterns:ob,defaultMatchWidth:"wide",parsePatterns:lb,defaultParseWidth:"any"}),day:sn({matchPatterns:cb,defaultMatchWidth:"wide",parsePatterns:ub,defaultParseWidth:"any"}),dayPeriod:sn({matchPatterns:db,defaultMatchWidth:"any",parsePatterns:fb,defaultParseWidth:"any"})},mb={code:"en-US",formatDistance:MT,formatLong:WT,formatRelative:zT,localize:QT,match:hb,options:{weekStartsOn:0,firstWeekContainsDate:1}};function pb(e){const t=Ke(e);return OT(t,IT(t))+1}function gb(e){const t=Ke(e),r=+kc(t)-+FT(t);return Math.round(r/vv)+1}function _v(e,t){var d,f,h,p;const r=Ke(e),n=r.getFullYear(),s=xu(),i=(t==null?void 0:t.firstWeekContainsDate)??((f=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??s.firstWeekContainsDate??((p=(h=s.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??1,a=ln(e,0);a.setFullYear(n+1,0,i),a.setHours(0,0,0,0);const o=At(a,t),c=ln(e,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const u=At(c,t);return r.getTime()>=o.getTime()?n+1:r.getTime()>=u.getTime()?n:n-1}function xb(e,t){var o,c,u,d;const r=xu(),n=(t==null?void 0:t.firstWeekContainsDate)??((c=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,s=_v(e,t),i=ln(e,0);return i.setFullYear(s,0,n),i.setHours(0,0,0,0),At(i,t)}function vb(e,t){const r=Ke(e),n=+At(r,t)-+xb(r,t);return Math.round(n/vv)+1}function Le(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const In={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Le(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Le(r+1,2)},d(e,t){return Le(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Le(e.getHours()%12||12,t.length)},H(e,t){return Le(e.getHours(),t.length)},m(e,t){return Le(e.getMinutes(),t.length)},s(e,t){return Le(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return Le(s,t.length)}},di={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wp={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return In.y(e,t)},Y:function(e,t,r,n){const s=_v(e,n),i=s>0?s:1-s;if(t==="YY"){const a=i%100;return Le(a,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Le(i,t.length)},R:function(e,t){const r=yv(e);return Le(r,t.length)},u:function(e,t){const r=e.getFullYear();return Le(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Le(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Le(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return In.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Le(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const s=vb(e,n);return t==="wo"?r.ordinalNumber(s,{unit:"week"}):Le(s,t.length)},I:function(e,t,r){const n=gb(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Le(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):In.d(e,t)},D:function(e,t,r){const n=pb(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Le(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const s=e.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Le(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const s=e.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Le(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),s=n===0?7:n;switch(t){case"i":return String(s);case"ii":return Le(s,t.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let s;switch(n===12?s=di.noon:n===0?s=di.midnight:s=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let s;switch(n>=17?s=di.evening:n>=12?s=di.afternoon:n>=4?s=di.morning:s=di.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return In.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):In.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Le(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Le(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):In.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):In.s(e,t)},S:function(e,t){return In.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return Ep(n);case"XXXX":case"XX":return As(n);case"XXXXX":case"XXX":default:return As(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return Ep(n);case"xxxx":case"xx":return As(n);case"xxxxx":case"xxx":default:return As(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+_p(n,":");case"OOOO":default:return"GMT"+As(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+_p(n,":");case"zzzz":default:return"GMT"+As(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return Le(n,t.length)},T:function(e,t,r){const n=e.getTime();return Le(n,t.length)}};function _p(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Math.trunc(n/60),i=n%60;return i===0?r+String(s):r+String(s)+t+Le(i,2)}function Ep(e,t){return e%60===0?(e>0?"-":"+")+Le(Math.abs(e)/60,2):As(e,t)}function As(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Le(Math.trunc(n/60),2),i=Le(n%60,2);return r+s+t+i}const Sp=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Ev=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},yb=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return Sp(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",Sp(n,t)).replace("{{time}}",Ev(s,t))},wb={p:Ev,P:yb},_b=/^D+$/,Eb=/^Y+$/,Sb=["D","DD","YY","YYYY"];function Tb(e){return _b.test(e)}function bb(e){return Eb.test(e)}function kb(e,t,r){const n=Nb(e,t,r);if(console.warn(n),Sb.includes(e))throw new RangeError(n)}function Nb(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Cb=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,jb=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ab=/^'([^]*?)'?$/,Ob=/''/g,Fb=/[a-zA-Z]/;function be(e,t,r){var d,f,h,p,g,m,x,w;const n=xu(),s=(r==null?void 0:r.locale)??n.locale??mb,i=(r==null?void 0:r.firstWeekContainsDate)??((f=(d=r==null?void 0:r.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((p=(h=n.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??1,a=(r==null?void 0:r.weekStartsOn)??((m=(g=r==null?void 0:r.locale)==null?void 0:g.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((w=(x=n.locale)==null?void 0:x.options)==null?void 0:w.weekStartsOn)??0,o=Ke(e);if(!RT(o))throw new RangeError("Invalid time value");let c=t.match(jb).map(v=>{const y=v[0];if(y==="p"||y==="P"){const _=wb[y];return _(v,s.formatLong)}return v}).join("").match(Cb).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const y=v[0];if(y==="'")return{isToken:!1,value:Pb(v)};if(wp[y])return{isToken:!0,value:v};if(y.match(Fb))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:v}});s.localize.preprocessor&&(c=s.localize.preprocessor(o,c));const u={firstWeekContainsDate:i,weekStartsOn:a,locale:s};return c.map(v=>{if(!v.isToken)return v.value;const y=v.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&bb(y)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&Tb(y))&&kb(y,t,String(e));const _=wp[y[0]];return _(o,y,s.localize,u)}).join("")}function Pb(e){const t=e.match(Ab);return t?t[1].replace(Ob,"'"):e}function _u(e,t){const r=Ke(e),n=Ke(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function fs(e){return zd(e,PT(e))}function Tp(e,t){const r=+Ke(e),[n,s]=[+Ke(t.start),+Ke(t.end)].sort((i,a)=>i-a);return r>=n&&r<=s}function bp(e,t){return Mt(e,-t)}function Db(e,t){const r=Ke(e);return r.setHours(t),r}function Rb(e,t){const r=Ke(e);return r.setMinutes(t),r}const Xs=[{id:"550e8400-e29b-41d4-a716-446655440001",employeeId:"012E3D24690F653F",name:" ",nameKana:" ",email:"yamada@terao-f.co.jp",phone:"03-1234-5678",department:"",role:"president",defaultWorkDays:[{day:1,startTime:"09:00",endTime:"18:00"},{day:2,startTime:"09:00",endTime:"18:00"},{day:3,startTime:"09:00",endTime:"18:00"},{day:4,startTime:"09:00",endTime:"18:00"},{day:5,startTime:"09:00",endTime:"18:00"}]},{id:"550e8400-e29b-41d4-a716-446655440002",employeeId:"112E3D24690F653G",name:" ",nameKana:" ",email:"suzuki@terao-f.co.jp",phone:"03-1234-5679",department:"",role:"admin",defaultWorkDays:[{day:1,startTime:"09:00",endTime:"18:00"},{day:2,startTime:"09:00",endTime:"18:00"},{day:3,startTime:"09:00",endTime:"18:00"},{day:4,startTime:"09:00",endTime:"18:00"},{day:5,startTime:"09:00",endTime:"18:00"}]},{id:"550e8400-e29b-41d4-a716-446655440003",employeeId:"212E3D24690F653H",name:" ",nameKana:" ",email:"sato@terao-f.co.jp",phone:"03-1234-5680",department:"CAD-CAM",role:"employee",defaultWorkDays:[{day:1,startTime:"09:00",endTime:"18:00"},{day:2,startTime:"09:00",endTime:"18:00"},{day:3,startTime:"09:00",endTime:"18:00"},{day:4,startTime:"09:00",endTime:"18:00"},{day:5,startTime:"09:00",endTime:"18:00"}]},{id:"4",employeeId:"312E3D24690F653I",name:" ",nameKana:" ",email:"tanaka@terao-f.co.jp",phone:"03-1234-5681",department:"WEB",role:"employee",defaultWorkDays:[{day:1,startTime:"09:00",endTime:"18:00"},{day:2,startTime:"09:00",endTime:"18:00"},{day:3,startTime:"09:00",endTime:"18:00"},{day:4,startTime:"09:00",endTime:"18:00"},{day:5,startTime:"09:00",endTime:"18:00"}]}],Cc=[{id:"1",name:"",type:"department",members:["1"],createdBy:"1",createdAt:new Date("2025-01-01")},{id:"2",name:"",type:"department",members:["2"],createdBy:"1",createdAt:new Date("2025-01-01")},{id:"3",name:"CAD-CAM",type:"department",members:["3"],createdBy:"1",createdAt:new Date("2025-01-01")},{id:"4",name:"WEB",type:"department",members:["4"],createdBy:"1",createdAt:new Date("2025-01-01")},{id:"5",name:"A",type:"business",members:["1","2","3"],createdBy:"1",createdAt:new Date("2025-01-15")},{id:"6",name:"",type:"leave",members:["1","2"],createdBy:"1",createdAt:new Date("2025-01-01")}],jc=[{id:"1",name:"",createdBy:"1"},{id:"2",name:"",createdBy:"1"},{id:"3",name:"",createdBy:"1"},{id:"4",name:"Web",createdBy:"1"},{id:"5",name:"LAB",createdBy:"1"}],Ac=[{id:"1",name:"",licensePlate:" 300  12-34",type:"",createdBy:"1"},{id:"2",name:"",licensePlate:" 400  56-78",type:"",createdBy:"1"},{id:"3",name:"",licensePlate:" 500  90-12",type:"",createdBy:"1"}],Oc=[{id:"1",name:"CAD 1",type:"CAD"},{id:"2",name:" 1",type:""},{id:"3",name:" 1",type:""},{id:"4",name:" 1",type:""},{id:"5",name:" 1",type:""},{id:"6",name:" 1",type:""}],Fc=new Date,Pc=new Date(Fc);Pc.setDate(Pc.getDate()+1);const Dc=new Date(Fc);Dc.setDate(Dc.getDate()+2);const kp=[{id:"1",type:"",title:"",details:"",startTime:new Date(Fc.setHours(10,0,0,0)),endTime:new Date(Fc.setHours(11,0,0,0)),isAllDay:!1,recurrence:{type:"weekly",interval:1,endDate:null,count:null,weekdays:[1]},participants:["1","2","3","4"],equipment:[{id:"1",type:"room"}],reminders:[{time:15,methods:["email","notification"]}],createdBy:"1",createdAt:new Date("2025-01-15"),updatedBy:null,updatedAt:null},{id:"2",type:"",title:"A",details:"",startTime:new Date(Pc.setHours(14,0,0,0)),endTime:new Date(Pc.setHours(15,30,0,0)),isAllDay:!1,recurrence:null,participants:["1","2"],equipment:[{id:"4",type:"room"}],reminders:[{time:30,methods:["email"]}],createdBy:"2",createdAt:new Date("2025-01-20"),updatedBy:null,updatedAt:null},{id:"3",type:"",title:"B",details:"",startTime:new Date(Dc.setHours(13,0,0,0)),endTime:new Date(Dc.setHours(16,0,0,0)),isAllDay:!1,recurrence:null,participants:["1","3"],equipment:[{id:"2",type:"room"},{id:"1",type:"vehicle"}],reminders:[{time:60,methods:["email","notification","calendar"]}],createdBy:"1",createdAt:new Date("2025-01-22"),updatedBy:null,updatedAt:null}],Np=[{id:"1",type:"vacation",userId:"3",date:new Date("2025-02-15"),reason:"",status:"pending",approvers:[{userId:"2",status:"approved",timestamp:new Date("2025-02-10T10:30:00")},{userId:"1",status:"pending",timestamp:null}],createdAt:new Date("2025-02-10")},{id:"2",type:"late",userId:"4",date:new Date("2025-02-12"),reason:"",status:"approved",approvers:[{userId:"2",status:"approved",timestamp:new Date("2025-02-11T09:15:00")},{userId:"1",status:"approved",timestamp:new Date("2025-02-11T14:20:00")}],createdAt:new Date("2025-02-11")}],Ib="modulepreload",Lb=function(e){return"/"+e},Cp={},Ho=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=Lb(c),c in Cp)return;Cp[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Ib,u||(f.as="script"),f.crossOrigin="",f.href=c,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},Mb=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ho(async()=>{const{default:n}=await Promise.resolve().then(()=>fa);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class oh extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Bb extends oh{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class $b extends oh{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Ub extends oh{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Vd;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Vd||(Vd={}));var Wb=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(d){try{u(n.next(d))}catch(f){a(f)}}function c(d){try{u(n.throw(d))}catch(f){a(f)}}function u(d){d.done?i(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class Hb{constructor(t,{headers:r={},customFetch:n,region:s=Vd.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=Mb(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return Wb(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:a}=r;let o={},{region:c}=r;c||(c=this.region),c&&c!=="any"&&(o["x-region"]=c);let u;a&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(o["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(o["Content-Type"]="application/json",u=JSON.stringify(a)));const d=yield this.fetch(`${this.url}/${t}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:u}).catch(g=>{throw new Bb(g)}),f=d.headers.get("x-relay-error");if(f&&f==="true")throw new $b(d);if(!d.ok)throw new Ub(d);let h=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),p;return h==="application/json"?p=yield d.json():h==="application/octet-stream"?p=yield d.blob():h==="text/event-stream"?p=d:h==="multipart/form-data"?p=yield d.formData():p=yield d.text(),{data:p,error:null}}catch(s){return{data:null,error:s}}})}}var er={},lh={},Eu={},zo={},Su={},Tu={},zb=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ea=zb();const Vb=ea.fetch,Sv=ea.fetch.bind(ea),Tv=ea.Headers,Gb=ea.Request,qb=ea.Response,fa=Object.freeze(Object.defineProperty({__proto__:null,Headers:Tv,Request:Gb,Response:qb,default:Sv,fetch:Vb},Symbol.toStringTag,{value:"Module"})),Kb=s2(fa);var bu={};Object.defineProperty(bu,"__esModule",{value:!0});let Xb=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};bu.default=Xb;var bv=Ar&&Ar.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Tu,"__esModule",{value:!0});const Yb=bv(Kb),Jb=bv(bu);let Qb=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Yb.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,o,c;let u=null,d=null,f=null,h=i.status,p=i.statusText;if(i.ok){if(this.method!=="HEAD"){const w=await i.text();w===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=w:d=JSON.parse(w))}const m=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),x=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");m&&x&&x.length>1&&(f=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,f=null,h=406,p="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const m=await i.text();try{u=JSON.parse(m),Array.isArray(u)&&i.status===404&&(d=[],u=null,h=200,p="OK")}catch{i.status===404&&m===""?(h=204,p="No Content"):u={message:m}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,h=200,p="OK"),u&&this.shouldThrowOnError)throw new Jb.default(u)}return{error:u,data:d,count:f,status:h,statusText:p}});return this.shouldThrowOnError||(s=s.catch(i=>{var a,o,c;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};Tu.default=Qb;var Zb=Ar&&Ar.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Su,"__esModule",{value:!0});const ek=Zb(Tu);let tk=class extends ek.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const a=i?`${i}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"offset":`${s}.offset`,a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(a,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:a="text"}={}){var o;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${u}"; options=${c};`,a==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Su.default=tk;var rk=Ar&&Ar.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(zo,"__esModule",{value:!0});const nk=rk(Su);let sk=class extends nk.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${a}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};zo.default=sk;var ik=Ar&&Ar.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Eu,"__esModule",{value:!0});const Oa=ik(zo);let ak=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=r,this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let i=!1;const a=(t??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),n&&(this.headers.Prefer=`count=${n}`),new Oa.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const a=t.reduce((o,c)=>o.concat(Object.keys(c)),[]);if(a.length>0){const o=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",o.join(","))}}return new Oa.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){const a="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),s&&o.push(`count=${s}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const c=t.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new Oa.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),this.headers.Prefer=s.join(","),new Oa.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Oa.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Eu.default=ak;var ku={},Nu={};Object.defineProperty(Nu,"__esModule",{value:!0});Nu.version=void 0;Nu.version="0.0.0-automated";Object.defineProperty(ku,"__esModule",{value:!0});ku.DEFAULT_HEADERS=void 0;const ok=Nu;ku.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${ok.version}`};var kv=Ar&&Ar.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(lh,"__esModule",{value:!0});const lk=kv(Eu),ck=kv(zo),uk=ku;let dk=class Nv{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},uk.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new lk.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Nv(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:i}={}){let a;const o=new URL(`${this.url}/rpc/${t}`);let c;n||s?(a=n?"HEAD":"GET",Object.entries(r).filter(([d,f])=>f!==void 0).map(([d,f])=>[d,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([d,f])=>{o.searchParams.append(d,f)})):(a="POST",c=r);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new ck.default({method:a,url:o,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};lh.default=dk;var ha=Ar&&Ar.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(er,"__esModule",{value:!0});er.PostgrestError=er.PostgrestBuilder=er.PostgrestTransformBuilder=er.PostgrestFilterBuilder=er.PostgrestQueryBuilder=er.PostgrestClient=void 0;const Cv=ha(lh);er.PostgrestClient=Cv.default;const jv=ha(Eu);er.PostgrestQueryBuilder=jv.default;const Av=ha(zo);er.PostgrestFilterBuilder=Av.default;const Ov=ha(Su);er.PostgrestTransformBuilder=Ov.default;const Fv=ha(Tu);er.PostgrestBuilder=Fv.default;const Pv=ha(bu);er.PostgrestError=Pv.default;var fk=er.default={PostgrestClient:Cv.default,PostgrestQueryBuilder:jv.default,PostgrestFilterBuilder:Av.default,PostgrestTransformBuilder:Ov.default,PostgrestBuilder:Fv.default,PostgrestError:Pv.default};const{PostgrestClient:hk,PostgrestQueryBuilder:F8,PostgrestFilterBuilder:P8,PostgrestTransformBuilder:D8,PostgrestBuilder:R8,PostgrestError:I8}=fk;let Gd;typeof window>"u"?Gd=require("ws"):Gd=window.WebSocket;const mk=Gd,pk="2.11.10",gk={"X-Client-Info":`realtime-js/${pk}`},xk="1.0.0",Dv=1e4,vk=1e3;var Wi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Wi||(Wi={}));var Ht;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ht||(Ht={}));var $r;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})($r||($r={}));var qd;(function(e){e.websocket="websocket"})(qd||(qd={}));var Fs;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Fs||(Fs={}));class yk{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2);let a=this.HEADER_LENGTH+2;const o=n.decode(t.slice(a,a+s));a=a+s;const c=n.decode(t.slice(a,a+i));a=a+i;const u=JSON.parse(n.decode(t.slice(a,t.byteLength)));return{ref:null,topic:o,event:c,payload:u}}}class Rv{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ze;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ze||(ze={}));const jp=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,a)=>(i[a]=wk(a,e,t,s),i),{})},wk=(e,t,r,n)=>{const s=t.find(o=>o.name===e),i=s==null?void 0:s.type,a=r[e];return i&&!n.includes(i)?Iv(i,a):Kd(a)},Iv=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Tk(t,r)}switch(e){case ze.bool:return _k(t);case ze.float4:case ze.float8:case ze.int2:case ze.int4:case ze.int8:case ze.numeric:case ze.oid:return Ek(t);case ze.json:case ze.jsonb:return Sk(t);case ze.timestamp:return bk(t);case ze.abstime:case ze.date:case ze.daterange:case ze.int4range:case ze.int8range:case ze.money:case ze.reltime:case ze.text:case ze.time:case ze.timestamptz:case ze.timetz:case ze.tsrange:case ze.tstzrange:return Kd(t);default:return Kd(t)}},Kd=e=>e,_k=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Ek=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Sk=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Tk=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const a=e.slice(1,r);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>Iv(t,o))}return e},bk=e=>typeof e=="string"?e.replace(" ","T"):e,Lv=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class T0{constructor(t,r,n={},s=Dv){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Ap;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Ap||(Ap={}));class Ja{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ja.syncState(this.state,s,i,a),this.pendingDiffs.forEach(c=>{this.state=Ja.syncDiff(this.state,c,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ja.syncDiff(this.state,s,i,a),o())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const i=this.cloneDeep(t),a=this.transformState(r),o={},c={};return this.map(i,(u,d)=>{a[u]||(c[u]=d)}),this.map(a,(u,d)=>{const f=i[u];if(f){const h=d.map(x=>x.presence_ref),p=f.map(x=>x.presence_ref),g=d.filter(x=>p.indexOf(x.presence_ref)<0),m=f.filter(x=>h.indexOf(x.presence_ref)<0);g.length>0&&(o[u]=g),m.length>0&&(c[u]=m)}else o[u]=d}),this.syncDiff(i,{joins:o,leaves:c},n,s)}static syncDiff(t,r,n,s){const{joins:i,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(o,c)=>{var u;const d=(u=t[o])!==null&&u!==void 0?u:[];if(t[o]=this.cloneDeep(c),d.length>0){const f=t[o].map(p=>p.presence_ref),h=d.filter(p=>f.indexOf(p.presence_ref)<0);t[o].unshift(...h)}n(o,d,c)}),this.map(a,(o,c)=>{let u=t[o];if(!u)return;const d=c.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),t[o]=u,s(o,u,c),u.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Op;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Op||(Op={}));var Fp;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Fp||(Fp={}));var pn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(pn||(pn={}));class ch{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Ht.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new T0(this,$r.join,this.params,this.timeout),this.rejoinTimer=new Rv(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ht.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ht.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Ht.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ht.errored,this.rejoinTimer.scheduleTimeout())}),this._on($r.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Ja(this),this.broadcastEndpointURL=Lv(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a,private:o}}=this.params;this._onError(d=>t==null?void 0:t(pn.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(pn.CLOSED));const c={},u={broadcast:i,presence:a,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&s!==void 0?s:[],private:o};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},c)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var f;if(this.socket.setAuth(),d===void 0){t==null||t(pn.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,p=(f=h==null?void 0:h.length)!==null&&f!==void 0?f:0,g=[];for(let m=0;m<p;m++){const x=h[m],{filter:{event:w,schema:v,table:y,filter:_}}=x,C=d&&d[m];if(C&&C.event===w&&C.schema===v&&C.table===y&&C.filter===_)g.push(Object.assign(Object.assign({},x),{id:C.id}));else{this.unsubscribe(),this.state=Ht.errored,t==null||t(pn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(pn.SUBSCRIBED);return}}).receive("error",d=>{this.state=Ht.errored,t==null||t(pn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(pn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:a}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ht.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger($r.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(n=>{const s=new T0(this,$r.leave,{},t);s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new T0(this,t,r,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,i;const a=t.toLocaleLowerCase(),{close:o,error:c,leave:u,join:d}=$r;if(n&&[o,c,u,d].indexOf(a)>=0&&n!==this._joinRef())return;let h=this._onMessage(a,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var g,m,x;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((x=(m=p.filter)===null||m===void 0?void 0:m.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===a}).map(p=>p.callback(h,n)):(i=this.bindings[a])===null||i===void 0||i.filter(p=>{var g,m,x,w,v,y;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in p){const _=p.id,C=(g=p.filter)===null||g===void 0?void 0:g.event;return _&&((m=r.ids)===null||m===void 0?void 0:m.includes(_))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const _=(v=(w=p==null?void 0:p.filter)===null||w===void 0?void 0:w.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return _==="*"||_===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===a}).map(p=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:m,table:x,commit_timestamp:w,type:v,errors:y}=g;h=Object.assign(Object.assign({},{schema:m,table:x,commit_timestamp:w,eventType:v,new:{},old:{},errors:y}),this._getPayloadRecords(g))}p.callback(h,n)})}_isClosed(){return this.state===Ht.closed}_isJoined(){return this.state===Ht.joined}_isJoining(){return this.state===Ht.joining}_isLeaving(){return this.state===Ht.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&ch.isEqual(s.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on($r.close,{},t)}_onError(t){this._on($r.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ht.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=jp(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=jp(t.columns,t.old_record)),r}}const Pp=()=>{},kk=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Nk{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=gk,this.params={},this.timeout=Dv,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Pp,this.ref=0,this.logger=Pp,this.conn=null,this.sendBuffer=[],this.serializer=new yk,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>Ho(async()=>{const{default:c}=await Promise.resolve().then(()=>fa);return{default:c}},void 0).then(({default:c})=>c(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${t}/${qd.websocket}`,this.httpEndpoint=Lv(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const s=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,a)=>a(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Rv(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=mk),this.transport){typeof window<"u"&&this.transport===window.WebSocket?this.conn=new this.transport(this.endpointURL()):this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection();return}this.conn=new Ck(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:xk}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels=this.channels.filter(n=>n._joinRef!==t._joinRef),this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Wi.connecting:return Fs.Connecting;case Wi.open:return Fs.Open;case Wi.closing:return Fs.Closing;default:return Fs.Closed}}isConnected(){return this.connectionState()===Fs.Open}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new ch(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:s,ref:i}=t,a=()=>{this.encode(t,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{r&&n.updateJoinPayload({access_token:r,version:this.headers&&this.headers["X-Client-Info"]}),n.joinedOnce&&n._isJoined()&&n._push($r.access_token,{access_token:r})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(vk,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:s,payload:i,ref:a}=r;n==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${a&&"("+a+")"||""}`,i),Array.from(this.channels).filter(o=>o._isMember(n)).forEach(o=>o._trigger(s,i,a)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger($r.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([kk],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class Ck{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Wi.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class uh extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function pt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class jk extends uh{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Xd extends uh{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var Ak=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(d){try{u(n.next(d))}catch(f){a(f)}}function c(d){try{u(n.throw(d))}catch(f){a(f)}}function u(d){d.done?i(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const Mv=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ho(async()=>{const{default:n}=await Promise.resolve().then(()=>fa);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Ok=()=>Ak(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ho(()=>Promise.resolve().then(()=>fa),void 0)).Response:Response}),Yd=e=>{if(Array.isArray(e))return e.map(r=>Yd(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=Yd(n)}),t};var ri=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(d){try{u(n.next(d))}catch(f){a(f)}}function c(d){try{u(n.throw(d))}catch(f){a(f)}}function u(d){d.done?i(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const b0=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Fk=(e,t,r)=>ri(void 0,void 0,void 0,function*(){const n=yield Ok();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{t(new jk(b0(s),e.status||500))}).catch(s=>{t(new Xd(b0(s),s))}):t(new Xd(b0(e),e))}),Pk=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),r))};function Vo(e,t,r,n,s,i){return ri(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,Pk(t,n,s,i)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>a(c)).catch(c=>Fk(c,o,n))})})}function Rc(e,t,r,n){return ri(this,void 0,void 0,function*(){return Vo(e,"GET",t,r,n)})}function Wn(e,t,r,n,s){return ri(this,void 0,void 0,function*(){return Vo(e,"POST",t,n,s,r)})}function Dk(e,t,r,n,s){return ri(this,void 0,void 0,function*(){return Vo(e,"PUT",t,n,s,r)})}function Rk(e,t,r,n){return ri(this,void 0,void 0,function*(){return Vo(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Bv(e,t,r,n,s){return ri(this,void 0,void 0,function*(){return Vo(e,"DELETE",t,n,s,r)})}var Qt=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(d){try{u(n.next(d))}catch(f){a(f)}}function c(d){try{u(n.throw(d))}catch(f){a(f)}}function u(d){d.done?i(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const Ik={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Dp={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Lk{constructor(t,r={},n,s){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Mv(s)}uploadOrUpdate(t,r,n,s){return Qt(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},Dp),s);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,c&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),f=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:t,body:i,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),h=yield f.json();return f.ok?{data:{path:u,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(i){if(pt(i))return{data:null,error:i};throw i}})}upload(t,r,n){return Qt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return Qt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:Dp.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const f=yield this.fetch(o.toString(),{method:"PUT",body:c,headers:d}),h=yield f.json();return f.ok?{data:{path:i,fullPath:h.Key},error:null}:{data:null,error:h}}catch(c){if(pt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Qt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield Wn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new uh("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:o},error:null}}catch(n){if(pt(n))return{data:null,error:n};throw n}})}update(t,r,n){return Qt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Qt(this,void 0,void 0,function*(){try{return{data:yield Wn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(pt(s))return{data:null,error:s};throw s}})}copy(t,r,n){return Qt(this,void 0,void 0,function*(){try{return{data:{path:(yield Wn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(pt(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return Qt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield Wn(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(s){if(pt(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return Qt(this,void 0,void 0,function*(){try{const s=yield Wn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(s){if(pt(s))return{data:null,error:s};throw s}})}download(t,r){return Qt(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield Rc(this.fetch,`${this.url}/${s}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(pt(o))return{data:null,error:o};throw o}})}info(t){return Qt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Rc(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Yd(n),error:null}}catch(n){if(pt(n))return{data:null,error:n};throw n}})}exists(t){return Qt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield Rk(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(pt(n)&&n instanceof Xd){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${u}`)}}}remove(t){return Qt(this,void 0,void 0,function*(){try{return{data:yield Bv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(pt(r))return{data:null,error:r};throw r}})}list(t,r,n){return Qt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Ik),r),{prefix:t||""});return{data:yield Wn(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(pt(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Mk="2.7.1",Bk={"X-Client-Info":`storage-js/${Mk}`};var fi=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(d){try{u(n.next(d))}catch(f){a(f)}}function c(d){try{u(n.throw(d))}catch(f){a(f)}}function u(d){d.done?i(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class $k{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},Bk),r),this.fetch=Mv(n)}listBuckets(){return fi(this,void 0,void 0,function*(){try{return{data:yield Rc(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(pt(t))return{data:null,error:t};throw t}})}getBucket(t){return fi(this,void 0,void 0,function*(){try{return{data:yield Rc(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(pt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return fi(this,void 0,void 0,function*(){try{return{data:yield Wn(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(pt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return fi(this,void 0,void 0,function*(){try{return{data:yield Dk(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(pt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return fi(this,void 0,void 0,function*(){try{return{data:yield Wn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(pt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return fi(this,void 0,void 0,function*(){try{return{data:yield Bv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(pt(r))return{data:null,error:r};throw r}})}}class Uk extends $k{constructor(t,r={},n){super(t,r,n)}from(t){return new Lk(this.url,this.headers,t,this.fetch)}}const Wk="2.50.0";let Ma="";typeof Deno<"u"?Ma="deno":typeof document<"u"?Ma="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ma="react-native":Ma="node";const Hk={"X-Client-Info":`supabase-js-${Ma}/${Wk}`},zk={headers:Hk},Vk={schema:"public"},Gk={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},qk={};var Kk=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(d){try{u(n.next(d))}catch(f){a(f)}}function c(d){try{u(n.throw(d))}catch(f){a(f)}}function u(d){d.done?i(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const Xk=e=>{let t;return e?t=e:typeof fetch>"u"?t=Sv:t=fetch,(...r)=>t(...r)},Yk=()=>typeof Headers>"u"?Tv:Headers,Jk=(e,t,r)=>{const n=Xk(r),s=Yk();return(i,a)=>Kk(void 0,void 0,void 0,function*(){var o;const c=(o=yield t())!==null&&o!==void 0?o:e;let u=new s(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(i,Object.assign(Object.assign({},a),{headers:u}))})};var Qk=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(d){try{u(n.next(d))}catch(f){a(f)}}function c(d){try{u(n.throw(d))}catch(f){a(f)}}function u(d){d.done?i(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};function Zk(e){return e.endsWith("/")?e:e+"/"}function e4(e,t){var r,n;const{db:s,auth:i,realtime:a,global:o}=e,{db:c,auth:u,realtime:d,global:f}=t,h={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},d),a),global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>Qk(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}const $v="2.70.0",wi=30*1e3,Jd=3,k0=Jd*wi,t4="http://localhost:9999",r4="supabase.auth.token",n4={"X-Client-Info":`gotrue-js/${$v}`},Qd="X-Supabase-Api-Version",Uv={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},s4=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,i4=6e5;class dh extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ne(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class a4 extends dh{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function o4(e){return Ne(e)&&e.name==="AuthApiError"}class Wv extends dh{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Es extends dh{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class Bn extends Es{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function l4(e){return Ne(e)&&e.name==="AuthSessionMissingError"}class _l extends Es{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class El extends Es{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Sl extends Es{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function c4(e){return Ne(e)&&e.name==="AuthImplicitGrantRedirectError"}class Rp extends Es{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Zd extends Es{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function N0(e){return Ne(e)&&e.name==="AuthRetryableFetchError"}class Ip extends Es{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Qa extends Es{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ic="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Lp=` 	
\r=`.split(""),u4=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Lp.length;t+=1)e[Lp[t].charCodeAt(0)]=-2;for(let t=0;t<Ic.length;t+=1)e[Ic[t].charCodeAt(0)]=t;return e})();function Mp(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ic[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ic[n]),t.queuedBits-=6}}function Hv(e,t,r){const n=u4[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Bp(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=a=>{h4(a,n,r)};for(let a=0;a<e.length;a+=1)Hv(e.charCodeAt(a),s,i);return t.join("")}function d4(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function f4(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}d4(n,t)}}function h4(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function m4(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)Hv(e.charCodeAt(s),r,n);return new Uint8Array(t)}function p4(e){const t=[];return f4(e,r=>t.push(r)),new Uint8Array(t)}function g4(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>Mp(s,r,n)),Mp(null,r,n),t.join("")}function x4(e){return Math.round(Date.now()/1e3)+e}function v4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Lr=()=>typeof window<"u"&&typeof document<"u",Ns={tested:!1,writable:!1},Za=()=>{if(!Lr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ns.tested)return Ns.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ns.tested=!0,Ns.writable=!0}catch{Ns.tested=!0,Ns.writable=!1}return Ns.writable};function y4(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const zv=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ho(async()=>{const{default:n}=await Promise.resolve().then(()=>fa);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},w4=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Vv=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Tl=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},bl=async(e,t)=>{await e.removeItem(t)};class Cu{constructor(){this.promise=new Cu.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Cu.promiseConstructor=Promise;function C0(e){const t=e.split(".");if(t.length!==3)throw new Qa("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!s4.test(t[n]))throw new Qa("JWT not in base64url format");return{header:JSON.parse(Bp(t[0])),payload:JSON.parse(Bp(t[1])),signature:m4(t[2]),raw:{header:t[0],payload:t[1]}}}async function _4(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function E4(e,t){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await e(i);if(!t(i,null,a)){n(a);return}}catch(a){if(!t(i,a)){s(a);return}}})()})}function S4(e){return("0"+e.toString(16)).substr(-2)}function T4(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,S4).join("")}async function b4(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function k4(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await b4(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function hi(e,t,r=!1){const n=T4();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await Vv(e,`${t}-code-verifier`,s);const i=await k4(n);return[i,n===i?"plain":"s256"]}const N4=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function C4(e){const t=e.headers.get(Qd);if(!t||!t.match(N4))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function j4(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function A4(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const O4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function mi(e){if(!O4.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var F4=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const Os=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),P4=[502,503,504];async function $p(e){var t;if(!w4(e))throw new Zd(Os(e),0);if(P4.includes(e.status))throw new Zd(Os(e),e.status);let r;try{r=await e.json()}catch(i){throw new Wv(Os(i),i)}let n;const s=C4(e);if(s&&s.getTime()>=Uv["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Ip(Os(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Bn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new Ip(Os(r),e.status,r.weak_password.reasons);throw new a4(Os(r),e.status||500,n)}const D4=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function je(e,t,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[Qd]||(i[Qd]=Uv["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const a=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await R4(e,t,r+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function R4(e,t,r,n,s,i){const a=D4(t,n,s,i);let o;try{o=await e(r,Object.assign({},a))}catch(c){throw console.error(c),new Zd(Os(c),0)}if(o.ok||await $p(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(c){await $p(c)}}function hn(e){var t;let r=null;B4(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=x4(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Up(e){const t=hn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function qn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function I4(e){return{data:e,error:null}}function L4(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,a=F4(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},c=Object.assign({},a);return{data:{properties:o,user:c},error:null}}function M4(e){return e}function B4(e){return e.access_token&&e.refresh_token&&e.expires_in}const j0=["global","local","others"];var $4=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class U4{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=zv(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=j0[0]){if(j0.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${j0.join(", ")}`);try{return await je(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ne(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await je(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:qn})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=$4(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await je(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:L4,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ne(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await je(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:qn})}catch(r){if(Ne(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,i,a,o,c;try{const u={nextPage:null,lastPage:0,total:0},d=await je(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:M4});if(d.error)throw d.error;const f=await d.json(),h=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(c=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);u[`${x}Page`]=m}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(Ne(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){mi(t);try{return await je(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:qn})}catch(r){if(Ne(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){mi(t);try{return await je(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:qn})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){mi(t);try{return await je(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:qn})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){mi(t.userId);try{const{data:r,error:n}=await je(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _deleteFactor(t){mi(t.userId),mi(t.id);try{return{data:await je(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}}const W4={getItem:e=>Za()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Za()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Za()&&globalThis.localStorage.removeItem(e)}};function Wp(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function H4(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const pi={debug:!!(globalThis&&Za()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Gv extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class z4 extends Gv{}async function V4(e,t,r){pi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),pi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){pi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{pi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw pi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new z4(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(pi.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}H4();const G4={url:t4,storageKey:r4,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:n4,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Hp(e,t,r){return await r()}class Co{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Co.nextInstanceID,Co.nextInstanceID+=1,this.instanceID>0&&Lr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},G4),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new U4({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=zv(s.fetch),this.lock=s.lock||Hp,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Lr()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=V4:this.lock=Hp,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Za()?this.storage=W4:(this.memoryStorage={},this.storage=Wp(this.memoryStorage)):(this.memoryStorage={},this.storage=Wp(this.memoryStorage)),Lr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${$v}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=y4(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Lr()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),c4(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ne(r)?{error:r}:{error:new Wv("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const i=await je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:hn}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(Ne(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,s;try{let i;if("email"in t){const{email:d,password:f,options:h}=t;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await hi(this.storage,this.storageKey)),i=await je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:g},xform:hn})}else if("phone"in t){const{phone:d,password:f,options:h}=t;i=await je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:hn})}else throw new El("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(Ne(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:a,options:o}=t;r=await je(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Up})}else if("phone"in t){const{phone:i,password:a,options:o}=t;r=await je(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Up})}else throw new El("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new _l}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Ne(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,s,i,a,o,c,u,d,f,h,p;let g,m;if("message"in t)g=t.message,m=t.signature;else{const{chain:x,wallet:w,statement:v,options:y}=t;let _;if(Lr())if(typeof w=="object")_=w;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))_=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=w}const C=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const E=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),v?{statement:v}:null));let T;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")T=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)T=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)g=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),m=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${C.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(s=(n=y==null?void 0:y.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=y==null?void 0:y.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((a=y==null?void 0:y.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((u=y==null?void 0:y.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((f=(d=y==null?void 0:y.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...y.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const E=await _.signMessage(new TextEncoder().encode(g),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=E}}try{const{data:x,error:w}=await je(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:g4(m)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:hn});if(w)throw w;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new _l}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:w})}catch(x){if(Ne(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(t){const r=await Tl(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:a}=await je(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:hn});if(await bl(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new _l}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(Ne(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:i,nonce:a}=t,o=await je(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:hn}),{data:c,error:u}=o;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new _l}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(Ne(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,i,a;try{if("email"in t){const{email:o,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await hi(this.storage,this.storageKey));const{error:f}=await je(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:o,options:c}=t,{data:u,error:d}=await je(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(a=c==null?void 0:c.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new El("You must provide either an email or phone number.")}catch(o){if(Ne(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await je(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:hn});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,u=a.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(Ne(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await hi(this.storage,this.storageKey)),await je(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:I4})}catch(i){if(Ne(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Bn;const{error:s}=await je(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(Ne(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:i}=t,{error:a}=await je(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){const{phone:n,type:s,options:i}=t,{data:a,error:o}=await je(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new El("You must provide either an email or phone number and a type")}catch(r){if(Ne(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Tl(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<k0:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let a=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,u,d)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:t},error:null}}const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await je(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:qn}):await this._useSession(async r=>{var n,s,i;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Bn}:await je(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:qn})})}catch(r){if(Ne(r))return l4(r)&&(await this._removeSession(),await bl(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new Bn;const a=s.session;let o=null,c=null;this.flowType==="pkce"&&t.email!=null&&([o,c]=await hi(this.storage,this.storageKey));const{data:u,error:d}=await je(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:c}),jwt:a.access_token,xform:qn});if(d)throw d;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Bn;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:a}=C0(t.access_token);if(a.exp&&(n=a.exp,s=n<=r),s){const{session:o,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Ne(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:o}=r;if(o)throw o;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Bn;const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Ne(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Lr())throw new Sl("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Sl(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Rp("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Sl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Rp("No code detected.");const{data:v,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:o,expires_at:c,token_type:u}=t;if(!i||!o||!a||!u)throw new Sl("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(o);let h=d+f;c&&(h=parseInt(c));const p=h-d;p*1e3<=wi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${f}s`);const g=h-f;d-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,d):d-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,d);const{data:m,error:x}=await this._getUser(i);if(x)throw x;const w={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:f,expires_at:h,refresh_token:a,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:t.type},error:null}}catch(n){if(Ne(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Tl(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const a=(n=s.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,t);if(o&&!(o4(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await bl(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=v4(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await hi(this.storage,this.storageKey,!0));try{return await je(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Ne(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var a,o,c,u,d;const{data:f,error:h}=i;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await je(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return Lr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Ne(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)throw a;return await je(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await E4(async s=>(s>0&&await _4(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await je(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:hn})),(s,i)=>{const a=200*Math.pow(2,s);return i&&N0(i)&&Date.now()+a-n<wi})}catch(n){if(this._debug(r,"error",n),Ne(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Lr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await Tl(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const s=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<k0;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${k0}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),N0(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Bn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Cu;const{data:i,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!i.session)throw new Bn;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),Ne(i)){const a={session:null,error:i};return N0(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(c){i.push(c)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Vv(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await bl(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Lr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),wi);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/wi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${wi}ms, refresh threshold is ${Jd} ticks`),s<=Jd&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Gv)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Lr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,a]=await hi(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await je(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:u}=await je(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:a,error:o}=await je(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await je(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:i}=t;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=C0(s.access_token);let o=null;a.aal&&(o=a.aal);let c=o;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const d=a.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(a=>a.kid===t);if(n||(n=this.jwks.keys.find(a=>a.kid===t),n&&this.jwks_cached_at+i4>Date.now()))return n;const{data:s,error:i}=await je(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new Qa("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(a=>a.kid===t),!n)throw new Qa("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:p,error:g}=await this.getSession();if(g||!p.session)return{data:null,error:g};n=p.session.access_token}const{header:s,payload:i,signature:a,raw:{header:o,payload:c}}=C0(n);if(j4(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:i,header:s,signature:a},error:null}}const u=A4(s.alg),d=await this.fetchJwk(s.kid,r),f=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,a,p4(`${o}.${c}`)))throw new Qa("Invalid JWT signature");return{data:{claims:i,header:s,signature:a},error:null}}catch(n){if(Ne(n))return{data:null,error:n};throw n}}}Co.nextInstanceID=0;const q4=Co;class K4 extends q4{constructor(t){super(t)}}var X4=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(d){try{u(n.next(d))}catch(f){a(f)}}function c(d){try{u(n.throw(d))}catch(f){a(f)}}function u(d){d.done?i(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class Y4{constructor(t,r,n){var s,i,a;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=Zk(t),c=new URL(o);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:Vk,realtime:qk,auth:Object.assign(Object.assign({},Gk),{storageKey:u}),global:zk},f=e4(n??{},d);this.storageKey=(s=f.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=f.global.headers)!==null&&i!==void 0?i:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=f.auth)!==null&&a!==void 0?a:{},this.headers,f.global.fetch),this.fetch=Jk(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new hk(new URL("rest/v1",c).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new Hb(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Uk(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return X4(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:i,flowType:a,lock:o,debug:c},u,d){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new K4({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),u),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,flowType:a,lock:o,debug:c,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Nk(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const J4=(e,t,r)=>new Y4(e,t,r),Q4="https://nyzdivpchfwywpsdgihw.supabase.co",Z4="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im55emRpdnBjaGZ3eXdwc2RnaWh3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkwNDAwNzYsImV4cCI6MjA2NDYxNjA3Nn0.Pb72YvgROvQ2jGCgyvVFIRzzadWYQuoxeuXX4MWAGA0",xe=J4(Q4,Z4),gi={emailService:{from:"noreply@company.com",fromName:"",replyTo:"support@company.com"},pushService:{vapidPublicKey:"",vapidPrivateKey:"",subject:"mailto:support@company.com"},appUrl:"http://localhost:5173"};class eN{async getUserPreferences(t){try{const{data:r,error:n}=await xe.from("notification_preferences").select("*").eq("user_id",t).single();return n?(console.error("Error fetching notification preferences:",n),null):this.mapPreferencesFromDb(r)}catch(r){return console.error("Error in getUserPreferences:",r),null}}async updateUserPreferences(t,r){try{const n=this.mapPreferencesToDb(r),{error:s}=await xe.from("notification_preferences").upsert({user_id:t,...n},{onConflict:"user_id"});return s?(console.error("Error updating notification preferences:",s),!1):!0}catch(n){return console.error("Error in updateUserPreferences:",n),!1}}async sendEmail(t){try{const{data:r,error:n}=await xe.functions.invoke("send-email",{body:{to:t.to,templateName:t.templateName,variables:t.variables,from:gi.emailService.from,fromName:gi.emailService.fromName,replyTo:gi.emailService.replyTo}});if(n)throw n;return t.userId&&await this.logNotification({userId:t.userId,type:"email",category:this.getNotificationCategory(t.templateName),subject:r.subject,content:r.bodyText,metadata:t.metadata||{},status:"sent",sentAt:new Date}),{success:!0,messageId:r.messageId}}catch(r){return console.error("Error sending email:",r),t.userId&&await this.logNotification({userId:t.userId,type:"email",category:this.getNotificationCategory(t.templateName),metadata:t.metadata||{},status:"failed",errorMessage:r instanceof Error?r.message:"Unknown error"}),{success:!1,error:r instanceof Error?r.message:"Failed to send email"}}}async sendPush(t){try{const r=await this.getUserPreferences(t.userId);if(!(r!=null&&r.pushEnabled)||!r.pushSubscription)return{success:!1,error:"Push notifications not enabled for user"};const{data:n,error:s}=await xe.functions.invoke("send-push",{body:{subscription:r.pushSubscription,notification:{title:t.title,body:t.body,icon:t.icon||"/icon-192x192.png",badge:t.badge||"/badge-72x72.png",tag:t.tag,data:t.data,requireInteraction:t.requireInteraction,actions:t.actions}}});if(s)throw s;return await this.logNotification({userId:t.userId,type:"push",category:this.getCategoryFromData(t.data),subject:t.title,content:t.body,metadata:t.data||{},status:"sent",sentAt:new Date}),{success:!0}}catch(r){return console.error("Error sending push notification:",r),await this.logNotification({userId:t.userId,type:"push",category:this.getCategoryFromData(t.data),subject:t.title,content:t.body,metadata:t.data||{},status:"failed",errorMessage:r instanceof Error?r.message:"Unknown error"}),{success:!1,error:r instanceof Error?r.message:"Failed to send push notification"}}}async subscribeToPush(t,r){try{const{error:n}=await xe.from("notification_preferences").update({push_subscription:r,push_enabled:!0}).eq("user_id",t);return n?(console.error("Error saving push subscription:",n),!1):!0}catch(n){return console.error("Error in subscribeToPush:",n),!1}}async unsubscribeFromPush(t){try{const{error:r}=await xe.from("notification_preferences").update({push_subscription:null,push_enabled:!1}).eq("user_id",t);return r?(console.error("Error removing push subscription:",r),!1):!0}catch(r){return console.error("Error in unsubscribeFromPush:",r),!1}}async notifyScheduleCreated(t){const r=await this.getUserPreferences(t.user.id);r&&(r.emailEnabled&&r.emailScheduleCreated&&await this.sendEmail({to:t.user.email,templateName:"schedule_created",variables:{userName:t.user.name,title:t.schedule.title,startTime:this.formatDateTime(t.schedule.startTime),endTime:this.formatDateTime(t.schedule.endTime),type:t.schedule.type,location:t.schedule.location||"",details:t.schedule.details||"",meetLink:t.schedule.meetLink||"",calendarLink:`${gi.appUrl}/calendar`},userId:t.user.id,metadata:{scheduleId:t.schedule.id}}),r.pushEnabled&&r.pushScheduleCreated&&await this.sendPush({userId:t.user.id,title:"",body:`${t.schedule.title} - ${this.formatDateTime(t.schedule.startTime)}`,tag:`schedule-${t.schedule.id}`,data:{type:"schedule_created",scheduleId:t.schedule.id},actions:[{action:"view",title:""},{action:"dismiss",title:""}]}))}async notifyScheduleUpdated(t){var n;const r=await this.getUserPreferences(t.user.id);r&&(r.emailEnabled&&r.emailScheduleUpdated&&await this.sendEmail({to:t.user.email,templateName:"schedule_updated",variables:{userName:t.user.name,title:t.schedule.title,startTime:this.formatDateTime(t.schedule.startTime),endTime:this.formatDateTime(t.schedule.endTime),type:t.schedule.type,location:t.schedule.location||"",details:t.schedule.details||"",meetLink:t.schedule.meetLink||"",changes:((n=t.changes)==null?void 0:n.join(`
`))||"",calendarLink:`${gi.appUrl}/calendar`},userId:t.user.id,metadata:{scheduleId:t.schedule.id}}),r.pushEnabled&&r.pushScheduleUpdated&&await this.sendPush({userId:t.user.id,title:"",body:`${t.schedule.title} - ${this.formatDateTime(t.schedule.startTime)}`,tag:`schedule-${t.schedule.id}`,data:{type:"schedule_updated",scheduleId:t.schedule.id}}))}async notifyScheduleDeleted(t){const r=await this.getUserPreferences(t.user.id);r&&(r.emailEnabled&&r.emailScheduleDeleted&&await this.sendEmail({to:t.user.email,templateName:"schedule_deleted",variables:{userName:t.user.name,title:t.schedule.title,startTime:this.formatDateTime(t.schedule.startTime),endTime:this.formatDateTime(t.schedule.endTime),type:t.schedule.type,deletedBy:t.deletedBy||"",reason:t.reason||""},userId:t.user.id,metadata:{scheduleId:t.schedule.id}}),r.pushEnabled&&r.pushScheduleDeleted&&await this.sendPush({userId:t.user.id,title:"",body:`${t.schedule.title} - ${this.formatDateTime(t.schedule.startTime)}`,tag:`schedule-${t.schedule.id}`,data:{type:"schedule_deleted",scheduleId:t.schedule.id}}))}async notifyScheduleReminder(t){const r=await this.getUserPreferences(t.user.id);r&&(r.emailEnabled&&r.emailScheduleReminder&&await this.sendEmail({to:t.user.email,templateName:"schedule_reminder",variables:{userName:t.user.name,title:t.schedule.title,startTime:this.formatDateTime(t.schedule.startTime),endTime:this.formatDateTime(t.schedule.endTime),type:t.schedule.type,location:t.schedule.location||"",details:t.schedule.details||"",meetLink:t.schedule.meetLink||"",participants:t.schedule.participants.join(", "),timeUntilEvent:t.timeUntilEvent||"15",calendarLink:`${gi.appUrl}/calendar`},userId:t.user.id,metadata:{scheduleId:t.schedule.id}}),r.pushEnabled&&r.pushScheduleReminder&&await this.sendPush({userId:t.user.id,title:`: ${t.schedule.title}`,body:`${t.timeUntilEvent}`,tag:`reminder-${t.schedule.id}`,data:{type:"schedule_reminder",scheduleId:t.schedule.id},requireInteraction:!0,actions:[{action:"view",title:""},{action:"join",title:""}]}))}async getUserNotificationLogs(t,r=50,n=0){try{const{data:s,error:i}=await xe.from("notification_logs").select("*").eq("user_id",t).order("created_at",{ascending:!1}).range(n,n+r-1);return i?(console.error("Error fetching notification logs:",i),[]):s.map(this.mapNotificationLogFromDb)}catch(s){return console.error("Error in getUserNotificationLogs:",s),[]}}async logNotification(t){try{const{error:r}=await xe.from("notification_logs").insert({user_id:t.userId,type:t.type,category:t.category,subject:t.subject,content:t.content,metadata:t.metadata,status:t.status,error_message:t.errorMessage,sent_at:t.sentAt});r&&console.error("Error logging notification:",r)}catch(r){console.error("Error in logNotification:",r)}}formatDateTime(t){return new Intl.DateTimeFormat("ja-JP",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Tokyo"}).format(t)}getNotificationCategory(t){return{schedule_created:"schedule_created",schedule_updated:"schedule_updated",schedule_deleted:"schedule_deleted",schedule_reminder:"schedule_reminder",leave_request_submitted:"leave_request_submitted",leave_request_approved:"leave_request_approved",leave_request_rejected:"leave_request_rejected"}[t]||"schedule_created"}getCategoryFromData(t){return t!=null&&t.type&&{schedule_created:"schedule_created",schedule_updated:"schedule_updated",schedule_deleted:"schedule_deleted",schedule_reminder:"schedule_reminder",leave_request:"leave_request_submitted",leave_approved:"leave_request_approved",leave_rejected:"leave_request_rejected"}[t.type]||"schedule_created"}mapPreferencesFromDb(t){return{id:t.id,userId:t.user_id,emailEnabled:t.email_enabled,emailScheduleCreated:t.email_schedule_created,emailScheduleUpdated:t.email_schedule_updated,emailScheduleDeleted:t.email_schedule_deleted,emailScheduleReminder:t.email_schedule_reminder,emailLeaveRequest:t.email_leave_request,emailLeaveApproval:t.email_leave_approval,pushEnabled:t.push_enabled,pushScheduleCreated:t.push_schedule_created,pushScheduleUpdated:t.push_schedule_updated,pushScheduleDeleted:t.push_schedule_deleted,pushScheduleReminder:t.push_schedule_reminder,pushLeaveRequest:t.push_leave_request,pushLeaveApproval:t.push_leave_approval,pushSubscription:t.push_subscription,defaultReminderTime:t.default_reminder_time,quietHoursEnabled:t.quiet_hours_enabled,quietHoursStart:t.quiet_hours_start,quietHoursEnd:t.quiet_hours_end,createdAt:new Date(t.created_at),updatedAt:new Date(t.updated_at)}}mapPreferencesToDb(t){const r={};return t.emailEnabled!==void 0&&(r.email_enabled=t.emailEnabled),t.emailScheduleCreated!==void 0&&(r.email_schedule_created=t.emailScheduleCreated),t.emailScheduleUpdated!==void 0&&(r.email_schedule_updated=t.emailScheduleUpdated),t.emailScheduleDeleted!==void 0&&(r.email_schedule_deleted=t.emailScheduleDeleted),t.emailScheduleReminder!==void 0&&(r.email_schedule_reminder=t.emailScheduleReminder),t.emailLeaveRequest!==void 0&&(r.email_leave_request=t.emailLeaveRequest),t.emailLeaveApproval!==void 0&&(r.email_leave_approval=t.emailLeaveApproval),t.pushEnabled!==void 0&&(r.push_enabled=t.pushEnabled),t.pushScheduleCreated!==void 0&&(r.push_schedule_created=t.pushScheduleCreated),t.pushScheduleUpdated!==void 0&&(r.push_schedule_updated=t.pushScheduleUpdated),t.pushScheduleDeleted!==void 0&&(r.push_schedule_deleted=t.pushScheduleDeleted),t.pushScheduleReminder!==void 0&&(r.push_schedule_reminder=t.pushScheduleReminder),t.pushLeaveRequest!==void 0&&(r.push_leave_request=t.pushLeaveRequest),t.pushLeaveApproval!==void 0&&(r.push_leave_approval=t.pushLeaveApproval),t.pushSubscription!==void 0&&(r.push_subscription=t.pushSubscription),t.defaultReminderTime!==void 0&&(r.default_reminder_time=t.defaultReminderTime),t.quietHoursEnabled!==void 0&&(r.quiet_hours_enabled=t.quietHoursEnabled),t.quietHoursStart!==void 0&&(r.quiet_hours_start=t.quietHoursStart),t.quietHoursEnd!==void 0&&(r.quiet_hours_end=t.quietHoursEnd),r}mapNotificationLogFromDb(t){return{id:t.id,userId:t.user_id,type:t.type,category:t.category,subject:t.subject,content:t.content,metadata:t.metadata,status:t.status,errorMessage:t.error_message,sentAt:t.sent_at?new Date(t.sent_at):void 0,createdAt:new Date(t.created_at)}}}const Kr=new eN,qv=b.createContext(void 0);function tN({children:e}){const[t,r]=b.useState(new Date),[n,s]=b.useState("week"),[i,a]=b.useState([]),[o,c]=b.useState(()=>{const E=localStorage.getItem("visibleUsers");return E?JSON.parse(E):[]}),u=b.useCallback(async()=>{try{const{data:E,error:T}=await xe.from("schedules").select("*").order("start_time");if(T)console.error("Failed to fetch schedules from Supabase:",T),console.warn("Using mock data for schedules"),a(kp);else if(E){const M=E.map(A=>({id:A.id,type:A.type,title:A.title,details:A.details||"",startTime:new Date(A.start_time),endTime:new Date(A.end_time),isAllDay:A.is_all_day,recurrence:A.recurrence,participants:A.participants||[],equipment:A.equipment||[],reminders:A.reminders||[],meetLink:A.meet_link,meetingType:A.meeting_type||"in-person",createdBy:A.created_by,createdAt:new Date(A.created_at),updatedBy:A.updated_by,updatedAt:A.updated_at?new Date(A.updated_at):null}));a(M)}}catch(E){console.error("Error fetching schedules:",E),console.warn("Using mock data for schedules"),a(kp)}},[]);b.useEffect(()=>{u()},[u]),b.useEffect(()=>{localStorage.setItem("visibleUsers",JSON.stringify(o))},[o]);const d=b.useCallback(()=>{r(E=>{switch(n){case"day":return Mt(E,1);case"week":return Mt(E,7);case"month":const T=new Date(E);return T.setMonth(T.getMonth()+1),T;default:return E}})},[n]),f=b.useCallback(()=>{r(E=>{switch(n){case"day":return bp(E,1);case"week":return bp(E,7);case"month":const T=new Date(E);return T.setMonth(T.getMonth()-1),T;default:return E}})},[n]),h=b.useCallback(()=>{r(new Date)},[]),p=b.useCallback(E=>{c(T=>T.includes(E)?T.filter(M=>M!==E):[...T,E])},[]),g=b.useCallback(E=>i.filter(T=>!!(zd(new Date(T.startTime),E)||zd(new Date(T.endTime),E)||new Date(T.startTime)<E&&new Date(T.endTime)>E)),[i]),m=b.useCallback((E,T)=>i.filter(M=>{const A=new Date(M.startTime),B=new Date(M.endTime);return Tp(A,{start:E,end:T})||Tp(B,{start:E,end:T})||A<=E&&B>=T}),[i]),x=b.useCallback((E,T,M,A)=>{const B=i.filter(z=>{if(!(E>=z.startTime&&E<z.endTime||T>z.startTime&&T<=z.endTime||E<=z.startTime&&T>=z.endTime))return!1;const V=M.some(ne=>z.participants.includes(ne)),pe=A.some(ne=>z.equipment.some(le=>le.id===ne.id&&le.type===ne.type));return V||pe});return{hasConflicts:B.length>0,conflicts:B}},[i]),w=b.useCallback(async E=>{if(g(E.startTime).length>=10)return we.error("110"),!1;const{hasConflicts:M,conflicts:A}=x(E.startTime,E.endTime,E.participants,E.equipment);if(M&&!window.confirm(`

`+A.map(z=>`${z.title} (${z.participants.length})`).join(`
`)))return!1;try{if(console.log("Schedule data before saving:",{type:E.type,title:E.title,startTime:E.startTime,endTime:E.endTime,participants:E.participants,createdBy:E.createdBy}),!E.type||!E.title||!E.startTime||!E.endTime)return console.error("Required fields missing:",{type:E.type,title:E.title,startTime:E.startTime,endTime:E.endTime}),we.error(""),!1;const{data:B,error:z}=await xe.from("schedules").insert([{type:E.type,title:E.title,details:E.details||null,start_time:E.startTime.toISOString(),end_time:E.endTime.toISOString(),is_all_day:E.isAllDay||!1,recurrence:E.recurrence||null,participants:E.participants||[],equipment:E.equipment||[],reminders:E.reminders||[],meet_link:E.meetLink||null,meeting_type:E.meetingType||"in-person",created_by:E.createdBy||null}]).select().single();if(z)return console.error("Supabase error details:",z),console.error("Error code:",z.code),console.error("Error message:",z.message),console.error("Error details:",z.details),we.error(`: ${z.message}`),!1;const U={id:B.id,type:B.type,title:B.title,details:B.details||"",startTime:new Date(B.start_time),endTime:new Date(B.end_time),isAllDay:B.is_all_day,recurrence:B.recurrence,participants:B.participants||[],equipment:B.equipment||[],reminders:B.reminders||[],meetLink:B.meet_link,meetingType:B.meeting_type||"in-person",createdBy:B.created_by,createdAt:new Date(B.created_at),updatedBy:B.updated_by,updatedAt:B.updated_at?new Date(B.updated_at):null};a(V=>[...V,U]),we.success("");try{const V=U.participants.map(async pe=>{const{data:ne}=await xe.from("users").select("id, name, email").eq("id",pe).single();ne&&await Kr.notifyScheduleCreated({schedule:{id:U.id,title:U.title,type:U.type,startTime:U.startTime,endTime:U.endTime,details:U.details,meetLink:U.meetLink,participants:U.participants,location:A0(U.equipment)},user:{id:ne.id,name:ne.name,email:ne.email}})});await Promise.all(V)}catch(V){console.error("Notification error:",V)}return!0}catch(B){return console.error("Error creating schedule:",B),we.error(""),!1}},[i,g,x]),v=b.useCallback(async E=>{try{const T=i.find(A=>A.id===E.id);if(!T)return;const{error:M}=await xe.from("schedules").update({type:E.type,title:E.title,details:E.details||null,start_time:E.startTime.toISOString(),end_time:E.endTime.toISOString(),is_all_day:E.isAllDay||!1,recurrence:E.recurrence||null,participants:E.participants||[],equipment:E.equipment||[],reminders:E.reminders||[],meet_link:E.meetLink||null,meeting_type:E.meetingType||"in-person",updated_by:E.updatedBy||null,updated_at:new Date().toISOString()}).eq("id",E.id);if(M){console.error("Error updating schedule:",M),we.error("");return}a(A=>A.map(B=>B.id===E.id?{...E,updatedAt:new Date}:B)),we.success("");try{const A=[];T.title!==E.title&&A.push(`: ${T.title}  ${E.title}`),(T.startTime.getTime()!==E.startTime.getTime()||T.endTime.getTime()!==E.endTime.getTime())&&A.push(""),T.meetLink!==E.meetLink&&A.push("");const B=new Set([...T.participants,...E.participants]),z=Array.from(B).map(async U=>{const{data:V}=await xe.from("users").select("id, name, email").eq("id",U).single();V&&await Kr.notifyScheduleUpdated({schedule:{id:E.id,title:E.title,type:E.type,startTime:E.startTime,endTime:E.endTime,details:E.details,meetLink:E.meetLink,participants:E.participants,location:A0(E.equipment)},user:{id:V.id,name:V.name,email:V.email},changes:A})});await Promise.all(z)}catch(A){console.error("Notification error:",A)}}catch(T){console.error("Error updating schedule:",T),we.error("")}},[i]),y=b.useCallback(async(E,T,M)=>{try{const A=i.find(z=>z.id===E);if(!A)return;const{error:B}=await xe.from("schedules").delete().eq("id",E);if(B){console.error("Error deleting schedule:",B),we.error("");return}a(z=>z.filter(U=>U.id!==E)),we.success("");try{const z=A.participants.map(async U=>{const{data:V}=await xe.from("users").select("id, name, email").eq("id",U).single();if(V){const{data:pe}=T?await xe.from("users").select("name").eq("id",T).single():{data:null};await Kr.notifyScheduleDeleted({schedule:{id:A.id,title:A.title,type:A.type,startTime:A.startTime,endTime:A.endTime,details:A.details,meetLink:A.meetLink,participants:A.participants,location:A0(A.equipment)},user:{id:V.id,name:V.name,email:V.email},deletedBy:pe==null?void 0:pe.name,reason:M})}});await Promise.all(z)}catch(z){console.error("Notification error:",z)}}catch(A){console.error("Error deleting schedule:",A),we.error("")}},[i]),_=b.useCallback(E=>i.filter(T=>T.participants.includes(E)||T.createdBy===E),[i]),C=b.useCallback((E,T)=>i.filter(M=>M.equipment.some(A=>A.id===E&&A.type===T)),[i]);return l.jsx(qv.Provider,{value:{currentDate:t,view:n,schedules:i,visibleUsers:o,setCurrentDate:r,setView:s,goToNextPeriod:d,goToPreviousPeriod:f,goToToday:h,toggleUserVisibility:p,addSchedule:w,updateSchedule:v,deleteSchedule:y,getSchedulesForDate:g,getSchedulesForDateRange:m,getSchedulesForUser:_,getSchedulesForEquipment:C,checkScheduleConflicts:x,refreshSchedules:u},children:e})}function A0(e){if(!e||e.length===0)return;const t=e.filter(r=>r.type==="room");if(t.length>0)return t.map(r=>r.name).join(", ")}function Go(){const e=b.useContext(qv);if(e===void 0)throw new Error("useCalendar must be used within a CalendarProvider");return e}const rN="";function qo(){return"Notification"in window&&"serviceWorker"in navigator&&"PushManager"in window}async function nN(){return qo()?await Notification.requestPermission():(console.warn("This browser does not support notifications"),"denied")}async function Kv(e){try{if(!qo())return console.warn("Push notifications not supported"),!1;if(await nN()!=="granted")return console.warn("Notification permission denied"),!1;const r=await navigator.serviceWorker.register("/sw.js");await navigator.serviceWorker.ready;let n=await r.pushManager.getSubscription();n||(n=await r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:iN(rN)}));const s=n.toJSON(),i=await Kr.subscribeToPush(e,s);return i&&(console.log("Push notification registered successfully"),await Xv("",{body:"",icon:"/icon-192x192.png",badge:"/badge-72x72.png"})),i}catch(t){return console.error("Error registering push notification:",t),!1}}async function sN(e){try{const r=await(await navigator.serviceWorker.ready).pushManager.getSubscription();return r&&await r.unsubscribe(),await Kr.unsubscribeFromPush(e)}catch(t){return console.error("Error unregistering push notification:",t),!1}}async function Xv(e,t){if(!qo()||await Notification.requestPermission()!=="granted")return;await(await navigator.serviceWorker.ready).showNotification(e,{...t,timestamp:Date.now()})}function iN(e){const t="=".repeat((4-e.length%4)%4),r=(e+t).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(r),s=new Uint8Array(n.length);for(let i=0;i<n.length;++i)s[i]=n.charCodeAt(i);return s}function aN(){qo()&&navigator.serviceWorker.addEventListener("message",e=>{var t;((t=e.data)==null?void 0:t.type)==="notification-click"&&oN(e.data)})}function oN(e){const{action:t,notificationData:r}=e;switch(r==null?void 0:r.type){case"schedule_created":case"schedule_updated":case"schedule_reminder":(t==="view"||t==="join")&&(window.location.href=`/calendar?scheduleId=${r.scheduleId}`);break;case"leave_request":window.location.href="/leave-requests";break;default:window.location.href="/dashboard"}}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var lN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cN=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Oe=(e,t)=>{const r=b.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:o="",children:c,...u},d)=>b.createElement("svg",{ref:d,...lN,width:s,height:s,stroke:n,strokeWidth:a?Number(i)*24/Number(s):i,className:["lucide",`lucide-${cN(e)}`,o].join(" "),...u},[...t.map(([f,h])=>b.createElement(f,h)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uN=Oe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ql=Oe("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dN=Oe("ArrowDownUp",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fN=Oe("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hN=Oe("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=Oe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=Oe("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mN=Oe("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=Oe("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=Oe("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pN=Oe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gN=Oe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xN=Oe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ju=Oe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=Oe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Au=Oe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=Oe("DoorOpen",[["path",{d:"M13 4h3a2 2 0 0 1 2 2v14",key:"hrm0s9"}],["path",{d:"M2 20h3",key:"1gaodv"}],["path",{d:"M13 20h9",key:"s90cdi"}],["path",{d:"M10 12v.01",key:"vx6srw"}],["path",{d:"M13 4.562v16.157a1 1 0 0 1-1.242.97L5 20V5.562a2 2 0 0 1 1.515-1.94l4-1A2 2 0 0 1 13 4.561Z",key:"199qr4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vN=Oe("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=Oe("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yN=Oe("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wN=Oe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fh=Oe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _N=Oe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EN=Oe("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=Oe("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=Oe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SN=Oe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TN=Oe("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bN=Oe("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kN=Oe("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=Oe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NN=Oe("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yv=Oe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=Oe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=Oe("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CN=Oe("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=Oe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function jN(){const[e,t]=b.useState([]),[r,n]=b.useState(!0),[s,i]=b.useState(""),a=Uo(),{switchUser:o}=Wt();b.useEffect(()=>{c()},[]);const c=async()=>{try{n(!0),console.log("DB");const{data:d,error:f}=await xe.from("users").select("*").order("name");if(f){console.error(":",f),i("");return}console.log(":",d);const h=(d==null?void 0:d.map(p=>({id:p.id,employeeId:p.employee_id,name:p.name,nameKana:p.name_kana,email:p.email,phone:p.phone,department:p.department,role:p.role,defaultWorkDays:p.default_work_days||[]})))||[];t(h),console.log(":",h)}catch(d){console.error("fetchUsers :",d),i("")}finally{n(!1)}},u=d=>{console.log(":",d);const f=e.find(h=>h.id===d);console.log(":",f),f?(console.log("switchUser"),o(f),console.log("navigate"),a("/")):console.error(":",d)};return l.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[l.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[l.jsx("div",{className:"flex justify-center",children:l.jsx(ra,{className:"h-12 w-12 text-blue-600"})}),l.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:""}),l.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"PC"})]}),l.jsxs("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:[l.jsx("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:r?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"..."})]}):s?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("p",{className:"text-red-600 mb-4",children:s}),l.jsx("button",{onClick:c,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:""})]}):l.jsx("div",{className:"space-y-3",children:e.map(d=>l.jsxs("button",{onClick:()=>u(d.id),className:"w-full flex items-center p-4 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all",children:[l.jsx("div",{className:"flex-shrink-0 h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 font-medium text-lg",children:d.name.charAt(0)})}),l.jsxs("div",{className:"ml-4 flex-1 text-left",children:[l.jsx("div",{className:"text-lg font-medium text-gray-900",children:d.name}),l.jsxs("div",{className:"text-sm text-gray-500",children:[d.department,"  ",d.role==="president"?"":d.role==="admin"?"":""]})]}),l.jsx(Yv,{className:"h-5 w-5 text-gray-400"})]},d.id))})}),l.jsx("div",{className:"mt-6 text-center",children:l.jsx("p",{className:"text-xs text-gray-500",children:"PC"})})]})]})}const AN={lessThanXSeconds:{one:"1",other:"{{count}}",oneWithSuffix:"1",otherWithSuffix:"{{count}}"},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1",other:"{{count}}",oneWithSuffix:"1",otherWithSuffix:"{{count}}"},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:"1",other:"{{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:"1",other:"{{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:"1",other:"{{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:"1",other:"{{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1",other:"{{count}}"},almostXYears:{one:"1",other:"{{count}}"}},ON=(e,t,r)=>{r=r||{};let n;const s=AN[e];return typeof s=="string"?n=s:t===1?r.addSuffix&&s.oneWithSuffix?n=s.oneWithSuffix:n=s.one:r.addSuffix&&s.otherWithSuffix?n=s.otherWithSuffix.replace("{{count}}",String(t)):n=s.other.replace("{{count}}",String(t)),r.addSuffix?r.comparison&&r.comparison>0?n+"":n+"":n},FN={full:"yMdEEEE",long:"yMd",medium:"y/MM/dd",short:"y/MM/dd"},PN={full:"Hmmss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},DN={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},RN={date:Ui({formats:FN,defaultWidth:"full"}),time:Ui({formats:PN,defaultWidth:"full"}),dateTime:Ui({formats:DN,defaultWidth:"full"})},IN={lastWeek:"eeeep",yesterday:"p",today:"p",tomorrow:"p",nextWeek:"eeeep",other:"P"},LN=(e,t,r,n)=>IN[e],MN={narrow:["BC","AC"],abbreviated:["",""],wide:["",""]},BN={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},$N={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},UN={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},WN={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},HN={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},zN=(e,t)=>{const r=Number(e);switch(String(t==null?void 0:t.unit)){case"year":return`${r}`;case"quarter":return`${r}`;case"month":return`${r}`;case"week":return`${r}`;case"date":return`${r}`;case"hour":return`${r}`;case"minute":return`${r}`;case"second":return`${r}`;default:return`${r}`}},VN={ordinalNumber:zN,era:nn({values:MN,defaultWidth:"wide"}),quarter:nn({values:BN,defaultWidth:"wide",argumentCallback:e=>Number(e)-1}),month:nn({values:$N,defaultWidth:"wide"}),day:nn({values:UN,defaultWidth:"wide"}),dayPeriod:nn({values:WN,defaultWidth:"wide",formattingValues:HN,defaultFormattingWidth:"wide"})},GN=/^?\d+(|||||||)?/i,qN=/\d+/i,KN={narrow:/^(B\.?C\.?|A\.?D\.?)/i,abbreviated:/^([]|)/i,wide:/^([]|)/i},XN={narrow:[/^B/i,/^A/i],any:[/^()/i,/^(|)/i]},YN={narrow:/^[1234]/i,abbreviated:/^Q[1234]/i,wide:/^[1234]/i},JN={any:[/(1||)/i,/(2||)/i,/(3||)/i,/(4||)/i]},QN={narrow:/^([123456789]|1[012])/,abbreviated:/^([123456789]|1[012])/i,wide:/^([123456789]|1[012])/i},ZN={any:[/^1\D/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},e3={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},t3={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},r3={any:/^(AM|PM|||||||)/i},n3={any:{am:/^(A|)/i,pm:/^(P|)/i,midnight:/^|/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},s3={ordinalNumber:wv({matchPattern:GN,parsePattern:qN,valueCallback:function(e){return parseInt(e,10)}}),era:sn({matchPatterns:KN,defaultMatchWidth:"wide",parsePatterns:XN,defaultParseWidth:"any"}),quarter:sn({matchPatterns:YN,defaultMatchWidth:"wide",parsePatterns:JN,defaultParseWidth:"any",valueCallback:e=>e+1}),month:sn({matchPatterns:QN,defaultMatchWidth:"wide",parsePatterns:ZN,defaultParseWidth:"any"}),day:sn({matchPatterns:e3,defaultMatchWidth:"wide",parsePatterns:t3,defaultParseWidth:"any"}),dayPeriod:sn({matchPatterns:r3,defaultMatchWidth:"any",parsePatterns:n3,defaultParseWidth:"any"})},Nr={code:"ja",formatDistance:ON,formatLong:RN,formatRelative:LN,localize:VN,match:s3,options:{weekStartsOn:0,firstWeekContainsDate:1}};function i3(){const e=Uo(),{currentUser:t}=Wt(),{getSchedulesForDate:r,refreshSchedules:n}=Go();Ct.useEffect(()=>{n()},[n]);const s=new Date,a=r(s).filter(c=>c.participants.includes((t==null?void 0:t.id)||"")||c.createdBy===(t==null?void 0:t.id)),o=[{name:"",description:"",icon:l.jsx(ra,{className:"h-8 w-8 text-white"}),href:"/calendar/my",color:"bg-blue-600"},{name:"",description:"",icon:l.jsx(na,{className:"h-8 w-8 text-white"}),href:"/calendar/vehicle",color:"bg-amber-600"},{name:"",description:"",icon:l.jsx(sa,{className:"h-8 w-8 text-white"}),href:"/calendar/room",color:"bg-emerald-600"},{name:"",description:"",icon:l.jsx(ta,{className:"h-8 w-8 text-white"}),href:"/calendar/sample",color:"bg-purple-600"},{name:"",description:"",icon:l.jsx(Au,{className:"h-8 w-8 text-white"}),href:"/leave",color:"bg-rose-600"}];return((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="president")&&o.push({name:"",description:"",icon:l.jsx(Hr,{className:"h-8 w-8 text-white"}),href:"/admin/users",color:"bg-indigo-600"}),l.jsxs("div",{children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:""}),l.jsx("p",{className:"mt-1 text-sm text-gray-500",children:be(s,"yyyyMdEEEE",{locale:Nr})})]}),l.jsx("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3",children:o.map(c=>l.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg cursor-pointer hover:shadow-md transition-shadow duration-200",onClick:()=>e(c.href),children:l.jsx("div",{className:"p-5",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:`flex-shrink-0 rounded-md p-3 ${c.color}`,children:c.icon}),l.jsxs("div",{className:"ml-5",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:c.name}),l.jsx("p",{className:"text-sm text-gray-500",children:c.description})]})]})})},c.name))}),l.jsxs("div",{className:"mt-8",children:[l.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:""}),l.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:a.length>0?l.jsx("ul",{className:"divide-y divide-gray-200",children:a.map(c=>l.jsx("li",{children:l.jsx("div",{className:"px-4 py-4 sm:px-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:`
                          flex-shrink-0 h-10 w-10 rounded-md flex items-center justify-center
                          ${c.type===""?"bg-blue-100 text-blue-600":c.type===""?"bg-purple-100 text-purple-600":c.type===""?"bg-amber-100 text-amber-600":c.type===""?"bg-emerald-100 text-emerald-600":"bg-gray-100 text-gray-600"}
                        `,children:l.jsx(ra,{className:"h-6 w-6"})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:c.title}),l.jsxs("div",{className:"text-sm text-gray-500",children:[be(c.startTime,"HH:mm")," - ",be(c.endTime,"HH:mm")]})]})]}),l.jsxs("div",{className:"flex items-center",children:[c.equipment.map(u=>l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 mr-2",children:u.type==="room"?"":u.type==="vehicle"?"":""},u.id)),l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:c.type})]})]})})},c.id))}):l.jsx("div",{className:"px-4 py-5 sm:px-6 text-center text-gray-500",children:""})})]})]})}function ef({selectedParticipants:e,onChange:t,showBusinessGroups:r=!0,showLeaveGroups:n=!1,readOnlyLeaveGroup:s=!1}){const{currentUser:i}=Wt(),[a,o]=b.useState([]),[c,u]=b.useState([]),[d,f]=b.useState(new Set),[h,p]=b.useState(!0);b.useEffect(()=>{g()},[]);const g=async()=>{try{const{data:E,error:T}=await xe.from("users").select("id, name, department, role").order("name");!T&&E&&o(E);const{data:M,error:A}=await xe.from("groups").select("*").order("type, name");if(!A&&M){let B=M;r||(B=B.filter(z=>z.type!=="business")),n||(B=B.filter(z=>z.type!=="leave")),r&&i&&(B=B.filter(z=>z.type!=="business"||z.members.includes(i.id))),u(B)}}catch(E){console.error("Error fetching data:",E)}finally{p(!1)}},m=E=>{const T=new Set(d);T.has(E)?T.delete(E):T.add(E),f(T)},x=E=>{const T=e.includes(E)?e.filter(M=>M!==E):[...e,E];t(T)},w=(E,T)=>{const M=E.members.filter(A=>a.find(B=>B.id===A));if(T){const A=[...new Set([...e,...M])];t(A)}else{const A=e.filter(B=>!M.includes(B));t(A)}},v=E=>{const T=E.members.filter(M=>a.find(A=>A.id===M));return T.length>0&&T.every(M=>e.includes(M))},y=E=>{switch(E){case"department":return"";case"business":return"";case"leave":return"";default:return""}},_=()=>a.filter(E=>e.includes(E.id));if(h)return l.jsx("div",{className:"text-center py-4",children:"..."});const C=c.reduce((E,T)=>(E[T.type]||(E[T.type]=[]),E[T.type].push(T),E),{});return l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:""}),l.jsx("div",{className:"border border-gray-200 rounded-lg max-h-80 overflow-y-auto",children:Object.entries(C).map(([E,T])=>l.jsxs("div",{className:"border-b border-gray-100 last:border-b-0",children:[l.jsx("div",{className:"bg-gray-50 px-3 py-2 text-xs font-medium text-gray-600 uppercase",children:y(E)}),T.map(M=>{const A=d.has(M.id),B=v(M),z=a.filter(V=>M.members.includes(V.id)),U=s&&M.type==="leave";return l.jsxs("div",{className:"border-b border-gray-100 last:border-b-0",children:[l.jsx("div",{className:"flex items-center px-3 py-2 hover:bg-gray-50",children:l.jsxs("button",{onClick:()=>m(M.id),className:"flex items-center flex-1 text-left",children:[A?l.jsx(xN,{className:"h-4 w-4 text-gray-400 mr-2"}):l.jsx(Ko,{className:"h-4 w-4 text-gray-400 mr-2"}),l.jsx("input",{type:"checkbox",checked:B,onChange:V=>w(M,V.target.checked),disabled:U,className:"mr-2 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 disabled:opacity-50"}),l.jsx("span",{className:"text-sm text-gray-900",children:M.name}),l.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",z.length,")"]})]})}),A&&l.jsxs("div",{className:"pl-8 pb-2",children:[l.jsx("div",{className:"mb-2",children:l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:B,onChange:V=>w(M,V.target.checked),disabled:U,className:"mr-2 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 disabled:opacity-50"}),l.jsx("span",{className:"text-sm text-gray-700 font-medium",children:""})]})}),l.jsx("div",{className:"space-y-1",children:z.map(V=>l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:e.includes(V.id),onChange:()=>x(V.id),disabled:U,className:"mr-2 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 disabled:opacity-50"}),l.jsx("span",{className:"text-sm text-gray-700",children:V.name}),l.jsxs("span",{className:"ml-1 text-xs text-gray-500",children:["(",V.department,")"]})]},V.id))})]})]},M.id)})]},E))})]}),l.jsxs("div",{children:[l.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:[" (",e.length,")"]}),l.jsx("div",{className:"border border-gray-200 rounded-lg p-3 max-h-80 overflow-y-auto",children:_().length===0?l.jsxs("div",{className:"text-center py-8 text-gray-500",children:[l.jsx(Hr,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),l.jsx("p",{className:"text-sm",children:""})]}):l.jsx("div",{className:"space-y-2",children:_().map(E=>l.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-900",children:E.name}),l.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",E.department,")"]})]}),l.jsx("button",{onClick:()=>x(E.id),className:"text-red-600 hover:text-red-800 text-xs",children:""})]},E.id))})})]})]})})}const zp={:{allowsMeetLink:!0,defaultType:"online",autoGenerateMeetLink:!0},"15":{allowsMeetLink:!0,defaultType:"online",autoGenerateMeetLink:!0},:{allowsMeetLink:!0,defaultType:"hybrid",autoGenerateMeetLink:!1},:{allowsMeetLink:!0,defaultType:"hybrid",autoGenerateMeetLink:!1},:{allowsMeetLink:!0,defaultType:"hybrid",autoGenerateMeetLink:!1},:{allowsMeetLink:!0,defaultType:"hybrid",autoGenerateMeetLink:!1},:{allowsMeetLink:!0,defaultType:"hybrid",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},"CAD":{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},"":{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!0,defaultType:"hybrid",autoGenerateMeetLink:!1}};function kl(e,t){return`https://meet.google.com/${a3(e,t)}`}function a3(e,t){const r=t.getTime(),n=o3(e),s=Math.random().toString(36).substring(2,5);return`${n.substring(0,3)}-${r.toString(36).substring(-4)}-${s}`}function o3(e){let t=0;for(let r=0;r<e.length;r++){const n=e.charCodeAt(r);t=(t<<5)-t+n,t=t&t}return Math.abs(t).toString(36)}function hh(e){return zp[e]||zp.}function O0(e){return hh(e).allowsMeetLink}function Vp(e){return hh(e).defaultType}function Gp(e){return hh(e).autoGenerateMeetLink}function Nl(e){return e?[/^https:\/\/meet\.google\.com\/[a-z0-9\-]{3,}$/i,/^https:\/\/meet\.google\.com\/[a-z]{3}-[a-z]{4}-[a-z]{3}$/i,/^https:\/\/meet\.google\.com\/lookup\/[a-z0-9]+$/i].some(r=>r.test(e)):!1}function l3(e){switch(e){case"in-person":return"";case"online":return"";case"hybrid":return"";default:return""}}function c3(e){switch(e){case"in-person":return"bg-gray-100 text-gray-800";case"online":return"bg-blue-100 text-blue-800";case"hybrid":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}}function Ou({isOpen:e,onClose:t,onSubmit:r,selectedDate:n,selectedEquipment:s,type:i,editingSchedule:a}){var ee,W,G,Z,Q,k,P,I,R,Y,ce,ge;const{currentUser:o}=Wt(),c=()=>{if(a)return{...a,startTime:new Date(a.startTime),endTime:new Date(a.endTime)};const H=Rb(Db(n||new Date,9),0),fe=jT(H,1),ie=i==="vehicle"?"":i==="room"?"":i==="sample"?"":"15",Se=Vp(ie);return{type:ie,title:"",details:"",startTime:H,endTime:fe,isAllDay:!1,participants:o?[o.id]:[],equipment:s?[{id:s.id,name:s.name,type:s.type}]:[],reminders:[{time:15,methods:["email"]}],recurrence:null,meetingType:Se,meetLink:Gp(ie)?kl("",H):""}},[u,d]=b.useState(c()),[f,h]=b.useState([]),[p,g]=b.useState([]),[m,x]=b.useState([]),[w,v]=b.useState(!1),[y,_]=b.useState(null),[C,E]=b.useState(null);b.useEffect(()=>{e&&(T(),a?(d(c()),M()):(_(null),E(null)))},[e,a]);const T=async()=>{try{const[L,H]=await Promise.all([xe.from("rooms").select("*").order("name"),xe.from("vehicles").select("*").order("name")]);L.data&&h(L.data),H.data&&g(H.data)}catch(L){console.error("Error loading equipment:",L)}},M=async()=>{if(a)try{const L=[a.createdBy,a.updatedBy].filter(Boolean);if(L.length===0)return;const{data:H,error:fe}=await xe.from("users").select("id, name, employee_id").in("id",L);if(fe){console.error("Error loading user info:",fe);return}const ie=H==null?void 0:H.find(Te=>Te.id===a.createdBy),Se=H==null?void 0:H.find(Te=>Te.id===a.updatedBy);_(ie||null),E(Se||null)}catch(L){console.error("Error loading user info:",L)}},B=(()=>{const L=[];for(let H=0;H<24;H++)for(let fe=0;fe<60;fe+=15){const ie=`${H.toString().padStart(2,"0")}:${fe.toString().padStart(2,"0")}`;L.push(ie)}return L})(),z=()=>{if(u.title&&u.startTime){const L=kl(u.title,u.startTime);d({...u,meetLink:L}),we.success("Google Meet ")}else we.error("")},U=L=>{const H={meetingType:L};L==="online"&&!u.meetLink&&u.title&&u.startTime&&(H.meetLink=kl(u.title,u.startTime)),L==="in-person"&&(H.meetLink=""),d({...u,...H})},V=L=>{const H=O0(L),fe=Vp(L),ie=Gp(L),Se={type:L,meetingType:fe};H?ie&&u.title&&u.startTime&&(Se.meetLink=kl(u.title,u.startTime)):(Se.meetLink="",Se.meetingType="in-person"),d({...u,...Se})},pe=async L=>{var fe,ie;if(!L.participants||L.participants.length===0)return[];const H=L.participants.filter(Se=>Se&&Se.trim()!=="");if(H.length===0)return[];try{let Se=xe.from("schedules").select("*").overlaps("participants",H).gte("end_time",(fe=L.startTime)==null?void 0:fe.toISOString()).lte("start_time",(ie=L.endTime)==null?void 0:ie.toISOString());a!=null&&a.id&&(Se=Se.neq("id",a.id));const{data:Te,error:He}=await Se;if(He)throw He;return Te||[]}catch(Se){return console.error("Error checking conflicts:",Se),[]}},ne=async L=>{var ie;L.preventDefault();const H=[];if((ie=u.title)!=null&&ie.trim()||H.push(""),u.type||H.push(""),!u.startTime||!u.endTime?H.push(""):u.startTime>=u.endTime&&H.push(""),(!u.participants||u.participants.length===0)&&H.push(""),i==="vehicle"?(!u.equipment||u.equipment.length===0)&&H.push(""):i==="room"?(!u.equipment||u.equipment.length===0)&&H.push(""):i==="sample"&&(u.assignedTo||H.push(""),(!u.quantity||u.quantity<1)&&H.push("")),H.length>0){we.error(H[0]);return}const fe=await pe(u);if(fe.length>0&&!w){x(fe),v(!0);return}console.log("Submitting form data:",u),r({...u,createdBy:o==null?void 0:o.id,updatedBy:o==null?void 0:o.id}),t(),v(!1)},le=()=>{r({...u,createdBy:o==null?void 0:o.id,updatedBy:o==null?void 0:o.id}),t(),v(!1)};return e?l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:i==="room"?"":i==="vehicle"?"":""}),l.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:l.jsx(Pn,{className:"h-6 w-6"})})]}),l.jsxs("form",{onSubmit:ne,className:"space-y-4",children:[i==="general"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:u.type||"",onChange:L=>V(L.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0,children:[l.jsx("option",{value:"15",children:"15"}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""})]})]}),i==="general"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:u.title||"",onChange:L=>d({...u,title:L.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),i==="general"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("textarea",{value:u.details||"",onChange:L=>d({...u,details:L.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),i==="general"&&O0(u.type||"")&&l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[l.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[l.jsx(Hn,{className:"h-4 w-4 mr-2"}),""]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",name:"meetingType",value:"in-person",checked:u.meetingType==="in-person",onChange:L=>U(L.target.value),className:"h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),l.jsxs("span",{className:"ml-2 text-sm text-gray-700 flex items-center",children:[l.jsx(Hr,{className:"h-4 w-4 mr-1"}),""]})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",name:"meetingType",value:"online",checked:u.meetingType==="online",onChange:L=>U(L.target.value),className:"h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),l.jsxs("span",{className:"ml-2 text-sm text-gray-700 flex items-center",children:[l.jsx(Hn,{className:"h-4 w-4 mr-1"}),""]})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",name:"meetingType",value:"hybrid",checked:u.meetingType==="hybrid",onChange:L=>U(L.target.value),className:"h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),l.jsxs("span",{className:"ml-2 text-sm text-gray-700 flex items-center",children:[l.jsx(Hn,{className:"h-4 w-4 mr-1"}),l.jsx(Hr,{className:"h-4 w-4 mr-1"}),""]})]})]})]}),(u.meetingType==="online"||u.meetingType==="hybrid")&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Google Meet "}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("input",{type:"url",value:u.meetLink||"",onChange:L=>d({...u,meetLink:L.target.value}),placeholder:"https://meet.google.com/...",className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),l.jsxs("button",{type:"button",onClick:z,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[l.jsx(Ba,{className:"h-4 w-4 mr-1"}),""]})]}),u.meetLink&&!Nl(u.meetLink)&&l.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Google Meet URL"}),u.meetLink&&Nl(u.meetLink)&&l.jsxs("div",{className:"mt-2 flex items-center",children:[l.jsx(Ba,{className:"h-4 w-4 text-green-600 mr-1"}),l.jsx("a",{href:u.meetLink,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-green-600 hover:text-green-800 underline",children:""})]})]})]}),i==="general"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:""}),l.jsx(ef,{selectedParticipants:u.participants||[],onChange:L=>d({...u,participants:L}),showBusinessGroups:!0,showLeaveGroups:!1})]}),(i==="general"||i==="room"||i==="vehicle")&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("div",{className:"mt-2 space-y-2",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600",children:""}),l.jsx("div",{className:"mt-1 space-y-1",children:f.map(L=>l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:(u.equipment||[]).some(H=>H.id===L.id&&H.type==="room"),onChange:H=>{const fe=u.equipment||[];H.target.checked?d({...u,equipment:[...fe,{id:L.id,name:L.name,type:"room"}]}):d({...u,equipment:fe.filter(ie=>!(ie.id===L.id&&ie.type==="room"))})},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-2 text-sm text-gray-700",children:L.name})]},L.id))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600",children:""}),l.jsx("div",{className:"mt-1 space-y-1",children:p.map(L=>l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:(u.equipment||[]).some(H=>H.id===L.id&&H.type==="vehicle"),onChange:H=>{const fe=u.equipment||[];H.target.checked?d({...u,equipment:[...fe,{id:L.id,name:L.name,type:"vehicle"}]}):d({...u,equipment:fe.filter(ie=>!(ie.id===L.id&&ie.type==="vehicle"))})},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-2 text-sm text-gray-700",children:L.name})]},L.id))})]})]})]}),i==="vehicle"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:u.type||"",onChange:L=>d({...u,type:L.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:u.title||"",onChange:L=>d({...u,title:L.target.value}),placeholder:": A",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("textarea",{value:u.details||"",onChange:L=>d({...u,details:L.target.value}),placeholder:": ",rows:2,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),i==="room"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:u.type||"",onChange:L=>d({...u,type:L.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:u.title||"",onChange:L=>d({...u,title:L.target.value}),placeholder:": ",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("textarea",{value:u.details||"",onChange:L=>d({...u,details:L.target.value}),placeholder:": ",rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:""}),l.jsx(ef,{selectedParticipants:u.participants||[],onChange:L=>d({...u,participants:L}),showBusinessGroups:!0,showLeaveGroups:!1})]}),O0(u.type||"")&&l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[l.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[l.jsx(Hn,{className:"h-4 w-4 mr-2"}),""]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",name:"meetingType",value:"in-person",checked:u.meetingType==="in-person",onChange:L=>U(L.target.value),className:"h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),l.jsxs("span",{className:"ml-2 text-sm text-gray-700 flex items-center",children:[l.jsx(Hr,{className:"h-4 w-4 mr-1"}),""]})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",name:"meetingType",value:"online",checked:u.meetingType==="online",onChange:L=>U(L.target.value),className:"h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),l.jsxs("span",{className:"ml-2 text-sm text-gray-700 flex items-center",children:[l.jsx(Hn,{className:"h-4 w-4 mr-1"}),""]})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",name:"meetingType",value:"hybrid",checked:u.meetingType==="hybrid",onChange:L=>U(L.target.value),className:"h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),l.jsxs("span",{className:"ml-2 text-sm text-gray-700 flex items-center",children:[l.jsx(Hn,{className:"h-4 w-4 mr-1"}),l.jsx(Hr,{className:"h-4 w-4 mr-1"}),""]})]})]})]}),(u.meetingType==="online"||u.meetingType==="hybrid")&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Google Meet "}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("input",{type:"url",value:u.meetLink||"",onChange:L=>d({...u,meetLink:L.target.value}),placeholder:"https://meet.google.com/...",className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),l.jsxs("button",{type:"button",onClick:z,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[l.jsx(Ba,{className:"h-4 w-4 mr-1"}),""]})]}),u.meetLink&&!Nl(u.meetLink)&&l.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Google Meet URL"}),u.meetLink&&Nl(u.meetLink)&&l.jsxs("div",{className:"mt-2 flex items-center",children:[l.jsx(Ba,{className:"h-4 w-4 text-green-600 mr-1"}),l.jsx("a",{href:u.meetLink,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-green-600 hover:text-green-800 underline",children:""})]})]})]})]}),i==="sample"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:u.type||"",onChange:L=>d({...u,type:L.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"CAD",children:"CAD"}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:u.title||"",onChange:L=>d({...u,title:L.target.value}),placeholder:": 22186",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:u.details||"",onChange:L=>d({...u,details:L.target.value}),placeholder:": Acka-424",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"number",min:"1",value:u.quantity||"1",onChange:L=>d({...u,quantity:parseInt(L.target.value)}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:u.assignedTo||"",onChange:L=>d({...u,assignedTo:L.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"",children:""}),Xs.map(L=>l.jsxs("option",{value:L.id,children:[L.name," (",L.department,")"]},L.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("textarea",{value:u.notes||"",onChange:L=>d({...u,notes:L.target.value}),placeholder:": ",rows:2,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"date",value:u.startTime?be(u.startTime,"yyyy-MM-dd"):"",onChange:L=>{const H=new Date(L.target.value),fe=u.startTime||new Date,ie=u.endTime||new Date,Se=new Date(H);Se.setHours(fe.getHours(),fe.getMinutes());const Te=new Date(H);Te.setHours(ie.getHours(),ie.getMinutes()),d({...u,startTime:Se,endTime:Te})},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("select",{value:u.startTime?be(u.startTime,"HH:mm"):"",onChange:L=>{const[H,fe]=L.target.value.split(":").map(Number),ie=new Date(u.startTime||new Date);ie.setHours(H,fe,0,0),d({...u,startTime:ie})},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0,children:B.map(L=>l.jsx("option",{value:L,children:L},L))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("select",{value:u.endTime?be(u.endTime,"HH:mm"):"",onChange:L=>{const[H,fe]=L.target.value.split(":").map(Number),ie=new Date(u.endTime||new Date);ie.setHours(H,fe,0,0),d({...u,endTime:ie})},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0,children:B.map(L=>l.jsx("option",{value:L,children:L},L))})]})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:u.isAllDay||!1,onChange:L=>d({...u,isAllDay:L.target.checked}),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("label",{className:"ml-2 text-sm text-gray-700",children:""})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("div",{children:l.jsxs("select",{value:((ee=u.recurrence)==null?void 0:ee.frequency)||"none",onChange:L=>{const H=L.target.value;d(H==="none"?{...u,recurrence:null}:{...u,recurrence:{frequency:H,interval:1,endType:"never",endDate:null,count:null,weekdays:[]}})},className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"none",children:""}),l.jsx("option",{value:"daily",children:""}),l.jsx("option",{value:"weekly",children:""}),l.jsx("option",{value:"monthly",children:""}),l.jsx("option",{value:"yearly",children:""}),l.jsx("option",{value:"weekdays",children:""}),l.jsx("option",{value:"custom",children:""})]})}),u.recurrence&&u.recurrence.frequency!=="none"&&u.recurrence.frequency!=="weekdays"&&l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600",children:""}),l.jsx("input",{type:"number",min:"1",max:"365",value:u.recurrence.interval||1,onChange:L=>d({...u,recurrence:{...u.recurrence,interval:parseInt(L.target.value)}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600",children:""}),l.jsxs("select",{value:u.recurrence.endType||"never",onChange:L=>d({...u,recurrence:{...u.recurrence,endType:L.target.value}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"never",children:""}),l.jsx("option",{value:"date",children:""}),l.jsx("option",{value:"count",children:""})]})]})]}),((W=u.recurrence)==null?void 0:W.endType)==="date"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600",children:""}),l.jsx("input",{type:"date",value:u.recurrence.endDate?be(new Date(u.recurrence.endDate),"yyyy-MM-dd"):"",onChange:L=>d({...u,recurrence:{...u.recurrence,endDate:new Date(L.target.value)}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),((G=u.recurrence)==null?void 0:G.endType)==="count"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600",children:""}),l.jsx("input",{type:"number",min:"1",max:"999",value:u.recurrence.count||"",onChange:L=>d({...u,recurrence:{...u.recurrence,count:parseInt(L.target.value)}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),((Z=u.recurrence)==null?void 0:Z.frequency)==="custom"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600 mb-2",children:""}),l.jsx("div",{className:"grid grid-cols-7 gap-1",children:["","","","","","",""].map((L,H)=>{var fe,ie;return l.jsxs("label",{className:"flex flex-col items-center",children:[l.jsx("input",{type:"checkbox",checked:((ie=(fe=u.recurrence)==null?void 0:fe.weekdays)==null?void 0:ie.includes(H))||!1,onChange:Se=>{var He;const Te=((He=u.recurrence)==null?void 0:He.weekdays)||[];Se.target.checked?d({...u,recurrence:{...u.recurrence,weekdays:[...Te,H]}}):d({...u,recurrence:{...u.recurrence,weekdays:Te.filter(Fe=>Fe!==H)}})},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"text-xs text-gray-600 mt-1",children:L})]},H)})})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsx("div",{className:"space-y-2",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("select",{value:((k=(Q=u.reminders)==null?void 0:Q[0])==null?void 0:k.time)||15,onChange:L=>{var fe,ie;const H=parseInt(L.target.value);d({...u,reminders:[{time:H,methods:((ie=(fe=u.reminders)==null?void 0:fe[0])==null?void 0:ie.methods)||["email"]}]})},className:"rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:5,children:"5"}),l.jsx("option",{value:10,children:"10"}),l.jsx("option",{value:15,children:"15"}),l.jsx("option",{value:30,children:"30"}),l.jsx("option",{value:60,children:"60"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:((R=(I=(P=u.reminders)==null?void 0:P[0])==null?void 0:I.methods)==null?void 0:R.includes("email"))||!1,onChange:L=>{var ie,Se,Te,He;const H=((Se=(ie=u.reminders)==null?void 0:ie[0])==null?void 0:Se.methods)||[],fe=L.target.checked?[...H.filter(Fe=>Fe!=="email"),"email"]:H.filter(Fe=>Fe!=="email");d({...u,reminders:[{time:((He=(Te=u.reminders)==null?void 0:Te[0])==null?void 0:He.time)||15,methods:fe}]})},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-1 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:((ge=(ce=(Y=u.reminders)==null?void 0:Y[0])==null?void 0:ce.methods)==null?void 0:ge.includes("notification"))||!1,onChange:L=>{var ie,Se,Te,He;const H=((Se=(ie=u.reminders)==null?void 0:ie[0])==null?void 0:Se.methods)||[],fe=L.target.checked?[...H.filter(Fe=>Fe!=="notification"),"notification"]:H.filter(Fe=>Fe!=="notification");d({...u,reminders:[{time:((He=(Te=u.reminders)==null?void 0:Te[0])==null?void 0:He.time)||15,methods:fe}]})},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-1 text-sm text-gray-700",children:""})]})]})]})})]}),a&&l.jsxs("div",{className:"border-t pt-4",children:[l.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:""}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[y&&l.jsxs("div",{className:"flex items-center justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:":"}),l.jsxs("span",{className:"text-gray-900",children:[y.name," (ID: ",y.employee_id,")",a.createdAt&&l.jsx("span",{className:"ml-2 text-gray-500",children:be(new Date(a.createdAt),"yyyy/MM/dd HH:mm")})]})]}),C&&a.updatedAt&&l.jsxs("div",{className:"flex items-center justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:":"}),l.jsxs("span",{className:"text-gray-900",children:[C.name," (ID: ",C.employee_id,")",l.jsx("span",{className:"ml-2 text-gray-500",children:be(new Date(a.updatedAt),"yyyy/MM/dd HH:mm")})]})]})]})]}),l.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[l.jsx("div",{children:a&&l.jsx("button",{type:"button",onClick:()=>{confirm("")&&(r({...u,_delete:!0}),t())},className:"px-4 py-2 border border-red-300 rounded-md shadow-sm text-sm font-medium text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:""})}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:""}),l.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:a?"":""})]})]})]}),w&&l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(Ql,{className:"h-6 w-6 text-yellow-600 mr-2"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("p",{className:"text-sm text-gray-600 mb-2",children:""}),l.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:m.map(L=>{const H=L.startTime||L.start_time,fe=L.endTime||L.end_time,ie=H?new Date(H):null,Se=fe?new Date(fe):null;return!ie||!Se||isNaN(ie.getTime())||isNaN(Se.getTime())?(console.error("Invalid date in conflicting schedule:",L),l.jsxs("div",{className:"p-2 bg-red-50 rounded border border-red-200",children:[l.jsx("div",{className:"font-medium text-red-800",children:L.title}),l.jsx("div",{className:"text-sm text-red-600",children:""})]},L.id)):l.jsxs("div",{className:"p-2 bg-red-50 rounded border border-red-200",children:[l.jsx("div",{className:"font-medium text-red-800",children:L.title}),l.jsxs("div",{className:"text-sm text-red-600",children:[be(ie,"MM/dd HH:mm")," - ",be(Se,"HH:mm")]})]},L.id)})})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx("button",{type:"button",onClick:()=>v(!1),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:""}),l.jsx("button",{type:"button",onClick:le,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700",children:""})]})]})})]})}):null}function u3(){const{currentUser:e}=Wt(),{currentDate:t,view:r,visibleUsers:n,setView:s,goToNextPeriod:i,goToPreviousPeriod:a,goToToday:o,toggleUserVisibility:c,getSchedulesForDateRange:u,addSchedule:d,updateSchedule:f,refreshSchedules:h}=Go(),[p,g]=b.useState(n.length>0?n:[]),[m,x]=b.useState([]),[w,v]=b.useState(!0),[y,_]=b.useState(!1),[C,E]=b.useState(null);b.useEffect(()=>{T()},[]);const T=async()=>{try{v(!0);const{data:W,error:G}=await xe.from("users").select("*").order("name_kana");if(G){console.error("Error fetching users:",G);const Z=[...Xs].sort((Q,k)=>(Q.nameKana||Q.name).localeCompare(k.nameKana||k.name,"ja"));x(Z)}else{const Z=(W==null?void 0:W.map(k=>({id:k.id,employeeId:k.employee_id,name:k.name,nameKana:k.name_kana,email:k.email,phone:k.phone,department:k.department,role:k.role,defaultWorkDays:k.default_work_days||[]})))||[],Q=Z.sort((k,P)=>(k.nameKana||k.name).localeCompare(P.nameKana||P.name,"ja"));if(x(Q),n.length===0){const k=Z.map(P=>P.id);g(k),k.forEach(P=>c(P))}}}catch(W){console.error("Error fetching users:",W),x(Xs)}finally{v(!1)}},A=(()=>{switch(r){case"day":return[t];case"week":const W=At(t,{weekStartsOn:1});return Array.from({length:7},(P,I)=>Mt(W,I));case"month":const G=wu(t),Z=vu(t),Q=At(G,{weekStartsOn:1}),k=Mt(At(Mt(Z,6),{weekStartsOn:1}),6);return yu({start:Q,end:k});default:return[]}})(),B=A.length>0?u(A[0],Mt(A[A.length-1],1)):[],z=W=>{g(G=>G.includes(W)?G.filter(Z=>Z!==W):[...G,W]),c(W)},U=()=>{if(p.length===m.length)g([]),m.forEach(W=>{n.includes(W.id)&&c(W.id)});else{const W=m.map(G=>G.id);g(W),W.forEach(G=>{n.includes(G)||c(G)})}},V=(W,G)=>B.filter(Z=>(Z.participants.includes(W)||Z.createdBy===W)&&new Date(Z.startTime).toDateString()===G.toDateString()),pe=(W,G)=>{const Z=new Date(W.startTime),Q=new Date(W.endTime);return G.some(k=>{if(k.id===W.id)return!1;const P=new Date(k.startTime),I=new Date(k.endTime);return W.participants.some(Y=>k.participants.includes(Y))?Z<I&&Q>P:!1})},ne=()=>r==="month"?le():ee(),le=()=>{const W=[];for(let G=0;G<A.length;G+=7)W.push(A.slice(G,G+7));return l.jsxs("div",{className:"bg-white",children:[l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200 bg-gray-50",children:["","","","","","",""].map((G,Z)=>l.jsx("div",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:G},Z))}),W.map((G,Z)=>l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:G.map((Q,k)=>{const P=_u(Q,t),I=p.flatMap(R=>V(R,Q));return l.jsxs("div",{className:`min-h-[120px] p-2 border-r border-gray-200 ${P?"bg-white":"bg-gray-50 text-gray-400"}`,children:[l.jsx("div",{className:`text-sm font-medium mb-1 ${fs(Q)?"bg-blue-100 text-blue-800 rounded-full w-6 h-6 flex items-center justify-center":""}`,children:be(Q,"d")}),l.jsxs("div",{className:"space-y-1",children:[I.slice(0,3).map(R=>{var ge,L;const Y=m.find(H=>R.participants.includes(H.id)||R.createdBy===H.id),ce=pe(R,B);return l.jsx("div",{onClick:()=>{E(R),_(!0)},className:`text-xs px-1 py-0.5 rounded truncate cursor-pointer hover:opacity-80
                            ${R.type===""?"bg-blue-100 text-blue-800":R.type===""?"bg-purple-100 text-purple-800":R.type===""?"bg-amber-100 text-amber-800":R.type===""?"bg-emerald-100 text-emerald-800":R.type===""?"bg-yellow-100 text-yellow-800":R.type===""||R.type==="CAD"||R.type===""||R.type===""||R.type===""||R.type===""||R.type===""?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,title:`${Y==null?void 0:Y.name}: ${R.title}${((ge=R.equipment)==null?void 0:ge.length)>0?` [${R.equipment.map(H=>H.name).join(", ")}]`:""}${R.meetLink?" (Google Meet)":""}${ce?"  ":""}`,children:l.jsxs("div",{className:"flex items-center space-x-1",children:[ce&&l.jsx(Ql,{className:"h-3 w-3 flex-shrink-0 text-red-600"}),R.meetLink&&l.jsx(Hn,{className:"h-3 w-3 flex-shrink-0"}),l.jsxs("span",{className:"truncate",children:[R.title,((L=R.equipment)==null?void 0:L.length)>0&&l.jsxs("span",{className:"text-xs opacity-75 ml-1",children:["[",R.equipment.map(H=>H.name).join(", "),"]"]})]})]})},R.id)}),I.length>3&&l.jsxs("div",{className:"text-xs text-gray-500",children:["+",I.length-3,""]}),I.length>=10&&l.jsxs("div",{className:"text-xs text-red-600 font-medium",children:[l.jsx(Ql,{className:"h-3 w-3 inline mr-1"}),""]})]})]},k)})},Z))]})},ee=()=>l.jsxs("div",{className:"bg-white",children:[l.jsx("div",{className:`grid ${r==="day"?"grid-cols-1":"grid-cols-7"} border-b border-gray-200 bg-gray-50`,children:A.map((W,G)=>l.jsx("div",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("span",{children:be(W,r==="day"?"yyyyMd EEEE":"EEEE",{locale:Nr})}),r!=="day"&&l.jsx("span",{className:`mt-1 text-sm ${fs(W)?"bg-blue-100 text-blue-800 rounded-full w-7 h-7 flex items-center justify-center":""}`,children:be(W,"d")})]})},G))}),l.jsx("div",{className:"divide-y divide-gray-200",children:p.map(W=>{const G=m.find(Z=>Z.id===W);return G?l.jsxs("div",{className:"divide-y divide-gray-200",children:[l.jsx("div",{className:"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:G.name}),l.jsx("div",{className:`grid ${r==="day"?"grid-cols-1":"grid-cols-7"} divide-x divide-gray-200`,children:A.map((Z,Q)=>{const k=V(W,Z);return l.jsx("div",{className:"min-h-[100px] px-2 py-2 text-sm text-gray-900",children:k.map(P=>{var R;const I=pe(P,B);return l.jsxs("div",{onClick:()=>{E(P),_(!0)},className:`mb-1 px-2 py-1 rounded text-xs cursor-pointer hover:opacity-80
                                ${P.type===""?"bg-blue-100 text-blue-800":P.type===""?"bg-purple-100 text-purple-800":P.type===""?"bg-amber-100 text-amber-800":P.type===""?"bg-emerald-100 text-emerald-800":P.type===""?"bg-yellow-100 text-yellow-800":P.type===""||P.type==="CAD"||P.type===""||P.type===""||P.type===""||P.type===""||P.type===""?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:[l.jsxs("div",{className:"font-medium flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-1",children:[I&&l.jsx(Ql,{className:"h-3 w-3 flex-shrink-0 text-red-600"}),l.jsxs("span",{children:[be(P.startTime,"HH:mm"),"-",be(P.endTime,"HH:mm")]})]}),P.meetLink&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Hn,{className:"h-3 w-3"}),P.meetingType&&l.jsx("span",{className:`px-1 py-0.5 rounded text-xs ${c3(P.meetingType)}`,children:l3(P.meetingType)})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("span",{className:"truncate",children:[P.title,((R=P.equipment)==null?void 0:R.length)>0&&l.jsxs("span",{className:"text-xs opacity-75 ml-1",children:["[",P.equipment.map(Y=>Y.name).join(", "),"]"]})]}),P.meetLink&&l.jsx("a",{href:P.meetLink,target:"_blank",rel:"noopener noreferrer",onClick:Y=>Y.stopPropagation(),className:"ml-1 text-blue-600 hover:text-blue-800",title:"Google Meet",children:l.jsx(Ba,{className:"h-3 w-3"})})]})]},P.id)})},Q)})})]},W):null})})]});return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{E(null),_(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[l.jsx(hs,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsxs("div",{className:"bg-white shadow rounded-lg",children:[l.jsx("div",{className:"px-4 py-5 border-b border-gray-200 sm:px-6",children:l.jsxs("div",{className:"flex items-center justify-between flex-wrap sm:flex-nowrap",children:[l.jsx("div",{children:l.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:be(t,"yyyyM",{locale:Nr})})}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("div",{className:"inline-flex shadow-sm rounded-md",children:[l.jsx("button",{type:"button",onClick:()=>s("day"),className:`relative inline-flex items-center px-4 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium ${r==="day"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>s("week"),className:`relative inline-flex items-center px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium ${r==="week"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>s("month"),className:`relative inline-flex items-center px-4 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium ${r==="month"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""})]}),l.jsxs("div",{className:"inline-flex rounded-md shadow-sm",children:[l.jsxs("button",{type:"button",onClick:a,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx(ju,{className:"h-5 w-5"})]}),l.jsx("button",{type:"button",onClick:o,className:"relative inline-flex items-center px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",children:""}),l.jsxs("button",{type:"button",onClick:i,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx(Ko,{className:"h-5 w-5"})]})]})]})]})}),l.jsxs("div",{className:"flex flex-1",children:[l.jsxs("div",{className:"w-60 border-r border-gray-200 bg-gray-50 p-4",children:[l.jsxs("div",{className:"flex items-center mb-3",children:[l.jsx("input",{id:"select-all",name:"select-all",type:"checkbox",className:"h-4 w-4 text-blue-600 border-gray-300 rounded",checked:p.length===m.length&&m.length>0,onChange:U}),l.jsx("label",{htmlFor:"select-all",className:"ml-2 block text-sm text-gray-900 font-semibold",children:""})]}),l.jsx("div",{className:"space-y-2 max-h-[calc(100vh-250px)] overflow-auto",children:w?l.jsx("div",{className:"text-center py-4",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"})}):m.map(W=>l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{id:`user-${W.id}`,name:`user-${W.id}`,type:"checkbox",className:"h-4 w-4 text-blue-600 border-gray-300 rounded",checked:p.includes(W.id),onChange:()=>z(W.id)}),l.jsxs("label",{htmlFor:`user-${W.id}`,className:"ml-2 block text-sm text-gray-700",children:[W.name,l.jsxs("span",{className:"ml-1 text-xs text-gray-500",children:["(",W.department,")"]})]})]},W.id))})]}),l.jsx("div",{className:"flex-1 overflow-auto",children:ne()})]})]}),l.jsx(Ou,{isOpen:y,onClose:()=>{_(!1),E(null)},onSubmit:async W=>{try{if(console.log("MyCalendar onSubmit called with:",W),console.log("Current user:",e),console.log("Editing schedule:",C),W._delete&&C)try{const{error:G}=await xe.from("schedules").delete().eq("id",C.id);if(G)throw G;await h();return}catch(G){console.error("Error deleting schedule:",G),alert("");return}if(C){const G={...C,...W,id:C.id,createdAt:C.createdAt,createdBy:C.createdBy,updatedBy:e==null?void 0:e.id,updatedAt:new Date};console.log("Updating schedule:",G),f(G)}else{const G={...W,createdBy:e==null?void 0:e.id};console.log("Creating schedule:",G);const Z=await d(G);if(console.log("addSchedule result:",Z),!Z){console.error("addSchedule returned false");return}}}catch(G){console.error("Error saving schedule - Full error object:",G),console.error("Error message:",G==null?void 0:G.message),console.error("Error stack:",G==null?void 0:G.stack),alert(`: ${(G==null?void 0:G.message)||"Unknown error"}`)}},selectedDate:t,type:"general",editingSchedule:C})]})}function d3(){const{currentDate:e,view:t,setView:r,goToNextPeriod:n,goToPreviousPeriod:s,goToToday:i,getSchedulesForEquipment:a,addSchedule:o,refreshSchedules:c}=Go(),[u,d]=b.useState(!1),[f,h]=b.useState(null),[p,g]=b.useState(null),[m,x]=b.useState([]),[w,v]=b.useState([]);b.useEffect(()=>{y(),_()},[]);const y=async()=>{try{const{data:ee,error:W}=await xe.from("vehicles").select("*").order("name");if(W)console.error("Error fetching vehicles:",W),x(Ac);else{const G=(ee==null?void 0:ee.map(Z=>({id:Z.id,name:Z.name,licensePlate:Z.license_plate,type:Z.type,createdBy:Z.created_by})))||[];x(G)}}catch(ee){console.error("Error fetching vehicles:",ee),x(Ac)}},_=async()=>{try{const{data:ee,error:W}=await xe.from("users").select("id, name, employee_id").order("name");W?console.error("Error fetching users:",W):v(ee||[])}catch(ee){console.error("Error fetching users:",ee)}},E=(()=>{switch(t){case"day":return[e];case"week":const ee=At(e,{weekStartsOn:1});return Array.from({length:7},(k,P)=>Mt(ee,P));case"month":const W=wu(e),G=vu(e),Z=At(W,{weekStartsOn:1}),Q=Mt(At(Mt(G,6),{weekStartsOn:1}),6);return yu({start:Z,end:Q});default:return[]}})(),[T,M]=b.useState([]);b.useEffect(()=>{A()},[e,t]);const A=async()=>{try{if(E.length===0)return;const ee=be(E[0],"yyyy-MM-dd"),W=be(E[E.length-1],"yyyy-MM-dd"),{data:G,error:Z}=await xe.from("schedules").select("*").gte("start_time",`${ee}T00:00:00.000Z`).lte("start_time",`${W}T23:59:59.999Z`).order("start_time");Z?console.error("Error fetching vehicle schedules:",Z):M(G||[])}catch(ee){console.error("Error fetching vehicle schedules:",ee)}},B=(ee,W)=>T.filter(G=>{var Q;return new Date(G.start_time).toDateString()===W.toDateString()&&((Q=G.equipment)==null?void 0:Q.some(k=>k.id===ee&&k.type==="vehicle"))}).map(G=>({...G,startTime:new Date(G.start_time),endTime:new Date(G.end_time)})),z=ee=>!ee||ee.length===0?"":ee.map(G=>{var Z;return(Z=w.find(Q=>Q.id===G))==null?void 0:Z.name}).filter(Boolean).join(", "),U=(ee,W)=>{h({id:ee.id,type:"vehicle"}),g(W),d(!0)},V=async ee=>{var W,G;try{const{error:Z}=await xe.from("schedules").insert([{type:ee.type,title:ee.title,details:ee.details,start_time:(W=ee.startTime)==null?void 0:W.toISOString(),end_time:(G=ee.endTime)==null?void 0:G.toISOString(),is_all_day:ee.isAllDay,participants:ee.participants,equipment:ee.equipment,reminders:ee.reminders,meet_link:ee.meetLink,meeting_type:ee.meetingType,created_by:ee.createdBy}]);if(Z)throw Z;await c(),await A()}catch(Z){console.error("Error saving vehicle reservation:",Z),alert("")}},pe=()=>t==="month"?le():ne(),ne=()=>l.jsx("div",{className:"overflow-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-48",children:""}),E.map((ee,W)=>l.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("span",{children:be(ee,t==="day"?"yyyyMd EEEE":"EEEE",{locale:Nr})}),t!=="day"&&l.jsx("span",{className:`mt-1 text-sm ${fs(ee)?"bg-blue-100 text-blue-800 rounded-full w-7 h-7 flex items-center justify-center":""}`,children:be(ee,"d")})]})},W))]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(ee=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-amber-100 flex items-center justify-center",children:l.jsx(na,{className:"h-6 w-6 text-amber-600"})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:ee.name}),l.jsx("div",{className:"text-xs text-gray-500",children:ee.licensePlate})]})]})}),E.map((W,G)=>{const Z=B(ee.id,W);return l.jsxs("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-500 relative group border border-gray-100",children:[l.jsx("button",{onClick:()=>U(ee,W),className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200 bg-amber-100 rounded-full p-1",children:l.jsx(hs,{className:"h-4 w-4 text-amber-600"})}),l.jsx("div",{className:t==="day"?"min-h-[120px]":"min-h-[80px]",children:Z.map(Q=>l.jsxs("div",{className:"mb-1 px-2 py-1 rounded text-xs bg-amber-100 text-amber-800 border-l-4 border-amber-500 cursor-pointer hover:bg-amber-200",onClick:()=>{},children:[l.jsxs("div",{className:"font-medium",children:[be(Q.startTime,"HH:mm"),"-",be(Q.endTime,"HH:mm")]}),l.jsx("div",{className:"truncate",children:Q.title}),l.jsx("div",{className:"text-xs text-amber-600",children:z(Q.participants||[])}),Q.details&&l.jsx("div",{className:"text-xs text-amber-500 truncate",children:Q.details})]},Q.id))})]},G)})]},ee.id))})]})}),le=()=>{const ee=[];for(let W=0;W<E.length;W+=7)ee.push(E.slice(W,W+7));return l.jsxs("div",{className:"overflow-auto",children:[l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200 bg-gray-50",children:["","","","","","",""].map((W,G)=>l.jsx("div",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:W},G))}),ee.map((W,G)=>l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:W.map((Z,Q)=>{const k=_u(Z,e),P=m.flatMap(I=>B(I.id,Z));return l.jsxs("div",{className:`min-h-[120px] p-2 border-r border-gray-200 ${k?"bg-white":"bg-gray-50 text-gray-400"}`,children:[l.jsx("div",{className:`text-sm font-medium mb-1 ${fs(Z)?"bg-blue-100 text-blue-800 rounded-full w-6 h-6 flex items-center justify-center":""}`,children:be(Z,"d")}),l.jsxs("div",{className:"space-y-1",children:[P.slice(0,3).map(I=>{const R=m.find(Y=>{var ce;return(ce=I.equipment)==null?void 0:ce.some(ge=>ge.id===Y.id&&ge.type==="vehicle")});return l.jsxs("div",{onClick:()=>{},className:"text-xs px-1 py-0.5 rounded truncate cursor-pointer hover:opacity-80 bg-amber-100 text-amber-800",title:`${R==null?void 0:R.name}: ${I.title} [${z(I.participants||[])}]`,children:[l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(na,{className:"h-3 w-3 flex-shrink-0"}),l.jsx("span",{className:"truncate",children:I.title})]}),l.jsx("div",{className:"text-xs text-amber-600 truncate mt-1",children:z(I.participants||[])})]},I.id)}),P.length>3&&l.jsxs("div",{className:"text-xs text-gray-500",children:["+",P.length-3,""]})]})]},Q)})},G))]})};return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{h(null),g(null),d(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-amber-600 hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500",children:[l.jsx(hs,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsxs("div",{className:"bg-white shadow rounded-lg",children:[l.jsx("div",{className:"px-4 py-5 border-b border-gray-200 sm:px-6",children:l.jsxs("div",{className:"flex items-center justify-between flex-wrap sm:flex-nowrap",children:[l.jsx("div",{children:l.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:be(e,"yyyyM",{locale:Nr})})}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("div",{className:"inline-flex shadow-sm rounded-md",children:[l.jsx("button",{type:"button",onClick:()=>r("day"),className:`relative inline-flex items-center px-4 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium ${t==="day"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>r("week"),className:`relative inline-flex items-center px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium ${t==="week"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>r("month"),className:`relative inline-flex items-center px-4 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium ${t==="month"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""})]}),l.jsxs("div",{className:"inline-flex rounded-md shadow-sm",children:[l.jsxs("button",{type:"button",onClick:s,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx(ju,{className:"h-5 w-5"})]}),l.jsx("button",{type:"button",onClick:i,className:"relative inline-flex items-center px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",children:""}),l.jsxs("button",{type:"button",onClick:n,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx(Ko,{className:"h-5 w-5"})]})]})]})]})}),pe()]}),l.jsx(Ou,{isOpen:u,onClose:()=>d(!1),onSubmit:V,selectedDate:p||void 0,selectedEquipment:f||void 0,type:"vehicle"})]})}function f3(){const{currentDate:e,view:t,setView:r,goToNextPeriod:n,goToPreviousPeriod:s,goToToday:i,getSchedulesForEquipment:a,addSchedule:o}=Go(),[c,u]=b.useState(!1),[d,f]=b.useState(null),[h,p]=b.useState(null),[g,m]=b.useState([]),[x,w]=b.useState([]);b.useEffect(()=>{v(),y()},[]);const v=async()=>{try{const{data:le,error:ee}=await xe.from("rooms").select("*").order("name");ee?(console.error("Error fetching rooms:",ee),m(jc)):m(le||[])}catch(le){console.error("Error fetching rooms:",le),m(jc)}},y=async()=>{try{const{data:le,error:ee}=await xe.from("users").select("id, name, employee_id").order("name");ee?console.error("Error fetching users:",ee):w(le||[])}catch(le){console.error("Error fetching users:",le)}},C=(()=>{switch(t){case"day":return[e];case"week":const le=At(e,{weekStartsOn:1});return Array.from({length:7},(Q,k)=>Mt(le,k));case"month":const ee=wu(e),W=vu(e),G=At(ee,{weekStartsOn:1}),Z=Mt(At(Mt(W,6),{weekStartsOn:1}),6);return yu({start:G,end:Z});default:return[]}})(),[E,T]=b.useState([]);b.useEffect(()=>{M()},[e,t]);const M=async()=>{try{if(C.length===0)return;const le=be(C[0],"yyyy-MM-dd"),ee=be(C[C.length-1],"yyyy-MM-dd"),{data:W,error:G}=await xe.from("schedules").select("*").gte("start_time",`${le}T00:00:00.000Z`).lte("start_time",`${ee}T23:59:59.999Z`).order("start_time");G?console.error("Error fetching room schedules:",G):T(W||[])}catch(le){console.error("Error fetching room schedules:",le)}},A=(le,ee)=>E.filter(W=>{var Z;return new Date(W.start_time).toDateString()===ee.toDateString()&&((Z=W.equipment)==null?void 0:Z.some(Q=>Q.id===le&&Q.type==="room"))}).map(W=>({...W,startTime:new Date(W.start_time),endTime:new Date(W.end_time)})),B=le=>!le||le.length===0?"":le.map(W=>{var G;return(G=x.find(Z=>Z.id===W))==null?void 0:G.name}).filter(Boolean).join(", "),z=(le,ee)=>{f({id:le.id,type:"room"}),p(ee),u(!0)},U=async le=>{var ee,W;try{const{error:G}=await xe.from("schedules").insert([{type:le.type,title:le.title,details:le.details,start_time:(ee=le.startTime)==null?void 0:ee.toISOString(),end_time:(W=le.endTime)==null?void 0:W.toISOString(),is_all_day:le.isAllDay,participants:le.participants,equipment:le.equipment,reminders:le.reminders,meet_link:le.meetLink,meeting_type:le.meetingType,created_by:le.createdBy}]);if(G)throw G;await M()}catch(G){console.error("Error saving room reservation:",G),alert("")}},V=()=>t==="month"?ne():pe(),pe=()=>l.jsx("div",{className:"overflow-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-48",children:""}),C.map((le,ee)=>l.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("span",{children:be(le,t==="day"?"yyyyMd EEEE":"EEEE",{locale:Nr})}),t!=="day"&&l.jsx("span",{className:`mt-1 text-sm ${fs(le)?"bg-blue-100 text-blue-800 rounded-full w-7 h-7 flex items-center justify-center":""}`,children:be(le,"d")})]})},ee))]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(le=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-emerald-100 flex items-center justify-center",children:l.jsx(sa,{className:"h-6 w-6 text-emerald-600"})}),l.jsx("div",{className:"ml-4",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:le.name})})]})}),C.map((ee,W)=>{const G=A(le.id,ee);return l.jsxs("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-500 relative group border border-gray-100",children:[l.jsx("button",{onClick:()=>z(le,ee),className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200 bg-emerald-100 rounded-full p-1",children:l.jsx(hs,{className:"h-4 w-4 text-emerald-600"})}),l.jsx("div",{className:t==="day"?"min-h-[120px]":"min-h-[80px]",children:G.map(Z=>l.jsxs("div",{className:"mb-1 px-2 py-1 rounded text-xs bg-emerald-100 text-emerald-800 border-l-4 border-emerald-500 cursor-pointer hover:bg-emerald-200",onClick:()=>{},children:[l.jsxs("div",{className:"font-medium",children:[be(Z.startTime,"HH:mm"),"-",be(Z.endTime,"HH:mm")]}),l.jsx("div",{className:"truncate",children:Z.title}),l.jsx("div",{className:"text-xs text-emerald-600",children:B(Z.participants||[])}),Z.details&&l.jsx("div",{className:"text-xs text-emerald-500 truncate",children:Z.details})]},Z.id))})]},W)})]},le.id))})]})}),ne=()=>{const le=[];for(let ee=0;ee<C.length;ee+=7)le.push(C.slice(ee,ee+7));return l.jsxs("div",{className:"overflow-auto",children:[l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200 bg-gray-50",children:["","","","","","",""].map((ee,W)=>l.jsx("div",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:ee},W))}),le.map((ee,W)=>l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:ee.map((G,Z)=>{const Q=_u(G,e),k=g.flatMap(P=>A(P.id,G));return l.jsxs("div",{className:`min-h-[120px] p-2 border-r border-gray-200 ${Q?"bg-white":"bg-gray-50 text-gray-400"}`,children:[l.jsx("div",{className:`text-sm font-medium mb-1 ${fs(G)?"bg-blue-100 text-blue-800 rounded-full w-6 h-6 flex items-center justify-center":""}`,children:be(G,"d")}),l.jsxs("div",{className:"space-y-1",children:[k.slice(0,3).map(P=>{const I=g.find(R=>{var Y;return(Y=P.equipment)==null?void 0:Y.some(ce=>ce.id===R.id&&ce.type==="room")});return l.jsxs("div",{onClick:()=>{},className:"text-xs px-1 py-0.5 rounded truncate cursor-pointer hover:opacity-80 bg-emerald-100 text-emerald-800",title:`${I==null?void 0:I.name}: ${P.title} [${B(P.participants||[])}]`,children:[l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(sa,{className:"h-3 w-3 flex-shrink-0"}),l.jsx("span",{className:"truncate",children:P.title})]}),l.jsx("div",{className:"text-xs text-emerald-600 truncate mt-1",children:B(P.participants||[])})]},P.id)}),k.length>3&&l.jsxs("div",{className:"text-xs text-gray-500",children:["+",k.length-3,""]})]})]},Z)})},W))]})};return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{f(null),p(null),u(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500",children:[l.jsx(hs,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsxs("div",{className:"bg-white shadow rounded-lg",children:[l.jsx("div",{className:"px-4 py-5 border-b border-gray-200 sm:px-6",children:l.jsxs("div",{className:"flex items-center justify-between flex-wrap sm:flex-nowrap",children:[l.jsx("div",{children:l.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:be(e,"yyyyM",{locale:Nr})})}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("div",{className:"inline-flex shadow-sm rounded-md",children:[l.jsx("button",{type:"button",onClick:()=>r("day"),className:`relative inline-flex items-center px-4 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium ${t==="day"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>r("week"),className:`relative inline-flex items-center px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium ${t==="week"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>r("month"),className:`relative inline-flex items-center px-4 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium ${t==="month"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""})]}),l.jsxs("div",{className:"inline-flex rounded-md shadow-sm",children:[l.jsxs("button",{type:"button",onClick:s,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx(ju,{className:"h-5 w-5"})]}),l.jsx("button",{type:"button",onClick:i,className:"relative inline-flex items-center px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",children:""}),l.jsxs("button",{type:"button",onClick:n,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx(Ko,{className:"h-5 w-5"})]})]})]})]})}),V()]}),l.jsx(Ou,{isOpen:c,onClose:()=>u(!1),onSubmit:U,selectedDate:h||void 0,selectedEquipment:d||void 0,type:"room"})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Lc={};Lc.version="0.18.5";var Jv=1252,h3=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Qv=function(e){h3.indexOf(e)!=-1&&(Jv=e)};function m3(){Qv(1252)}var jo=function(e){Qv(e)};function p3(){jo(1200),m3()}var Cl=function(t){return String.fromCharCode(t)},qp=function(t){return String.fromCharCode(t)},Ps,Jn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ao(e){for(var t="",r=0,n=0,s=0,i=0,a=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),a=(r&3)<<4|n>>4,s=e.charCodeAt(u++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=Jn.charAt(i)+Jn.charAt(a)+Jn.charAt(o)+Jn.charAt(c);return t}function Cn(e){var t="",r=0,n=0,s=0,i=0,a=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=Jn.indexOf(e.charAt(u++)),a=Jn.indexOf(e.charAt(u++)),r=i<<2|a>>4,t+=String.fromCharCode(r),o=Jn.indexOf(e.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=Jn.indexOf(e.charAt(u++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Re=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Dn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ys(e){return Re?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Kp(e){return Re?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Wr=function(t){return Re?Dn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Fu(e){if(typeof ArrayBuffer>"u")return Wr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Xo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function g3(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var kt=Re?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Dn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function x3(e){for(var t=[],r=0,n=e.length+250,s=Ys(e.length+255),i=0;i<e.length;++i){var a=e.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Ys(65535),n=65530)}return t.push(s.slice(0,r)),kt(t)}var ro=/\u0000/g,jl=/[\u0001-\u0006]/g;function Hi(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function zr(e,t){var r=""+e;return r.length>=t?r:nt("0",t-r.length)+r}function mh(e,t){var r=""+e;return r.length>=t?r:nt(" ",t-r.length)+r}function Mc(e,t){var r=""+e;return r.length>=t?r:r+nt(" ",t-r.length)}function v3(e,t){var r=""+Math.round(e);return r.length>=t?r:nt("0",t-r.length)+r}function y3(e,t){var r=""+e;return r.length>=t?r:nt("0",t-r.length)+r}var Xp=Math.pow(2,32);function xi(e,t){if(e>Xp||e<-Xp)return v3(e,t);var r=Math.round(e);return y3(r,t)}function Bc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Yp=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],F0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function w3(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var it={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Jp={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},_3={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function $c(e,t,r){for(var n=e<0?-1:1,s=e*n,i=0,a=1,o=0,c=1,u=0,d=0,f=Math.floor(s);u<t&&(f=Math.floor(s),o=f*a+i,d=f*u+c,!(s-f<5e-8));)s=1/(s-f),i=a,a=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=i):(d=u,o=a)),!r)return[0,n*o,d];var h=Math.floor(n*o/d);return[h,n*o-h*d,d]}function Al(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),i=0,a=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=C3(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var Zv=new Date(1899,11,31,0,0,0),E3=Zv.getTime(),S3=new Date(1900,2,1,0,0,0);function ey(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=S3&&(r+=24*60*60*1e3),(r-(E3+(e.getTimezoneOffset()-Zv.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ph(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function T3(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function b3(e){var t=e<0?12:11,r=ph(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function k3(e){var t=ph(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function N3(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=b3(e):t===10?r=e.toFixed(10).substr(0,12):r=k3(e),ph(T3(r.toUpperCase()))}function tf(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):N3(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ms(14,ey(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function C3(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function j3(e,t,r,n){var s="",i=0,a=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return F0[r.m-1][1];case 5:return F0[r.m-1][0];default:return F0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return Yp[r.q][0];default:return Yp[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?zr(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),t==="s"?i===0?"0":""+i/a:(s=zr(i,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?zr(c,u):"";return d}function Qn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var ty=/%/g;function A3(e,t,r){var n=t.replace(ty,""),s=t.length-n.length;return wn(e,n,r*Math.pow(10,2*s))+nt("%",s)}function O3(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return wn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function ry(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ry(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var ny=/# (\?+)( ?)\/( ?)(\d+)/;function F3(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?nt(" ",e[1].length+1+e[4].length):mh(a,e[1].length)+e[2]+"/"+e[3]+zr(o,e[4].length))}function P3(e,t,r){return r+(t===0?"":""+t)+nt(" ",e[1].length+2+e[4].length)}var sy=/^#*0*\.([0#]+)/,iy=/\).*[0#]/,ay=/\(###\) ###\\?-####/;function Vt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Qp(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Zp(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function D3(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function R3(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Er(e,t,r){if(e.charCodeAt(0)===40&&!t.match(iy)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Er("n",n,r):"("+Er("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return O3(e,t,r);if(t.indexOf("%")!==-1)return A3(e,t,r);if(t.indexOf("E")!==-1)return ry(t,r);if(t.charCodeAt(0)===36)return"$"+Er(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,a,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+xi(c,t.length);if(t.match(/^[#?]+$/))return s=xi(r,0),s==="0"&&(s=""),s.length>t.length?s:Vt(t.substr(0,t.length-s.length))+s;if(i=t.match(ny))return F3(i,c,u);if(t.match(/^#+0+$/))return u+xi(c,t.length-t.indexOf("0"));if(i=t.match(sy))return s=Qp(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Vt(i[1])).replace(/\.$/,"."+Vt(i[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+nt("0",Vt(i[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+Qp(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Qn(xi(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Er(e,t,-r):Qn(""+(Math.floor(r)+D3(r,i[1].length)))+"."+zr(Zp(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Er(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Hi(Er(e,t.replace(/[\\-]/g,""),r)),a=0,Hi(Hi(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<s.length?s.charAt(a++):g==="0"?"0":""}));if(t.match(ay))return s=Er(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=$c(c,Math.pow(10,a)-1,!1),s=""+u,d=wn("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=Mc(o[2],a),d.length<i[4].length&&(d=Vt(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=$c(c,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?mh(o[1],a)+i[2]+"/"+i[3]+Mc(o[2],a):nt(" ",2*a+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=xi(r,0),t.length<=s.length?s:Vt(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var f=t.indexOf(".")-a,h=t.length-s.length-f;return Vt(t.substr(0,f)+s+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return a=Zp(r,i[1].length),r<0?"-"+Er(e,t,-r):Qn(R3(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?zr(0,3-g.length):"")+g})+"."+zr(a,i[1].length);switch(t){case"###,##0.00":return Er(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Qn(xi(c,0));return p!=="0"?u+p:"";case"###,###.00":return Er(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Er(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function I3(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return wn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function L3(e,t,r){var n=t.replace(ty,""),s=t.length-n.length;return wn(e,n,r*Math.pow(10,2*s))+nt("%",s)}function oy(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+oy(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Zr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(iy)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Zr("n",n,r):"("+Zr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return I3(e,t,r);if(t.indexOf("%")!==-1)return L3(e,t,r);if(t.indexOf("E")!==-1)return oy(t,r);if(t.charCodeAt(0)===36)return"$"+Zr(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,a,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+zr(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Vt(t.substr(0,t.length-s.length))+s;if(i=t.match(ny))return P3(i,c,u);if(t.match(/^#+0+$/))return u+zr(c,t.length-t.indexOf("0"));if(i=t.match(sy))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Vt(i[1])).replace(/\.$/,"."+Vt(i[1])),s=s.replace(/\.(\d*)$/,function(g,m){return"."+m+nt("0",Vt(i[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Qn(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Zr(e,t,-r):Qn(""+r)+"."+nt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Zr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Hi(Zr(e,t.replace(/[\\-]/g,""),r)),a=0,Hi(Hi(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<s.length?s.charAt(a++):g==="0"?"0":""}));if(t.match(ay))return s=Zr(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=$c(c,Math.pow(10,a)-1,!1),s=""+u,d=wn("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=Mc(o[2],a),d.length<i[4].length&&(d=Vt(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=$c(c,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?mh(o[1],a)+i[2]+"/"+i[3]+Mc(o[2],a):nt(" ",2*a+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Vt(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var f=t.indexOf(".")-a,h=t.length-s.length-f;return Vt(t.substr(0,f)+s+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Zr(e,t,-r):Qn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?zr(0,3-g.length):"")+g})+"."+zr(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Qn(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return Zr(e,t.slice(0,t.lastIndexOf(".")),r)+Vt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function wn(e,t,r){return(r|0)===r?Zr(e,t,r):Er(e,t,r)}function M3(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var ly=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function cy(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Bc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(ly))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function B3(e,t,r,n){for(var s=[],i="",a=0,o="",c="t",u,d,f,h="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!Bc(e,a))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(f=e.charCodeAt(++a))!==34&&a<e.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++a;break;case"\\":var p=e.charAt(++a),g=p==="("||p===")"?p:"t";s[s.length]={t:g,v:p},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(u==null&&(u=Al(t,r,e.charAt(a+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Al(t,r),u==null))return"";for(i=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var m={t:o,v:o};if(u==null&&(u=Al(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",h="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",a+=5,h="h"):e.substr(a,5).toUpperCase()==="/"?(u!=null&&(m.v=u.H>=12?"":""),m.t="T",a+=5,h="h"):(m.t="t",++a),u==null&&m.t==="T")return"";s[s.length]=m,c=o;break;case"[":for(i=o;e.charAt(a++)!=="]"&&a<e.length;)i+=e.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(ly)){if(u==null&&(u=Al(t,r),u==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",cy(e)||(s[s.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++a<e.length&&(o=e.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},c=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)i+=e.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++a;break}var x=0,w=0,v;for(a=s.length-1,c="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=h,c="h",x<1&&(x=1);break;case"s":(v=s[a].v.match(/\.0+$/))&&(w=Math.max(w,v[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=s[a].t;break;case"m":c==="s"&&(s[a].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&s[a].v.match(/[Hh]/)&&(x=1),x<2&&s[a].v.match(/[Mm]/)&&(x=2),x<3&&s[a].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",_;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=j3(s[a].t.charCodeAt(0),s[a].v,u,w),s[a].t="t";break;case"n":case"?":for(_=a+1;s[_]!=null&&((o=s[_].t)==="?"||o==="D"||(o===" "||o==="t")&&s[_+1]!=null&&(s[_+1].t==="?"||s[_+1].t==="t"&&s[_+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[_].v==="/"||s[_].v===" "&&s[_+1]!=null&&s[_+1].t=="?"));)s[a].v+=s[_].v,s[_]={v:"",t:";"},++_;y+=s[a].v,a=_-1;break;case"G":s[a].t="t",s[a].v=tf(t,r);break}var C="",E,T;if(y.length>0){y.charCodeAt(0)==40?(E=t<0&&y.charCodeAt(0)===45?-t:t,T=wn("n",y,E)):(E=t<0&&n>1?-t:t,T=wn("n",y,E),E<0&&s[0]&&s[0].t=="t"&&(T=T.substr(1),s[0].v="-"+s[0].v)),_=T.length-1;var M=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){M=a;break}var A=s.length;if(M===s.length&&T.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(_>=s[a].v.length-1?(_-=s[a].v.length,s[a].v=T.substr(_+1,s[a].v.length)):_<0?s[a].v="":(s[a].v=T.substr(0,_+1),_=-1),s[a].t="t",A=a);_>=0&&A<s.length&&(s[A].v=T.substr(0,_+1)+s[A].v)}else if(M!==s.length&&T.indexOf("E")===-1){for(_=T.indexOf(".")-1,a=M;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(d=s[a].v.indexOf(".")>-1&&a===M?s[a].v.indexOf(".")-1:s[a].v.length-1,C=s[a].v.substr(d+1);d>=0;--d)_>=0&&(s[a].v.charAt(d)==="0"||s[a].v.charAt(d)==="#")&&(C=T.charAt(_--)+C);s[a].v=C,s[a].t="t",A=a}for(_>=0&&A<s.length&&(s[A].v=T.substr(0,_+1)+s[A].v),_=T.indexOf(".")+1,a=M;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==M)){for(d=s[a].v.indexOf(".")>-1&&a===M?s[a].v.indexOf(".")+1:0,C=s[a].v.substr(0,d);d<s[a].v.length;++d)_<T.length&&(C+=T.charAt(_++));s[a].v=C,s[a].t="t",A=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(E=n>1&&t<0&&a>0&&s[a-1].v==="-"?-t:t,s[a].v=wn(s[a].t,s[a].v,E),s[a].t="t");var B="";for(a=0;a!==s.length;++a)s[a]!=null&&(B+=s[a].v);return B}var eg=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function tg(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function $3(e,t){var r=M3(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(eg),o=r[1].match(eg);return tg(t,a)?[n,r[0]]:tg(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function ms(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:it)[e],n==null&&(n=r.table&&r.table[Jp[e]]||it[Jp[e]]),n==null&&(n=_3[e]||"General");break}if(Bc(n,0))return tf(t,r);t instanceof Date&&(t=ey(t,r.date1904));var s=$3(n,t);if(Bc(s[1]))return tf(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return B3(s[1],t,r,s[0])}function uy(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(it[r]==null){t<0&&(t=r);continue}if(it[r]==e){t=r;break}}t<0&&(t=391)}return it[t]=e,t}function Pu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&uy(e[t],t)}function Du(){it=w3()}var dy=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function U3(e){var t=typeof e=="number"?it[e]:e;return t=t.replace(dy,"(\\d+)"),new RegExp("^"+t+"$")}function W3(e,t,r){var n=-1,s=-1,i=-1,a=-1,o=-1,c=-1;(t.match(dy)||[]).forEach(function(f,h){var p=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":i=p;break;case"h":a=p;break;case"s":c=p;break;case"m":a>=0?o=p:s=p;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?u:n==-1&&s==-1&&i==-1?d:u+"T"+d}var H3=function(){var e={};e.version="1.2.0";function t(){for(var T=0,M=new Array(256),A=0;A!=256;++A)T=A,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,M[A]=T;return typeof Int32Array<"u"?new Int32Array(M):M}var r=t();function n(T){var M=0,A=0,B=0,z=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)z[B]=T[B];for(B=0;B!=256;++B)for(A=T[B],M=256+B;M<4096;M+=256)A=z[M]=A>>>8^T[A&255];var U=[];for(B=1;B!=16;++B)U[B-1]=typeof Int32Array<"u"?z.subarray(B*256,B*256+256):z.slice(B*256,B*256+256);return U}var s=n(r),i=s[0],a=s[1],o=s[2],c=s[3],u=s[4],d=s[5],f=s[6],h=s[7],p=s[8],g=s[9],m=s[10],x=s[11],w=s[12],v=s[13],y=s[14];function _(T,M){for(var A=M^-1,B=0,z=T.length;B<z;)A=A>>>8^r[(A^T.charCodeAt(B++))&255];return~A}function C(T,M){for(var A=M^-1,B=T.length-15,z=0;z<B;)A=y[T[z++]^A&255]^v[T[z++]^A>>8&255]^w[T[z++]^A>>16&255]^x[T[z++]^A>>>24]^m[T[z++]]^g[T[z++]]^p[T[z++]]^h[T[z++]]^f[T[z++]]^d[T[z++]]^u[T[z++]]^c[T[z++]]^o[T[z++]]^a[T[z++]]^i[T[z++]]^r[T[z++]];for(B+=15;z<B;)A=A>>>8^r[(A^T[z++])&255];return~A}function E(T,M){for(var A=M^-1,B=0,z=T.length,U=0,V=0;B<z;)U=T.charCodeAt(B++),U<128?A=A>>>8^r[(A^U)&255]:U<2048?(A=A>>>8^r[(A^(192|U>>6&31))&255],A=A>>>8^r[(A^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,V=T.charCodeAt(B++)&1023,A=A>>>8^r[(A^(240|U>>8&7))&255],A=A>>>8^r[(A^(128|U>>2&63))&255],A=A>>>8^r[(A^(128|V>>6&15|(U&3)<<4))&255],A=A>>>8^r[(A^(128|V&63))&255]):(A=A>>>8^r[(A^(224|U>>12&15))&255],A=A>>>8^r[(A^(128|U>>6&63))&255],A=A>>>8^r[(A^(128|U&63))&255]);return~A}return e.table=r,e.bstr=_,e.buf=C,e.str=E,e}(),We=function(){var t={};t.version="1.2.1";function r(S,O){for(var N=S.split("/"),j=O.split("/"),F=0,D=0,K=Math.min(N.length,j.length);F<K;++F){if(D=N[F].length-j[F].length)return D;if(N[F]!=j[F])return N[F]<j[F]?-1:1}return N.length-j.length}function n(S){if(S.charAt(S.length-1)=="/")return S.slice(0,-1).indexOf("/")===-1?S:n(S.slice(0,-1));var O=S.lastIndexOf("/");return O===-1?S:S.slice(0,O+1)}function s(S){if(S.charAt(S.length-1)=="/")return s(S.slice(0,-1));var O=S.lastIndexOf("/");return O===-1?S:S.slice(O+1)}function i(S,O){typeof O=="string"&&(O=new Date(O));var N=O.getHours();N=N<<6|O.getMinutes(),N=N<<5|O.getSeconds()>>>1,S.write_shift(2,N);var j=O.getFullYear()-1980;j=j<<4|O.getMonth()+1,j=j<<5|O.getDate(),S.write_shift(2,j)}function a(S){var O=S.read_shift(2)&65535,N=S.read_shift(2)&65535,j=new Date,F=N&31;N>>>=5;var D=N&15;N>>>=4,j.setMilliseconds(0),j.setFullYear(N+1980),j.setMonth(D-1),j.setDate(F);var K=O&31;O>>>=5;var re=O&63;return O>>>=6,j.setHours(O),j.setMinutes(re),j.setSeconds(K<<1),j}function o(S){ur(S,0);for(var O={},N=0;S.l<=S.length-4;){var j=S.read_shift(2),F=S.read_shift(2),D=S.l+F,K={};switch(j){case 21589:N=S.read_shift(1),N&1&&(K.mtime=S.read_shift(4)),F>5&&(N&2&&(K.atime=S.read_shift(4)),N&4&&(K.ctime=S.read_shift(4))),K.mtime&&(K.mt=new Date(K.mtime*1e3));break}S.l=D,O[j]=K}return O}var c;function u(){return c||(c={})}function d(S,O){if(S[0]==80&&S[1]==75)return Qh(S,O);if((S[0]|32)==109&&(S[1]|32)==105)return Yw(S,O);if(S.length<512)throw new Error("CFB file size "+S.length+" < 512");var N=3,j=512,F=0,D=0,K=0,re=0,q=0,X=[],J=S.slice(0,512);ur(J,0);var ae=f(J);switch(N=ae[0],N){case 3:j=512;break;case 4:j=4096;break;case 0:if(ae[1]==0)return Qh(S,O);default:throw new Error("Major Version: Expected 3 or 4 saw "+N)}j!==512&&(J=S.slice(0,j),ur(J,28));var me=S.slice(0,j);h(J,N);var ye=J.read_shift(4,"i");if(N===3&&ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ye);J.l+=4,K=J.read_shift(4,"i"),J.l+=4,J.chk("00100000","Mini Stream Cutoff Size: "),re=J.read_shift(4,"i"),F=J.read_shift(4,"i"),q=J.read_shift(4,"i"),D=J.read_shift(4,"i");for(var ue=-1,ve=0;ve<109&&(ue=J.read_shift(4,"i"),!(ue<0));++ve)X[ve]=ue;var ke=p(S,j);x(q,D,ke,j,X);var Je=v(ke,K,X,j);Je[K].name="!Directory",F>0&&re!==V&&(Je[re].name="!MiniFAT"),Je[X[0]].name="!FAT",Je.fat_addrs=X,Je.ssz=j;var Qe={},Dt=[],wa=[],_a=[];y(K,Je,ke,Dt,F,Qe,wa,re),g(wa,_a,Dt),Dt.shift();var Ea={FileIndex:wa,FullPaths:_a};return O&&O.raw&&(Ea.raw={header:me,sectors:ke}),Ea}function f(S){if(S[S.l]==80&&S[S.l+1]==75)return[0,0];S.chk(pe,"Header Signature: "),S.l+=16;var O=S.read_shift(2,"u");return[S.read_shift(2,"u"),O]}function h(S,O){var N=9;switch(S.l+=2,N=S.read_shift(2)){case 9:if(O!=3)throw new Error("Sector Shift: Expected 9 saw "+N);break;case 12:if(O!=4)throw new Error("Sector Shift: Expected 12 saw "+N);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+N)}S.chk("0600","Mini Sector Shift: "),S.chk("000000000000","Reserved: ")}function p(S,O){for(var N=Math.ceil(S.length/O)-1,j=[],F=1;F<N;++F)j[F-1]=S.slice(F*O,(F+1)*O);return j[N-1]=S.slice(N*O),j}function g(S,O,N){for(var j=0,F=0,D=0,K=0,re=0,q=N.length,X=[],J=[];j<q;++j)X[j]=J[j]=j,O[j]=N[j];for(;re<J.length;++re)j=J[re],F=S[j].L,D=S[j].R,K=S[j].C,X[j]===j&&(F!==-1&&X[F]!==F&&(X[j]=X[F]),D!==-1&&X[D]!==D&&(X[j]=X[D])),K!==-1&&(X[K]=j),F!==-1&&j!=X[j]&&(X[F]=X[j],J.lastIndexOf(F)<re&&J.push(F)),D!==-1&&j!=X[j]&&(X[D]=X[j],J.lastIndexOf(D)<re&&J.push(D));for(j=1;j<q;++j)X[j]===j&&(D!==-1&&X[D]!==D?X[j]=X[D]:F!==-1&&X[F]!==F&&(X[j]=X[F]));for(j=1;j<q;++j)if(S[j].type!==0){if(re=j,re!=X[re])do re=X[re],O[j]=O[re]+"/"+O[j];while(re!==0&&X[re]!==-1&&re!=X[re]);X[j]=-1}for(O[0]+="/",j=1;j<q;++j)S[j].type!==2&&(O[j]+="/")}function m(S,O,N){for(var j=S.start,F=S.size,D=[],K=j;N&&F>0&&K>=0;)D.push(O.slice(K*U,K*U+U)),F-=U,K=Ds(N,K*4);return D.length===0?te(0):kt(D).slice(0,S.size)}function x(S,O,N,j,F){var D=V;if(S===V){if(O!==0)throw new Error("DIFAT chain shorter than expected")}else if(S!==-1){var K=N[S],re=(j>>>2)-1;if(!K)return;for(var q=0;q<re&&(D=Ds(K,q*4))!==V;++q)F.push(D);x(Ds(K,j-4),O-1,N,j,F)}}function w(S,O,N,j,F){var D=[],K=[];F||(F=[]);var re=j-1,q=0,X=0;for(q=O;q>=0;){F[q]=!0,D[D.length]=q,K.push(S[q]);var J=N[Math.floor(q*4/j)];if(X=q*4&re,j<4+X)throw new Error("FAT boundary crossed: "+q+" 4 "+j);if(!S[J])break;q=Ds(S[J],X)}return{nodes:D,data:cg([K])}}function v(S,O,N,j){var F=S.length,D=[],K=[],re=[],q=[],X=j-1,J=0,ae=0,me=0,ye=0;for(J=0;J<F;++J)if(re=[],me=J+O,me>=F&&(me-=F),!K[me]){q=[];var ue=[];for(ae=me;ae>=0;){ue[ae]=!0,K[ae]=!0,re[re.length]=ae,q.push(S[ae]);var ve=N[Math.floor(ae*4/j)];if(ye=ae*4&X,j<4+ye)throw new Error("FAT boundary crossed: "+ae+" 4 "+j);if(!S[ve]||(ae=Ds(S[ve],ye),ue[ae]))break}D[me]={nodes:re,data:cg([q])}}return D}function y(S,O,N,j,F,D,K,re){for(var q=0,X=j.length?2:0,J=O[S].data,ae=0,me=0,ye;ae<J.length;ae+=128){var ue=J.slice(ae,ae+128);ur(ue,64),me=ue.read_shift(2),ye=wh(ue,0,me-X),j.push(ye);var ve={name:ye,type:ue.read_shift(1),color:ue.read_shift(1),L:ue.read_shift(4,"i"),R:ue.read_shift(4,"i"),C:ue.read_shift(4,"i"),clsid:ue.read_shift(16),state:ue.read_shift(4,"i"),start:0,size:0},ke=ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2);ke!==0&&(ve.ct=_(ue,ue.l-8));var Je=ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2);Je!==0&&(ve.mt=_(ue,ue.l-8)),ve.start=ue.read_shift(4,"i"),ve.size=ue.read_shift(4,"i"),ve.size<0&&ve.start<0&&(ve.size=ve.type=0,ve.start=V,ve.name=""),ve.type===5?(q=ve.start,F>0&&q!==V&&(O[q].name="!StreamData")):ve.size>=4096?(ve.storage="fat",O[ve.start]===void 0&&(O[ve.start]=w(N,ve.start,O.fat_addrs,O.ssz)),O[ve.start].name=ve.name,ve.content=O[ve.start].data.slice(0,ve.size)):(ve.storage="minifat",ve.size<0?ve.size=0:q!==V&&ve.start!==V&&O[q]&&(ve.content=m(ve,O[q].data,(O[re]||{}).data))),ve.content&&ur(ve.content,0),D[ye]=ve,K.push(ve)}}function _(S,O){return new Date((fr(S,O+4)/1e7*Math.pow(2,32)+fr(S,O)/1e7-11644473600)*1e3)}function C(S,O){return u(),d(c.readFileSync(S),O)}function E(S,O){var N=O&&O.type;switch(N||Re&&Buffer.isBuffer(S)&&(N="buffer"),N||"base64"){case"file":return C(S,O);case"base64":return d(Wr(Cn(S)),O);case"binary":return d(Wr(S),O)}return d(S,O)}function T(S,O){var N=O||{},j=N.root||"Root Entry";if(S.FullPaths||(S.FullPaths=[]),S.FileIndex||(S.FileIndex=[]),S.FullPaths.length!==S.FileIndex.length)throw new Error("inconsistent CFB structure");S.FullPaths.length===0&&(S.FullPaths[0]=j+"/",S.FileIndex[0]={name:j,type:5}),N.CLSID&&(S.FileIndex[0].clsid=N.CLSID),M(S)}function M(S){var O="Sh33tJ5";if(!We.find(S,"/"+O)){var N=te(4);N[0]=55,N[1]=N[3]=50,N[2]=54,S.FileIndex.push({name:O,type:2,content:N,size:4,L:69,R:69,C:69}),S.FullPaths.push(S.FullPaths[0]+O),A(S)}}function A(S,O){T(S);for(var N=!1,j=!1,F=S.FullPaths.length-1;F>=0;--F){var D=S.FileIndex[F];switch(D.type){case 0:j?N=!0:(S.FileIndex.pop(),S.FullPaths.pop());break;case 1:case 2:case 5:j=!0,isNaN(D.R*D.L*D.C)&&(N=!0),D.R>-1&&D.L>-1&&D.R==D.L&&(N=!0);break;default:N=!0;break}}if(!(!N&&!O)){var K=new Date(1987,1,19),re=0,q=Object.create?Object.create(null):{},X=[];for(F=0;F<S.FullPaths.length;++F)q[S.FullPaths[F]]=!0,S.FileIndex[F].type!==0&&X.push([S.FullPaths[F],S.FileIndex[F]]);for(F=0;F<X.length;++F){var J=n(X[F][0]);j=q[J],j||(X.push([J,{name:s(J).replace("/",""),type:1,clsid:le,ct:K,mt:K,content:null}]),q[J]=!0)}for(X.sort(function(ye,ue){return r(ye[0],ue[0])}),S.FullPaths=[],S.FileIndex=[],F=0;F<X.length;++F)S.FullPaths[F]=X[F][0],S.FileIndex[F]=X[F][1];for(F=0;F<X.length;++F){var ae=S.FileIndex[F],me=S.FullPaths[F];if(ae.name=s(me).replace("/",""),ae.L=ae.R=ae.C=-(ae.color=1),ae.size=ae.content?ae.content.length:0,ae.start=0,ae.clsid=ae.clsid||le,F===0)ae.C=X.length>1?1:-1,ae.size=0,ae.type=5;else if(me.slice(-1)=="/"){for(re=F+1;re<X.length&&n(S.FullPaths[re])!=me;++re);for(ae.C=re>=X.length?-1:re,re=F+1;re<X.length&&n(S.FullPaths[re])!=n(me);++re);ae.R=re>=X.length?-1:re,ae.type=1}else n(S.FullPaths[F+1]||"")==n(me)&&(ae.R=F+1),ae.type=2}}}function B(S,O){var N=O||{};if(N.fileType=="mad")return Jw(S,N);switch(A(S),N.fileType){case"zip":return zw(S,N)}var j=function(ye){for(var ue=0,ve=0,ke=0;ke<ye.FileIndex.length;++ke){var Je=ye.FileIndex[ke];if(Je.content){var Qe=Je.content.length;Qe>0&&(Qe<4096?ue+=Qe+63>>6:ve+=Qe+511>>9)}}for(var Dt=ye.FullPaths.length+3>>2,wa=ue+7>>3,_a=ue+127>>7,Ea=wa+ve+Dt+_a,ks=Ea+127>>7,Yu=ks<=109?0:Math.ceil((ks-109)/127);Ea+ks+Yu+127>>7>ks;)Yu=++ks<=109?0:Math.ceil((ks-109)/127);var dn=[1,Yu,ks,_a,Dt,ve,ue,0];return ye.FileIndex[0].size=ue<<6,dn[7]=(ye.FileIndex[0].start=dn[0]+dn[1]+dn[2]+dn[3]+dn[4]+dn[5])+(dn[6]+7>>3),dn}(S),F=te(j[7]<<9),D=0,K=0;{for(D=0;D<8;++D)F.write_shift(1,ne[D]);for(D=0;D<8;++D)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),D=0;D<3;++D)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,j[2]),F.write_shift(4,j[0]+j[1]+j[2]+j[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,j[3]?j[0]+j[1]+j[2]-1:V),F.write_shift(4,j[3]),F.write_shift(-4,j[1]?j[0]-1:V),F.write_shift(4,j[1]),D=0;D<109;++D)F.write_shift(-4,D<j[2]?j[1]+D:-1)}if(j[1])for(K=0;K<j[1];++K){for(;D<236+K*127;++D)F.write_shift(-4,D<j[2]?j[1]+D:-1);F.write_shift(-4,K===j[1]-1?V:K+1)}var re=function(ye){for(K+=ye;D<K-1;++D)F.write_shift(-4,D+1);ye&&(++D,F.write_shift(-4,V))};for(K=D=0,K+=j[1];D<K;++D)F.write_shift(-4,ee.DIFSECT);for(K+=j[2];D<K;++D)F.write_shift(-4,ee.FATSECT);re(j[3]),re(j[4]);for(var q=0,X=0,J=S.FileIndex[0];q<S.FileIndex.length;++q)J=S.FileIndex[q],J.content&&(X=J.content.length,!(X<4096)&&(J.start=K,re(X+511>>9)));for(re(j[6]+7>>3);F.l&511;)F.write_shift(-4,ee.ENDOFCHAIN);for(K=D=0,q=0;q<S.FileIndex.length;++q)J=S.FileIndex[q],J.content&&(X=J.content.length,!(!X||X>=4096)&&(J.start=K,re(X+63>>6)));for(;F.l&511;)F.write_shift(-4,ee.ENDOFCHAIN);for(D=0;D<j[4]<<2;++D){var ae=S.FullPaths[D];if(!ae||ae.length===0){for(q=0;q<17;++q)F.write_shift(4,0);for(q=0;q<3;++q)F.write_shift(4,-1);for(q=0;q<12;++q)F.write_shift(4,0);continue}J=S.FileIndex[D],D===0&&(J.start=J.size?J.start-1:V);var me=D===0&&N.root||J.name;if(X=2*(me.length+1),F.write_shift(64,me,"utf16le"),F.write_shift(2,X),F.write_shift(1,J.type),F.write_shift(1,J.color),F.write_shift(-4,J.L),F.write_shift(-4,J.R),F.write_shift(-4,J.C),J.clsid)F.write_shift(16,J.clsid,"hex");else for(q=0;q<4;++q)F.write_shift(4,0);F.write_shift(4,J.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,J.start),F.write_shift(4,J.size),F.write_shift(4,0)}for(D=1;D<S.FileIndex.length;++D)if(J=S.FileIndex[D],J.size>=4096)if(F.l=J.start+1<<9,Re&&Buffer.isBuffer(J.content))J.content.copy(F,F.l,0,J.size),F.l+=J.size+511&-512;else{for(q=0;q<J.size;++q)F.write_shift(1,J.content[q]);for(;q&511;++q)F.write_shift(1,0)}for(D=1;D<S.FileIndex.length;++D)if(J=S.FileIndex[D],J.size>0&&J.size<4096)if(Re&&Buffer.isBuffer(J.content))J.content.copy(F,F.l,0,J.size),F.l+=J.size+63&-64;else{for(q=0;q<J.size;++q)F.write_shift(1,J.content[q]);for(;q&63;++q)F.write_shift(1,0)}if(Re)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function z(S,O){var N=S.FullPaths.map(function(q){return q.toUpperCase()}),j=N.map(function(q){var X=q.split("/");return X[X.length-(q.slice(-1)=="/"?2:1)]}),F=!1;O.charCodeAt(0)===47?(F=!0,O=N[0].slice(0,-1)+O):F=O.indexOf("/")!==-1;var D=O.toUpperCase(),K=F===!0?N.indexOf(D):j.indexOf(D);if(K!==-1)return S.FileIndex[K];var re=!D.match(jl);for(D=D.replace(ro,""),re&&(D=D.replace(jl,"!")),K=0;K<N.length;++K)if((re?N[K].replace(jl,"!"):N[K]).replace(ro,"")==D||(re?j[K].replace(jl,"!"):j[K]).replace(ro,"")==D)return S.FileIndex[K];return null}var U=64,V=-2,pe="d0cf11e0a1b11ae1",ne=[208,207,17,224,161,177,26,225],le="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:pe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:le,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function W(S,O,N){u();var j=B(S,N);c.writeFileSync(O,j)}function G(S){for(var O=new Array(S.length),N=0;N<S.length;++N)O[N]=String.fromCharCode(S[N]);return O.join("")}function Z(S,O){var N=B(S,O);switch(O&&O.type||"buffer"){case"file":return u(),c.writeFileSync(O.filename,N),N;case"binary":return typeof N=="string"?N:G(N);case"base64":return Ao(typeof N=="string"?N:G(N));case"buffer":if(Re)return Buffer.isBuffer(N)?N:Dn(N);case"array":return typeof N=="string"?Wr(N):N}return N}var Q;function k(S){try{var O=S.InflateRaw,N=new O;if(N._processChunk(new Uint8Array([3,0]),N._finishFlushFlag),N.bytesRead)Q=S;else throw new Error("zlib does not expose bytesRead")}catch(j){console.error("cannot use native zlib: "+(j.message||j))}}function P(S,O){if(!Q)return Yh(S,O);var N=Q.InflateRaw,j=new N,F=j._processChunk(S.slice(S.l),j._finishFlushFlag);return S.l+=j.bytesRead,F}function I(S){return Q?Q.deflateRawSync(S):zh(S)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ge(S){var O=(S<<1|S<<11)&139536|(S<<5|S<<15)&558144;return(O>>16|O>>8|O)&255}for(var L=typeof Uint8Array<"u",H=L?new Uint8Array(256):[],fe=0;fe<256;++fe)H[fe]=ge(fe);function ie(S,O){var N=H[S&255];return O<=8?N>>>8-O:(N=N<<8|H[S>>8&255],O<=16?N>>>16-O:(N=N<<8|H[S>>16&255],N>>>24-O))}function Se(S,O){var N=O&7,j=O>>>3;return(S[j]|(N<=6?0:S[j+1]<<8))>>>N&3}function Te(S,O){var N=O&7,j=O>>>3;return(S[j]|(N<=5?0:S[j+1]<<8))>>>N&7}function He(S,O){var N=O&7,j=O>>>3;return(S[j]|(N<=4?0:S[j+1]<<8))>>>N&15}function Fe(S,O){var N=O&7,j=O>>>3;return(S[j]|(N<=3?0:S[j+1]<<8))>>>N&31}function Ee(S,O){var N=O&7,j=O>>>3;return(S[j]|(N<=1?0:S[j+1]<<8))>>>N&127}function _r(S,O,N){var j=O&7,F=O>>>3,D=(1<<N)-1,K=S[F]>>>j;return N<8-j||(K|=S[F+1]<<8-j,N<16-j)||(K|=S[F+2]<<16-j,N<24-j)||(K|=S[F+3]<<24-j),K&D}function un(S,O,N){var j=O&7,F=O>>>3;return j<=5?S[F]|=(N&7)<<j:(S[F]|=N<<j&255,S[F+1]=(N&7)>>8-j),O+3}function Ts(S,O,N){var j=O&7,F=O>>>3;return N=(N&1)<<j,S[F]|=N,O+1}function ci(S,O,N){var j=O&7,F=O>>>3;return N<<=j,S[F]|=N&255,N>>>=8,S[F+1]=N,O+8}function Hh(S,O,N){var j=O&7,F=O>>>3;return N<<=j,S[F]|=N&255,N>>>=8,S[F+1]=N&255,S[F+2]=N>>>8,O+16}function Gu(S,O){var N=S.length,j=2*N>O?2*N:O+5,F=0;if(N>=O)return S;if(Re){var D=Kp(j);if(S.copy)S.copy(D);else for(;F<S.length;++F)D[F]=S[F];return D}else if(L){var K=new Uint8Array(j);if(K.set)K.set(S);else for(;F<N;++F)K[F]=S[F];return K}return S.length=j,S}function Jr(S){for(var O=new Array(S),N=0;N<S;++N)O[N]=0;return O}function tl(S,O,N){var j=1,F=0,D=0,K=0,re=0,q=S.length,X=L?new Uint16Array(32):Jr(32);for(D=0;D<32;++D)X[D]=0;for(D=q;D<N;++D)S[D]=0;q=S.length;var J=L?new Uint16Array(q):Jr(q);for(D=0;D<q;++D)X[F=S[D]]++,j<F&&(j=F),J[D]=0;for(X[0]=0,D=1;D<=j;++D)X[D+16]=re=re+X[D-1]<<1;for(D=0;D<q;++D)re=S[D],re!=0&&(J[D]=X[re+16]++);var ae=0;for(D=0;D<q;++D)if(ae=S[D],ae!=0)for(re=ie(J[D],j)>>j-ae,K=(1<<j+4-ae)-1;K>=0;--K)O[re|K<<ae]=ae&15|D<<4;return j}var qu=L?new Uint16Array(512):Jr(512),Ku=L?new Uint16Array(32):Jr(32);if(!L){for(var bs=0;bs<512;++bs)qu[bs]=0;for(bs=0;bs<32;++bs)Ku[bs]=0}(function(){for(var S=[],O=0;O<32;O++)S.push(5);tl(S,Ku,32);var N=[];for(O=0;O<=143;O++)N.push(8);for(;O<=255;O++)N.push(9);for(;O<=279;O++)N.push(7);for(;O<=287;O++)N.push(8);tl(N,qu,288)})();var $w=function(){for(var O=L?new Uint8Array(32768):[],N=0,j=0;N<ce.length-1;++N)for(;j<ce[N+1];++j)O[j]=N;for(;j<32768;++j)O[j]=29;var F=L?new Uint8Array(259):[];for(N=0,j=0;N<Y.length-1;++N)for(;j<Y[N+1];++j)F[j]=N;function D(re,q){for(var X=0;X<re.length;){var J=Math.min(65535,re.length-X),ae=X+J==re.length;for(q.write_shift(1,+ae),q.write_shift(2,J),q.write_shift(2,~J&65535);J-- >0;)q[q.l++]=re[X++]}return q.l}function K(re,q){for(var X=0,J=0,ae=L?new Uint16Array(32768):[];J<re.length;){var me=Math.min(65535,re.length-J);if(me<10){for(X=un(q,X,+(J+me==re.length)),X&7&&(X+=8-(X&7)),q.l=X/8|0,q.write_shift(2,me),q.write_shift(2,~me&65535);me-- >0;)q[q.l++]=re[J++];X=q.l*8;continue}X=un(q,X,+(J+me==re.length)+2);for(var ye=0;me-- >0;){var ue=re[J];ye=(ye<<5^ue)&32767;var ve=-1,ke=0;if((ve=ae[ye])&&(ve|=J&-32768,ve>J&&(ve-=32768),ve<J))for(;re[ve+ke]==re[J+ke]&&ke<250;)++ke;if(ke>2){ue=F[ke],ue<=22?X=ci(q,X,H[ue+1]>>1)-1:(ci(q,X,3),X+=5,ci(q,X,H[ue-23]>>5),X+=3);var Je=ue<8?0:ue-4>>2;Je>0&&(Hh(q,X,ke-Y[ue]),X+=Je),ue=O[J-ve],X=ci(q,X,H[ue]>>3),X-=3;var Qe=ue<4?0:ue-2>>1;Qe>0&&(Hh(q,X,J-ve-ce[ue]),X+=Qe);for(var Dt=0;Dt<ke;++Dt)ae[ye]=J&32767,ye=(ye<<5^re[J])&32767,++J;me-=ke-1}else ue<=143?ue=ue+48:X=Ts(q,X,1),X=ci(q,X,H[ue]),ae[ye]=J&32767,++J}X=ci(q,X,0)-1}return q.l=(X+7)/8|0,q.l}return function(q,X){return q.length<8?D(q,X):K(q,X)}}();function zh(S){var O=te(50+Math.floor(S.length*1.1)),N=$w(S,O);return O.slice(0,N)}var Vh=L?new Uint16Array(32768):Jr(32768),Gh=L?new Uint16Array(32768):Jr(32768),qh=L?new Uint16Array(128):Jr(128),Kh=1,Xh=1;function Uw(S,O){var N=Fe(S,O)+257;O+=5;var j=Fe(S,O)+1;O+=5;var F=He(S,O)+4;O+=4;for(var D=0,K=L?new Uint8Array(19):Jr(19),re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q=1,X=L?new Uint8Array(8):Jr(8),J=L?new Uint8Array(8):Jr(8),ae=K.length,me=0;me<F;++me)K[R[me]]=D=Te(S,O),q<D&&(q=D),X[D]++,O+=3;var ye=0;for(X[0]=0,me=1;me<=q;++me)J[me]=ye=ye+X[me-1]<<1;for(me=0;me<ae;++me)(ye=K[me])!=0&&(re[me]=J[ye]++);var ue=0;for(me=0;me<ae;++me)if(ue=K[me],ue!=0){ye=H[re[me]]>>8-ue;for(var ve=(1<<7-ue)-1;ve>=0;--ve)qh[ye|ve<<ue]=ue&7|me<<3}var ke=[];for(q=1;ke.length<N+j;)switch(ye=qh[Ee(S,O)],O+=ye&7,ye>>>=3){case 16:for(D=3+Se(S,O),O+=2,ye=ke[ke.length-1];D-- >0;)ke.push(ye);break;case 17:for(D=3+Te(S,O),O+=3;D-- >0;)ke.push(0);break;case 18:for(D=11+Ee(S,O),O+=7;D-- >0;)ke.push(0);break;default:ke.push(ye),q<ye&&(q=ye);break}var Je=ke.slice(0,N),Qe=ke.slice(N);for(me=N;me<286;++me)Je[me]=0;for(me=j;me<30;++me)Qe[me]=0;return Kh=tl(Je,Vh,286),Xh=tl(Qe,Gh,30),O}function Ww(S,O){if(S[0]==3&&!(S[1]&3))return[Ys(O),2];for(var N=0,j=0,F=Kp(O||1<<18),D=0,K=F.length>>>0,re=0,q=0;!(j&1);){if(j=Te(S,N),N+=3,j>>>1)j>>1==1?(re=9,q=5):(N=Uw(S,N),re=Kh,q=Xh);else{N&7&&(N+=8-(N&7));var X=S[N>>>3]|S[(N>>>3)+1]<<8;if(N+=32,X>0)for(!O&&K<D+X&&(F=Gu(F,D+X),K=F.length);X-- >0;)F[D++]=S[N>>>3],N+=8;continue}for(;;){!O&&K<D+32767&&(F=Gu(F,D+32767),K=F.length);var J=_r(S,N,re),ae=j>>>1==1?qu[J]:Vh[J];if(N+=ae&15,ae>>>=4,!(ae>>>8&255))F[D++]=ae;else{if(ae==256)break;ae-=257;var me=ae<8?0:ae-4>>2;me>5&&(me=0);var ye=D+Y[ae];me>0&&(ye+=_r(S,N,me),N+=me),J=_r(S,N,q),ae=j>>>1==1?Ku[J]:Gh[J],N+=ae&15,ae>>>=4;var ue=ae<4?0:ae-2>>1,ve=ce[ae];for(ue>0&&(ve+=_r(S,N,ue),N+=ue),!O&&K<ye&&(F=Gu(F,ye+100),K=F.length);D<ye;)F[D]=F[D-ve],++D}}}return O?[F,N+7>>>3]:[F.slice(0,D),N+7>>>3]}function Yh(S,O){var N=S.slice(S.l||0),j=Ww(N,O);return S.l+=j[1],j[0]}function Jh(S,O){if(S)typeof console<"u"&&console.error(O);else throw new Error(O)}function Qh(S,O){var N=S;ur(N,0);var j=[],F=[],D={FileIndex:j,FullPaths:F};T(D,{root:O.root});for(var K=N.length-4;(N[K]!=80||N[K+1]!=75||N[K+2]!=5||N[K+3]!=6)&&K>=0;)--K;N.l=K+4,N.l+=4;var re=N.read_shift(2);N.l+=6;var q=N.read_shift(4);for(N.l=q,K=0;K<re;++K){N.l+=20;var X=N.read_shift(4),J=N.read_shift(4),ae=N.read_shift(2),me=N.read_shift(2),ye=N.read_shift(2);N.l+=8;var ue=N.read_shift(4),ve=o(N.slice(N.l+ae,N.l+ae+me));N.l+=ae+me+ye;var ke=N.l;N.l=ue+4,Hw(N,X,J,D,ve),N.l=ke}return D}function Hw(S,O,N,j,F){S.l+=2;var D=S.read_shift(2),K=S.read_shift(2),re=a(S);if(D&8257)throw new Error("Unsupported ZIP encryption");for(var q=S.read_shift(4),X=S.read_shift(4),J=S.read_shift(4),ae=S.read_shift(2),me=S.read_shift(2),ye="",ue=0;ue<ae;++ue)ye+=String.fromCharCode(S[S.l++]);if(me){var ve=o(S.slice(S.l,S.l+me));(ve[21589]||{}).mt&&(re=ve[21589].mt),((F||{})[21589]||{}).mt&&(re=F[21589].mt)}S.l+=me;var ke=S.slice(S.l,S.l+X);switch(K){case 8:ke=P(S,J);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+K)}var Je=!1;D&8&&(q=S.read_shift(4),q==134695760&&(q=S.read_shift(4),Je=!0),X=S.read_shift(4),J=S.read_shift(4)),X!=O&&Jh(Je,"Bad compressed size: "+O+" != "+X),J!=N&&Jh(Je,"Bad uncompressed size: "+N+" != "+J),Xu(j,ye,ke,{unsafe:!0,mt:re})}function zw(S,O){var N=O||{},j=[],F=[],D=te(1),K=N.compression?8:0,re=0,q=0,X=0,J=0,ae=0,me=S.FullPaths[0],ye=me,ue=S.FileIndex[0],ve=[],ke=0;for(q=1;q<S.FullPaths.length;++q)if(ye=S.FullPaths[q].slice(me.length),ue=S.FileIndex[q],!(!ue.size||!ue.content||ye=="Sh33tJ5")){var Je=J,Qe=te(ye.length);for(X=0;X<ye.length;++X)Qe.write_shift(1,ye.charCodeAt(X)&127);Qe=Qe.slice(0,Qe.l),ve[ae]=H3.buf(ue.content,0);var Dt=ue.content;K==8&&(Dt=I(Dt)),D=te(30),D.write_shift(4,67324752),D.write_shift(2,20),D.write_shift(2,re),D.write_shift(2,K),ue.mt?i(D,ue.mt):D.write_shift(4,0),D.write_shift(-4,ve[ae]),D.write_shift(4,Dt.length),D.write_shift(4,ue.content.length),D.write_shift(2,Qe.length),D.write_shift(2,0),J+=D.length,j.push(D),J+=Qe.length,j.push(Qe),J+=Dt.length,j.push(Dt),D=te(46),D.write_shift(4,33639248),D.write_shift(2,0),D.write_shift(2,20),D.write_shift(2,re),D.write_shift(2,K),D.write_shift(4,0),D.write_shift(-4,ve[ae]),D.write_shift(4,Dt.length),D.write_shift(4,ue.content.length),D.write_shift(2,Qe.length),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(4,0),D.write_shift(4,Je),ke+=D.l,F.push(D),ke+=Qe.length,F.push(Qe),++ae}return D=te(22),D.write_shift(4,101010256),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,ae),D.write_shift(2,ae),D.write_shift(4,ke),D.write_shift(4,J),D.write_shift(2,0),kt([kt(j),kt(F),D])}var rl={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Vw(S,O){if(S.ctype)return S.ctype;var N=S.name||"",j=N.match(/\.([^\.]+)$/);return j&&rl[j[1]]||O&&(j=(N=O).match(/[\.\\]([^\.\\])+$/),j&&rl[j[1]])?rl[j[1]]:"application/octet-stream"}function Gw(S){for(var O=Ao(S),N=[],j=0;j<O.length;j+=76)N.push(O.slice(j,j+76));return N.join(`\r
`)+`\r
`}function qw(S){var O=S.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(X){var J=X.charCodeAt(0).toString(16).toUpperCase();return"="+(J.length==1?"0"+J:J)});O=O.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),O.charAt(0)==`
`&&(O="=0D"+O.slice(1)),O=O.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var N=[],j=O.split(`\r
`),F=0;F<j.length;++F){var D=j[F];if(D.length==0){N.push("");continue}for(var K=0;K<D.length;){var re=76,q=D.slice(K,K+re);q.charAt(re-1)=="="?re--:q.charAt(re-2)=="="?re-=2:q.charAt(re-3)=="="&&(re-=3),q=D.slice(K,K+re),K+=re,K<D.length&&(q+="="),N.push(q)}}return N.join(`\r
`)}function Kw(S){for(var O=[],N=0;N<S.length;++N){for(var j=S[N];N<=S.length&&j.charAt(j.length-1)=="=";)j=j.slice(0,j.length-1)+S[++N];O.push(j)}for(var F=0;F<O.length;++F)O[F]=O[F].replace(/[=][0-9A-Fa-f]{2}/g,function(D){return String.fromCharCode(parseInt(D.slice(1),16))});return Wr(O.join(`\r
`))}function Xw(S,O,N){for(var j="",F="",D="",K,re=0;re<10;++re){var q=O[re];if(!q||q.match(/^\s*$/))break;var X=q.match(/^(.*?):\s*([^\s].*)$/);if(X)switch(X[1].toLowerCase()){case"content-location":j=X[2].trim();break;case"content-type":D=X[2].trim();break;case"content-transfer-encoding":F=X[2].trim();break}}switch(++re,F.toLowerCase()){case"base64":K=Wr(Cn(O.slice(re).join("")));break;case"quoted-printable":K=Kw(O.slice(re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var J=Xu(S,j.slice(N.length),K,{unsafe:!0});D&&(J.ctype=D)}function Yw(S,O){if(G(S.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var N=O&&O.root||"",j=(Re&&Buffer.isBuffer(S)?S.toString("binary"):G(S)).split(`\r
`),F=0,D="";for(F=0;F<j.length;++F)if(D=j[F],!!/^Content-Location:/i.test(D)&&(D=D.slice(D.indexOf("file")),N||(N=D.slice(0,D.lastIndexOf("/")+1)),D.slice(0,N.length)!=N))for(;N.length>0&&(N=N.slice(0,N.length-1),N=N.slice(0,N.lastIndexOf("/")+1),D.slice(0,N.length)!=N););var K=(j[1]||"").match(/boundary="(.*?)"/);if(!K)throw new Error("MAD cannot find boundary");var re="--"+(K[1]||""),q=[],X=[],J={FileIndex:q,FullPaths:X};T(J);var ae,me=0;for(F=0;F<j.length;++F){var ye=j[F];ye!==re&&ye!==re+"--"||(me++&&Xw(J,j.slice(ae,F),N),ae=F)}return J}function Jw(S,O){var N=O||{},j=N.boundary||"SheetJS";j="------="+j;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+j.slice(2)+'"',"","",""],D=S.FullPaths[0],K=D,re=S.FileIndex[0],q=1;q<S.FullPaths.length;++q)if(K=S.FullPaths[q].slice(D.length),re=S.FileIndex[q],!(!re.size||!re.content||K=="Sh33tJ5")){K=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ke){return"_x"+ke.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ke){return"_u"+ke.charCodeAt(0).toString(16)+"_"});for(var X=re.content,J=Re&&Buffer.isBuffer(X)?X.toString("binary"):G(X),ae=0,me=Math.min(1024,J.length),ye=0,ue=0;ue<=me;++ue)(ye=J.charCodeAt(ue))>=32&&ye<128&&++ae;var ve=ae>=me*4/5;F.push(j),F.push("Content-Location: "+(N.root||"file:///C:/SheetJS/")+K),F.push("Content-Transfer-Encoding: "+(ve?"quoted-printable":"base64")),F.push("Content-Type: "+Vw(re,K)),F.push(""),F.push(ve?qw(J):Gw(J))}return F.push(j+`--\r
`),F.join(`\r
`)}function Qw(S){var O={};return T(O,S),O}function Xu(S,O,N,j){var F=j&&j.unsafe;F||T(S);var D=!F&&We.find(S,O);if(!D){var K=S.FullPaths[0];O.slice(0,K.length)==K?K=O:(K.slice(-1)!="/"&&(K+="/"),K=(K+O).replace("//","/")),D={name:s(O),type:2},S.FileIndex.push(D),S.FullPaths.push(K),F||We.utils.cfb_gc(S)}return D.content=N,D.size=N?N.length:0,j&&(j.CLSID&&(D.clsid=j.CLSID),j.mt&&(D.mt=j.mt),j.ct&&(D.ct=j.ct)),D}function Zw(S,O){T(S);var N=We.find(S,O);if(N){for(var j=0;j<S.FileIndex.length;++j)if(S.FileIndex[j]==N)return S.FileIndex.splice(j,1),S.FullPaths.splice(j,1),!0}return!1}function e2(S,O,N){T(S);var j=We.find(S,O);if(j){for(var F=0;F<S.FileIndex.length;++F)if(S.FileIndex[F]==j)return S.FileIndex[F].name=s(N),S.FullPaths[F]=N,!0}return!1}function t2(S){A(S,!0)}return t.find=z,t.read=E,t.parse=d,t.write=Z,t.writeFile=W,t.utils={cfb_new:Qw,cfb_add:Xu,cfb_del:Zw,cfb_mov:e2,cfb_gc:t2,ReadShift:so,CheckField:jy,prep_blob:ur,bconcat:kt,use_zlib:k,_deflateRaw:zh,_inflateRaw:Yh,consts:ee},t}();function z3(e){return typeof e=="string"?Fu(e):Array.isArray(e)?g3(e):e}function Yo(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Fu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Fo(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([z3(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Xo(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Pt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function rg(e,t){for(var r=[],n=Pt(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function gh(e){for(var t=[],r=Pt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Ru(e){for(var t=[],r=Pt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function V3(e){for(var t=[],r=Pt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Uc=new Date(1899,11,30,0,0,0);function ar(e,t){var r=e.getTime(),n=Uc.getTime()+(e.getTimezoneOffset()-Uc.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var fy=new Date,G3=Uc.getTime()+(fy.getTimezoneOffset()-Uc.getTimezoneOffset())*6e4,ng=fy.getTimezoneOffset();function hy(e){var t=new Date;return t.setTime(e*24*60*60*1e3+G3),t.getTimezoneOffset()!==ng&&t.setTime(t.getTime()+(t.getTimezoneOffset()-ng)*6e4),t}var sg=new Date("2017-02-19T19:06:09.000Z"),my=isNaN(sg.getFullYear())?new Date("2/19/17"):sg,q3=my.getFullYear()==2017;function Xt(e,t){var r=new Date(e);if(q3)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(my.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Iu(e,t){if(Re&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function or(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=or(e[r]));return t}function nt(e,t){for(var r="";r.length<t;)r+=e;return r}function _n(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var K3=["january","february","march","april","may","june","july","august","september","october","november","december"];function Oo(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&K3.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Ce(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Re?n=Dn(r):n=x3(r),We.utils.cfb_add(e,t,n)}We.utils.cfb_add(e,t,r)}else e.file(t,r)}function xh(){return We.utils.cfb_new()}var dt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,X3={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},vh=gh(X3),yh=/[&<>'"]/g,Y3=/[\u0000-\u0008\u000b-\u001f]/g;function Be(e){var t=e+"";return t.replace(yh,function(r){return vh[r]}).replace(Y3,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ig(e){return Be(e).replace(/ /g,"_x0020_")}var py=/[\u0000-\u001f]/g;function J3(e){var t=e+"";return t.replace(yh,function(r){return vh[r]}).replace(/\n/g,"<br/>").replace(py,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Q3(e){var t=e+"";return t.replace(yh,function(r){return vh[r]}).replace(py,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function Z3(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function eC(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function P0(e){for(var t="",r=0,n=0,s=0,i=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,t+=String.fromCharCode(a);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function ag(e){var t=Ys(2*e.length),r,n,s=1,i=0,a=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[i++]=a&255,t[i++]=a>>>8,a=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function og(e){return Dn(e,"binary").toString("utf8")}var Ol="foo bar baz",no=Re&&(og(Ol)==P0(Ol)&&og||ag(Ol)==P0(Ol)&&ag)||P0,Fo=Re?function(e){return Dn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},tC=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),gy=/(^\s|\s$|\n)/;function Nt(e,t){return"<"+e+(t.match(gy)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Po(e){return Pt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function de(e,t,r){return"<"+e+(r!=null?Po(r):"")+(t!=null?(t.match(gy)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function rf(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function rC(e,t){switch(typeof e){case"string":var r=de("vt:lpwstr",Be(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return de((e|0)==e?"vt:i4":"vt:r8",Be(String(e)));case"boolean":return de("vt:bool",e?"true":"false")}if(e instanceof Date)return de("vt:filetime",rf(e));throw new Error("Unable to serialize "+e)}var xt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ma=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],dr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function nC(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function sC(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,a=n?-t:t;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|n}var lg=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,i=e[0][n].length;s<i;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},cg=Re?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Dn(t)})):lg(e)}:lg,ug=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode($a(e,s)));return n.join("").replace(ro,"")},wh=Re?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ro,""):ug(e,t,r)}:ug,dg=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},xy=Re?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):dg(e,t,r)}:dg,fg=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(_i(e,s)));return n.join("")},Jo=Re?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):fg(t,r,n)}:fg,vy=function(e,t){var r=fr(e,t);return r>0?Jo(e,t+4,t+4+r-1):""},yy=vy,wy=function(e,t){var r=fr(e,t);return r>0?Jo(e,t+4,t+4+r-1):""},_y=wy,Ey=function(e,t){var r=2*fr(e,t);return r>0?Jo(e,t+4,t+4+r-1):""},Sy=Ey,Ty=function(t,r){var n=fr(t,r);return n>0?wh(t,r+4,r+4+n):""},by=Ty,ky=function(e,t){var r=fr(e,t);return r>0?Jo(e,t+4,t+4+r):""},Ny=ky,Cy=function(e,t){return nC(e,t)},Wc=Cy,_h=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Re&&(yy=function(t,r){if(!Buffer.isBuffer(t))return vy(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},_y=function(t,r){if(!Buffer.isBuffer(t))return wy(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Sy=function(t,r){if(!Buffer.isBuffer(t))return Ey(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},by=function(t,r){if(!Buffer.isBuffer(t))return Ty(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Ny=function(t,r){if(!Buffer.isBuffer(t))return ky(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Wc=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Cy(t,r)},_h=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var _i=function(e,t){return e[t]},$a=function(e,t){return e[t+1]*256+e[t]},iC=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},fr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ds=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},aC=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function so(e,t){var r="",n,s,i=[],a,o,c,u;switch(t){case"dbcs":if(u=this.l,Re&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode($a(this,u)),u+=2;e*=2;break;case"utf8":r=Jo(this,this.l,this.l+e);break;case"utf16le":e*=2,r=wh(this,this.l,this.l+e);break;case"wstr":return so.call(this,e,"dbcs");case"lpstr-ansi":r=yy(this,this.l),e=4+fr(this,this.l);break;case"lpstr-cp":r=_y(this,this.l),e=4+fr(this,this.l);break;case"lpwstr":r=Sy(this,this.l),e=4+2*fr(this,this.l);break;case"lpp4":e=4+fr(this,this.l),r=by(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+fr(this,this.l),r=Ny(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=_i(this,this.l+e++))!==0;)i.push(Cl(a));r=i.join("");break;case"_wstr":for(e=0,r="";(a=$a(this,this.l+e))!==0;)i.push(Cl(a)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return a=_i(this,u),this.l=u+1,o=so.call(this,e-c,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Cl($a(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return a=_i(this,u),this.l=u+1,o=so.call(this,e-c,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Cl(_i(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=_i(this,this.l),this.l++,n;case 2:return n=(t==="i"?iC:$a)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ds:aC)(this,this.l),this.l+=4,n):(s=fr(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Wc(this,this.l):s=Wc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=xy(this,this.l,e);break}}return this.l+=e,r}var oC=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},lC=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},cC=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function uC(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)cC(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var a=t.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,oC(this,t,this.l);break;case 8:if(n=8,r==="f"){sC(this,t,this.l);break}case 16:break;case-4:n=4,lC(this,t,this.l);break}return this.l+=n,this}function jy(e,t){var r=xy(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ur(e,t){e.l=t,e.read_shift=so,e.chk=jy,e.write_shift=uC}function cn(e,t){e.l+=t}function te(e){var t=Ys(e);return ur(t,0),t}function ir(){var e=[],t=Re?256:2048,r=function(u){var d=te(u);return ur(d,0),d},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},a=function(){return s(),kt(e)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:a,_bufs:e}}function se(e,t,r,n){var s=+t,i;if(!isNaN(s)){n||(n=nF[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var a=e.next(i);s<=127?a.write_shift(1,s):(a.write_shift(1,(s&127)+128),a.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&_h(r)&&e.push(r)}}function io(e,t,r){var n=or(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function hg(e,t,r){var n=or(e);return n.s=io(n.s,t.s,r),n.e=io(n.e,t.s,r),n}function ao(e,t){if(e.cRel&&e.c<0)for(e=or(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=or(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ue(e);return!e.cRel&&e.cRel!=null&&(r=hC(r)),!e.rRel&&e.rRel!=null&&(r=dC(r)),r}function D0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Bt(e.s.c)+":"+(e.e.cRel?"":"$")+Bt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ot(e.s.r)+":"+(e.e.rRel?"":"$")+Ot(e.e.r):ao(e.s,t.biff)+":"+ao(e.e,t.biff)}function Eh(e){return parseInt(fC(e),10)-1}function Ot(e){return""+(e+1)}function dC(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function fC(e){return e.replace(/\$(\d+)$/,"$1")}function Sh(e){for(var t=mC(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Bt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function hC(e){return e.replace(/^([A-Z])/,"$$$1")}function mC(e){return e.replace(/^\$([A-Z])/,"$1")}function pC(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function vt(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Ue(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function vr(e){var t=e.indexOf(":");return t==-1?{s:vt(e),e:vt(e)}:{s:vt(e.slice(0,t)),e:vt(e.slice(t+1))}}function ut(e,t){return typeof t>"u"||typeof t=="number"?ut(e.s,e.e):(typeof e!="string"&&(e=Ue(e)),typeof t!="string"&&(t=Ue(t)),e==t?e:e+":"+t)}function Xe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=e.length;for(r=0;n<i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function mg(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ms(e.z,r?ar(t):t)}catch{}try{return e.w=ms((e.XF||{}).numFmtId||(r?14:0),r?ar(t):t)}catch{return""+t}}function jn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Qo[e.v]||e.v:t==null?mg(e,e.v):mg(e,t))}function ni(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Ay(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,i=e||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?vt(n.origin):n.origin;a=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=Xe(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),a==-1&&(u.e.r=a=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var p={v:t[f][h]},g=a+f,m=o+h;if(u.s.r>g&&(u.s.r=g),u.s.c>m&&(u.s.c=m),u.e.r<g&&(u.e.r=g),u.e.c<m&&(u.e.c=m),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))p=t[f][h];else if(Array.isArray(p.v)&&(p.f=t[f][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||it[14],n.cellDates?(p.t="d",p.w=ms(p.z,ar(p.v))):(p.t="n",p.v=ar(p.v),p.w=ms(p.z,p.v))):p.t="s";if(s)i[g]||(i[g]=[]),i[g][m]&&i[g][m].z&&(p.z=i[g][m].z),i[g][m]=p;else{var x=Ue({c:m,r:g});i[x]&&i[x].z&&(p.z=i[x].z),i[x]=p}}}return u.s.c<1e7&&(i["!ref"]=ut(u)),i}function pa(e,t){return Ay(null,e,t)}function gC(e){return e.read_shift(4,"i")}function Xr(e,t){return t||(t=te(4)),t.write_shift(4,e),t}function $t(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function yt(e,t){var r=!1;return t==null&&(r=!0,t=te(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function xC(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function vC(e,t){return t||(t=te(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Th(e,t){var r=e.l,n=e.read_shift(1),s=$t(e),i=[],a={t:s,h:s};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(xC(e));a.r=i}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function yC(e,t){var r=!1;return t==null&&(r=!0,t=te(15+4*e.t.length)),t.write_shift(1,0),yt(e.t,t),r?t.slice(0,t.l):t}var wC=Th;function _C(e,t){var r=!1;return t==null&&(r=!0,t=te(23+4*e.t.length)),t.write_shift(1,1),yt(e.t,t),t.write_shift(4,1),vC({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function Pr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function si(e,t){return t==null&&(t=te(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ii(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ai(e,t){return t==null&&(t=te(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var EC=$t,Oy=yt;function bh(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Hc(e,t){var r=!1;return t==null&&(r=!0,t=te(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var SC=$t,nf=bh,kh=Hc;function Fy(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?Wc([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ds(t,0)>>2;return r?s/100:s}function Py(e,t){t==null&&(t=te(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Dy(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function TC(e,t){return t||(t=te(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var oi=Dy,ga=TC;function xa(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Js(e,t){return(t||te(8)).write_shift(8,e,"f")}function bC(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=DC[s];u&&(t.rgb=bg(u));break;case 2:t.rgb=bg([a,o,c]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function zc(e,t){if(t||(t=te(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function kC(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function NC(e,t){t||(t=te(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var Ry=2,lr=3,Fl=11,Vc=19,Pl=64,CC=65,jC=71,AC=4108,OC=4126,bt=80,pg={1:{n:"CodePage",t:Ry},2:{n:"Category",t:bt},3:{n:"PresentationFormat",t:bt},4:{n:"ByteCount",t:lr},5:{n:"LineCount",t:lr},6:{n:"ParagraphCount",t:lr},7:{n:"SlideCount",t:lr},8:{n:"NoteCount",t:lr},9:{n:"HiddenCount",t:lr},10:{n:"MultimediaClipCount",t:lr},11:{n:"ScaleCrop",t:Fl},12:{n:"HeadingPairs",t:AC},13:{n:"TitlesOfParts",t:OC},14:{n:"Manager",t:bt},15:{n:"Company",t:bt},16:{n:"LinksUpToDate",t:Fl},17:{n:"CharacterCount",t:lr},19:{n:"SharedDoc",t:Fl},22:{n:"HyperlinksChanged",t:Fl},23:{n:"AppVersion",t:lr,p:"version"},24:{n:"DigSig",t:CC},26:{n:"ContentType",t:bt},27:{n:"ContentStatus",t:bt},28:{n:"Language",t:bt},29:{n:"Version",t:bt},255:{},2147483648:{n:"Locale",t:Vc},2147483651:{n:"Behavior",t:Vc},1919054434:{}},gg={1:{n:"CodePage",t:Ry},2:{n:"Title",t:bt},3:{n:"Subject",t:bt},4:{n:"Author",t:bt},5:{n:"Keywords",t:bt},6:{n:"Comments",t:bt},7:{n:"Template",t:bt},8:{n:"LastAuthor",t:bt},9:{n:"RevNumber",t:bt},10:{n:"EditTime",t:Pl},11:{n:"LastPrinted",t:Pl},12:{n:"CreatedDate",t:Pl},13:{n:"ModifiedDate",t:Pl},14:{n:"PageCount",t:lr},15:{n:"WordCount",t:lr},16:{n:"CharCount",t:lr},17:{n:"Thumbnail",t:jC},18:{n:"Application",t:bt},19:{n:"DocSecurity",t:lr},255:{},2147483648:{n:"Locale",t:Vc},2147483651:{n:"Behavior",t:Vc},1919054434:{}};function FC(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var PC=FC([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),DC=or(PC),Qo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RC={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Dl={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Iy(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Ly(e,t){var r=V3(RC),n=[],s;n[n.length]=dt,n[n.length]=de("Types",null,{xmlns:xt.CT,"xmlns:xsd":xt.xsd,"xmlns:xsi":xt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return de("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=de("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Dl[c][t.bookType]||Dl[c].xlsx}))},a=function(c){(e[c]||[]).forEach(function(u){n[n.length]=de("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Dl[c][t.bookType]||Dl[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=de("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var De={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function My(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function zi(e){var t=[dt,de("Relationships",null,{xmlns:xt.RELS})];return Pt(e["!id"]).forEach(function(r){t[t.length]=de("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Me(e,t,r,n,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[De.HLINK,De.XPATH,De.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}function IC(e){var t=[dt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function xg(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function LC(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function MC(e){var t=[dt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(xg(e[r][0],e[r][1])),t.push(LC("",e[r][0]));return t.push(xg("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function By(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Lc.version+"</meta:generator></office:meta></office:document-meta>"}var Ws=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function R0(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Be(t),n[n.length]=r?de(e,t,r):Nt(e,t))}function $y(e,t){var r=t||{},n=[dt,de("cp:coreProperties",null,{"xmlns:cp":xt.CORE_PROPS,"xmlns:dc":xt.dc,"xmlns:dcterms":xt.dcterms,"xmlns:dcmitype":xt.dcmitype,"xmlns:xsi":xt.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&R0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:rf(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&R0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:rf(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=Ws.length;++i){var a=Ws[i],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&R0(a[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Vi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Uy=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Wy(e){var t=[],r=de;return e||(e={}),e.Application="SheetJS",t[t.length]=dt,t[t.length]=de("Properties",null,{xmlns:xt.EXT_PROPS,"xmlns:vt":xt.vt}),Vi.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Be(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Be(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Hy(e){var t=[dt,de("Properties",null,{xmlns:xt.CUST_PROPS,"xmlns:vt":xt.vt})];if(!e)return t.join("");var r=1;return Pt(e).forEach(function(s){++r,t[t.length]=de("property",rC(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Be(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var vg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function BC(e,t){var r=[];return Pt(vg).map(function(n){for(var s=0;s<Ws.length;++s)if(Ws[s][1]==n)return Ws[s];for(s=0;s<Vi.length;++s)if(Vi[s][1]==n)return Vi[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Nt(vg[n[1]]||n[1],s))}}),de("DocumentProperties",r.join(""),{xmlns:dr.o})}function $C(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Pt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var a=0;a<Ws.length;++a)if(i==Ws[a][1])return;for(a=0;a<Vi.length;++a)if(i==Vi[a][1])return;for(a=0;a<r.length;++a)if(i==r[a])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(de(ig(i),o,{"dt:dt":c}))}}),t&&Pt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var a=t[i],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),s.push(de(ig(i),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+dr.o+'">'+s.join("")+"</"+n+">"}function UC(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var a=te(8);return a.write_shift(4,n),a.write_shift(4,s),a}function yg(e,t){var r=te(4),n=te(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=te(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=UC(t);break;case 31:case 80:for(n=te(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return kt([r,n])}var zy=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function WC(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function wg(e,t,r){var n=te(8),s=[],i=[],a=8,o=0,c=te(8),u=te(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),s.push(u),a+=8+c.length,!t){u=te(8),u.write_shift(4,0),s.unshift(u);var d=[te(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=te(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=kt(d),i.unshift(c),a+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(zy.indexOf(e[o][0])>-1||Uy.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],p=0;if(t){p=+t[e[o][0]];var g=r[p];if(g.p=="version"&&typeof h=="string"){var m=h.split(".");h=(+m[0]<<16)+(+m[1]||0)}c=yg(g.t,h)}else{var x=WC(h);x==-1&&(x=31,h=String(h)),c=yg(x,h)}i.push(c),u=te(8),u.write_shift(4,t?p:2+o),s.push(u),a+=8+c.length}var w=8*(i.length+1);for(o=0;o<i.length;++o)s[o].write_shift(4,w),w+=i[o].length;return n.write_shift(4,a),n.write_shift(4,i.length),kt([n].concat(s).concat(i))}function _g(e,t,r,n,s,i){var a=te(s?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,We.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,s?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,s?68:48);var c=wg(e,r,n);if(o.push(c),s){var u=wg(s,null,null);a.write_shift(16,i,"hex"),a.write_shift(4,68+c.length),o.push(u)}return kt(o)}function HC(e,t){t||(t=te(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function zC(e,t){return e.read_shift(t)===1}function Gt(e,t){return t||(t=te(2)),t.write_shift(2,+!!e),t}function Vy(e){return e.read_shift(2,"u")}function Sr(e,t){return t||(t=te(2)),t.write_shift(2,e),t}function Gy(e,t,r){return r||(r=te(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function qy(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?e.read_shift(n,s):"";return a}function VC(e){var t=e.t||"",r=te(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=te(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return kt(s)}function GC(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function qC(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):GC(e,n,r)}function KC(e,t,r){if(r.biff>5)return qC(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Ky(e,t,r){return r||(r=te(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Eg(e,t){t||(t=te(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function XC(e){var t=te(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(i==28)n=n.slice(1),Eg(n,t);else if(i&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&Eg(s>-1?n.slice(s+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Qs(e,t,r,n){return n||(n=te(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function YC(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),i=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[s,i,a]}function JC(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function Xy(e,t){return t||(t=te(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Nh(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=te(s);return i.write_shift(2,n),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function QC(e,t){var r=!t||t.biff==8,n=te(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function ZC(e,t){var r=!t||t.biff>=8?2:1,n=te(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function ej(e,t){var r=te(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=VC(e[s]);var i=kt([r].concat(n));return i.parts=[r.length].concat(n.map(function(a){return a.length})),i}function tj(){var e=te(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function rj(e){var t=te(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function nj(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,i=te(s);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function sj(e,t,r,n){var s=te(10);return Qs(e,t,n,s),s.write_shift(4,r),s}function ij(e,t,r,n,s){var i=!s||s.biff==8,a=te(8+ +i+(1+i)*r.length);return Qs(e,t,n,a),a.write_shift(2,r.length),i&&a.write_shift(1,1),a.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),a}function aj(e,t,r,n){var s=r&&r.biff==5;n||(n=te(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function oj(e,t){var r=t.biff==8||!t.biff?4:2,n=te(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Sg(e,t,r,n){var s=r&&r.biff==5;n||(n=te(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function lj(e){var t=te(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function cj(e,t,r,n,s,i){var a=te(8);return Qs(e,t,n,a),Gy(r,i,a),a}function uj(e,t,r,n){var s=te(14);return Qs(e,t,n,s),Js(r,s),s}function dj(e,t,r){if(r.biff<8)return fj(e,t,r);for(var n=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(YC(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function fj(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=qy(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function hj(e){var t=te(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Xy(e[r],t);return t}function mj(e){var t=te(24),r=vt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return kt([t,XC(e[1])])}function pj(e){var t=e[1].Tooltip,r=te(10+2*(t.length+1));r.write_shift(2,2048);var n=vt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function gj(e){return e||(e=te(4)),e.write_shift(2,1),e.write_shift(2,1),e}function xj(e,t,r){if(!r.cellStyles)return cn(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),i=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:i,w:a,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function vj(e,t){var r=te(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function yj(e){for(var t=te(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function wj(e,t,r){var n=te(15);return el(n,e,t),n.write_shift(8,r,"f"),n}function _j(e,t,r){var n=te(9);return el(n,e,t),n.write_shift(2,r),n}var Ej=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=gh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=Ys(1);switch(c.type){case"base64":d=Wr(Cn(o));break;case"binary":d=Wr(o);break;case"buffer":case"array":d=o;break}ur(d,0);var f=d.read_shift(1),h=!!(f&136),p=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,x=521;f==2&&(m=d.read_shift(2)),d.l+=3,f!=2&&(m=d.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(x=d.read_shift(2));var w=d.read_shift(2),v=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(v=e[d[d.l]]),d.l+=1,d.l+=2),g&&(d.l+=36);for(var y=[],_={},C=Math.min(d.length,f==2?521:x-10-(p?264:0)),E=g?32:11;d.l<C&&d[d.l]!=13;)switch(_={},_.name=Ps.utils.decode(v,d.slice(d.l,d.l+E)).replace(/[\u0000\r\n].*$/g,""),d.l+=E,_.type=String.fromCharCode(d.read_shift(1)),f!=2&&!g&&(_.offset=d.read_shift(4)),_.len=d.read_shift(1),f==2&&(_.offset=d.read_shift(2)),_.dec=d.read_shift(1),_.name.length&&y.push(_),f!=2&&(d.l+=g?13:14),_.type){case"B":(!p||_.len!=8)&&c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(d[d.l]!==13&&(d.l=x-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=x;var T=0,M=0;for(u[0]=[],M=0;M!=y.length;++M)u[0][M]=y[M].name;for(;m-- >0;){if(d[d.l]===42){d.l+=w;continue}for(++d.l,u[++T]=[],M=0,M=0;M!=y.length;++M){var A=d.slice(d.l,d.l+y[M].len);d.l+=y[M].len,ur(A,0);var B=Ps.utils.decode(v,A);switch(y[M].type){case"C":B.trim().length&&(u[T][M]=B.replace(/\s+$/,""));break;case"D":B.length===8?u[T][M]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):u[T][M]=B;break;case"F":u[T][M]=parseFloat(B.trim());break;case"+":case"I":u[T][M]=g?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":u[T][M]=!0;break;case"N":case"F":u[T][M]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[T][M]="##MEMO##"+(g?parseInt(B.trim(),10):A.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(u[T][M]=+B||0);break;case"@":u[T][M]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":u[T][M]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":u[T][M]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[T][M]=-A.read_shift(-8,"f");break;case"B":if(p&&y[M].len==8){u[T][M]=A.read_shift(8,"f");break}case"G":case"P":A.l+=y[M].len;break;case"0":if(y[M].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[M].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=y,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=pa(r(o,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function s(o,c){try{return ni(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var u=c||{};if(+u.codepage>=0&&jo(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=ir(),f=Yc(o,{header:1,raw:!0,cellDates:!0}),h=f[0],p=f.slice(1),g=o["!cols"]||[],m=0,x=0,w=0,v=1;for(m=0;m<h.length;++m){if(((g[m]||{}).DBF||{}).name){h[m]=g[m].DBF.name,++w;continue}if(h[m]!=null){if(++w,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(x=0;x<1024;++x)if(h.indexOf(h[m]+"_"+x)==-1){h[m]+="_"+x;break}}}}var y=Xe(o["!ref"]),_=[],C=[],E=[];for(m=0;m<=y.e.c-y.s.c;++m){var T="",M="",A=0,B=[];for(x=0;x<p.length;++x)p[x][m]!=null&&B.push(p[x][m]);if(B.length==0||h[m]==null){_[m]="?";continue}for(x=0;x<B.length;++x){switch(typeof B[x]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=B[x]instanceof Date?"D":"C";break;default:M="C"}A=Math.max(A,String(B[x]).length),T=T&&T!=M?"C":M}A>250&&(A=250),M=((g[m]||{}).DBF||{}).type,M=="C"&&g[m].DBF.len>A&&(A=g[m].DBF.len),T=="B"&&M=="N"&&(T="N",E[m]=g[m].DBF.dec,A=g[m].DBF.len),C[m]=T=="C"||M=="N"?A:i[T]||0,v+=C[m],_[m]=T}var z=d.next(32);for(z.write_shift(4,318902576),z.write_shift(4,p.length),z.write_shift(2,296+32*w),z.write_shift(2,v),m=0;m<4;++m)z.write_shift(4,0);for(z.write_shift(4,0|(+t[Jv]||3)<<8),m=0,x=0;m<h.length;++m)if(h[m]!=null){var U=d.next(32),V=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);U.write_shift(1,V,"sbcs"),U.write_shift(1,_[m]=="?"?"C":_[m],"sbcs"),U.write_shift(4,x),U.write_shift(1,C[m]||i[_[m]]||0),U.write_shift(1,E[m]||0),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(1,0),U.write_shift(4,0),U.write_shift(4,0),x+=C[m]||i[_[m]]||0}var pe=d.next(264);for(pe.write_shift(4,13),m=0;m<65;++m)pe.write_shift(4,0);for(m=0;m<p.length;++m){var ne=d.next(v);for(ne.write_shift(1,0),x=0;x<h.length;++x)if(h[x]!=null)switch(_[x]){case"L":ne.write_shift(1,p[m][x]==null?63:p[m][x]?84:70);break;case"B":ne.write_shift(8,p[m][x]||0,"f");break;case"N":var le="0";for(typeof p[m][x]=="number"&&(le=p[m][x].toFixed(E[x]||0)),w=0;w<C[x]-le.length;++w)ne.write_shift(1,32);ne.write_shift(1,le,"sbcs");break;case"D":p[m][x]?(ne.write_shift(4,("0000"+p[m][x].getFullYear()).slice(-4),"sbcs"),ne.write_shift(2,("00"+(p[m][x].getMonth()+1)).slice(-2),"sbcs"),ne.write_shift(2,("00"+p[m][x].getDate()).slice(-2),"sbcs")):ne.write_shift(8,"00000000","sbcs");break;case"C":var ee=String(p[m][x]!=null?p[m][x]:"").slice(0,C[x]);for(ne.write_shift(1,ee,"sbcs"),w=0;w<C[x]-ee.length;++w)ne.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),Sj=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Pt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var g=e[p];return typeof g=="number"?qp(g):g},n=function(h,p,g){var m=p.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?h:qp(m)};e["|"]=254;function s(h,p){switch(p.type){case"base64":return i(Cn(h),p);case"binary":return i(h,p);case"buffer":return i(Re&&Buffer.isBuffer(h)?h.toString("binary"):Xo(h),p);case"array":return i(Iu(h),p)}throw new Error("Unrecognized type "+p.type)}function i(h,p){var g=h.split(/[\n\r]+/),m=-1,x=-1,w=0,v=0,y=[],_=[],C=null,E={},T=[],M=[],A=[],B=0,z;for(+p.codepage>=0&&jo(+p.codepage);w!==g.length;++w){B=0;var U=g[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),V=U.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),pe=V[0],ne;if(U.length>0)switch(pe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&_.push(U.slice(3).replace(/;;/g,";"));break;case"C":var le=!1,ee=!1,W=!1,G=!1,Z=-1,Q=-1;for(v=1;v<V.length;++v)switch(V[v].charAt(0)){case"A":break;case"X":x=parseInt(V[v].slice(1))-1,ee=!0;break;case"Y":for(m=parseInt(V[v].slice(1))-1,ee||(x=0),z=y.length;z<=m;++z)y[z]=[];break;case"K":ne=V[v].slice(1),ne.charAt(0)==='"'?ne=ne.slice(1,ne.length-1):ne==="TRUE"?ne=!0:ne==="FALSE"?ne=!1:isNaN(_n(ne))?isNaN(Oo(ne).getDate())||(ne=Xt(ne)):(ne=_n(ne),C!==null&&cy(C)&&(ne=hy(ne))),le=!0;break;case"E":G=!0;var k=_A(V[v].slice(1),{r:m,c:x});y[m][x]=[y[m][x],k];break;case"S":W=!0,y[m][x]=[y[m][x],"S5S"];break;case"G":break;case"R":Z=parseInt(V[v].slice(1))-1;break;case"C":Q=parseInt(V[v].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+U)}if(le&&(y[m][x]&&y[m][x].length==2?y[m][x][0]=ne:y[m][x]=ne,C=null),W){if(G)throw new Error("SYLK shared formula cannot have own formula");var P=Z>-1&&y[Z][Q];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");y[m][x][1]=EA(P[1],{r:m-Z,c:x-Q})}break;case"F":var I=0;for(v=1;v<V.length;++v)switch(V[v].charAt(0)){case"X":x=parseInt(V[v].slice(1))-1,++I;break;case"Y":for(m=parseInt(V[v].slice(1))-1,z=y.length;z<=m;++z)y[z]=[];break;case"M":B=parseInt(V[v].slice(1))/20;break;case"F":break;case"G":break;case"P":C=_[parseInt(V[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=V[v].slice(1).split(" "),z=parseInt(A[0],10);z<=parseInt(A[1],10);++z)B=parseInt(A[2],10),M[z-1]=B===0?{hidden:!0}:{wch:B},Ch(M[z-1]);break;case"C":x=parseInt(V[v].slice(1))-1,M[x]||(M[x]={});break;case"R":m=parseInt(V[v].slice(1))-1,T[m]||(T[m]={}),B>0?(T[m].hpt=B,T[m].hpx=ew(B)):B===0&&(T[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+U)}I<1&&(C=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+U)}}return T.length>0&&(E["!rows"]=T),M.length>0&&(E["!cols"]=M),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,E]}function a(h,p){var g=s(h,p),m=g[0],x=g[1],w=pa(m,p);return Pt(x).forEach(function(v){w[v]=x[v]}),w}function o(h,p){return ni(a(h,p),p)}function c(h,p,g,m){var x="C;Y"+(g+1)+";X"+(m+1)+";K";switch(h.t){case"n":x+=h.v||0,h.f&&!h.F&&(x+=";E"+Ah(h.f,{r:g,c:m}));break;case"b":x+=h.v?"TRUE":"FALSE";break;case"e":x+=h.w||h.v;break;case"d":x+='"'+(h.w||h.v)+'"';break;case"s":x+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function u(h,p){p.forEach(function(g,m){var x="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?x+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Gc(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=qc(g.wpx)),typeof g.wch=="number"&&(x+=Math.round(g.wch))),x.charAt(x.length-1)!=" "&&h.push(x)})}function d(h,p){p.forEach(function(g,m){var x="F;";g.hidden?x+="M0;":g.hpt?x+="M"+20*g.hpt+";":g.hpx&&(x+="M"+20*Kc(g.hpx)+";"),x.length>2&&h.push(x+"R"+(m+1))})}function f(h,p){var g=["ID;PWXL;N;E"],m=[],x=Xe(h["!ref"]),w,v=Array.isArray(h),y=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&u(g,h["!cols"]),h["!rows"]&&d(g,h["!rows"]),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var _=x.s.r;_<=x.e.r;++_)for(var C=x.s.c;C<=x.e.c;++C){var E=Ue({r:_,c:C});w=v?(h[_]||[])[C]:h[E],!(!w||w.v==null&&(!w.f||w.F))&&m.push(c(w,h,_,C))}return g.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),Tj=function(){function e(i,a){switch(a.type){case"base64":return t(Cn(i),a);case"binary":return t(i,a);case"buffer":return t(Re&&Buffer.isBuffer(i)?i.toString("binary"):Xo(i),a);case"array":return t(Iu(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){for(var o=i.split(`
`),c=-1,u=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=o[d].trim().split(","),p=h[0],g=h[1];++d;for(var m=o[d]||"";(m.match(/["]/g)||[]).length&1&&d<o.length-1;)m+=`
`+o[++d];switch(m=m.trim(),+p){case-1:if(m==="BOT"){f[++c]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[c][u]=!0:m==="FALSE"?f[c][u]=!1:isNaN(_n(g))?isNaN(Oo(g).getDate())?f[c][u]=g:f[c][u]=Xt(g):f[c][u]=_n(g),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[c][u++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(i,a){return pa(e(i,a),a)}function n(i,a){return ni(r(i,a),a)}var s=function(){var i=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},a=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=Xe(c["!ref"]),f,h=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){a(u,-1,0,"BOT");for(var g=d.s.c;g<=d.e.c;++g){var m=Ue({r:p,c:g});if(f=h?(c[p]||[])[g]:c[m],!f){a(u,1,0,"");continue}switch(f.t){case"n":var x=f.w;!x&&f.v!=null&&(x=f.v),x==null?f.f&&!f.F?a(u,1,0,"="+f.f):a(u,1,0,""):a(u,0,x,"V");break;case"b":a(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=ms(f.z||it[14],ar(Xt(f.v)))),a(u,0,f.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var w=`\r
`,v=u.join(w);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),Yy=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var p=f.split(`
`),g=-1,m=-1,x=0,w=[];x!==p.length;++x){var v=p[x].trim().split(":");if(v[0]==="cell"){var y=vt(v[1]);if(w.length<=y.r)for(g=w.length;g<=y.r;++g)w[g]||(w[g]=[]);switch(g=y.r,m=y.c,v[2]){case"t":w[g][m]=e(v[3]);break;case"v":w[g][m]=+v[3];break;case"vtf":var _=v[v.length-1];case"vtc":switch(v[3]){case"nl":w[g][m]=!!+v[4];break;default:w[g][m]=+v[4];break}v[2]=="vtf"&&(w[g][m]=[w[g][m],_])}}}return h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),w}function n(f,h){return pa(r(f,h),h)}function s(f,h){return ni(n(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],g,m="",x=vr(f["!ref"]),w=Array.isArray(f),v=x.s.r;v<=x.e.r;++v)for(var y=x.s.c;y<=x.e.c;++y)if(m=Ue({r:v,c:y}),g=w?(f[v]||[])[y]:f[m],!(!g||g.v==null||g.t==="z")){switch(p=["cell",m,"t"],g.t){case"s":case"str":p.push(t(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=t(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var _=ar(Xt(g.v));p[2]="vtc",p[3]="nd",p[4]=""+_,p[5]=g.w||ms(g.z||it[14],_);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[i,a,o,a,u(f),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),bj=function(){function e(d,f,h,p,g){g.raw?f[h][p]=d:d===""||(d==="TRUE"?f[h][p]=!0:d==="FALSE"?f[h][p]=!1:isNaN(_n(d))?isNaN(Oo(d).getDate())?f[h][p]=d:f[h][p]=Xt(d):f[h][p]=_n(d))}function t(d,f){var h=f||{},p=[];if(!d||d.length===0)return p;for(var g=d.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var x=10,w=0,v=0;v<=m;++v)w=g[v].indexOf(" "),w==-1?w=g[v].length:w++,x=Math.max(x,w);for(v=0;v<=m;++v){p[v]=[];var y=0;for(e(g[v].slice(0,x).trim(),p,v,y,h),y=1;y<=(g[v].length-x)/10+1;++y)e(g[v].slice(x+(y-1)*10,x+y*10).trim(),p,v,y,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var f={},h=!1,p=0,g=0;p<d.length;++p)(g=d.charCodeAt(p))==34?h=!h:!h&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&g.push([f[p],p]);if(!g.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&g.push([f[p],p])}return g.sort(function(m,x){return m[0]-x[0]||n[m[1]]-n[x[1]]}),r[g.pop()[1]]||44}function i(d,f){var h=f||{},p="",g=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=s(d.slice(0,1024)):h&&h.FS?p=h.FS:p=s(d.slice(0,1024));var x=0,w=0,v=0,y=0,_=0,C=p.charCodeAt(0),E=!1,T=0,M=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var A=h.dateNF!=null?U3(h.dateNF):null;function B(){var z=d.slice(y,_),U={};if(z.charAt(0)=='"'&&z.charAt(z.length-1)=='"'&&(z=z.slice(1,-1).replace(/""/g,'"')),z.length===0)U.t="z";else if(h.raw)U.t="s",U.v=z;else if(z.trim().length===0)U.t="s",U.v=z;else if(z.charCodeAt(0)==61)z.charCodeAt(1)==34&&z.charCodeAt(z.length-1)==34?(U.t="s",U.v=z.slice(2,-1).replace(/""/g,'"')):SA(z)?(U.t="n",U.f=z.slice(1)):(U.t="s",U.v=z);else if(z=="TRUE")U.t="b",U.v=!0;else if(z=="FALSE")U.t="b",U.v=!1;else if(!isNaN(v=_n(z)))U.t="n",h.cellText!==!1&&(U.w=z),U.v=v;else if(!isNaN(Oo(z).getDate())||A&&z.match(A)){U.z=h.dateNF||it[14];var V=0;A&&z.match(A)&&(z=W3(z,h.dateNF,z.match(A)||[]),V=1),h.cellDates?(U.t="d",U.v=Xt(z,V)):(U.t="n",U.v=ar(Xt(z,V))),h.cellText!==!1&&(U.w=ms(U.z,U.v instanceof Date?ar(U.v):U.v)),h.cellNF||delete U.z}else U.t="s",U.v=z;if(U.t=="z"||(h.dense?(g[x]||(g[x]=[]),g[x][w]=U):g[Ue({c:w,r:x})]=U),y=_+1,M=d.charCodeAt(y),m.e.c<w&&(m.e.c=w),m.e.r<x&&(m.e.r=x),T==C)++w;else if(w=0,++x,h.sheetRows&&h.sheetRows<=x)return!0}e:for(;_<d.length;++_)switch(T=d.charCodeAt(_)){case 34:M===34&&(E=!E);break;case C:case 10:case 13:if(!E&&B())break e;break}return _-y>0&&B(),g["!ref"]=ut(m),g}function a(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,f):pa(t(d,f),f)}function o(d,f){var h="",p=f.type=="string"?[0,0,0,0]:LF(d,f);switch(f.type){case"base64":h=Cn(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof Ps<"u"?h=Ps.utils.decode(f.codepage,d):h=Re&&Buffer.isBuffer(d)?d.toString("binary"):Xo(d);break;case"array":h=Iu(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=no(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=no(h):f.type=="binary"&&typeof Ps<"u"&&f.codepage&&(h=Ps.utils.decode(f.codepage,Ps.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?Yy.to_sheet(f.type=="string"?h:no(h),f):a(h,f)}function c(d,f){return ni(o(d,f),f)}function u(d){for(var f=[],h=Xe(d["!ref"]),p,g=Array.isArray(d),m=h.s.r;m<=h.e.r;++m){for(var x=[],w=h.s.c;w<=h.e.c;++w){var v=Ue({r:m,c:w});if(p=g?(d[m]||[])[w]:d[v],!p||p.v==null){x.push("          ");continue}for(var y=(p.w||(jn(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";x.push(y+(w===0?" ":""))}f.push(x.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}(),Tg=function(){function e(k,P,I){if(k){ur(k,k.l||0);for(var R=I.Enum||Z;k.l<k.length;){var Y=k.read_shift(2),ce=R[Y]||R[65535],ge=k.read_shift(2),L=k.l+ge,H=ce.f&&ce.f(k,ge,I);if(k.l=L,P(H,ce,Y))return}}}function t(k,P){switch(P.type){case"base64":return r(Wr(Cn(k)),P);case"binary":return r(Wr(k),P);case"buffer":case"array":return r(k,P)}throw"Unsupported type "+P.type}function r(k,P){if(!k)return k;var I=P||{},R=I.dense?[]:{},Y="Sheet1",ce="",ge=0,L={},H=[],fe=[],ie={s:{r:0,c:0},e:{r:0,c:0}},Se=I.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)I.Enum=Z,e(k,function(Ee,_r,un){switch(un){case 0:I.vers=Ee,Ee>=4096&&(I.qpro=!0);break;case 6:ie=Ee;break;case 204:Ee&&(ce=Ee);break;case 222:ce=Ee;break;case 15:case 51:I.qpro||(Ee[1].v=Ee[1].v.slice(1));case 13:case 14:case 16:un==14&&(Ee[2]&112)==112&&(Ee[2]&15)>1&&(Ee[2]&15)<15&&(Ee[1].z=I.dateNF||it[14],I.cellDates&&(Ee[1].t="d",Ee[1].v=hy(Ee[1].v))),I.qpro&&Ee[3]>ge&&(R["!ref"]=ut(ie),L[Y]=R,H.push(Y),R=I.dense?[]:{},ie={s:{r:0,c:0},e:{r:0,c:0}},ge=Ee[3],Y=ce||"Sheet"+(ge+1),ce="");var Ts=I.dense?(R[Ee[0].r]||[])[Ee[0].c]:R[Ue(Ee[0])];if(Ts){Ts.t=Ee[1].t,Ts.v=Ee[1].v,Ee[1].z!=null&&(Ts.z=Ee[1].z),Ee[1].f!=null&&(Ts.f=Ee[1].f);break}I.dense?(R[Ee[0].r]||(R[Ee[0].r]=[]),R[Ee[0].r][Ee[0].c]=Ee[1]):R[Ue(Ee[0])]=Ee[1];break}},I);else if(k[2]==26||k[2]==14)I.Enum=Q,k[2]==14&&(I.qpro=!0,k.l=0),e(k,function(Ee,_r,un){switch(un){case 204:Y=Ee;break;case 22:Ee[1].v=Ee[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ee[3]>ge&&(R["!ref"]=ut(ie),L[Y]=R,H.push(Y),R=I.dense?[]:{},ie={s:{r:0,c:0},e:{r:0,c:0}},ge=Ee[3],Y="Sheet"+(ge+1)),Se>0&&Ee[0].r>=Se)break;I.dense?(R[Ee[0].r]||(R[Ee[0].r]=[]),R[Ee[0].r][Ee[0].c]=Ee[1]):R[Ue(Ee[0])]=Ee[1],ie.e.c<Ee[0].c&&(ie.e.c=Ee[0].c),ie.e.r<Ee[0].r&&(ie.e.r=Ee[0].r);break;case 27:Ee[14e3]&&(fe[Ee[14e3][0]]=Ee[14e3][1]);break;case 1537:fe[Ee[0]]=Ee[1],Ee[0]==ge&&(Y=Ee[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(R["!ref"]=ut(ie),L[ce||Y]=R,H.push(ce||Y),!fe.length)return{SheetNames:H,Sheets:L};for(var Te={},He=[],Fe=0;Fe<fe.length;++Fe)L[H[Fe]]?(He.push(fe[Fe]||H[Fe]),Te[fe[Fe]]=L[fe[Fe]]||L[H[Fe]]):(He.push(fe[Fe]),Te[fe[Fe]]={"!ref":"A1"});return{SheetNames:He,Sheets:Te}}function n(k,P){var I=P||{};if(+I.codepage>=0&&jo(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var R=ir(),Y=Xe(k["!ref"]),ce=Array.isArray(k),ge=[];he(R,0,i(1030)),he(R,6,c(Y));for(var L=Math.min(Y.e.r,8191),H=Y.s.r;H<=L;++H)for(var fe=Ot(H),ie=Y.s.c;ie<=Y.e.c;++ie){H===Y.s.r&&(ge[ie]=Bt(ie));var Se=ge[ie]+fe,Te=ce?(k[H]||[])[ie]:k[Se];if(!(!Te||Te.t=="z"))if(Te.t=="n")(Te.v|0)==Te.v&&Te.v>=-32768&&Te.v<=32767?he(R,13,p(H,ie,Te.v)):he(R,14,m(H,ie,Te.v));else{var He=jn(Te);he(R,15,f(H,ie,He.slice(0,239)))}}return he(R,1),R.end()}function s(k,P){var I=P||{};if(+I.codepage>=0&&jo(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var R=ir();he(R,0,a(k));for(var Y=0,ce=0;Y<k.SheetNames.length;++Y)(k.Sheets[k.SheetNames[Y]]||{})["!ref"]&&he(R,27,G(k.SheetNames[Y],ce++));var ge=0;for(Y=0;Y<k.SheetNames.length;++Y){var L=k.Sheets[k.SheetNames[Y]];if(!(!L||!L["!ref"])){for(var H=Xe(L["!ref"]),fe=Array.isArray(L),ie=[],Se=Math.min(H.e.r,8191),Te=H.s.r;Te<=Se;++Te)for(var He=Ot(Te),Fe=H.s.c;Fe<=H.e.c;++Fe){Te===H.s.r&&(ie[Fe]=Bt(Fe));var Ee=ie[Fe]+He,_r=fe?(L[Te]||[])[Fe]:L[Ee];if(!(!_r||_r.t=="z"))if(_r.t=="n")he(R,23,B(Te,Fe,ge,_r.v));else{var un=jn(_r);he(R,22,T(Te,Fe,ge,un.slice(0,239)))}}++ge}}return he(R,1),R.end()}function i(k){var P=te(2);return P.write_shift(2,k),P}function a(k){var P=te(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var I=0,R=0,Y=0,ce=0;ce<k.SheetNames.length;++ce){var ge=k.SheetNames[ce],L=k.Sheets[ge];if(!(!L||!L["!ref"])){++Y;var H=vr(L["!ref"]);I<H.e.r&&(I=H.e.r),R<H.e.c&&(R=H.e.c)}}return I>8191&&(I=8191),P.write_shift(2,I),P.write_shift(1,Y),P.write_shift(1,R),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function o(k,P,I){var R={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&I.qpro?(R.s.c=k.read_shift(1),k.l++,R.s.r=k.read_shift(2),R.e.c=k.read_shift(1),k.l++,R.e.r=k.read_shift(2),R):(R.s.c=k.read_shift(2),R.s.r=k.read_shift(2),P==12&&I.qpro&&(k.l+=2),R.e.c=k.read_shift(2),R.e.r=k.read_shift(2),P==12&&I.qpro&&(k.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function c(k){var P=te(8);return P.write_shift(2,k.s.c),P.write_shift(2,k.s.r),P.write_shift(2,k.e.c),P.write_shift(2,k.e.r),P}function u(k,P,I){var R=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(R[0].c=k.read_shift(1),R[3]=k.read_shift(1),R[0].r=k.read_shift(2),k.l+=2):(R[2]=k.read_shift(1),R[0].c=k.read_shift(2),R[0].r=k.read_shift(2)),R}function d(k,P,I){var R=k.l+P,Y=u(k,P,I);if(Y[1].t="s",I.vers==20768){k.l++;var ce=k.read_shift(1);return Y[1].v=k.read_shift(ce,"utf8"),Y}return I.qpro&&k.l++,Y[1].v=k.read_shift(R-k.l,"cstr"),Y}function f(k,P,I){var R=te(7+I.length);R.write_shift(1,255),R.write_shift(2,P),R.write_shift(2,k),R.write_shift(1,39);for(var Y=0;Y<R.length;++Y){var ce=I.charCodeAt(Y);R.write_shift(1,ce>=128?95:ce)}return R.write_shift(1,0),R}function h(k,P,I){var R=u(k,P,I);return R[1].v=k.read_shift(2,"i"),R}function p(k,P,I){var R=te(7);return R.write_shift(1,255),R.write_shift(2,P),R.write_shift(2,k),R.write_shift(2,I,"i"),R}function g(k,P,I){var R=u(k,P,I);return R[1].v=k.read_shift(8,"f"),R}function m(k,P,I){var R=te(13);return R.write_shift(1,255),R.write_shift(2,P),R.write_shift(2,k),R.write_shift(8,I,"f"),R}function x(k,P,I){var R=k.l+P,Y=u(k,P,I);if(Y[1].v=k.read_shift(8,"f"),I.qpro)k.l=R;else{var ce=k.read_shift(2);_(k.slice(k.l,k.l+ce),Y),k.l+=ce}return Y}function w(k,P,I){var R=P&32768;return P&=-32769,P=(R?k:0)+(P>=8192?P-16384:P),(R?"":"$")+(I?Bt(P):Ot(P))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(k,P){ur(k,0);for(var I=[],R=0,Y="",ce="",ge="",L="";k.l<k.length;){var H=k[k.l++];switch(H){case 0:I.push(k.read_shift(8,"f"));break;case 1:ce=w(P[0].c,k.read_shift(2),!0),Y=w(P[0].r,k.read_shift(2),!1),I.push(ce+Y);break;case 2:{var fe=w(P[0].c,k.read_shift(2),!0),ie=w(P[0].r,k.read_shift(2),!1);ce=w(P[0].c,k.read_shift(2),!0),Y=w(P[0].r,k.read_shift(2),!1),I.push(fe+ie+":"+ce+Y)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(k.read_shift(2));break;case 6:{for(var Se="";H=k[k.l++];)Se+=String.fromCharCode(H);I.push('"'+Se.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:L=I.pop(),ge=I.pop(),I.push(["AND","OR"][H-20]+"("+ge+","+L+")");break;default:if(H<32&&y[H])L=I.pop(),ge=I.pop(),I.push(ge+y[H]+L);else if(v[H]){if(R=v[H][1],R==69&&(R=k[k.l++]),R>I.length){console.error("WK1 bad formula parse 0x"+H.toString(16)+":|"+I.join("|")+"|");return}var Te=I.slice(-R);I.length-=R,I.push(v[H][0]+"("+Te.join(",")+")")}else return H<=7?console.error("WK1 invalid opcode "+H.toString(16)):H<=24?console.error("WK1 unsupported op "+H.toString(16)):H<=30?console.error("WK1 invalid opcode "+H.toString(16)):H<=115?console.error("WK1 unsupported function opcode "+H.toString(16)):console.error("WK1 unrecognized opcode "+H.toString(16))}}I.length==1?P[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function C(k){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=k.read_shift(2),P[3]=k[k.l++],P[0].c=k[k.l++],P}function E(k,P){var I=C(k);return I[1].t="s",I[1].v=k.read_shift(P-4,"cstr"),I}function T(k,P,I,R){var Y=te(6+R.length);Y.write_shift(2,k),Y.write_shift(1,I),Y.write_shift(1,P),Y.write_shift(1,39);for(var ce=0;ce<R.length;++ce){var ge=R.charCodeAt(ce);Y.write_shift(1,ge>=128?95:ge)}return Y.write_shift(1,0),Y}function M(k,P){var I=C(k);I[1].v=k.read_shift(2);var R=I[1].v>>1;if(I[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return I[1].v=R,I}function A(k,P){var I=C(k),R=k.read_shift(4),Y=k.read_shift(4),ce=k.read_shift(2);if(ce==65535)return R===0&&Y===3221225472?(I[1].t="e",I[1].v=15):R===0&&Y===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var ge=ce&32768;return ce=(ce&32767)-16446,I[1].v=(1-ge*2)*(Y*Math.pow(2,ce+32)+R*Math.pow(2,ce)),I}function B(k,P,I,R){var Y=te(14);if(Y.write_shift(2,k),Y.write_shift(1,I),Y.write_shift(1,P),R==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var ce=0,ge=0,L=0,H=0;return R<0&&(ce=1,R=-R),ge=Math.log2(R)|0,R/=Math.pow(2,ge-31),H=R>>>0,H&2147483648||(R/=2,++ge,H=R>>>0),R-=H,H|=2147483648,H>>>=0,R*=Math.pow(2,32),L=R>>>0,Y.write_shift(4,L),Y.write_shift(4,H),ge+=16383+(ce?32768:0),Y.write_shift(2,ge),Y}function z(k,P){var I=A(k);return k.l+=P-14,I}function U(k,P){var I=C(k),R=k.read_shift(4);return I[1].v=R>>6,I}function V(k,P){var I=C(k),R=k.read_shift(8,"f");return I[1].v=R,I}function pe(k,P){var I=V(k);return k.l+=P-10,I}function ne(k,P){return k[k.l+P-1]==0?k.read_shift(P,"cstr"):""}function le(k,P){var I=k[k.l++];I>P-1&&(I=P-1);for(var R="";R.length<I;)R+=String.fromCharCode(k[k.l++]);return R}function ee(k,P,I){if(!(!I.qpro||P<21)){var R=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var Y=k.read_shift(P-21,"cstr");return[R,Y]}}function W(k,P){for(var I={},R=k.l+P;k.l<R;){var Y=k.read_shift(2);if(Y==14e3){for(I[Y]=[0,""],I[Y][0]=k.read_shift(2);k[k.l];)I[Y][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return I}function G(k,P){var I=te(5+k.length);I.write_shift(2,14e3),I.write_shift(2,P);for(var R=0;R<k.length;++R){var Y=k.charCodeAt(R);I[I.l++]=Y>127?95:Y}return I[I.l++]=0,I}var Z={0:{n:"BOF",f:Vy},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ne},222:{n:"SHEETNAMELP",f:le},65535:{n:""}},Q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:M},25:{n:"FORMULA19",f:z},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:W},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:U},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:pe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ne},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}(),kj=/^\s|\s$|[\t\n\r]/;function Jy(e,t){if(!t.bookSST)return"";var r=[dt];r[r.length]=de("sst",null,{xmlns:ma[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(kj)&&(i+=' xml:space="preserve"'),i+=">"+Be(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Nj(e){return[e.read_shift(4),e.read_shift(4)]}function Cj(e,t){return t||(t=te(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var jj=yC;function Aj(e){var t=ir();se(t,159,Cj(e));for(var r=0;r<e.length;++r)se(t,19,jj(e[r]));return se(t,160),t.end()}function Oj(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Qy(e){var t=0,r,n=Oj(e),s=n.length+1,i,a,o,c,u;for(r=Ys(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^a;return t^52811}var Fj=function(){function e(s,i){switch(i.type){case"base64":return t(Cn(s),i);case"binary":return t(s,i);case"buffer":return t(Re&&Buffer.isBuffer(s)?s.toString("binary"):Xo(s),i);case"array":return t(Iu(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var a=i||{},o=a.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,p=0,g,m=-1;g=h.exec(d);){switch(g[0]){case"\\cell":var x=d.slice(p,h.lastIndex-g[0].length);if(x[0]==" "&&(x=x.slice(1)),++m,x.length){var w={v:x,t:"s"};Array.isArray(o)?o[f][m]=w:o[Ue({r:f,c:m})]=w}break}p=h.lastIndex}m>u.e.c&&(u.e.c=m)}),o["!ref"]=ut(u),o}function r(s,i){return ni(e(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=Xe(s["!ref"]),o,c=Array.isArray(s),u=a.s.r;u<=a.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=a.s.c;d<=a.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=a.s.c;d<=a.e.c;++d){var f=Ue({r:u,c:d});o=c?(s[u]||[])[d]:s[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(jn(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function bg(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Pj=6,En=Pj;function Gc(e){return Math.floor((e+Math.round(128/En)/256)*En)}function qc(e){return Math.floor((e-5)/En*100+.5)/100}function sf(e){return Math.round((e*En+5)/En*256)/256}function Ch(e){e.width?(e.wpx=Gc(e.width),e.wch=qc(e.wpx),e.MDW=En):e.wpx?(e.wch=qc(e.wpx),e.width=sf(e.wch),e.MDW=En):typeof e.wch=="number"&&(e.width=sf(e.wch),e.wpx=Gc(e.width),e.MDW=En),e.customWidth&&delete e.customWidth}var Dj=96,Zy=Dj;function Kc(e){return e*96/Zy}function ew(e){return e*Zy/96}function Rj(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=de("numFmt",null,{numFmtId:n,formatCode:Be(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=de("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Ij(e){var t=[];return t[t.length]=de("cellXfs",null),e.forEach(function(r){t[t.length]=de("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=de("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function tw(e,t){var r=[dt,de("styleSheet",null,{xmlns:ma[0],"xmlns:vt":xt.vt})],n;return e.SSF&&(n=Rj(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Ij(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Lj(e,t){var r=e.read_shift(2),n=$t(e);return[r,n]}function Mj(e,t,r){r||(r=te(6+4*t.length)),r.write_shift(2,e),yt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Bj(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=kC(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=bC(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=$t(e),n}function $j(e,t){t||(t=te(25+4*32)),t.write_shift(2,e.sz*20),NC(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),zc(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),yt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Uj=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],I0,Wj=cn;function kg(e,t){t||(t=te(4*3+8*7+16*1)),I0||(I0=gh(Uj));var r=I0[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(zc({auto:1},t),zc({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Hj(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function rw(e,t,r){r||(r=te(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Fa(e,t){return t||(t=te(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var zj=cn;function Vj(e,t){return t||(t=te(51)),t.write_shift(1,0),Fa(null,t),Fa(null,t),Fa(null,t),Fa(null,t),Fa(null,t),t.length>t.l?t.slice(0,t.l):t}function Gj(e,t){return t||(t=te(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),Hc(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function qj(e,t,r){var n=te(2052);return n.write_shift(4,e),Hc(t,n),Hc(r,n),n.length>n.l?n.slice(0,n.l):n}function Kj(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(se(e,615,Xr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&se(e,44,Mj(s,t[s]))}),se(e,616))}}function Xj(e){var t=1;se(e,611,Xr(t)),se(e,43,$j({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),se(e,612)}function Yj(e){var t=2;se(e,603,Xr(t)),se(e,45,kg({patternType:"none"})),se(e,45,kg({patternType:"gray125"})),se(e,604)}function Jj(e){var t=1;se(e,613,Xr(t)),se(e,46,Vj()),se(e,614)}function Qj(e){var t=1;se(e,626,Xr(t)),se(e,47,rw({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),se(e,627)}function Zj(e,t){se(e,617,Xr(t.length)),t.forEach(function(r){se(e,47,rw(r,0))}),se(e,618)}function eA(e){var t=1;se(e,619,Xr(t)),se(e,48,Gj({xfId:0,builtinId:0,name:"Normal"})),se(e,620)}function tA(e){var t=0;se(e,505,Xr(t)),se(e,506)}function rA(e){var t=0;se(e,508,qj(t,"TableStyleMedium9","PivotStyleMedium4")),se(e,509)}function nA(e,t){var r=ir();return se(r,278),Kj(r,e.SSF),Xj(r),Yj(r),Jj(r),Qj(r),Zj(r,t.cellXfs),eA(r),tA(r),rA(r),se(r,279),r.end()}function nw(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[dt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function sA(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:$t(e)}}function iA(e){var t=te(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),yt(e.name,t),t.slice(0,t.l)}function aA(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function oA(e){var t=te(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function lA(e,t){var r=te(8+2*t.length);return r.write_shift(4,e),yt(t,r),r.slice(0,r.l)}function cA(e){return e.l+=4,e.read_shift(4)!=0}function uA(e,t){var r=te(8);return r.write_shift(4,e),r.write_shift(4,1),r}function dA(){var e=ir();return se(e,332),se(e,334,Xr(1)),se(e,335,iA({name:"XLDAPR",version:12e4,flags:3496657072})),se(e,336),se(e,339,lA(1,"XLDAPR")),se(e,52),se(e,35,Xr(514)),se(e,4096,Xr(0)),se(e,4097,Sr(1)),se(e,36),se(e,53),se(e,340),se(e,337,uA(1)),se(e,51,oA([[1,0]])),se(e,338),se(e,333),e.end()}function sw(){var e=[dt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function fA(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ue(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Di=1024;function iw(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[de("xml",null,{"xmlns:v":dr.v,"xmlns:o":dr.o,"xmlns:x":dr.x,"xmlns:mv":dr.mv}).replace(/\/>/,">"),de("o:shapelayout",de("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),de("v:shapetype",[de("v:stroke",null,{joinstyle:"miter"}),de("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Di<e*1e3;)Di+=1e3;return t.forEach(function(i){var a=vt(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?de("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=de("v:fill",c,o),d={on:"t",obscured:"t"};++Di,s=s.concat(["<v:shape"+Po({id:"_x0000_s"+Di,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,de("v:shadow",null,d),de("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Nt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Nt("x:AutoFill","False"),Nt("x:Row",String(a.r)),Nt("x:Column",String(a.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function aw(e){var t=[dt,de("comments",null,{xmlns:ma[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var i=Be(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(Be(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(Nt("t",Be(i[0]||"")));else{for(var a=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)a+=`Reply:
    `+i[o]+`
`;t.push(Nt("t",Be(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function hA(e,t,r){var n=[dt,de("ThreadedComments",null,{xmlns:xt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(de("threadedComment",Nt("text",a.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function mA(e){var t=[dt,de("personList",null,{xmlns:xt.TCMNT,"xmlns:x":ma[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(de("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function pA(e){var t={};t.iauthor=e.read_shift(4);var r=oi(e);return t.rfx=r.s,t.ref=Ue(r.s),e.l+=16,t}function gA(e,t){return t==null&&(t=te(36)),t.write_shift(4,e[1].iauthor),ga(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var xA=$t;function vA(e){return yt(e.slice(0,54))}function yA(e){var t=ir(),r=[];return se(t,628),se(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),se(t,632,vA(s.a)))})}),se(t,631),se(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:vt(n[0]),e:vt(n[0])};se(t,635,gA([i,s])),s.t&&s.t.length>0&&se(t,637,_C(s)),se(t,636),delete s.iauthor})}),se(t,634),se(t,629),t.end()}function wA(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&We.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var ow=["xlsb","xlsm","xlam","biff8","xla"],_A=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,i,a){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=a.length>0?parseInt(a,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,s+(o?"":"$")+Bt(d)+(c?"":"$")+Ot(u)}return function(s,i){return t=i,s.replace(e,r)}}(),jh=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ah=function(){return function(t,r){return t.replace(jh,function(n,s,i,a,o,c){var u=Sh(a)-(i?0:r.c),d=Eh(c)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",h=u==0?"":i?u+1:"["+u+"]";return s+"R"+f+"C"+h})}}();function EA(e,t){return e.replace(jh,function(r,n,s,i,a,o){return n+(s=="$"?s+i:Bt(Sh(i)+t.c))+(a=="$"?a+o:Ot(Eh(o)+t.r))})}function SA(e){return e.length!=1}function lt(e){e.l+=1}function ps(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function lw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return cw(e);r.biff==12&&(n=4)}var s=e.read_shift(n),i=e.read_shift(n),a=ps(e),o=ps(e);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function cw(e){var t=ps(e),r=ps(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function TA(e,t,r){if(r.biff<8)return cw(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=ps(e),a=ps(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function uw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return bA(e);var n=e.read_shift(r&&r.biff==12?4:2),s=ps(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function bA(e){var t=ps(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function kA(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function NA(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return CA(e);var s=e.read_shift(n>=12?4:2),i=e.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function CA(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function jA(e,t,r){var n=(e[e.l++]&96)>>5,s=lw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function AA(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var a=lw(e,i,r);return[n,s,a]}function OA(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function FA(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,s]}function PA(e,t,r){var n=(e[e.l++]&96)>>5,s=TA(e,t-1,r);return[n,s]}function DA(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Ng(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function RA(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function IA(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function LA(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function MA(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function BA(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function dw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function $A(e){return e.read_shift(2),dw(e)}function UA(e){return e.read_shift(2),dw(e)}function WA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=uw(e,0,r);return[n,s]}function HA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=NA(e,0,r);return[n,s]}function zA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=uw(e,0,r);return[n,s,i]}function VA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[V5[s],mw[s],n]}function GA(e,t,r){var n=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:qA(e);return[s,(i[0]===0?mw:z5)[i[1]]]}function qA(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function KA(e,t,r){e.l+=r&&r.biff==2?3:4}function XA(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function YA(e){return e.l++,Qo[e.read_shift(1)]}function JA(e){return e.l++,e.read_shift(2)}function QA(e){return e.l++,e.read_shift(1)!==0}function ZA(e){return e.l++,xa(e)}function e5(e,t,r){return e.l++,qy(e,t-1,r)}function t5(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=zC(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Qo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=xa(e);break;case 2:r[1]=KC(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function r5(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?oi:JC)(e));return s}function n5(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=t5(e,r.biff);return a}function s5(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function i5(e,t,r){if(r.biff==5)return a5(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[n,s,i]}function a5(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function o5(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function l5(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function c5(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function u5(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,s]}var d5=cn,f5=cn,h5=cn;function Zo(e,t,r){return e.l+=2,[kA(e)]}function Oh(e){return e.l+=6,[]}var m5=Zo,p5=Oh,g5=Oh,x5=Zo;function fw(e){return e.l+=2,[Vy(e),e.read_shift(2)&1]}var v5=Zo,y5=fw,w5=Oh,_5=Zo,E5=Zo,S5=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function T5(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),a=S5[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:s,C:i}}function b5(e){return e.l+=2,[e.read_shift(4)]}function k5(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function N5(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function C5(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function j5(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function A5(e){return e.l+=4,[0,0]}var Cg={1:{n:"PtgExp",f:XA},2:{n:"PtgTbl",f:h5},3:{n:"PtgAdd",f:lt},4:{n:"PtgSub",f:lt},5:{n:"PtgMul",f:lt},6:{n:"PtgDiv",f:lt},7:{n:"PtgPower",f:lt},8:{n:"PtgConcat",f:lt},9:{n:"PtgLt",f:lt},10:{n:"PtgLe",f:lt},11:{n:"PtgEq",f:lt},12:{n:"PtgGe",f:lt},13:{n:"PtgGt",f:lt},14:{n:"PtgNe",f:lt},15:{n:"PtgIsect",f:lt},16:{n:"PtgUnion",f:lt},17:{n:"PtgRange",f:lt},18:{n:"PtgUplus",f:lt},19:{n:"PtgUminus",f:lt},20:{n:"PtgPercent",f:lt},21:{n:"PtgParen",f:lt},22:{n:"PtgMissArg",f:lt},23:{n:"PtgStr",f:e5},26:{n:"PtgSheet",f:k5},27:{n:"PtgEndSheet",f:N5},28:{n:"PtgErr",f:YA},29:{n:"PtgBool",f:QA},30:{n:"PtgInt",f:JA},31:{n:"PtgNum",f:ZA},32:{n:"PtgArray",f:DA},33:{n:"PtgFunc",f:VA},34:{n:"PtgFuncVar",f:GA},35:{n:"PtgName",f:s5},36:{n:"PtgRef",f:WA},37:{n:"PtgArea",f:jA},38:{n:"PtgMemArea",f:o5},39:{n:"PtgMemErr",f:d5},40:{n:"PtgMemNoMem",f:f5},41:{n:"PtgMemFunc",f:l5},42:{n:"PtgRefErr",f:c5},43:{n:"PtgAreaErr",f:OA},44:{n:"PtgRefN",f:HA},45:{n:"PtgAreaN",f:PA},46:{n:"PtgMemAreaN",f:C5},47:{n:"PtgMemNoMemN",f:j5},57:{n:"PtgNameX",f:i5},58:{n:"PtgRef3d",f:zA},59:{n:"PtgArea3d",f:AA},60:{n:"PtgRefErr3d",f:u5},61:{n:"PtgAreaErr3d",f:FA},255:{}},O5={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},F5={1:{n:"PtgElfLel",f:fw},2:{n:"PtgElfRw",f:_5},3:{n:"PtgElfCol",f:m5},6:{n:"PtgElfRwV",f:E5},7:{n:"PtgElfColV",f:x5},10:{n:"PtgElfRadical",f:v5},11:{n:"PtgElfRadicalS",f:w5},13:{n:"PtgElfColS",f:p5},15:{n:"PtgElfColSV",f:g5},16:{n:"PtgElfRadicalLel",f:y5},25:{n:"PtgList",f:T5},29:{n:"PtgSxName",f:b5},255:{}},P5={0:{n:"PtgAttrNoop",f:A5},1:{n:"PtgAttrSemi",f:BA},2:{n:"PtgAttrIf",f:LA},4:{n:"PtgAttrChoose",f:RA},8:{n:"PtgAttrGoto",f:IA},16:{n:"PtgAttrSum",f:KA},32:{n:"PtgAttrBaxcel",f:Ng},33:{n:"PtgAttrBaxcel",f:Ng},64:{n:"PtgAttrSpace",f:$A},65:{n:"PtgAttrSpaceSemi",f:UA},128:{n:"PtgAttrIfError",f:MA},255:{}};function D5(e,t,r,n){if(n.biff<8)return cn(e,t);for(var s=e.l+t,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=n5(e,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=r5(e,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=s-e.l,t!==0&&i.push(cn(e,t)),i}function R5(e,t,r){for(var n=e.l+t,s,i,a=[];n!=e.l;)t=n-e.l,i=e[e.l],s=Cg[i]||Cg[O5[i]],(i===24||i===25)&&(s=(i===24?F5:P5)[e[e.l+1]]),!s||!s.f?cn(e,t):a.push([s.n,s.f(e,t,r)]);return a}function I5(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var L5={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function M5(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function hw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function jg(e,t,r){var n=hw(e,t,r);return n=="#REF"?n:M5(n,r)}function ia(e,t,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,u,d,f=0,h=0,p,g="";if(!e[0]||!e[0][0])return"";for(var m=-1,x="",w=0,v=e[0].length;w<v;++w){var y=e[0][w];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:x=nt(" ",e[0][m][1][1]);break;case 1:x=nt("\r",e[0][m][1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+x,m=-1}o.push(u+L5[y[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=io(y[1][1],a,s),o.push(ao(d,i));break;case"PtgRefN":d=r?io(y[1][1],r,s):y[1][1],o.push(ao(d,i));break;case"PtgRef3d":f=y[1][1],d=io(y[1][2],a,s),g=jg(n,f,s),o.push(g+"!"+ao(d,i));break;case"PtgFunc":case"PtgFuncVar":var _=y[1][0],C=y[1][1];_||(_=0),_&=127;var E=_==0?[]:o.slice(-_);o.length-=_,C==="User"&&(C=E.shift()),o.push(C+"("+E.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":p=hg(y[1][1],r?{s:r}:a,s),o.push(D0(p,s));break;case"PtgArea":p=hg(y[1][1],a,s),o.push(D0(p,s));break;case"PtgArea3d":f=y[1][1],p=y[1][2],g=jg(n,f,s),o.push(g+"!"+D0(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var T=(n.names||[])[h-1]||(n[0]||[])[h],M=T?T.Name:"SH33TJSNAME"+String(h);M&&M.slice(0,6)=="_xlfn."&&!s.xlfn&&(M=M.slice(6)),o.push(M);break;case"PtgNameX":var A=y[1][1];h=y[1][2];var B;if(s.biff<=5)A<0&&(A=-A),n[A]&&(B=n[A][h]);else{var z="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][h]&&n[A][h].itab>0&&(z=n.SheetNames[n[A][h].itab-1]+"!"):z=n.SheetNames[h-1]+"!"),n[A]&&n[A][h])z+=n[A][h].Name;else if(n[0]&&n[0][h])z+=n[0][h].Name;else{var U=(hw(n,A,s)||"").split(";;");U[h-1]?z=U[h-1]:z+="SH33TJSERRX"}o.push(z);break}B||(B={Name:"SH33TJSERRY"}),o.push(B.Name);break;case"PtgParen":var V="(",pe=")";if(m>=0){switch(x="",e[0][m][1][0]){case 2:V=nt(" ",e[0][m][1][1])+V;break;case 3:V=nt("\r",e[0][m][1][1])+V;break;case 4:pe=nt(" ",e[0][m][1][1])+pe;break;case 5:pe=nt("\r",e[0][m][1][1])+pe;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(V+o.pop()+pe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var ne={c:r.c,r:r.r};if(n.sharedf[Ue(d)]){var le=n.sharedf[Ue(d)];o.push(ia(le,a,ne,n,s))}else{var ee=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(ia(u[1],a,ne,n,s)),ee=!0;break}ee||o.push(y[1])}break;case"PtgArray":o.push("{"+I5(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var W=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&m>=0&&W.indexOf(e[0][w][0])==-1){y=e[0][m];var G=!0;switch(y[1][0]){case 4:G=!1;case 0:x=nt(" ",y[1][1]);break;case 5:G=!1;case 1:x=nt("\r",y[1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((G?x:"")+o.pop()+(G?"":x)),m=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function B5(e){if(e==null){var t=te(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Js(e);return Js(0)}function $5(e,t,r,n,s){var i=Qs(t,r,s),a=B5(e.v),o=te(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=te(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=kt([i,a,o,u]);return f}function Lu(e,t,r){var n=e.read_shift(4),s=R5(e,n,r),i=e.read_shift(4),a=i>0?D5(e,i,s,r):null;return[s,a]}var U5=Lu,Mu=Lu,W5=Lu,H5=Lu,z5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},mw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},V5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function G5(e){var t="of:="+e.replace(jh,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function q5(e){return e.replace(/\./,"!")}var oo=typeof Map<"u";function Fh(e,t,r){var n=0,s=e.length;if(r){if(oo?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=oo?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(oo?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function Bu(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(En=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=qc(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=sf(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function pw(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ss(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){uy(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===n)return s;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function K5(e,t,r){if(e&&e["!ref"]){var n=Xe(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function X5(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ut(e[r])+'"/>';return t+"</mergeCells>"}function Y5(e,t,r,n,s){var i=!1,a={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,a.codeName=Fo(Be(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+de("outlinePr",null,u)}!i&&!o||(s[s.length]=de("sheetPr",o,a))}var J5=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Q5=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Z5(e){var t={sheet:1};return J5.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Q5.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Qy(e.password).toString(16).toUpperCase()),de("sheetProtection",null,t)}function e6(e){return pw(e),de("pageMargins",null,e)}function t6(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=de("col",null,Bu(s,n)));return r[r.length]="</cols>",r.join("")}function r6(e,t,r,n){var s=typeof e.ref=="string"?e.ref:ut(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,a=vr(s);a.s.r==a.e.r&&(a.e.r=vr(t["!ref"]).e.r,s=ut(a));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),de("autoFilter",null,{ref:s})}function n6(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),de("sheetViews",de("sheetView",null,s),{})}function s6(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Qo[e.v];break;case"d":n&&n.cellDates?s=Xt(e.v,-1).toISOString():(e=or(e),e.t="n",s=""+(e.v=ar(Xt(e.v)))),typeof e.z>"u"&&(e.z=it[14]);break;default:s=e.v;break}var o=Nt("v",Be(s)),c={r:t},u=Ss(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Nt("v",""+Fh(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=a),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=de("f",Be(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),de("c",o,c)}function i6(e,t,r,n){var s=[],i=[],a=Xe(e["!ref"]),o="",c,u="",d=[],f=0,h=0,p=e["!rows"],g=Array.isArray(e),m={r:u},x,w=-1;for(h=a.s.c;h<=a.e.c;++h)d[h]=Bt(h);for(f=a.s.r;f<=a.e.r;++f){for(i=[],u=Ot(f),h=a.s.c;h<=a.e.c;++h){c=d[h]+u;var v=g?(e[f]||[])[h]:e[c];v!==void 0&&(o=s6(v,c,e,t))!=null&&i.push(o)}(i.length>0||p&&p[f])&&(m={r:u},p&&p[f]&&(x=p[f],x.hidden&&(m.hidden=1),w=-1,x.hpx?w=Kc(x.hpx):x.hpt&&(w=x.hpt),w>-1&&(m.ht=w,m.customHeight=1),x.level&&(m.outlineLevel=x.level)),s[s.length]=de("row",i.join(""),m))}if(p)for(;f<p.length;++f)p&&p[f]&&(m={r:f+1},x=p[f],x.hidden&&(m.hidden=1),w=-1,x.hpx?w=Kc(x.hpx):x.hpt&&(w=x.hpt),w>-1&&(m.ht=w,m.customHeight=1),x.level&&(m.outlineLevel=x.level),s[s.length]=de("row","",m));return s.join("")}function gw(e,t,r,n){var s=[dt,de("worksheet",null,{xmlns:ma[0],"xmlns:r":xt.r})],i=r.SheetNames[e],a=0,o="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",d=Xe(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=ut(d)}n||(n={}),c["!comments"]=[];var f=[];Y5(c,r,e,t,s),s[s.length]=de("dimension",null,{ref:u}),s[s.length]=n6(c,t,e,r),t.sheetFormat&&(s[s.length]=de("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=t6(c,c["!cols"])),s[a=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=i6(c,t),o.length>0&&(s[s.length]=o)),s.length>a+1&&(s[s.length]="</sheetData>",s[a]=s[a].replace("/>",">")),c["!protect"]&&(s[s.length]=Z5(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=r6(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=X5(c["!merges"]));var h=-1,p,g=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=Me(n,-1,Be(m[1].Target).replace(/#.*$/,""),De.HLINK),p["r:id"]="rId"+g),(h=m[1].Target.indexOf("#"))>-1&&(p.location=Be(m[1].Target.slice(h+1))),m[1].Tooltip&&(p.tooltip=Be(m[1].Tooltip)),s[s.length]=de("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=e6(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Nt("ignoredErrors",de("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(g=Me(n,-1,"../drawings/drawing"+(e+1)+".xml",De.DRAW),s[s.length]=de("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=f),c["!comments"].length>0&&(g=Me(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",De.VML),s[s.length]=de("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function a6(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function o6(e,t,r){var n=te(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;s.hpx?i=Kc(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var a=0;s.level&&(a|=s.level),s.hidden&&(a|=16),(s.hpx||s.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var g=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Ue(u)];g&&(f<0&&(f=p),h=p)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var m=n.l;return n.l=c,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function l6(e,t,r,n){var s=o6(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&se(e,0,s)}var c6=oi,u6=ga;function d6(){}function f6(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=EC(e),r}function h6(e,t,r){r==null&&(r=te(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return zc({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Oy(e,r),r.slice(0,r.l)}function m6(e){var t=Pr(e);return[t]}function p6(e,t,r){return r==null&&(r=te(8)),si(t,r)}function g6(e){var t=ii(e);return[t]}function x6(e,t,r){return r==null&&(r=te(4)),ai(t,r)}function v6(e){var t=Pr(e),r=e.read_shift(1);return[t,r,"b"]}function y6(e,t,r){return r==null&&(r=te(9)),si(t,r),r.write_shift(1,e.v?1:0),r}function w6(e){var t=ii(e),r=e.read_shift(1);return[t,r,"b"]}function _6(e,t,r){return r==null&&(r=te(5)),ai(t,r),r.write_shift(1,e.v?1:0),r}function E6(e){var t=Pr(e),r=e.read_shift(1);return[t,r,"e"]}function S6(e,t,r){return r==null&&(r=te(9)),si(t,r),r.write_shift(1,e.v),r}function T6(e){var t=ii(e),r=e.read_shift(1);return[t,r,"e"]}function b6(e,t,r){return r==null&&(r=te(8)),ai(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function k6(e){var t=Pr(e),r=e.read_shift(4);return[t,r,"s"]}function N6(e,t,r){return r==null&&(r=te(12)),si(t,r),r.write_shift(4,t.v),r}function C6(e){var t=ii(e),r=e.read_shift(4);return[t,r,"s"]}function j6(e,t,r){return r==null&&(r=te(8)),ai(t,r),r.write_shift(4,t.v),r}function A6(e){var t=Pr(e),r=xa(e);return[t,r,"n"]}function O6(e,t,r){return r==null&&(r=te(16)),si(t,r),Js(e.v,r),r}function F6(e){var t=ii(e),r=xa(e);return[t,r,"n"]}function P6(e,t,r){return r==null&&(r=te(12)),ai(t,r),Js(e.v,r),r}function D6(e){var t=Pr(e),r=Fy(e);return[t,r,"n"]}function R6(e,t,r){return r==null&&(r=te(12)),si(t,r),Py(e.v,r),r}function I6(e){var t=ii(e),r=Fy(e);return[t,r,"n"]}function L6(e,t,r){return r==null&&(r=te(8)),ai(t,r),Py(e.v,r),r}function M6(e){var t=Pr(e),r=Th(e);return[t,r,"is"]}function B6(e){var t=Pr(e),r=$t(e);return[t,r,"str"]}function $6(e,t,r){return r==null&&(r=te(12+4*e.v.length)),si(t,r),yt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function U6(e){var t=ii(e),r=$t(e);return[t,r,"str"]}function W6(e,t,r){return r==null&&(r=te(8+4*e.v.length)),ai(t,r),yt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function H6(e,t,r){var n=e.l+t,s=Pr(e);s.r=r["!row"];var i=e.read_shift(1),a=[s,i,"b"];if(r.cellFormula){e.l+=2;var o=Mu(e,n-e.l,r);a[3]=ia(o,null,s,r.supbooks,r)}else e.l=n;return a}function z6(e,t,r){var n=e.l+t,s=Pr(e);s.r=r["!row"];var i=e.read_shift(1),a=[s,i,"e"];if(r.cellFormula){e.l+=2;var o=Mu(e,n-e.l,r);a[3]=ia(o,null,s,r.supbooks,r)}else e.l=n;return a}function V6(e,t,r){var n=e.l+t,s=Pr(e);s.r=r["!row"];var i=xa(e),a=[s,i,"n"];if(r.cellFormula){e.l+=2;var o=Mu(e,n-e.l,r);a[3]=ia(o,null,s,r.supbooks,r)}else e.l=n;return a}function G6(e,t,r){var n=e.l+t,s=Pr(e);s.r=r["!row"];var i=$t(e),a=[s,i,"str"];if(r.cellFormula){e.l+=2;var o=Mu(e,n-e.l,r);a[3]=ia(o,null,s,r.supbooks,r)}else e.l=n;return a}var q6=oi,K6=ga;function X6(e,t){return t==null&&(t=te(4)),t.write_shift(4,e),t}function Y6(e,t){var r=e.l+t,n=oi(e),s=bh(e),i=$t(e),a=$t(e),o=$t(e);e.l=r;var c={rfx:n,relId:s,loc:i,display:o};return a&&(c.Tooltip=a),c}function J6(e,t){var r=te(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ga({s:vt(e[0]),e:vt(e[0])},r),kh("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return yt(s||"",r),yt(e[1].Tooltip||"",r),yt("",r),r.slice(0,r.l)}function Q6(){}function Z6(e,t,r){var n=e.l+t,s=Dy(e),i=e.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=U5(e,n-e.l,r);a[1]=o}else e.l=n;return a}function eO(e,t,r){var n=e.l+t,s=oi(e),i=[s];if(r.cellFormula){var a=H5(e,n-e.l,r);i[1]=a,e.l=n}else e.l=n;return i}function tO(e,t,r){r==null&&(r=te(18));var n=Bu(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var xw=["left","right","top","bottom","header","footer"];function rO(e){var t={};return xw.forEach(function(r){t[r]=xa(e)}),t}function nO(e,t){return t==null&&(t=te(6*8)),pw(e),xw.forEach(function(r){Js(e[r],t)}),t}function sO(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function iO(e,t,r){r==null&&(r=te(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function aO(e){var t=te(24);return t.write_shift(4,4),t.write_shift(4,1),ga(e,t),t}function oO(e,t){return t==null&&(t=te(16*4+2)),t.write_shift(2,e.password?Qy(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function lO(){}function cO(){}function uO(e,t,r,n,s,i,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=or(t),t.z=t.z||it[14],t.v=ar(Xt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=Ss(s.cellXfs,t,s),t.l&&i["!links"].push([Ue(c),t.l]),t.c&&i["!comments"].push([Ue(c),t.c]),t.t){case"s":case"str":return s.bookSST?(o=Fh(s.Strings,t.v,s.revStrings),c.t="s",c.v=o,a?se(e,18,j6(t,c)):se(e,7,N6(t,c))):(c.t="str",a?se(e,17,W6(t,c)):se(e,6,$6(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?se(e,13,L6(t,c)):se(e,2,R6(t,c)):a?se(e,16,P6(t,c)):se(e,5,O6(t,c)),!0;case"b":return c.t="b",a?se(e,15,_6(t,c)):se(e,4,y6(t,c)),!0;case"e":return c.t="e",a?se(e,14,b6(t,c)):se(e,3,S6(t,c)),!0}return a?se(e,12,x6(t,c)):se(e,1,p6(t,c)),!0}function dO(e,t,r,n){var s=Xe(t["!ref"]||"A1"),i,a="",o=[];se(e,145);var c=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){a=Ot(d),l6(e,t,s,d);var f=!1;if(d<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){d===s.s.r&&(o[h]=Bt(h)),i=o[h]+a;var p=c?(t[d]||[])[h]:t[i];if(!p){f=!1;continue}f=uO(e,p,d,h,n,t,f)}}se(e,146)}function fO(e,t){!t||!t["!merges"]||(se(e,177,X6(t["!merges"].length)),t["!merges"].forEach(function(r){se(e,176,K6(r))}),se(e,178))}function hO(e,t){!t||!t["!cols"]||(se(e,390),t["!cols"].forEach(function(r,n){r&&se(e,60,tO(n,r))}),se(e,391))}function mO(e,t){!t||!t["!ref"]||(se(e,648),se(e,649,aO(Xe(t["!ref"]))),se(e,650))}function pO(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Me(r,-1,n[1].Target.replace(/#.*$/,""),De.HLINK);se(e,494,J6(n,s))}}),delete t["!links"]}function gO(e,t,r,n){if(t["!comments"].length>0){var s=Me(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",De.VML);se(e,551,kh("rId"+s)),t["!legacy"]=s}}function xO(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:ut(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=vr(i);o.s.r==o.e.r&&(o.e.r=vr(t["!ref"]).e.r,i=ut(o));for(var c=0;c<a.length;++c){var u=a[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),se(e,161,ga(Xe(i))),se(e,162)}}function vO(e,t,r){se(e,133),se(e,137,iO(t,r)),se(e,138),se(e,134)}function yO(e,t){t["!protect"]&&se(e,535,oO(t["!protect"]))}function wO(e,t,r,n){var s=ir(),i=r.SheetNames[e],a=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=Xe(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],se(s,129),(r.vbaraw||a["!outline"])&&se(s,147,h6(o,a["!outline"])),se(s,148,u6(c)),vO(s,a,r.Workbook),hO(s,a),dO(s,a,e,t),yO(s,a),xO(s,a,r,e),fO(s,a),pO(s,a,n),a["!margins"]&&se(s,476,nO(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&mO(s,a),gO(s,a,e,n),se(s,130),s.end()}function _O(e,t){e.l+=10;var r=$t(e);return{name:r}}var EO=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function SO(e){return!e.Workbook||!e.Workbook.WBProps?"false":eC(e.Workbook.WBProps.date1904)?"true":"false"}var TO="][*?/\\".split("");function vw(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return TO.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function bO(e,t,r){e.forEach(function(n,s){vw(n);for(var i=0;i<s;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[s]&&t[s].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function kO(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];bO(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)K5(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function yw(e){var t=[dt];t[t.length]=de("workbook",null,{xmlns:ma[0],"xmlns:r":xt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(EO.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=de("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var a={name:Be(e.SheetNames[i].slice(0,31))};if(a.sheetId=""+(i+1),a["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=de("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=de("definedName",Be(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function NO(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=nf(e),r.name=$t(e),r}function CO(e,t){return t||(t=te(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),kh(e.strRelID,t),yt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function jO(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?$t(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function AO(e,t){t||(t=te(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Oy(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function OO(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=SC(e),a=W5(e,0,r),o=bh(e);e.l=n;var c={Name:i,Ptg:a};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function FO(e,t){se(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};se(e,156,CO(s))}se(e,144)}function PO(e,t){t||(t=te(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return yt("SheetJS",t),yt(Lc.version,t),yt(Lc.version,t),yt("7262",t),t.length>t.l?t.slice(0,t.l):t}function DO(e,t){t||(t=te(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function RO(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(se(e,135),se(e,158,DO(s)),se(e,136))}}function IO(e,t){var r=ir();return se(r,131),se(r,128,PO()),se(r,153,AO(e.Workbook&&e.Workbook.WBProps||null)),RO(r,e),FO(r,e),se(r,132),r.end()}function LO(e,t,r){return(t.slice(-4)===".bin"?IO:yw)(e)}function MO(e,t,r,n,s){return(t.slice(-4)===".bin"?wO:gw)(e,r,n,s)}function BO(e,t,r){return(t.slice(-4)===".bin"?nA:tw)(e,r)}function $O(e,t,r){return(t.slice(-4)===".bin"?Aj:Jy)(e,r)}function UO(e,t,r){return(t.slice(-4)===".bin"?yA:aw)(e)}function WO(e){return(e.slice(-4)===".bin"?dA:sw)()}function HO(e,t){var r=[];return e.Props&&r.push(BC(e.Props,t)),e.Custprops&&r.push($C(e.Props,e.Custprops)),r.join("")}function zO(){return""}function VO(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var i=[];i.push(de("NumberFormat",null,{"ss:Format":Be(it[n.numFmtId])}));var a={"ss:ID":"s"+(21+s)};r.push(de("Style",i.join(""),a))}),de("Styles",r.join(""))}function ww(e){return de("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Ah(e.Ref,{r:0,c:0})})}function GO(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(ww(s)))}return de("Names",r.join(""))}function qO(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],a=0;a<s.length;++a){var o=s[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(ww(o)))}return i.join("")}function KO(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(de("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(de("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(de("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(de("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Nt("ProtectContents","True")),e["!protect"].objects&&s.push(Nt("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Nt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Nt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Nt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&s.push("<"+a[1]+"/>")})),s.length==0?"":de("WorksheetOptions",s.join(""),{xmlns:dr.x})}function XO(e){return e.map(function(t){var r=Z3(t.t||""),n=de("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return de("Comment",n,{"ss:Author":t.a})}).join("")}function YO(e,t,r,n,s,i,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Be(Ah(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var c=vt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Be(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Be(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=a.c||u[d].s.r!=a.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Qo[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||it[14]);break;case"s":f="String",h=Q3(e.v||"");break}var p=Ss(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=a.c+1;var g=e.v!=null?h:"",m=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(m+=XO(e.c)),de("Cell",m,o)}function JO(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=ew(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function QO(e,t,r,n){if(!e["!ref"])return"";var s=Xe(e["!ref"]),i=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(x,w){Ch(x);var v=!!x.width,y=Bu(w,x),_={"ss:Index":w+1};v&&(_["ss:Width"]=Gc(y.width)),x.hidden&&(_["ss:Hidden"]="1"),o.push(de("Column",null,_))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[JO(u,(e["!rows"]||[])[u])],f=s.s.c;f<=s.e.c;++f){var h=!1;for(a=0;a!=i.length;++a)if(!(i[a].s.c>f)&&!(i[a].s.r>u)&&!(i[a].e.c<f)&&!(i[a].e.r<u)){(i[a].s.c!=f||i[a].s.r!=u)&&(h=!0);break}if(!h){var p={r:u,c:f},g=Ue(p),m=c?(e[u]||[])[f]:e[g];d.push(YO(m,g,e,t,r,n,p))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function ZO(e,t,r){var n=[],s=r.SheetNames[e],i=r.Sheets[s],a=i?qO(i,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=i?QO(i,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(KO(i,t,e,r)),n.join("")}function eF(e,t){t||(t={}),e.SSF||(e.SSF=or(it)),e.SSF&&(Du(),Pu(e.SSF),t.revssf=Ru(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ss(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(HO(e,t)),r.push(zO()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(de("Worksheet",ZO(n,t,e),{"ss:Name":Be(e.SheetNames[n])}));return r[2]=VO(e,t),r[3]=GO(e),dt+de("Workbook",r.join(""),{xmlns:dr.ss,"xmlns:o":dr.o,"xmlns:x":dr.x,"xmlns:ss":dr.ss,"xmlns:dt":dr.dt,"xmlns:html":dr.html})}var L0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function tF(e,t){var r=[],n=[],s=[],i=0,a,o=rg(pg,"n"),c=rg(gg,"n");if(e.Props)for(a=Pt(e.Props),i=0;i<a.length;++i)(Object.prototype.hasOwnProperty.call(o,a[i])?r:Object.prototype.hasOwnProperty.call(c,a[i])?n:s).push([a[i],e.Props[a[i]]]);if(e.Custprops)for(a=Pt(e.Custprops),i=0;i<a.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},a[i])||(Object.prototype.hasOwnProperty.call(o,a[i])?r:Object.prototype.hasOwnProperty.call(c,a[i])?n:s).push([a[i],e.Custprops[a[i]]]);var u=[];for(i=0;i<s.length;++i)zy.indexOf(s[i][0])>-1||Uy.indexOf(s[i][0])>-1||s[i][1]!=null&&u.push(s[i]);n.length&&We.utils.cfb_add(t,"/SummaryInformation",_g(n,L0.SI,c,gg)),(r.length||u.length)&&We.utils.cfb_add(t,"/DocumentSummaryInformation",_g(r,L0.DSI,o,pg,u.length?u:null,L0.UDI))}function rF(e,t){var r=t||{},n=We.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return We.utils.cfb_add(n,s,_w(e,r)),r.biff==8&&(e.Props||e.Custprops)&&tF(e,n),r.biff==8&&e.vbaraw&&wA(n,We.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var nF={0:{f:a6},1:{f:m6},2:{f:D6},3:{f:E6},4:{f:v6},5:{f:A6},6:{f:B6},7:{f:k6},8:{f:G6},9:{f:V6},10:{f:H6},11:{f:z6},12:{f:g6},13:{f:I6},14:{f:T6},15:{f:w6},16:{f:F6},17:{f:U6},18:{f:C6},19:{f:Th},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:OO},40:{},42:{},43:{f:Bj},44:{f:Lj},45:{f:Wj},46:{f:zj},47:{f:Hj},48:{},49:{f:gC},50:{},51:{f:aA},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:xj},62:{f:M6},63:{f:fA},64:{f:lO},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:cn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:sO},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:f6},148:{f:c6,p:16},151:{f:Q6},152:{},153:{f:jO},154:{},155:{},156:{f:NO},157:{},158:{},159:{T:1,f:Nj},160:{T:-1},161:{T:1,f:oi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:q6},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:sA},336:{T:-1},337:{f:cA,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:nf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:dj},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Z6},427:{f:eO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:rO},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:d6},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Y6},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:nf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:xA},633:{T:1},634:{T:-1},635:{T:1,f:pA},636:{T:-1},637:{f:wC},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:_O},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:cO},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function he(e,t,r,n){var s=t;if(!isNaN(s)){var i=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&_h(r)&&e.push(r)}}function sF(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return he(e,t,r,s);var i=t;if(!isNaN(i)){for(var a=r.parts||[],o=0,c=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function el(e,t,r){return e||(e=te(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function iF(e,t,r,n){var s=te(9);return el(s,e,t),Gy(r,n||"b",s),s}function aF(e,t,r){var n=te(8+2*r.length);return el(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function oF(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?ar(Xt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?he(e,2,_j(r,n,s)):he(e,3,wj(r,n,s));return;case"b":case"e":he(e,5,iF(r,n,t.v,t.t));return;case"s":case"str":he(e,4,aF(r,n,(t.v||"").slice(0,255)));return}he(e,1,el(null,r,n))}function lF(e,t,r,n){var s=Array.isArray(t),i=Xe(t["!ref"]||"A1"),a,o="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),a=ut(i)}for(var u=i.s.r;u<=i.e.r;++u){o=Ot(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(c[d]=Bt(d)),a=c[d]+o;var f=s?(t[u]||[])[d]:t[a];f&&oF(e,f,u,d)}}}function cF(e,t){for(var r=t||{},n=ir(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return he(n,r.biff==4?1033:r.biff==3?521:9,Nh(e,16,r)),lF(n,e.Sheets[e.SheetNames[s]],s,r),he(n,10),n.end()}function uF(e,t,r){he(e,49,nj({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function dF(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&he(e,1054,aj(s,t[s],r))})}function fF(e,t){var r=te(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),he(e,2151,r),r=te(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Xy(Xe(t["!ref"]||"A1"),r),r.write_shift(4,4),he(e,2152,r)}function hF(e,t){for(var r=0;r<16;++r)he(e,224,Sg({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){he(e,224,Sg(n,0,t))})}function mF(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];he(e,440,mj(n)),n[1].Tooltip&&he(e,2048,pj(n))}delete t["!links"]}function pF(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&he(e,125,vj(Bu(s,n),s))})}}function gF(e,t,r,n,s){var i=16+Ss(s.cellXfs,t,s);if(t.v==null&&!t.bf){he(e,513,Qs(r,n,i));return}if(t.bf)he(e,6,$5(t,r,n,s,i));else switch(t.t){case"d":case"n":var a=t.t=="d"?ar(Xt(t.v)):t.v;he(e,515,uj(r,n,a,i));break;case"b":case"e":he(e,517,cj(r,n,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var o=Fh(s.Strings,t.v,s.revStrings);he(e,253,sj(r,n,o,i))}else he(e,516,ij(r,n,(t.v||"").slice(0,255),i,s));break;default:he(e,513,Qs(r,n,i))}}function xF(e,t,r){var n=ir(),s=r.SheetNames[e],i=r.Sheets[s]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,d,f="",h=[],p=Xe(i["!ref"]||"A1"),g=u?65536:16384;if(p.e.c>255||p.e.r>=g){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,g-1)}he(n,2057,Nh(r,16,t)),he(n,13,Sr(1)),he(n,12,Sr(100)),he(n,15,Gt(!0)),he(n,17,Gt(!1)),he(n,16,Js(.001)),he(n,95,Gt(!0)),he(n,42,Gt(!1)),he(n,43,Gt(!1)),he(n,130,Sr(1)),he(n,128,lj()),he(n,131,Gt(!1)),he(n,132,Gt(!1)),u&&pF(n,i["!cols"]),he(n,512,oj(p,t)),u&&(i["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){f=Ot(m);for(var x=p.s.c;x<=p.e.c;++x){m===p.s.r&&(h[x]=Bt(x)),d=h[x]+f;var w=c?(i[m]||[])[x]:i[d];w&&(gF(n,w,m,x,t),u&&w.l&&i["!links"].push([d,w.l]))}}var v=o.CodeName||o.name||s;return u&&he(n,574,rj((a.Views||[])[0])),u&&(i["!merges"]||[]).length&&he(n,229,hj(i["!merges"])),u&&mF(n,i),he(n,442,Ky(v)),u&&fF(n,i),he(n,10),n.end()}function vF(e,t,r){var n=ir(),s=(e||{}).Workbook||{},i=s.Sheets||[],a=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(he(n,2057,Nh(e,5,r)),r.bookType=="xla"&&he(n,135),he(n,225,o?Sr(1200):null),he(n,193,HC(2)),c&&he(n,191),c&&he(n,192),he(n,226),he(n,92,QC("SheetJS",r)),he(n,66,Sr(o?1200:1252)),o&&he(n,353,Sr(0)),o&&he(n,448),he(n,317,yj(e.SheetNames.length)),o&&e.vbaraw&&he(n,211),o&&e.vbaraw){var u=a.CodeName||"ThisWorkbook";he(n,442,Ky(u))}he(n,156,Sr(17)),he(n,25,Gt(!1)),he(n,18,Gt(!1)),he(n,19,Sr(0)),o&&he(n,431,Gt(!1)),o&&he(n,444,Sr(0)),he(n,61,tj()),he(n,64,Gt(!1)),he(n,141,Sr(0)),he(n,34,Gt(SO(e)=="true")),he(n,14,Gt(!0)),o&&he(n,439,Gt(!1)),he(n,218,Sr(0)),uF(n,e,r),dF(n,e.SSF,r),hF(n,r),o&&he(n,352,Gt(!1));var d=n.end(),f=ir();o&&he(f,140,gj()),o&&r.Strings&&sF(f,252,ej(r.Strings)),he(f,10);var h=f.end(),p=ir(),g=0,m=0;for(m=0;m<e.SheetNames.length;++m)g+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var x=d.length+g+h.length;for(m=0;m<e.SheetNames.length;++m){var w=i[m]||{};he(p,133,ZC({pos:x,hs:w.Hidden||0,dt:0,name:e.SheetNames[m]},r)),x+=t[m].length}var v=p.end();if(g!=v.length)throw new Error("BS8 "+g+" != "+v.length);var y=[];return d.length&&y.push(d),v.length&&y.push(v),h.length&&y.push(h),kt(y)}function yF(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=or(it)),e&&e.SSF&&(Du(),Pu(e.SSF),r.revssf=Ru(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ph(r),r.cellXfs=[],Ss(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=xF(s,r,e);return n.unshift(vF(e,n,r)),kt(n)}function _w(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=vr(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return yF(e,t);case 4:case 3:case 2:return cF(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function wF(e,t,r,n){for(var s=e["!merges"]||[],i=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>a)&&!(s[u].e.r<r||s[u].e.c<a)){if(s[u].s.r<r||s[u].s.c<a){o=-1;break}o=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var d=Ue({r,c:a}),f=n.dense?(e[r]||[])[a]:e[d],h=f&&f.v!=null&&(f.h||J3(f.w||(jn(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+d,i.push(de("td",h,p))}}var g="<tr>";return g+i.join("")+"</tr>"}var _F='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',EF="</body></html>";function SF(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Ew(e,t){var r=t||{},n=r.header!=null?r.header:_F,s=r.footer!=null?r.footer:EF,i=[n],a=vr(e["!ref"]);r.dense=Array.isArray(e),i.push(SF(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(wF(e,a,o,r));return i.push("</table>"+s),i.join("")}function Sw(e,t,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?vt(n.origin):n.origin;s=a.r,i=a.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var d=vr(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var f=[],h=0,p=e["!rows"]||(e["!rows"]=[]),g=0,m=0,x=0,w=0,v=0,y=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&m<c;++g){var _=o[g];if(Ag(_)){if(n.display)continue;p[m]={hidden:!0}}var C=_.children;for(x=w=0;x<C.length;++x){var E=C[x];if(!(n.display&&Ag(E))){var T=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):tC(E.innerHTML),M=E.getAttribute("data-z")||E.getAttribute("z");for(h=0;h<f.length;++h){var A=f[h];A.s.c==w+i&&A.s.r<m+s&&m+s<=A.e.r&&(w=A.e.c+1-i,h=-1)}y=+E.getAttribute("colspan")||1,((v=+E.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:m+s,c:w+i},e:{r:m+s+(v||1)-1,c:w+i+(y||1)-1}});var B={t:"s",v:T},z=E.getAttribute("data-t")||E.getAttribute("t")||"";T!=null&&(T.length==0?B.t=z||"z":n.raw||T.trim().length==0||z=="s"||(T==="TRUE"?B={t:"b",v:!0}:T==="FALSE"?B={t:"b",v:!1}:isNaN(_n(T))?isNaN(Oo(T).getDate())||(B={t:"d",v:Xt(T)},n.cellDates||(B={t:"n",v:ar(B.v)}),B.z=n.dateNF||it[14]):B={t:"n",v:_n(T)})),B.z===void 0&&M!=null&&(B.z=M);var U="",V=E.getElementsByTagName("A");if(V&&V.length)for(var pe=0;pe<V.length&&!(V[pe].hasAttribute("href")&&(U=V[pe].getAttribute("href"),U.charAt(0)!="#"));++pe);U&&U.charAt(0)!="#"&&(B.l={Target:U}),n.dense?(e[m+s]||(e[m+s]=[]),e[m+s][w+i]=B):e[Ue({c:w+i,r:m+s})]=B,u.e.c<w+i&&(u.e.c=w+i),w+=y}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,m-1+s),e["!ref"]=ut(u),m>=c&&(e["!fullref"]=ut((u.e.r=o.length-g+m-1+s,u))),e}function Tw(e,t){var r=t||{},n=r.dense?[]:{};return Sw(n,e,t)}function TF(e,t){return ni(Tw(e,t),t)}function Ag(e){var t="",r=bF(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function bF(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var kF=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Po({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return dt+t}}(),Og=function(){var e=function(i){return Be(i).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,a,o){var c=[];c.push('      <table:table table:name="'+Be(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,f=vr(i["!ref"]||"A1"),h=i["!merges"]||[],p=0,g=Array.isArray(i);if(i["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var m="",x=i["!rows"]||[];for(u=0;u<f.s.r;++u)m=x[u]?' table:style-name="ro'+x[u].ods+'"':"",c.push("        <table:table-row"+m+`></table:table-row>
`);for(;u<=f.e.r;++u){for(m=x[u]?' table:style-name="ro'+x[u].ods+'"':"",c.push("        <table:table-row"+m+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var w=!1,v={},y="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>d)&&!(h[p].s.r>u)&&!(h[p].e.c<d)&&!(h[p].e.r<u)){(h[p].s.c!=d||h[p].s.r!=u)&&(w=!0),v["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,v["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(w){c.push(r);continue}var _=Ue({r:u,c:d}),C=g?(i[u]||[])[d]:i[_];if(C&&C.f&&(v["table:formula"]=Be(G5(C.f)),C.F&&C.F.slice(0,_.length)==_)){var E=vr(C.F);v["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,v["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!C){c.push(t);continue}switch(C.t){case"b":y=C.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=C.v?"true":"false";break;case"n":y=C.w||String(C.v||0),v["office:value-type"]="float",v["office:value"]=C.v||0;break;case"s":case"str":y=C.v==null?"":C.v,v["office:value-type"]="string";break;case"d":y=C.w||Xt(C.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=Xt(C.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(t);continue}var T=e(y);if(C.l&&C.l.Target){var M=C.l.Target;M=M.charAt(0)=="#"?"#"+q5(M.slice(1)):M,M.charAt(0)!="#"&&!M.match(/^\w+:/)&&(M="../"+M),T=de("text:a",T,{"xlink:href":M.replace(/&/g,"&amp;")})}c.push("          "+de("table:table-cell",de("text:p",T,{}),v)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(i,a){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Ch(f),f.ods=o;var h=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(a,o){var c=[dt],u=Po({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Po({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(By().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)c.push(n(a.Sheets[a.SheetNames[f]],a,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function bw(e,t){if(t.bookType=="fods")return Og(e,t);var r=xh(),n="",s=[],i=[];return n="mimetype",Ce(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ce(r,n,Og(e,t)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Ce(r,n,kF(e,t)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Ce(r,n,dt+By()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Ce(r,n,MC(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ce(r,n,IC(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Xc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function NF(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Wr(Fo(e))}function CF(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function gs(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function jF(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function Do(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ie(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Gi(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ft(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=Do(e,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Do(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:i};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function Et(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Ie(n*8+s.type)),s.type==2&&t.push(Ie(s.data.length)),t.push(s.data))})}),gs(t)}function Rr(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=Do(e,n),i=ft(e.slice(n[0],n[0]+s));n[0]+=s;var a={id:Gi(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=ft(o.data),u=Gi(c[3][0].data);a.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(a.merge=Gi(i[3][0].data)>>>0>0),r.push(a)}return r}function vi(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ie(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ie(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(a){s.push(a.data),a.meta[3]=[{type:0,data:Ie(a.data.length)}],n[2].push({data:Et(a.meta),type:2})});var i=Et(n);t.push(Ie(i.length)),t.push(i),s.forEach(function(a){return t.push(a)})}),gs(t)}function AF(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Do(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[gs(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=gs(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Ir(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(AF(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return gs(t)}function yi(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=Ie(n),a=i.length;t.push(i),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,s[0]=0,s[1]=a&255,s[2]=a>>8&255,s[3]=a>>16&255,r+=n}return gs(t)}function M0(e,t){var r=new Uint8Array(32),n=Xc(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,jF(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,s)}function B0(e,t){var r=new Uint8Array(32),n=Xc(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,s)}function Ln(e){var t=ft(e);return Do(t[1][0].data)}function OF(e,t,r){var n,s,i,a;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(i=e[8])==null?void 0:i[0])==null?void 0:a.data)&&Gi(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=Xc(e[7][0].data),d=0,f=[],h=Xc(e[4][0].data),p=0,g=[],m=0;m<t.length;++m){if(t[m]==null){u.setUint16(m*2,65535,!0),h.setUint16(m*2,65535);continue}u.setUint16(m*2,d,!0),h.setUint16(m*2,p,!0);var x,w;switch(typeof t[m]){case"string":x=M0({t:"s",v:t[m]},r),w=B0({t:"s",v:t[m]},r);break;case"number":x=M0({t:"n",v:t[m]},r),w=B0({t:"n",v:t[m]},r);break;case"boolean":x=M0({t:"b",v:t[m]},r),w=B0({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}f.push(x),d+=x.length,g.push(w),p+=w.length,++c}for(e[2][0].data=Ie(c);m<e[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),h.setUint16(m*2,65535,!0);return e[6][0].data=gs(f),e[3][0].data=gs(g),c}function FF(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=vr(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(ut(n)));var i=Yc(r,{range:n,header:1}),a=["~Sh33tJ5~"];i.forEach(function(P){return P.forEach(function(I){typeof I=="string"&&a.push(I)})});var o={},c=[],u=We.read(t.numbers,{type:"base64"});u.FileIndex.map(function(P,I){return[P,u.FullPaths[I]]}).forEach(function(P){var I=P[0],R=P[1];if(I.type==2&&I.name.match(/\.iwa/)){var Y=I.content,ce=Ir(Y),ge=Rr(ce);ge.forEach(function(L){c.push(L.id),o[L.id]={deps:[],location:R,type:Gi(L.messages[0].meta[1][0].data)}})}}),c.sort(function(P,I){return P-I});var d=c.filter(function(P){return P>1}).map(function(P){return[P,Ie(P)]});u.FileIndex.map(function(P,I){return[P,u.FullPaths[I]]}).forEach(function(P){var I=P[0];if(P[1],!!I.name.match(/\.iwa/)){var R=Rr(Ir(I.content));R.forEach(function(Y){Y.messages.forEach(function(ce){d.forEach(function(ge){Y.messages.some(function(L){return Gi(L.meta[1][0].data)!=11006&&CF(L.data,ge[1])})&&o[ge[0]].deps.push(Y.id)})})})}});for(var f=We.find(u,o[1].location),h=Rr(Ir(f.content)),p,g=0;g<h.length;++g){var m=h[g];m.id==1&&(p=m)}var x=Ln(ft(p.messages[0].data)[1][0].data);for(f=We.find(u,o[x].location),h=Rr(Ir(f.content)),g=0;g<h.length;++g)m=h[g],m.id==x&&(p=m);for(x=Ln(ft(p.messages[0].data)[2][0].data),f=We.find(u,o[x].location),h=Rr(Ir(f.content)),g=0;g<h.length;++g)m=h[g],m.id==x&&(p=m);for(x=Ln(ft(p.messages[0].data)[2][0].data),f=We.find(u,o[x].location),h=Rr(Ir(f.content)),g=0;g<h.length;++g)m=h[g],m.id==x&&(p=m);var w=ft(p.messages[0].data);{w[6][0].data=Ie(n.e.r+1),w[7][0].data=Ie(n.e.c+1);var v=Ln(w[46][0].data),y=We.find(u,o[v].location),_=Rr(Ir(y.content));{for(var C=0;C<_.length&&_[C].id!=v;++C);if(_[C].id!=v)throw"Bad ColumnRowUIDMapArchive";var E=ft(_[C].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var T=0;T<=n.e.c;++T){var M=[];M[1]=M[2]=[{type:0,data:Ie(T+420690)}],E[1].push({type:2,data:Et(M)}),E[2].push({type:0,data:Ie(T)}),E[3].push({type:0,data:Ie(T)})}E[4]=[],E[5]=[],E[6]=[];for(var A=0;A<=n.e.r;++A)M=[],M[1]=M[2]=[{type:0,data:Ie(A+726270)}],E[4].push({type:2,data:Et(M)}),E[5].push({type:0,data:Ie(A)}),E[6].push({type:0,data:Ie(A)});_[C].messages[0].data=Et(E)}y.content=yi(vi(_)),y.size=y.content.length,delete w[46];var B=ft(w[4][0].data);{B[7][0].data=Ie(n.e.r+1);var z=ft(B[1][0].data),U=Ln(z[2][0].data);y=We.find(u,o[U].location),_=Rr(Ir(y.content));{if(_[0].id!=U)throw"Bad HeaderStorageBucket";var V=ft(_[0].messages[0].data);for(A=0;A<i.length;++A){var pe=ft(V[2][0].data);pe[1][0].data=Ie(A),pe[4][0].data=Ie(i[A].length),V[2][A]={type:V[2][0].type,data:Et(pe)}}_[0].messages[0].data=Et(V)}y.content=yi(vi(_)),y.size=y.content.length;var ne=Ln(B[2][0].data);y=We.find(u,o[ne].location),_=Rr(Ir(y.content));{if(_[0].id!=ne)throw"Bad HeaderStorageBucket";for(V=ft(_[0].messages[0].data),T=0;T<=n.e.c;++T)pe=ft(V[2][0].data),pe[1][0].data=Ie(T),pe[4][0].data=Ie(n.e.r+1),V[2][T]={type:V[2][0].type,data:Et(pe)};_[0].messages[0].data=Et(V)}y.content=yi(vi(_)),y.size=y.content.length;var le=Ln(B[4][0].data);(function(){for(var P=We.find(u,o[le].location),I=Rr(Ir(P.content)),R,Y=0;Y<I.length;++Y){var ce=I[Y];ce.id==le&&(R=ce)}var ge=ft(R.messages[0].data);{ge[3]=[];var L=[];a.forEach(function(ie,Se){L[1]=[{type:0,data:Ie(Se)}],L[2]=[{type:0,data:Ie(1)}],L[3]=[{type:2,data:NF(ie)}],ge[3].push({type:2,data:Et(L)})})}R.messages[0].data=Et(ge);var H=vi(I),fe=yi(H);P.content=fe,P.size=P.content.length})();var ee=ft(B[3][0].data);{var W=ee[1][0];delete ee[2];var G=ft(W.data);{var Z=Ln(G[2][0].data);(function(){for(var P=We.find(u,o[Z].location),I=Rr(Ir(P.content)),R,Y=0;Y<I.length;++Y){var ce=I[Y];ce.id==Z&&(R=ce)}var ge=ft(R.messages[0].data);{delete ge[6],delete ee[7];var L=new Uint8Array(ge[5][0].data);ge[5]=[];for(var H=0,fe=0;fe<=n.e.r;++fe){var ie=ft(L);H+=OF(ie,i[fe],a),ie[1][0].data=Ie(fe),ge[5].push({data:Et(ie),type:2})}ge[1]=[{type:0,data:Ie(n.e.c+1)}],ge[2]=[{type:0,data:Ie(n.e.r+1)}],ge[3]=[{type:0,data:Ie(H)}],ge[4]=[{type:0,data:Ie(n.e.r+1)}]}R.messages[0].data=Et(ge);var Se=vi(I),Te=yi(Se);P.content=Te,P.size=P.content.length})()}W.data=Et(G)}B[3][0].data=Et(ee)}w[4][0].data=Et(B)}p.messages[0].data=Et(w);var Q=vi(h),k=yi(Q);return f.content=k,f.size=f.content.length,u}function PF(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Ph(e){PF([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function DF(e,t){return t.bookType=="ods"?bw(e,t):t.bookType=="numbers"?FF(e,t):t.bookType=="xlsb"?RF(e,t):IF(e,t)}function RF(e,t){Di=1024,e&&!e.SSF&&(e.SSF=or(it)),e&&e.SSF&&(Du(),Pu(e.SSF),t.revssf=Ru(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,oo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=ow.indexOf(t.bookType)>-1,s=Iy();Ph(t=t||{});var i=xh(),a="",o=0;if(t.cellXfs=[],Ss(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Ce(i,a,$y(e.Props,t)),s.coreprops.push(a),Me(t.rels,2,a,De.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Ce(i,a,Wy(e.Props)),s.extprops.push(a),Me(t.rels,3,a,De.EXT_PROPS),e.Custprops!==e.Props&&Pt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Ce(i,a,Hy(e.Custprops)),s.custprops.push(a),Me(t.rels,4,a,De.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Ce(i,a,MO(o-1,a,t,e,d)),s.sheets.push(a),Me(t.wbrels,-1,"worksheets/sheet"+o+"."+r,De.WS[0])}if(f){var p=f["!comments"],g=!1,m="";p&&p.length>0&&(m="xl/comments"+o+"."+r,Ce(i,m,UO(p,m)),s.comments.push(m),Me(d,-1,"../comments"+o+"."+r,De.CMNT),g=!0),f["!legacy"]&&g&&Ce(i,"xl/drawings/vmlDrawing"+o+".vml",iw(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Ce(i,My(a),zi(d))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Ce(i,a,$O(t.Strings,a,t)),s.strs.push(a),Me(t.wbrels,-1,"sharedStrings."+r,De.SST)),a="xl/workbook."+r,Ce(i,a,LO(e,a)),s.workbooks.push(a),Me(t.rels,1,a,De.WB),a="xl/theme/theme1.xml",Ce(i,a,nw(e.Themes,t)),s.themes.push(a),Me(t.wbrels,-1,"theme/theme1.xml",De.THEME),a="xl/styles."+r,Ce(i,a,BO(e,a,t)),s.styles.push(a),Me(t.wbrels,-1,"styles."+r,De.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Ce(i,a,e.vbaraw),s.vba.push(a),Me(t.wbrels,-1,"vbaProject.bin",De.VBA)),a="xl/metadata."+r,Ce(i,a,WO(a)),s.metadata.push(a),Me(t.wbrels,-1,"metadata."+r,De.XLMETA),Ce(i,"[Content_Types].xml",Ly(s,t)),Ce(i,"_rels/.rels",zi(t.rels)),Ce(i,"xl/_rels/workbook."+r+".rels",zi(t.wbrels)),delete t.revssf,delete t.ssf,i}function IF(e,t){Di=1024,e&&!e.SSF&&(e.SSF=or(it)),e&&e.SSF&&(Du(),Pu(e.SSF),t.revssf=Ru(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,oo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=ow.indexOf(t.bookType)>-1,s=Iy();Ph(t=t||{});var i=xh(),a="",o=0;if(t.cellXfs=[],Ss(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Ce(i,a,$y(e.Props,t)),s.coreprops.push(a),Me(t.rels,2,a,De.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ce(i,a,Wy(e.Props)),s.extprops.push(a),Me(t.rels,3,a,De.EXT_PROPS),e.Custprops!==e.Props&&Pt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Ce(i,a,Hy(e.Custprops)),s.custprops.push(a),Me(t.rels,4,a,De.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Ce(i,a,gw(o-1,t,e,f)),s.sheets.push(a),Me(t.wbrels,-1,"worksheets/sheet"+o+"."+r,De.WS[0])}if(h){var g=h["!comments"],m=!1,x="";if(g&&g.length>0){var w=!1;g.forEach(function(v){v[1].forEach(function(y){y.T==!0&&(w=!0)})}),w&&(x="xl/threadedComments/threadedComment"+o+"."+r,Ce(i,x,hA(g,d,t)),s.threadedcomments.push(x),Me(f,-1,"../threadedComments/threadedComment"+o+"."+r,De.TCMNT)),x="xl/comments"+o+"."+r,Ce(i,x,aw(g)),s.comments.push(x),Me(f,-1,"../comments"+o+"."+r,De.CMNT),m=!0}h["!legacy"]&&m&&Ce(i,"xl/drawings/vmlDrawing"+o+".vml",iw(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Ce(i,My(a),zi(f))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Ce(i,a,Jy(t.Strings,t)),s.strs.push(a),Me(t.wbrels,-1,"sharedStrings."+r,De.SST)),a="xl/workbook."+r,Ce(i,a,yw(e)),s.workbooks.push(a),Me(t.rels,1,a,De.WB),a="xl/theme/theme1.xml",Ce(i,a,nw(e.Themes,t)),s.themes.push(a),Me(t.wbrels,-1,"theme/theme1.xml",De.THEME),a="xl/styles."+r,Ce(i,a,tw(e,t)),s.styles.push(a),Me(t.wbrels,-1,"styles."+r,De.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Ce(i,a,e.vbaraw),s.vba.push(a),Me(t.wbrels,-1,"vbaProject.bin",De.VBA)),a="xl/metadata."+r,Ce(i,a,sw()),s.metadata.push(a),Me(t.wbrels,-1,"metadata."+r,De.XLMETA),d.length>1&&(a="xl/persons/person.xml",Ce(i,a,mA(d)),s.people.push(a),Me(t.wbrels,-1,"persons/person.xml",De.PEOPLE)),Ce(i,"[Content_Types].xml",Ly(s,t)),Ce(i,"_rels/.rels",zi(t.rels)),Ce(i,"xl/_rels/workbook."+r+".rels",zi(t.wbrels)),delete t.revssf,delete t.ssf,i}function LF(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Cn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function kw(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Yo(t.file,We.write(e,{type:Re?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return We.write(e,t)}function MF(e,t){var r=or(t||{}),n=DF(e,r);return BF(n,r)}function BF(e,t){var r={},n=Re?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?We.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Fu(s))}return t.password&&typeof encrypt_agile<"u"?kw(encrypt_agile(s,t.password),t):t.type==="file"?Yo(t.file,s):t.type=="string"?no(s):s}function $F(e,t){var r=t||{},n=rF(e,r);return kw(n,r)}function en(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Ao(Fo(n));case"binary":return Fo(n);case"string":return e;case"file":return Yo(t.file,n,"utf8");case"buffer":return Re?Dn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):en(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function UF(e,t){switch(t.type){case"base64":return Ao(e);case"binary":return e;case"string":return e;case"file":return Yo(t.file,e,"binary");case"buffer":return Re?Dn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Rl(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Ao(r):t.type=="string"?no(r):r;case"file":return Yo(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Nw(e,t){p3(),kO(e);var r=or(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Nw(e,r);return r.type="array",Fu(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return en(eF(e,r),r);case"slk":case"sylk":return en(Sj.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return en(Ew(e.Sheets[e.SheetNames[s]],r),r);case"txt":return UF(Cw(e.Sheets[e.SheetNames[s]],r),r);case"csv":return en(Dh(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return en(Tj.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Rl(Ej.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return en(bj.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return en(Fj.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return en(Yy.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return en(bw(e,r),r);case"wk1":return Rl(Tg.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Rl(Tg.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Rl(_w(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),$F(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return MF(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function WF(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function HF(e,t,r){var n={};return n.type="file",n.file=t,WF(n),Nw(e,n)}function zF(e,t,r,n,s,i,a,o){var c=Ot(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!a||e[r])for(var p=t.s.c;p<=t.e.c;++p){var g=a?e[r][p]:e[n[p]+c];if(g===void 0||g.t===void 0){if(u===void 0)continue;i[p]!=null&&(h[i[p]]=u);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(i[p]!=null){if(m==null)if(g.t=="e"&&m===null)h[i[p]]=null;else if(u!==void 0)h[i[p]]=u;else if(d&&m===null)h[i[p]]=null;else continue;else h[i[p]]=d&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?m:jn(g,m,o);m!=null&&(f=!1)}}return{row:h,isempty:f}}function Yc(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=Xe(d);break;case"number":c=Xe(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var f=Ot(c.s.r),h=[],p=[],g=0,m=0,x=Array.isArray(e),w=c.s.r,v=0,y={};x&&!e[w]&&(e[w]=[]);var _=u.skipHidden&&e["!cols"]||[],C=u.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(_[v]||{}).hidden)switch(h[v]=Bt(v),r=x?e[w][v]:e[h[v]+f],n){case 1:i[v]=v-c.s.c;break;case 2:i[v]=h[v];break;case 3:i[v]=u.header[v-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=jn(r,null,u),m=y[a]||0,!m)y[a]=1;else{do o=a+"_"+m++;while(y[o]);y[a]=m,y[o]=1}i[v]=o}for(w=c.s.r+s;w<=c.e.r;++w)if(!(C[w]||{}).hidden){var E=zF(e,c,w,h,n,i,x,u);(E.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[g++]=E.row)}return p.length=g,p}var Fg=/"/g;function VF(e,t,r,n,s,i,a,o){for(var c=!0,u=[],d="",f=Ot(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=o.dense?(e[r]||[])[h]:e[n[h]+f];if(p==null)d="";else if(p.v!=null){c=!1,d=""+(o.rawNumbers&&p.t=="n"?p.v:jn(p,null,o));for(var g=0,m=0;g!==d.length;++g)if((m=d.charCodeAt(g))===s||m===i||m===34||o.forceQuotes){d='"'+d.replace(Fg,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(c=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(Fg,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(a)}function Dh(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=Xe(e["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(h[g]||{}).hidden||(f[g]=Bt(g));for(var m=0,x=s.s.r;x<=s.e.r;++x)(p[x]||{}).hidden||(d=VF(e,s,x,f,a,c,i,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((m++?o:"")+d)));return delete n.dense,r.join("")}function Cw(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Dh(e,t);return r}function GF(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=Xe(e["!ref"]),i="",a=[],o,c=[],u=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)a[o]=Bt(o);for(var d=s.s.r;d<=s.e.r;++d)for(i=Ot(d),o=s.s.c;o<=s.e.c;++o)if(t=a[o]+i,r=u?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function jw(e,t,r){var n=r||{},s=+!n.skipHeader,i=e||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?vt(n.origin):n.origin;a=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:a+t.length-1+s}};if(i["!ref"]){var f=Xe(i["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),a==-1&&(a=f.e.r+1,d.e.r=a+t.length-1+s)}else a==-1&&(a=0,d.e.r=t.length-1+s);var h=n.header||[],p=0;t.forEach(function(m,x){Pt(m).forEach(function(w){(p=h.indexOf(w))==-1&&(h[p=h.length]=w);var v=m[w],y="z",_="",C=Ue({c:o+p,r:a+x+s});u=Ro(i,C),v&&typeof v=="object"&&!(v instanceof Date)?i[C]=v:(typeof v=="number"?y="n":typeof v=="boolean"?y="b":typeof v=="string"?y="s":v instanceof Date?(y="d",n.cellDates||(y="n",v=ar(v)),_=n.dateNF||it[14]):v===null&&n.nullError&&(y="e",v=0),u?(u.t=y,u.v=v,delete u.w,delete u.R,_&&(u.z=_)):i[C]=u={t:y,v},_&&(u.z=_))})}),d.e.c=Math.max(d.e.c,o+h.length-1);var g=Ot(a);if(s)for(p=0;p<h.length;++p)i[Bt(p+o)+g]={t:"s",v:h[p]};return i["!ref"]=ut(d),i}function qF(e,t){return jw(null,e,t)}function Ro(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=vt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Ro(e,Ue(t)):Ro(e,Ue({r:t,c:r||0}))}function KF(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function XF(){return{SheetNames:[],Sheets:{}}}function YF(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=a+s)!=-1;++s);}if(vw(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function JF(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=KF(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function QF(e,t){return e.z=t,e}function Aw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function ZF(e,t,r){return Aw(e,"#"+t,r)}function eP(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function tP(e,t,r,n){for(var s=typeof t!="string"?t:Xe(t),i=typeof t=="string"?t:ut(t),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var c=Ro(e,a,o);c.t="n",c.F=i,delete c.v,a==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var $0={encode_col:Bt,encode_row:Ot,encode_cell:Ue,encode_range:ut,decode_col:Sh,decode_row:Eh,split_cell:pC,decode_cell:vt,decode_range:vr,format_cell:jn,sheet_add_aoa:Ay,sheet_add_json:jw,sheet_add_dom:Sw,aoa_to_sheet:pa,json_to_sheet:qF,table_to_sheet:Tw,table_to_book:TF,sheet_to_csv:Dh,sheet_to_txt:Cw,sheet_to_json:Yc,sheet_to_html:Ew,sheet_to_formulae:GF,sheet_to_row_object_array:Yc,sheet_get_cell:Ro,book_new:XF,book_append_sheet:YF,book_set_sheet_visibility:JF,cell_set_number_format:QF,cell_set_hyperlink:Aw,cell_set_internal_link:ZF,cell_add_comment:eP,sheet_set_array_formula:tP,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function rP(){const{currentDate:e,view:t,setView:r,goToNextPeriod:n,goToPreviousPeriod:s,goToToday:i,getSchedulesForEquipment:a,addSchedule:o,refreshSchedules:c}=Go(),[u,d]=b.useState(!1),[f,h]=b.useState(null),[p,g]=b.useState(null),[m,x]=b.useState([]),[w,v]=b.useState(!1),[y,_]=b.useState(null),[C,E]=b.useState(null);b.useEffect(()=>{T()},[]);const T=async()=>{try{const{data:Q,error:k}=await xe.from("sample_equipment").select("*").order("name");k?(console.error("Error fetching sample equipment:",k),x(Oc)):x(Q||[])}catch(Q){console.error("Error fetching sample equipment:",Q),x(Oc)}},A=(()=>{switch(t){case"day":return[e];case"week":const Q=At(e,{weekStartsOn:1});return Array.from({length:7},(Y,ce)=>Mt(Q,ce));case"month":const k=wu(e),P=vu(e),I=At(k,{weekStartsOn:1}),R=Mt(At(Mt(P,6),{weekStartsOn:1}),6);return yu({start:I,end:R});default:return[]}})(),[B,z]=b.useState([]);b.useEffect(()=>{U()},[e,t]);const U=async()=>{try{if(A.length===0)return;const Q=be(A[0],"yyyy-MM-dd"),k=be(A[A.length-1],"yyyy-MM-dd"),{data:P,error:I}=await xe.from("schedules").select("*").gte("start_time",`${Q}T00:00:00.000Z`).lte("start_time",`${k}T23:59:59.999Z`).order("start_time");I?console.error("Error fetching sample schedules:",I):z(P||[])}catch(Q){console.error("Error fetching sample schedules:",Q)}},V=(Q,k)=>B.filter(P=>{var R;return new Date(P.start_time).toDateString()===k.toDateString()&&((R=P.equipment)==null?void 0:R.some(Y=>Y.id===Q&&Y.type==="sample"))}).map(P=>({...P,startTime:new Date(P.start_time),endTime:new Date(P.end_time)})),pe=(Q,k)=>{h({id:Q.id,type:"sample"}),g(k),d(!0)},ne=async Q=>{var k,P;try{const{error:I}=await xe.from("schedules").insert([{type:Q.type,title:Q.title,details:Q.details,start_time:(k=Q.startTime)==null?void 0:k.toISOString(),end_time:(P=Q.endTime)==null?void 0:P.toISOString(),is_all_day:Q.isAllDay,participants:Q.participants,equipment:Q.equipment,reminders:Q.reminders,meet_link:Q.meetLink,meeting_type:Q.meetingType,created_by:Q.createdBy,quantity:Q.quantity,assigned_to:Q.assignedTo,notes:Q.notes}]);if(I)throw I;await c(),await U()}catch(I){console.error("Error saving sample reservation:",I),alert("")}},le=({isOpen:Q,onClose:k})=>{const[P,I]=b.useState([]),[R,Y]=b.useState(!1);b.useEffect(()=>{Q&&y&&C&&ce()},[Q,y,C]);const ce=async()=>{if(!(!y||!C)){Y(!0);try{const H=be(y,"yyyy-MM-dd"),{data:fe,error:ie}=await xe.from("schedules").select("*").gte("start_time",`${H}T00:00:00.000Z`).lte("start_time",`${H}T23:59:59.999Z`).order("start_time");if(ie)throw ie;const Se=(fe||[]).filter(Te=>{var He;return(He=Te.equipment)==null?void 0:He.some(Fe=>Fe.id===C&&Fe.type==="sample")});I(Se.map((Te,He)=>({...Te,order:He+1})))}catch(H){console.error("Error loading orders:",H)}finally{Y(!1)}}},ge=(H,fe)=>{const ie=[...P],Se=fe==="up"?H-1:H+1;Se<0||Se>=ie.length||([ie[H],ie[Se]]=[ie[Se],ie[H]],ie[H].order=H+1,ie[Se].order=Se+1,I(ie))},L=async()=>{try{Y(!0);const H=P.map((fe,ie)=>xe.from("schedules").update({order:ie+1}).eq("id",fe.id));await Promise.all(H),alert(""),k()}catch(H){console.error("Error saving order:",H),alert("")}finally{Y(!1)}};return Q?l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full max-h-[80vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),l.jsx("button",{onClick:k,className:"text-gray-400 hover:text-gray-500",children:l.jsx(Pn,{className:"h-6 w-6"})})]}),R?l.jsx("div",{className:"text-center py-4",children:"..."}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"space-y-2 mb-4",children:P.map((H,fe)=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"font-medium",children:[H.order,". ",H.title]}),l.jsx("div",{className:"text-sm text-gray-500",children:H.details})]}),l.jsxs("div",{className:"flex flex-col space-y-1",children:[l.jsx("button",{onClick:()=>ge(fe,"up"),disabled:fe===0,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30 disabled:cursor-not-allowed",children:l.jsx(hN,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>ge(fe,"down"),disabled:fe===P.length-1,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30 disabled:cursor-not-allowed",children:l.jsx(fN,{className:"h-4 w-4"})})]})]},H.id))}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx("button",{onClick:k,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:""}),l.jsx("button",{onClick:L,disabled:R,className:"px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 disabled:opacity-50",children:""})]})]})]})}):null},ee=()=>{try{const Q=[];A.forEach(Y=>{m.forEach(ce=>{V(ce.id,Y).forEach((L,H)=>{Q.push({:be(Y,"yyyy/MM/dd",{locale:Nr}),:be(Y,"EEEE",{locale:Nr}),:ce.name,:ce.type,:H+1,:L.title,:L.details,:be(L.startTime,"HH:mm"),:be(L.endTime,"HH:mm"),:L.quantity||"",:L.assigned_to||"",:L.notes||""})})})});const k=$0.book_new(),P=$0.json_to_sheet(Q),I=[{wch:12},{wch:8},{wch:15},{wch:15},{wch:6},{wch:20},{wch:25},{wch:8},{wch:8},{wch:6},{wch:10},{wch:15}];P["!cols"]=I,$0.book_append_sheet(k,P,"");const R=`_${be(new Date,"yyyyMMdd")}.xlsx`;HF(k,R)}catch(Q){console.error("Error exporting to Excel:",Q),alert("Excel")}},W=()=>t==="month"?Z():G(),G=()=>l.jsx("div",{className:"overflow-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-48",children:""}),A.map((Q,k)=>l.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("span",{children:be(Q,t==="day"?"yyyyMd EEEE":"EEEE",{locale:Nr})}),t!=="day"&&l.jsx("span",{className:`mt-1 text-sm ${fs(Q)?"bg-blue-100 text-blue-800 rounded-full w-7 h-7 flex items-center justify-center":""}`,children:be(Q,"d")})]})},k))]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(Q=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-purple-100 flex items-center justify-center",children:l.jsx(ta,{className:"h-6 w-6 text-purple-600"})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:Q.name}),l.jsx("div",{className:"text-xs text-gray-500",children:Q.type})]})]})}),A.map((k,P)=>{const I=V(Q.id,k);return l.jsxs("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-500 relative group border border-gray-100",children:[l.jsx("button",{onClick:()=>pe(Q,k),className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200 bg-purple-100 rounded-full p-1",children:l.jsx(hs,{className:"h-4 w-4 text-purple-600"})}),I.length>0&&l.jsx("button",{onClick:()=>{_(k),E(Q.id),v(!0)},className:"absolute top-1 left-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200 bg-yellow-100 rounded-full p-1",title:"",children:l.jsx(dN,{className:"h-4 w-4 text-yellow-600"})}),l.jsx("div",{className:t==="day"?"min-h-[120px]":"min-h-[80px]",children:I.map((R,Y)=>l.jsxs("div",{className:"mb-1 px-2 py-1 rounded text-xs bg-purple-100 text-purple-800 border-l-4 border-purple-500 cursor-pointer hover:bg-purple-200",onClick:()=>{},children:[l.jsxs("div",{className:"font-medium flex items-center justify-between",children:[l.jsxs("span",{children:[Y+1,". ",be(R.startTime,"HH:mm"),"-",be(R.endTime,"HH:mm")]}),R.quantity&&l.jsxs("span",{className:"bg-purple-200 text-purple-800 px-1 rounded text-xs",children:[R.quantity,""]})]}),l.jsx("div",{className:"truncate",children:R.title}),l.jsx("div",{className:"text-xs text-purple-600",children:R.details})]},R.id))})]},P)})]},Q.id))})]})}),Z=()=>{const Q=[];for(let k=0;k<A.length;k+=7)Q.push(A.slice(k,k+7));return l.jsxs("div",{className:"overflow-auto",children:[l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200 bg-gray-50",children:["","","","","","",""].map((k,P)=>l.jsx("div",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:k},P))}),Q.map((k,P)=>l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:k.map((I,R)=>{const Y=_u(I,e),ce=m.flatMap(ge=>V(ge.id,I));return l.jsxs("div",{className:`min-h-[120px] p-2 border-r border-gray-200 ${Y?"bg-white":"bg-gray-50 text-gray-400"}`,children:[l.jsx("div",{className:`text-sm font-medium mb-1 ${fs(I)?"bg-blue-100 text-blue-800 rounded-full w-6 h-6 flex items-center justify-center":""}`,children:be(I,"d")}),l.jsxs("div",{className:"space-y-1",children:[ce.slice(0,3).map(ge=>{const L=m.find(H=>{var fe;return(fe=ge.equipment)==null?void 0:fe.some(ie=>ie.id===H.id&&ie.type==="sample")});return l.jsx("div",{onClick:()=>{},className:"text-xs px-1 py-0.5 rounded truncate cursor-pointer hover:opacity-80 bg-purple-100 text-purple-800",title:`${L==null?void 0:L.name}: ${ge.title}`,children:l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(ta,{className:"h-3 w-3 flex-shrink-0"}),l.jsx("span",{className:"truncate",children:ge.title})]})},ge.id)}),ce.length>3&&l.jsxs("div",{className:"text-xs text-gray-500",children:["+",ce.length-3,""]})]})]},R)})},P))]})};return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:""}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsxs("button",{onClick:ee,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:[l.jsx(vN,{className:"h-5 w-5 mr-1"}),"Excel"]}),l.jsxs("button",{onClick:()=>{h(null),g(null),d(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:[l.jsx(hs,{className:"h-5 w-5 mr-1"}),""]})]})]}),l.jsxs("div",{className:"bg-white shadow rounded-lg",children:[l.jsx("div",{className:"px-4 py-5 border-b border-gray-200 sm:px-6",children:l.jsxs("div",{className:"flex items-center justify-between flex-wrap sm:flex-nowrap",children:[l.jsx("div",{children:l.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:be(e,"yyyyM",{locale:Nr})})}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("div",{className:"inline-flex shadow-sm rounded-md",children:[l.jsx("button",{type:"button",onClick:()=>r("day"),className:`relative inline-flex items-center px-4 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium ${t==="day"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>r("week"),className:`relative inline-flex items-center px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium ${t==="week"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>r("month"),className:`relative inline-flex items-center px-4 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium ${t==="month"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""})]}),l.jsxs("div",{className:"inline-flex rounded-md shadow-sm",children:[l.jsxs("button",{type:"button",onClick:s,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx(ju,{className:"h-5 w-5"})]}),l.jsx("button",{type:"button",onClick:i,className:"relative inline-flex items-center px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",children:""}),l.jsxs("button",{type:"button",onClick:n,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx(Ko,{className:"h-5 w-5"})]})]})]})]})}),W()]}),l.jsx(Ou,{isOpen:u,onClose:()=>d(!1),onSubmit:ne,selectedDate:p||void 0,selectedEquipment:f||void 0,type:"sample"}),l.jsx(le,{isOpen:w,onClose:()=>v(!1)})]})}function nP(){const{currentUser:e}=Wt(),[t,r]=b.useState("my"),[n,s]=b.useState(!1),[i,a]=b.useState({}),[o,c]=b.useState([]),[u,d]=b.useState(!0),[f,h]=b.useState([]),[p,g]=b.useState([]),[m,x]=b.useState([]);b.useEffect(()=>{y(),v(),w()},[]);const w=async()=>{try{const{data:U,error:V}=await xe.from("users").select("*").order("name");if(V)console.error("Error fetching users:",V),x(Xs);else{const pe=(U==null?void 0:U.map(ne=>({id:ne.id,employeeId:ne.employee_id,name:ne.name,nameKana:ne.name_kana,email:ne.email,phone:ne.phone,department:ne.department,role:ne.role,defaultWorkDays:ne.default_work_days||[]})))||[];x(pe)}}catch(U){console.error("Error fetching users:",U),x(Xs)}},v=async()=>{try{const{data:U,error:V}=await xe.from("groups").select("*").eq("type","leave").order("name");V?(console.error("Error fetching leave groups:",V),h(Cc.filter(pe=>pe.type==="leave"))):h(U||[])}catch(U){console.error("Error fetching leave groups:",U),h(Cc.filter(V=>V.type==="leave"))}},y=async()=>{try{const{data:U,error:V}=await xe.from("leave_requests").select("*").order("created_at",{ascending:!1});if(V)console.error("Failed to fetch leave requests:",V),console.warn("Using mock data for leave requests"),c(Np);else if(U){const pe=U.map(ne=>({id:ne.id,type:ne.type,userId:ne.user_id,date:new Date(ne.date),reason:ne.reason,status:ne.status,approvers:ne.approvers||[],createdAt:new Date(ne.created_at)}));c(pe)}}catch(U){console.error("Error fetching leave requests:",U),console.warn("Using mock data for leave requests"),c(Np)}finally{d(!1)}},C=(()=>{const U=new Set;return f.forEach(V=>{var pe;(pe=V.members)==null||pe.forEach(ne=>{U.add(ne)})}),p.forEach(V=>{U.add(V)}),Array.from(U).map(V=>m.find(pe=>pe.id===V)).filter(V=>V!==void 0)})(),E=m.find(U=>U.role==="president"),T=o.filter(U=>t==="my"?U.userId===(e==null?void 0:e.id):t==="pending"?U.approvers.some(V=>V.userId===(e==null?void 0:e.id)&&V.status==="pending"):t==="approved"?U.approvers.some(V=>V.userId===(e==null?void 0:e.id)&&V.status!=="pending"):!1),M=async U=>{var V;if(U.preventDefault(),!i.date){we.error("");return}if(!((V=i.reason)!=null&&V.trim())){we.error("");return}try{const pe=[...C.map(ee=>({userId:ee.id,status:"pending",timestamp:null,step:1})),...E&&!C.find(ee=>ee.id===E.id)?[{userId:E.id,status:"pending",timestamp:null,step:2}]:[]],{data:ne,error:le}=await xe.from("leave_requests").insert([{type:i.type||"vacation",user_id:(e==null?void 0:e.id)||"",date:new Date(i.date||new Date).toISOString().split("T")[0],reason:i.reason||"",status:"pending",approvers:pe}]).select().single();if(le){console.error("Error saving leave request:",le),we.error("");return}else if(ne){const ee={id:ne.id,type:ne.type,userId:ne.user_id,date:new Date(ne.date),reason:ne.reason,status:ne.status,approvers:ne.approvers||[],createdAt:new Date(ne.created_at)};c([...o,ee]),we.success("")}s(!1),a({}),g([])}catch(pe){console.error("Error:",pe),we.error("")}},A=async(U,V)=>{const pe=o.find(P=>P.id===U);if(!pe)return;const ne=pe.approvers.map(P=>P.userId===(e==null?void 0:e.id)?{...P,status:V?"approved":"rejected",timestamp:new Date}:P),le=ne.filter(P=>P.step===1),ee=ne.filter(P=>P.step===2),W=le.length>0&&le.every(P=>P.status==="approved"),G=le.some(P=>P.status==="rejected"),Z=ee.length===0||ee.every(P=>P.status==="approved"),Q=ee.some(P=>P.status==="rejected");let k="pending";G||Q?k="rejected":W&&Z?k="approved":k="pending";try{const{error:P}=await xe.from("leave_requests").update({status:k,approvers:ne}).eq("id",U);if(P)console.error("Error updating leave request:",P),we.error("");else{const I=o.map(R=>R.id===U?{...R,status:k,approvers:ne}:R);c(I),V?k==="approved"?we.success(""):we.success(""):we.success("")}}catch(P){console.error("Error:",P),we.error("")}},B=async U=>{if(confirm(""))try{const{error:V}=await xe.from("leave_requests").delete().eq("id",U);if(V)console.error("Error deleting leave request:",V),we.error("");else{const pe=o.filter(ne=>ne.id!==U);c(pe),we.success("")}}catch(V){console.error("Error:",V),we.error("")}},z=U=>U==="approved"?l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[l.jsx(pN,{className:"h-4 w-4 mr-1"}),""]}):U==="rejected"?l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[l.jsx(CN,{className:"h-4 w-4 mr-1"}),""]}):l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[l.jsx(Au,{className:"h-4 w-4 mr-1"}),""]});return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>s(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-rose-600 hover:bg-rose-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500",children:[l.jsx(hs,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsxs("div",{className:"bg-white shadow rounded-lg",children:[l.jsx("div",{className:"border-b border-gray-200",children:l.jsxs("nav",{className:"-mb-px flex","aria-label":"Tabs",children:[l.jsx("button",{onClick:()=>r("my"),className:`w-1/3 py-4 px-1 text-center border-b-2 font-medium text-sm ${t==="my"?"border-rose-500 text-rose-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:""}),l.jsx("button",{onClick:()=>r("pending"),className:`w-1/3 py-4 px-1 text-center border-b-2 font-medium text-sm ${t==="pending"?"border-rose-500 text-rose-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:""}),l.jsx("button",{onClick:()=>r("approved"),className:`w-1/3 py-4 px-1 text-center border-b-2 font-medium text-sm ${t==="approved"?"border-rose-500 text-rose-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:""})]})}),l.jsx("div",{className:"overflow-auto",children:u?l.jsxs("div",{className:"px-6 py-10 text-center text-gray-500",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-rose-600 mx-auto mb-4"}),"..."]}):T.length>0?l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col\\",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"relative px-6 py-3",children:l.jsx("span",{className:"sr-only",children:""})})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T.map(U=>{const V=m.find(pe=>pe.id===U.userId);return l.jsxs("tr",{children:[l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:(V==null?void 0:V.name)||""}),l.jsx("div",{className:"text-sm text-gray-500",children:V==null?void 0:V.department})]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${U.type==="vacation"?"bg-blue-100 text-blue-800":U.type==="late"?"bg-yellow-100 text-yellow-800":"bg-purple-100 text-purple-800"}`,children:U.type==="vacation"?"":U.type==="late"?"":""})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("div",{className:"text-sm text-gray-900",children:be(new Date(U.date),"yyyy/MM/dd")})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("div",{className:"text-sm text-gray-900",children:U.reason})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:z(U.status)}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:be(new Date(U.createdAt),"yyyy/MM/dd")}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[t==="pending"&&l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>A(U.id,!0),className:"text-green-600 hover:text-green-900",children:""}),l.jsx("button",{onClick:()=>A(U.id,!1),className:"text-red-600 hover:text-red-900",children:""})]}),t==="my"&&U.status==="pending"&&l.jsx("button",{onClick:()=>B(U.id),className:"text-gray-600 hover:text-gray-900",children:""})]})]},U.id)})})]}):l.jsx("div",{className:"px-6 py-10 text-center text-gray-500",children:""})})]}),n&&l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),l.jsx("button",{onClick:()=>s(!1),className:"text-gray-400 hover:text-gray-500",children:l.jsx(Pn,{className:"h-6 w-6"})})]}),l.jsxs("form",{onSubmit:M,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:i.type||"vacation",onChange:U=>a({...i,type:U.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"vacation",children:""}),l.jsx("option",{value:"late",children:""}),l.jsx("option",{value:"early",children:""})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"date",value:i.date?be(new Date(i.date),"yyyy-MM-dd"):"",onChange:U=>a({...i,date:new Date(U.target.value)}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("textarea",{value:i.reason||"",onChange:U=>a({...i,reason:U.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsxs("div",{className:"space-y-2 bg-gray-50 p-3 rounded-md max-h-32 overflow-y-auto",children:[f.length===0?l.jsx("p",{className:"text-sm text-gray-500",children:""}):f.flatMap(U=>{var V;return(V=U.members)==null?void 0:V.map(pe=>{const ne=m.find(le=>le.id===pe);return ne?l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-rose-100 flex items-center justify-center",children:l.jsx("span",{className:"text-sm font-medium text-rose-600",children:ne.name.charAt(0)})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:ne.name}),l.jsx("p",{className:"text-xs text-gray-500",children:ne.department})]})]},ne.id):null})}).filter(Boolean),E&&l.jsxs("div",{className:"border-t pt-2 mt-2",children:[l.jsx("p",{className:"text-xs text-gray-500 mb-2",children:""}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-purple-100 flex items-center justify-center",children:l.jsx("span",{className:"text-sm font-medium text-purple-600",children:E.name.charAt(0)})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:E.name}),l.jsx("p",{className:"text-xs text-gray-500",children:E.department})]})]})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:""}),l.jsx(ef,{selectedParticipants:p,onChange:g,showBusinessGroups:!0,showLeaveGroups:!1})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx("button",{type:"button",onClick:()=>s(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:""}),l.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-rose-600 hover:bg-rose-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500",children:""})]})]})]})})]})}function sP(){const[e,t]=b.useState([]),[r,n]=b.useState(!1),[s,i]=b.useState(null),[a,o]=b.useState({}),[c,u]=b.useState(!0);b.useEffect(()=>{d()},[]);const d=async()=>{try{u(!0);const{data:g,error:m}=await xe.from("users").select("*").order("name");if(m)console.error("Error fetching users:",m),t(Xs);else{const x=(g==null?void 0:g.map(w=>({id:w.id,employeeId:w.employee_id,name:w.name,nameKana:w.name_kana,email:w.email,phone:w.phone,department:w.department,role:w.role,defaultWorkDays:w.default_work_days||[{day:1,startTime:"09:00",endTime:"18:00"},{day:2,startTime:"09:00",endTime:"18:00"},{day:3,startTime:"09:00",endTime:"18:00"},{day:4,startTime:"09:00",endTime:"18:00"},{day:5,startTime:"09:00",endTime:"18:00"}]})))||[];t(x)}}catch(g){console.error("Error fetching users:",g),t(Xs)}finally{u(!1)}},f=async g=>{var x,w,v;g.preventDefault();const m=[];if((x=a.name)!=null&&x.trim()||m.push(""),(w=a.email)!=null&&w.trim()?a.email.endsWith("@terao-f.co.jp")||m.push("@terao-f.co.jp"):m.push(""),(v=a.employeeId)!=null&&v.trim()||m.push(""),a.department||m.push(""),a.role||m.push(""),m.length>0){we.error(m[0]);return}try{const y=[{day:1,startTime:"09:00",endTime:"18:00"},{day:2,startTime:"09:00",endTime:"18:00"},{day:3,startTime:"09:00",endTime:"18:00"},{day:4,startTime:"09:00",endTime:"18:00"},{day:5,startTime:"09:00",endTime:"18:00"}];if(s){const{error:_}=await xe.from("users").update({employee_id:a.employeeId||"",name:a.name||"",name_kana:a.nameKana||"",email:a.email||"",phone:a.phone||"",department:a.department||"",role:a.role||"employee",default_work_days:a.defaultWorkDays||y,updated_at:new Date().toISOString()}).eq("id",s.id);if(_)throw _;we.success("")}else{const{error:_}=await xe.from("users").insert([{employee_id:a.employeeId||"",name:a.name||"",name_kana:a.nameKana||"",email:a.email||"",phone:a.phone||"",department:a.department||"",role:a.role||"employee",default_work_days:y}]);if(_)throw _;we.success("")}await d(),n(!1),i(null),o({})}catch(y){console.error("Error saving user:",y),we.error("")}},h=g=>{i(g),o(g),n(!0)},p=async g=>{if(confirm(""))try{const{error:m}=await xe.from("users").delete().eq("id",g);if(m)throw m;we.success(""),await d()}catch(m){console.error("Error deleting user:",m),we.error("")}};return c?l.jsx("div",{className:"h-full flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"..."})]})}):l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{i(null),o({}),n(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[l.jsx(NN,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"relative px-6 py-3",children:l.jsx("span",{className:"sr-only",children:""})})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(g=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:l.jsx("span",{className:"text-indigo-700 font-medium text-sm",children:g.name.charAt(0)})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:g.name}),l.jsx("div",{className:"text-sm text-gray-500",children:g.nameKana}),l.jsx("div",{className:"text-xs text-gray-400",children:g.employeeId})]})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("div",{className:"text-sm text-gray-900",children:g.department})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.role==="president"?"bg-purple-100 text-purple-800":g.role==="admin"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:g.role==="president"?"":g.role==="admin"?"":""})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[l.jsx("div",{children:g.email}),l.jsx("div",{children:g.phone})]}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[l.jsx("button",{onClick:()=>h(g),className:"text-indigo-600 hover:text-indigo-900 mr-3",children:l.jsx(eo,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>p(g.id),className:"text-red-600 hover:text-red-900",children:l.jsx(to,{className:"h-4 w-4"})})]})]},g.id))})]})}),r&&l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:s?"":""}),l.jsx("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-500",children:l.jsx(Pn,{className:"h-6 w-6"})})]}),l.jsxs("form",{onSubmit:f,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:a.employeeId||"",onChange:g=>o({...a,employeeId:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:a.name||"",onChange:g=>o({...a,name:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:a.nameKana||"",onChange:g=>o({...a,nameKana:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"email",value:a.email||"",onChange:g=>o({...a,email:g.target.value}),placeholder:"example@terao-f.co.jp",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),l.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"@terao-f.co.jp"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"tel",value:a.phone||"",onChange:g=>o({...a,phone:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:a.department||"",onChange:g=>o({...a,department:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"CAD-CAM",children:"CAD-CAM"}),l.jsx("option",{value:"WEB",children:"WEB"}),l.jsx("option",{value:"",children:""})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:a.role||"",onChange:g=>o({...a,role:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"employee",children:""}),l.jsx("option",{value:"admin",children:""}),l.jsx("option",{value:"president",children:""})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:""}),l.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:s?"":""})]})]})]})})]})}function iP(){const[e,t]=b.useState([]),[r,n]=b.useState(!1),[s,i]=b.useState(null),[a,o]=b.useState({}),[c,u]=b.useState(!0);b.useEffect(()=>{d()},[]);const d=async()=>{try{u(!0);const{data:g,error:m}=await xe.from("groups").select("*").order("type, name");if(m)console.error("Error fetching groups:",m),t(Cc);else{const x=(g==null?void 0:g.map(w=>({id:w.id,name:w.name,type:w.type,members:w.members||[],createdBy:w.created_by,createdAt:new Date(w.created_at)})))||[];t(x)}}catch(g){console.error("Error fetching groups:",g),t(Cc)}finally{u(!1)}},f=async g=>{g.preventDefault();try{if(s){const{error:m}=await xe.from("groups").update({name:a.name||"",type:a.type||"department",members:a.members||[],updated_at:new Date().toISOString()}).eq("id",s.id);if(m)throw m;we.success("")}else{const{error:m}=await xe.from("groups").insert([{name:a.name||"",type:a.type||"department",members:a.members||[],created_by:"550e8400-e29b-41d4-a716-446655440001"}]);if(m)throw m;we.success("")}await d(),n(!1),i(null),o({})}catch(m){console.error("Error saving group:",m),we.error("")}},h=g=>{i(g),o(g),n(!0)},p=async g=>{if(confirm(""))try{const{error:m}=await xe.from("groups").delete().eq("id",g);if(m)throw m;we.success(""),await d()}catch(m){console.error("Error deleting group:",m),we.error("")}};return c?l.jsx("div",{className:"h-full flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"..."})]})}):l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{i(null),o({}),n(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[l.jsx(Hr,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"relative px-6 py-3",children:l.jsx("span",{className:"sr-only",children:""})})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(g=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:l.jsx(Hr,{className:"h-5 w-5 text-indigo-600"})}),l.jsx("div",{className:"ml-4",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:g.name})})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.type==="department"?"bg-green-100 text-green-800":g.type==="business"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:g.type==="department"?"":g.type==="business"?"":""})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[g.members.length,""]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(g.createdAt).toLocaleDateString("ja-JP")}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[l.jsx("button",{onClick:()=>h(g),className:"text-indigo-600 hover:text-indigo-900 mr-3",children:l.jsx(eo,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>p(g.id),className:"text-red-600 hover:text-red-900",children:l.jsx(to,{className:"h-4 w-4"})})]})]},g.id))})]})}),r&&l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:s?"":""}),l.jsx("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-500",children:l.jsx(Pn,{className:"h-6 w-6"})})]}),l.jsxs("form",{onSubmit:f,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:a.name||"",onChange:g=>o({...a,name:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:a.type||"",onChange:g=>o({...a,type:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"department",children:""}),l.jsx("option",{value:"business",children:""}),l.jsx("option",{value:"leave",children:""})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:""}),l.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:s?"":""})]})]})]})})]})}function aP(){const[e,t]=b.useState([]),[r,n]=b.useState([]),[s,i]=b.useState([]),[a,o]=b.useState(!0),[c,u]=b.useState(!1),[d,f]=b.useState(null),[h,p]=b.useState(null),[g,m]=b.useState({});b.useEffect(()=>{x()},[]);const x=async()=>{try{o(!0);const{data:_,error:C}=await xe.from("rooms").select("*").order("name");C?(console.error("Error fetching rooms:",C),t(jc)):t(_||[]);const{data:E,error:T}=await xe.from("vehicles").select("*").order("name");if(T)console.error("Error fetching vehicles:",T),n(Ac);else{const B=(E==null?void 0:E.map(z=>({id:z.id,name:z.name,licensePlate:z.license_plate,type:z.type,createdBy:z.created_by})))||[];n(B)}const{data:M,error:A}=await xe.from("sample_equipment").select("*").order("name");A?(console.error("Error fetching sample equipment:",A),i(Oc)):i(M||[])}catch(_){console.error("Error fetching data:",_),t(jc),n(Ac),i(Oc)}finally{o(!1)}},w=async _=>{_.preventDefault();try{switch(d){case"room":if(h){const{error:C}=await xe.from("rooms").update({name:g.name||"",updated_at:new Date().toISOString()}).eq("id",h.id);if(C)throw C;we.success("")}else{const{error:C}=await xe.from("rooms").insert([{name:g.name||"",created_by:"550e8400-e29b-41d4-a716-446655440001"}]);if(C)throw C;we.success("")}break;case"vehicle":if(h){const{error:C}=await xe.from("vehicles").update({name:g.name||"",license_plate:g.licensePlate||"",type:g.type||"",updated_at:new Date().toISOString()}).eq("id",h.id);if(C)throw C;we.success("")}else{const{error:C}=await xe.from("vehicles").insert([{name:g.name||"",license_plate:g.licensePlate||"",type:g.type||"",created_by:"550e8400-e29b-41d4-a716-446655440001"}]);if(C)throw C;we.success("")}break;case"sample":if(h){const{error:C}=await xe.from("sample_equipment").update({name:g.name||"",type:g.type||"",updated_at:new Date().toISOString()}).eq("id",h.id);if(C)throw C;we.success("")}else{const{error:C}=await xe.from("sample_equipment").insert([{name:g.name||"",type:g.type||""}]);if(C)throw C;we.success("")}break}await x(),u(!1),p(null),m({}),f(null)}catch(C){console.error("Error saving data:",C),we.error("")}},v=(_,C)=>{p(_),m(_),f(C),u(!0)},y=async(_,C)=>{if(confirm(""))try{let E;switch(C){case"room":({error:E}=await xe.from("rooms").delete().eq("id",_));break;case"vehicle":({error:E}=await xe.from("vehicles").delete().eq("id",_));break;case"sample":({error:E}=await xe.from("sample_equipment").delete().eq("id",_));break}if(E)throw E;we.success(""),await x()}catch(E){console.error("Error deleting data:",E),we.error("")}};return a?l.jsx("div",{className:"h-full flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"..."})]})}):l.jsxs("div",{className:"h-full flex flex-col space-y-8",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{p(null),m({}),f("room"),u(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500",children:[l.jsx(sa,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"relative px-6 py-3",children:l.jsx("span",{className:"sr-only",children:""})})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(_=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-emerald-100 flex items-center justify-center",children:l.jsx(sa,{className:"h-5 w-5 text-emerald-600"})}),l.jsx("div",{className:"ml-4",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:_.name})})]})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[l.jsx("button",{onClick:()=>v(_,"room"),className:"text-emerald-600 hover:text-emerald-900 mr-3",children:l.jsx(eo,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>y(_.id,"room"),className:"text-red-600 hover:text-red-900",children:l.jsx(to,{className:"h-4 w-4"})})]})]},_.id))})]})})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{p(null),m({}),f("vehicle"),u(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-amber-600 hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500",children:[l.jsx(na,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"relative px-6 py-3",children:l.jsx("span",{className:"sr-only",children:""})})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(_=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-amber-100 flex items-center justify-center",children:l.jsx(na,{className:"h-5 w-5 text-amber-600"})}),l.jsx("div",{className:"ml-4",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:_.name})})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:_.licensePlate}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:_.type}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[l.jsx("button",{onClick:()=>v(_,"vehicle"),className:"text-amber-600 hover:text-amber-900 mr-3",children:l.jsx(eo,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>y(_.id,"vehicle"),className:"text-red-600 hover:text-red-900",children:l.jsx(to,{className:"h-4 w-4"})})]})]},_.id))})]})})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{p(null),m({}),f("sample"),u(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:[l.jsx(ta,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"relative px-6 py-3",children:l.jsx("span",{className:"sr-only",children:""})})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(_=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-purple-100 flex items-center justify-center",children:l.jsx(ta,{className:"h-5 w-5 text-purple-600"})}),l.jsx("div",{className:"ml-4",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:_.name})})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:_.type}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[l.jsx("button",{onClick:()=>v(_,"sample"),className:"text-purple-600 hover:text-purple-900 mr-3",children:l.jsx(eo,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>y(_.id,"sample"),className:"text-red-600 hover:text-red-900",children:l.jsx(to,{className:"h-4 w-4"})})]})]},_.id))})]})})]}),c&&l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:h?"":""}),l.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-500",children:l.jsx(Pn,{className:"h-6 w-6"})})]}),l.jsxs("form",{onSubmit:w,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:d==="room"?"":d==="vehicle"?"":""}),l.jsx("input",{type:"text",value:g.name||"",onChange:_=>m({...g,name:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),d==="vehicle"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:g.licensePlate||"",onChange:_=>m({...g,licensePlate:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:g.type||"",onChange:_=>m({...g,type:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""})]})]})]}),d==="sample"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:g.type||"",onChange:_=>m({...g,type:_.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"CAD",children:"CAD"}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx("button",{type:"button",onClick:()=>u(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:""}),l.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:h?"":""})]})]})]})})]})}class oP{constructor(){this.checkInterval=null,this.isRunning=!1}start(){this.isRunning||(this.isRunning=!0,this.checkInterval=window.setInterval(()=>{this.processScheduledNotifications()},6e4),this.processScheduledNotifications())}stop(){this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.isRunning=!1}async processScheduledNotifications(){try{const t=new Date,r=new Date(t.getTime()+5*6e4),{data:n,error:s}=await xe.from("scheduled_notifications").select(`
          *,
          schedules (
            id,
            title,
            type,
            start_time,
            end_time,
            details,
            meet_link,
            participants,
            equipment
          )
        `).eq("status","pending").lte("scheduled_for",r.toISOString()).order("scheduled_for",{ascending:!0});if(s){console.error("Error fetching scheduled notifications:",s);return}if(!n||n.length===0)return;for(const i of n)await this.processNotification(i)}catch(t){console.error("Error in processScheduledNotifications:",t)}}async processNotification(t){try{const r=new Date(t.scheduled_for),n=new Date;if(r>n)return;const{data:s,error:i}=await xe.from("users").select("id, name, email").eq("id",t.user_id).single();if(i||!s){console.error("User not found for notification:",t.user_id),await this.markNotificationAsFailed(t.id,"User not found");return}const a=await this.getParticipantNames(t.schedules.participants),o=new Date(t.schedules.start_time),c=this.formatTimeUntil(o,n),u={schedule:{id:t.schedules.id,title:t.schedules.title,type:t.schedules.type,startTime:new Date(t.schedules.start_time),endTime:new Date(t.schedules.end_time),details:t.schedules.details,meetLink:t.schedules.meet_link,participants:a,location:this.getLocationFromEquipment(t.schedules.equipment)},user:{id:s.id,name:s.name,email:s.email},timeUntilEvent:c};await Kr.notifyScheduleReminder(u),await this.markNotificationAsSent(t.id)}catch(r){console.error("Error processing notification:",r),await this.markNotificationAsFailed(t.id,r instanceof Error?r.message:"Unknown error")}}async markNotificationAsSent(t){await xe.from("scheduled_notifications").update({status:"sent"}).eq("id",t)}async markNotificationAsFailed(t,r){await xe.from("scheduled_notifications").update({status:"failed"}).eq("id",t)}async getParticipantNames(t){if(!t||t.length===0)return[];const{data:r}=await xe.from("users").select("name").in("id",t);return(r==null?void 0:r.map(n=>n.name))||[]}getLocationFromEquipment(t){if(!t||t.length===0)return;const r=t.filter(n=>n.type==="room");if(r.length>0)return r.map(n=>n.name).join(", ")}formatTimeUntil(t,r){const n=t.getTime()-r.getTime(),s=Math.floor(n/6e4);if(s<=0)return"";if(s<60)return`${s}`;{const i=Math.floor(s/60),a=s%60;return a===0?`${i}`:`${i}${a}`}}async sendTestReminder(t,r){try{const{data:n,error:s}=await xe.from("schedules").select("*").eq("id",t).single();if(s||!n)return console.error("Schedule not found:",t),!1;const{data:i,error:a}=await xe.from("users").select("id, name, email").eq("id",r).single();if(a||!i)return console.error("User not found:",r),!1;const o=await this.getParticipantNames(n.participants),c={schedule:{id:n.id,title:n.title,type:n.type,startTime:new Date(n.start_time),endTime:new Date(n.end_time),details:n.details,meetLink:n.meet_link,participants:o,location:this.getLocationFromEquipment(n.equipment)},user:{id:i.id,name:i.name,email:i.email},timeUntilEvent:"15"};return await Kr.notifyScheduleReminder(c),!0}catch(n){return console.error("Error sending test reminder:",n),!1}}}const lP=new oP;function cP(){const{currentUser:e}=Wt(),[t,r]=b.useState(!1),n=async()=>{if(e){r(!0);try{const o=await Kr.sendEmail({to:e.email,templateName:"schedule_reminder",variables:{userName:e.name,title:"",startTime:"202468 14:00",endTime:"202468 15:00",type:"",location:"A",details:"",timeUntilEvent:"15",calendarLink:window.location.origin+"/calendar"},userId:e.id});o.success?we.success(""):we.error(": "+o.error)}catch(o){console.error("Error sending test email:",o),we.error("")}finally{r(!1)}}},s=async()=>{if(e){r(!0);try{if(await Kv(e.id)){const c=await Kr.sendPush({userId:e.id,title:"",body:"",icon:"/icon-192x192.png",badge:"/badge-72x72.png",tag:"test-notification",data:{type:"test",timestamp:Date.now()},requireInteraction:!1,actions:[{action:"view",title:""},{action:"dismiss",title:""}]});c.success?we.success(""):we.error(": "+c.error)}else we.error("")}catch(o){console.error("Error sending test push notification:",o),we.error("")}finally{r(!1)}}},i=async()=>{r(!0);try{await Xv("",{body:"",icon:"/icon-192x192.png",badge:"/badge-72x72.png",tag:"local-test",requireInteraction:!1}),we.success("")}catch(o){console.error("Error showing local notification:",o),we.error("")}finally{r(!1)}},a=async()=>{if(e){r(!0);try{const o="test-schedule-"+Date.now();await lP.sendTestReminder(o,e.id)?we.success(""):we.error("")}catch(o){console.error("Error sending test reminder:",o),we.error("")}finally{r(!1)}}};return e?l.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(kN,{className:"h-6 w-6 text-blue-600 mr-2"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-6",children:""}),l.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[l.jsxs("button",{onClick:n,disabled:t,className:"flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(fh,{className:"h-5 w-5 mr-2"}),""]}),l.jsxs("button",{onClick:s,disabled:t,className:"flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(Bs,{className:"h-5 w-5 mr-2"}),""]}),l.jsxs("button",{onClick:i,disabled:t,className:"flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(Bs,{className:"h-5 w-5 mr-2"}),""]}),l.jsxs("button",{onClick:a,disabled:t,className:"flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(ra,{className:"h-5 w-5 mr-2"}),""]})]}),t&&l.jsxs("div",{className:"mt-4 flex items-center justify-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-indigo-600"}),l.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"..."})]})]}):l.jsx("div",{className:"p-4 bg-yellow-50 rounded-md",children:l.jsx("p",{className:"text-yellow-800",children:""})})}function uP(){const{currentUser:e}=Wt(),[t,r]=b.useState(null),[n,s]=b.useState(!0),[i,a]=b.useState(!1),[o]=b.useState(qo());b.useEffect(()=>{e&&c()},[e]);const c=async()=>{if(e){s(!0);try{const h=await Kr.getUserPreferences(e.id);r(h)}catch(h){console.error("Error loading preferences:",h),we.error("")}finally{s(!1)}}},u=async()=>{if(!(!e||!t)){a(!0);try{await Kr.updateUserPreferences(e.id,t)?we.success(""):we.error("")}catch(h){console.error("Error saving preferences:",h),we.error("")}finally{a(!1)}}},d=async h=>{e&&(h?await Kv(e.id)?(r(g=>g?{...g,pushEnabled:!0}:null),we.success("")):we.error(""):await sN(e.id)?(r(g=>g?{...g,pushEnabled:!1}:null),we.success("")):we.error(""))},f=(h,p)=>{r(g=>g?{...g,[h]:p}:null)};return n?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"text-gray-500",children:"..."})}):t?l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"bg-white shadow rounded-lg",children:[l.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""}),l.jsx("p",{className:"mt-1 text-sm text-gray-600",children:""})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(fh,{className:"h-5 w-5 text-gray-400 mr-2"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("label",{className:"flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:t.emailEnabled,onChange:h=>f("emailEnabled",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700",children:""})]})}),t.emailEnabled&&l.jsxs("div",{className:"ml-6 space-y-3",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.emailScheduleCreated,onChange:h=>f("emailScheduleCreated",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.emailScheduleUpdated,onChange:h=>f("emailScheduleUpdated",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.emailScheduleDeleted,onChange:h=>f("emailScheduleDeleted",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.emailScheduleReminder,onChange:h=>f("emailScheduleReminder",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.emailLeaveRequest,onChange:h=>f("emailLeaveRequest",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.emailLeaveApproval,onChange:h=>f("emailLeaveApproval",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:"/"})]})]})]})]}),l.jsxs("div",{className:"border-t pt-6",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(bN,{className:"h-5 w-5 text-gray-400 mr-2"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""})]}),o?l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("label",{className:"flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:t.pushEnabled,onChange:h=>d(h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700",children:""})]})}),t.pushEnabled&&l.jsxs("div",{className:"ml-6 space-y-3",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.pushScheduleCreated,onChange:h=>f("pushScheduleCreated",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.pushScheduleUpdated,onChange:h=>f("pushScheduleUpdated",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.pushScheduleDeleted,onChange:h=>f("pushScheduleDeleted",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.pushScheduleReminder,onChange:h=>f("pushScheduleReminder",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.pushLeaveRequest,onChange:h=>f("pushLeaveRequest",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.pushLeaveApproval,onChange:h=>f("pushLeaveApproval",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:"/"})]})]})]}):l.jsx("div",{className:"p-4 bg-yellow-50 rounded-md",children:l.jsx("p",{className:"text-sm text-yellow-800",children:""})})]}),l.jsxs("div",{className:"border-t pt-6",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(Au,{className:"h-5 w-5 text-gray-400 mr-2"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""})]}),l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsxs("select",{value:t.defaultReminderTime,onChange:h=>f("defaultReminderTime",parseInt(h.target.value)),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:5,children:"5"}),l.jsx("option",{value:10,children:"10"}),l.jsx("option",{value:15,children:"15"}),l.jsx("option",{value:30,children:"30"}),l.jsx("option",{value:60,children:"1"}),l.jsx("option",{value:120,children:"2"}),l.jsx("option",{value:1440,children:"1"})]})]})})]}),l.jsxs("div",{className:"border-t pt-6",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(EN,{className:"h-5 w-5 text-gray-400 mr-2"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.quietHoursEnabled,onChange:h=>f("quietHoursEnabled",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700",children:""})]}),t.quietHoursEnabled&&l.jsxs("div",{className:"ml-6 grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("input",{type:"time",value:t.quietHoursStart||"22:00",onChange:h=>f("quietHoursStart",h.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("input",{type:"time",value:t.quietHoursEnd||"07:00",onChange:h=>f("quietHoursEnd",h.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),t.quietHoursEnabled&&l.jsx("p",{className:"ml-6 text-sm text-gray-500",children:""})]})]})]}),l.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end",children:l.jsx("button",{onClick:u,disabled:i,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:i?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"..."]}):l.jsxs(l.Fragment,{children:[l.jsx(gN,{className:"h-4 w-4 mr-2"}),""]})})})]}),l.jsx("div",{className:"mt-8",children:l.jsx(cP,{})})]}):l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"text-gray-500",children:""})})}function Il({children:e,minRole:t,redirectTo:r="/user-switch"}){const{isAuthenticated:n,currentUser:s}=Wt();return!n||!s?l.jsx(uv,{to:r,replace:!0}):t&&s.role!=="president"&&t==="admin"&&s.role!=="admin"?l.jsx("div",{className:"flex h-screen items-center justify-center bg-gray-50",children:l.jsxs("div",{className:"text-center p-8",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:""}),l.jsx("p",{className:"text-gray-600 mb-4",children:""}),l.jsx("button",{onClick:()=>window.history.back(),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:""})]})}):l.jsx(l.Fragment,{children:e})}function Ow(){const{permissions:e,rolePermissions:t,hasPermission:r,hasAnyPermission:n,hasAllPermissions:s,canAccessResource:i,logSecurityEvent:a}=xv(),{currentUser:o}=Wt(),c=b.useMemo(()=>({canReadUsers:()=>r("users:read"),canWriteUsers:()=>r("users:write"),canDeleteUsers:()=>r("users:delete"),canManageRoles:()=>r("users:manage_roles"),canReadGroups:()=>r("groups:read"),canWriteGroups:()=>r("groups:write"),canDeleteGroups:()=>r("groups:delete"),canManageGroupMembers:()=>r("groups:manage_members"),canReadEquipment:()=>r("equipment:read"),canWriteEquipment:()=>r("equipment:write"),canDeleteEquipment:()=>r("equipment:delete"),canReadSchedules:()=>r("schedules:read"),canWriteSchedules:()=>r("schedules:write"),canDeleteSchedules:()=>r("schedules:delete"),canReadAllSchedules:()=>r("schedules:read_all"),canManageOthersSchedules:()=>r("schedules:manage_others"),canReadLeaveRequests:()=>r("leave:read"),canWriteLeaveRequests:()=>r("leave:write"),canApproveLeaveRequests:()=>r("leave:approve"),canReadAllLeaveRequests:()=>r("leave:read_all"),canAccessAdmin:()=>r("admin:access"),canManageSystemSettings:()=>r("admin:system_settings"),canViewAuditLogs:()=>r("admin:audit_logs"),canBackupSystem:()=>r("system:backup"),canPerformMaintenance:()=>r("system:maintenance")}),[r]),u=b.useMemo(()=>({canViewAllUsers:t.dataAccess.canViewAllUsers,canViewAllSchedules:t.dataAccess.canViewAllSchedules,canViewAllLeaveRequests:t.dataAccess.canViewAllLeaveRequests,canModifyOthersData:t.dataAccess.canModifyOthersData}),[t]),d=b.useMemo(()=>({canAccessUser:(m,x="read")=>i("user",x,m),canAccessSchedule:(m,x="read")=>i("schedule",x,m),canAccessLeaveRequest:(m,x="read")=>i("leave_request",x,m),canAccessGroup:(m,x="read")=>i("group",x,m),canAccessEquipment:(m="read")=>i("equipment",m)}),[i]),f=b.useMemo(()=>({isPresident:()=>(o==null?void 0:o.role)==="president",isAdmin:()=>(o==null?void 0:o.role)==="admin",isEmployee:()=>(o==null?void 0:o.role)==="employee",isAdminOrAbove:()=>(o==null?void 0:o.role)==="admin"||(o==null?void 0:o.role)==="president",hasRole:m=>(o==null?void 0:o.role)===m,hasAnyRole:m=>o?m.includes(o.role):!1}),[o]);return{permissions:e,rolePermissions:t,hasPermission:r,hasAnyPermission:n,hasAllPermissions:s,canAccessResource:i,...c,...u,...d,...f,enforcePermission:(m,x)=>{if(!r(m))throw a({type:"permission_denied",action:x||`Attempted action requiring permission: ${m}`,resource:m.split(":")[0],severity:"medium"}),new Error(`Permission denied: ${m}`)},enforceAnyPermission:(m,x)=>{if(!n(m))throw a({type:"permission_denied",action:x||`Attempted action requiring any of permissions: ${m.join(", ")}`,details:{requiredPermissions:m},severity:"medium"}),new Error(`Permission denied: Requires any of ${m.join(", ")}`)},enforceResourceAccess:(m,x,w)=>{if(!i(m,x,w))throw a({type:"permission_denied",action:`Attempted ${x} on ${m}`,resource:m,resourceId:w,severity:"medium"}),new Error(`Access denied: Cannot ${x} ${m}`)}}}function Pg({children:e,permission:t,permissions:r,requireAll:n=!1,role:s,roles:i,minRole:a,resource:o,action:c="read",resourceOwnerId:u,fallback:d=null,customCheck:f}){const{hasPermission:h,hasAnyPermission:p,hasAllPermissions:g,canAccessResource:m,hasRole:x,hasAnyRole:w,isAdminOrAbove:v}=Ow(),y=_=>{setTimeout(()=>{console.log("PermissionGate - :",_)},0)};return f?f()?l.jsx(l.Fragment,{children:e}):(y({type:"permission_denied",action:"Failed custom permission check",severity:"low"}),l.jsx(l.Fragment,{children:d})):t?h(t)?l.jsx(l.Fragment,{children:e}):(y({type:"permission_denied",action:`Access denied for permission: ${t}`,severity:"low"}),l.jsx(l.Fragment,{children:d})):r?(n?g(r):p(r))?l.jsx(l.Fragment,{children:e}):(y({type:"permission_denied",action:`Access denied for permissions: ${r.join(", ")} (requireAll: ${n})`,severity:"low"}),l.jsx(l.Fragment,{children:d})):s?x(s)?l.jsx(l.Fragment,{children:e}):(y({type:"permission_denied",action:`Access denied for role: ${s}`,severity:"low"}),l.jsx(l.Fragment,{children:d})):i?w(i)?l.jsx(l.Fragment,{children:e}):(y({type:"permission_denied",action:`Access denied for roles: ${i.join(", ")}`,severity:"low"}),l.jsx(l.Fragment,{children:d})):a?a==="admin"&&!v()?(y({type:"permission_denied",action:`Access denied for minimum role: ${a}`,severity:"low"}),l.jsx(l.Fragment,{children:d})):l.jsx(l.Fragment,{children:e}):o?m(o,c,u)?l.jsx(l.Fragment,{children:e}):(y({type:"permission_denied",action:`Access denied for resource: ${o} (action: ${c})`,resource:o,resourceId:u,severity:"low"}),l.jsx(l.Fragment,{children:d})):l.jsx(l.Fragment,{children:e})}function Dg({onClose:e}){const t=da(),{currentUser:r,logout:n}=Wt(),{canReadSchedules:s,canWriteSchedules:i,canReadLeaveRequests:a,canAccessAdmin:o,canViewAuditLogs:c,isAdminOrAbove:u}=Ow(),d=[{name:"",href:"/",icon:l.jsx(mN,{className:"h-6 w-6"}),show:!0},{name:"",href:"/calendar/my",icon:l.jsx(ra,{className:"h-6 w-6"}),show:s()},{name:"",href:"/calendar/vehicle",icon:l.jsx(na,{className:"h-6 w-6"}),show:i()},{name:"",href:"/calendar/room",icon:l.jsx(sa,{className:"h-6 w-6"}),show:i()},{name:"",href:"/calendar/sample",icon:l.jsx(ta,{className:"h-6 w-6"}),show:i()},{name:"",href:"/leave",icon:l.jsx(Au,{className:"h-6 w-6"}),show:a()},{name:"",href:"/settings/notifications",icon:l.jsx(Bs,{className:"h-6 w-6"}),show:!0}],f=[{name:"",href:"/admin/users",icon:l.jsx(Hr,{className:"h-6 w-6"}),permission:"users:read"},{name:"",href:"/admin/groups",icon:l.jsx(Hr,{className:"h-6 w-6"}),permission:"groups:read"},{name:"",href:"/admin/equipment",icon:l.jsx(SN,{className:"h-6 w-6"}),permission:"equipment:read"},{name:"",href:"/admin/audit",icon:l.jsx(TN,{className:"h-6 w-6"}),permission:"admin:audit_logs"}],h=()=>{e&&e()};return l.jsxs("div",{className:"flex flex-col h-0 flex-1 bg-white border-r border-gray-200",children:[l.jsxs("div",{className:"flex-1 flex flex-col pt-5 pb-4 overflow-y-auto",children:[l.jsx("div",{className:"flex items-center flex-shrink-0 px-4",children:l.jsx("span",{className:"text-2xl font-bold text-blue-600",children:""})}),l.jsxs("nav",{className:"mt-5 flex-1 px-2 bg-white space-y-1",children:[d.map(p=>{if(!p.show)return null;const g=t.pathname===p.href||p.href!=="/"&&t.pathname.startsWith(p.href);return l.jsxs(mp,{to:p.href,onClick:h,className:`
                  group flex items-center px-2 py-2 text-sm font-medium rounded-md
                  ${g?"bg-blue-100 text-blue-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}
                `,children:[l.jsx("div",{className:`mr-3 ${g?"text-blue-500":"text-gray-400 group-hover:text-gray-500"}`,children:p.icon}),p.name]},p.name)}),l.jsx(Pg,{permission:"admin:access",children:l.jsxs("div",{className:"pt-6",children:[l.jsx("div",{className:"px-3 mb-2 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:""}),f.map(p=>{const g=t.pathname===p.href;return l.jsx(Pg,{permission:p.permission,children:l.jsxs(mp,{to:p.href,onClick:h,className:`
                        group flex items-center px-2 py-2 text-sm font-medium rounded-md
                        ${g?"bg-blue-100 text-blue-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}
                      `,children:[l.jsx("div",{className:`mr-3 ${g?"text-blue-500":"text-gray-400 group-hover:text-gray-500"}`,children:p.icon}),p.name]})},p.name)})]})})]})]}),l.jsx("div",{className:"flex-shrink-0 flex border-t border-gray-200 p-4",children:l.jsx("div",{className:"flex items-center",children:l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-700",children:r==null?void 0:r.name}),l.jsx("div",{className:"text-xs text-gray-500",children:r==null?void 0:r.department})]})})})]})}var dP=Object.defineProperty,fP=(e,t,r)=>t in e?dP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,U0=(e,t,r)=>(fP(e,typeof t!="symbol"?t+"":t,r),r);let hP=class{constructor(){U0(this,"current",this.detect()),U0(this,"handoffState","pending"),U0(this,"currentId",0)}set(t){this.current!==t&&(this.handoffState="pending",this.currentId=0,this.current=t)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},Hs=new hP,jr=(e,t)=>{Hs.isServer?b.useEffect(e,t):b.useLayoutEffect(e,t)};function cs(e){let t=b.useRef(e);return jr(()=>{t.current=e},[e]),t}let st=function(e){let t=cs(e);return Ct.useCallback((...r)=>t.current(...r),[t])};function mP(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(t=>setTimeout(()=>{throw t}))}function An(){let e=[],t={addEventListener(r,n,s,i){return r.addEventListener(n,s,i),t.add(()=>r.removeEventListener(n,s,i))},requestAnimationFrame(...r){let n=requestAnimationFrame(...r);return t.add(()=>cancelAnimationFrame(n))},nextFrame(...r){return t.requestAnimationFrame(()=>t.requestAnimationFrame(...r))},setTimeout(...r){let n=setTimeout(...r);return t.add(()=>clearTimeout(n))},microTask(...r){let n={current:!0};return mP(()=>{n.current&&r[0]()}),t.add(()=>{n.current=!1})},style(r,n,s){let i=r.style.getPropertyValue(n);return Object.assign(r.style,{[n]:s}),this.add(()=>{Object.assign(r.style,{[n]:i})})},group(r){let n=An();return r(n),this.add(()=>n.dispose())},add(r){return e.push(r),()=>{let n=e.indexOf(r);if(n>=0)for(let s of e.splice(n,1))s()}},dispose(){for(let r of e.splice(0))r()}};return t}function $u(){let[e]=b.useState(An);return b.useEffect(()=>()=>e.dispose(),[e]),e}function pP(){let e=typeof document>"u";return"useSyncExternalStore"in G0?(t=>t.useSyncExternalStore)(G0)(()=>()=>{},()=>!1,()=>!e):!1}function Rh(){let e=pP(),[t,r]=b.useState(Hs.isHandoffComplete);return t&&Hs.isHandoffComplete===!1&&r(!1),b.useEffect(()=>{t!==!0&&r(!0)},[t]),b.useEffect(()=>Hs.handoff(),[]),e?!1:t}var Rg;let Ih=(Rg=Ct.useId)!=null?Rg:function(){let e=Rh(),[t,r]=Ct.useState(e?()=>Hs.nextId():null);return jr(()=>{t===null&&r(Hs.nextId())},[t]),t!=null?""+t:void 0};function pr(e,t,...r){if(e in t){let s=t[e];return typeof s=="function"?s(...r):s}let n=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(s=>`"${s}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,pr),n}function Uu(e){return Hs.isServer?null:e instanceof Node?e.ownerDocument:e!=null&&e.hasOwnProperty("current")&&e.current instanceof Node?e.current.ownerDocument:document}let af=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var of=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e))(of||{}),gP=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(gP||{}),xP=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(xP||{});function Fw(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(af)).sort((t,r)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}var Lh=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Lh||{});function Mh(e,t=0){var r;return e===((r=Uu(e))==null?void 0:r.body)?!1:pr(t,{0(){return e.matches(af)},1(){let n=e;for(;n!==null;){if(n.matches(af))return!0;n=n.parentElement}return!1}})}function Pw(e){let t=Uu(e);An().nextFrame(()=>{t&&!Mh(t.activeElement,0)&&yP(e)})}var vP=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(vP||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function yP(e){e==null||e.focus({preventScroll:!0})}let wP=["textarea","input"].join(",");function _P(e){var t,r;return(r=(t=e==null?void 0:e.matches)==null?void 0:t.call(e,wP))!=null?r:!1}function Dw(e,t=r=>r){return e.slice().sort((r,n)=>{let s=t(r),i=t(n);if(s===null||i===null)return 0;let a=s.compareDocumentPosition(i);return a&Node.DOCUMENT_POSITION_FOLLOWING?-1:a&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function EP(e,t){return SP(Fw(),t,{relativeTo:e})}function SP(e,t,{sorted:r=!0,relativeTo:n=null,skipElements:s=[]}={}){let i=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,a=Array.isArray(e)?r?Dw(e):e:Fw(e);s.length>0&&a.length>1&&(a=a.filter(p=>!s.includes(p))),n=n??i.activeElement;let o=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,a.indexOf(n))-1;if(t&4)return Math.max(0,a.indexOf(n))+1;if(t&8)return a.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=t&32?{preventScroll:!0}:{},d=0,f=a.length,h;do{if(d>=f||d+f<=0)return 0;let p=c+d;if(t&16)p=(p+f)%f;else{if(p<0)return 3;if(p>=f)return 1}h=a[p],h==null||h.focus(u),d+=o}while(h!==i.activeElement);return t&6&&_P(h)&&h.select(),2}function TP(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function bP(){return/Android/gi.test(window.navigator.userAgent)}function kP(){return TP()||bP()}function Ll(e,t,r){let n=cs(t);b.useEffect(()=>{function s(i){n.current(i)}return document.addEventListener(e,s,r),()=>document.removeEventListener(e,s,r)},[e,r])}function NP(e,t,r){let n=cs(t);b.useEffect(()=>{function s(i){n.current(i)}return window.addEventListener(e,s,r),()=>window.removeEventListener(e,s,r)},[e,r])}function CP(e,t,r=!0){let n=b.useRef(!1);b.useEffect(()=>{requestAnimationFrame(()=>{n.current=r})},[r]);function s(a,o){if(!n.current||a.defaultPrevented)return;let c=o(a);if(c===null||!c.getRootNode().contains(c)||!c.isConnected)return;let u=function d(f){return typeof f=="function"?d(f()):Array.isArray(f)||f instanceof Set?f:[f]}(e);for(let d of u){if(d===null)continue;let f=d instanceof HTMLElement?d:d.current;if(f!=null&&f.contains(c)||a.composed&&a.composedPath().includes(f))return}return!Mh(c,Lh.Loose)&&c.tabIndex!==-1&&a.preventDefault(),t(a,c)}let i=b.useRef(null);Ll("pointerdown",a=>{var o,c;n.current&&(i.current=((c=(o=a.composedPath)==null?void 0:o.call(a))==null?void 0:c[0])||a.target)},!0),Ll("mousedown",a=>{var o,c;n.current&&(i.current=((c=(o=a.composedPath)==null?void 0:o.call(a))==null?void 0:c[0])||a.target)},!0),Ll("click",a=>{kP()||i.current&&(s(a,()=>i.current),i.current=null)},!0),Ll("touchend",a=>s(a,()=>a.target instanceof HTMLElement?a.target:null),!0),NP("blur",a=>s(a,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function jP(...e){return b.useMemo(()=>Uu(...e),[...e])}function Ig(e){var t;if(e.type)return e.type;let r=(t=e.as)!=null?t:"button";if(typeof r=="string"&&r.toLowerCase()==="button")return"button"}function AP(e,t){let[r,n]=b.useState(()=>Ig(e));return jr(()=>{n(Ig(e))},[e.type,e.as]),jr(()=>{r||t.current&&t.current instanceof HTMLButtonElement&&!t.current.hasAttribute("type")&&n("button")},[r,t]),r}let OP=Symbol();function va(...e){let t=b.useRef(e);b.useEffect(()=>{t.current=e},[e]);let r=st(n=>{for(let s of t.current)s!=null&&(typeof s=="function"?s(n):s.current=n)});return e.every(n=>n==null||(n==null?void 0:n[OP]))?void 0:r}function Lg(e){return[e.screenX,e.screenY]}function FP(){let e=b.useRef([-1,-1]);return{wasMoved(t){let r=Lg(t);return e.current[0]===r[0]&&e.current[1]===r[1]?!1:(e.current=r,!0)},update(t){e.current=Lg(t)}}}function PP({container:e,accept:t,walk:r,enabled:n=!0}){let s=b.useRef(t),i=b.useRef(r);b.useEffect(()=>{s.current=t,i.current=r},[t,r]),jr(()=>{if(!e||!n)return;let a=Uu(e);if(!a)return;let o=s.current,c=i.current,u=Object.assign(f=>o(f),{acceptNode:o}),d=a.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,u,!1);for(;d.nextNode();)c(d.currentNode)},[e,n,s,i])}function Jc(...e){return Array.from(new Set(e.flatMap(t=>typeof t=="string"?t.split(" "):[]))).filter(Boolean).join(" ")}var Qc=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(Qc||{}),Zn=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(Zn||{});function ya({ourProps:e,theirProps:t,slot:r,defaultTag:n,features:s,visible:i=!0,name:a,mergeRefs:o}){o=o??DP;let c=Rw(t,e);if(i)return Ml(c,r,n,a,o);let u=s??0;if(u&2){let{static:d=!1,...f}=c;if(d)return Ml(f,r,n,a,o)}if(u&1){let{unmount:d=!0,...f}=c;return pr(d?0:1,{0(){return null},1(){return Ml({...f,hidden:!0,style:{display:"none"}},r,n,a,o)}})}return Ml(c,r,n,a,o)}function Ml(e,t={},r,n,s){let{as:i=r,children:a,refName:o="ref",...c}=W0(e,["unmount","static"]),u=e.ref!==void 0?{[o]:e.ref}:{},d=typeof a=="function"?a(t):a;"className"in c&&c.className&&typeof c.className=="function"&&(c.className=c.className(t));let f={};if(t){let h=!1,p=[];for(let[g,m]of Object.entries(t))typeof m=="boolean"&&(h=!0),m===!0&&p.push(g);h&&(f["data-headlessui-state"]=p.join(" "))}if(i===b.Fragment&&Object.keys(Mg(c)).length>0){if(!b.isValidElement(d)||Array.isArray(d)&&d.length>1)throw new Error(['Passing props on "Fragment"!',"",`The current component <${n} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(c).map(m=>`  - ${m}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(m=>`  - ${m}`).join(`
`)].join(`
`));let h=d.props,p=typeof(h==null?void 0:h.className)=="function"?(...m)=>Jc(h==null?void 0:h.className(...m),c.className):Jc(h==null?void 0:h.className,c.className),g=p?{className:p}:{};return b.cloneElement(d,Object.assign({},Rw(d.props,Mg(W0(c,["ref"]))),f,u,{ref:s(d.ref,u.ref)},g))}return b.createElement(i,Object.assign({},W0(c,["ref"]),i!==b.Fragment&&u,i!==b.Fragment&&f),d)}function DP(...e){return e.every(t=>t==null)?void 0:t=>{for(let r of e)r!=null&&(typeof r=="function"?r(t):r.current=t)}}function Rw(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},r={};for(let n of e)for(let s in n)s.startsWith("on")&&typeof n[s]=="function"?(r[s]!=null||(r[s]=[]),r[s].push(n[s])):t[s]=n[s];if(t.disabled||t["aria-disabled"])return Object.assign(t,Object.fromEntries(Object.keys(r).map(n=>[n,void 0])));for(let n in r)Object.assign(t,{[n](s,...i){let a=r[n];for(let o of a){if((s instanceof Event||(s==null?void 0:s.nativeEvent)instanceof Event)&&s.defaultPrevented)return;o(s,...i)}}});return t}function li(e){var t;return Object.assign(b.forwardRef(e),{displayName:(t=e.displayName)!=null?t:e.name})}function Mg(e){let t=Object.assign({},e);for(let r in t)t[r]===void 0&&delete t[r];return t}function W0(e,t=[]){let r=Object.assign({},e);for(let n of t)n in r&&delete r[n];return r}let Bh=b.createContext(null);Bh.displayName="OpenClosedContext";var hr=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(hr||{});function $h(){return b.useContext(Bh)}function Iw({value:e,children:t}){return Ct.createElement(Bh.Provider,{value:e},t)}function RP(e){let t=e.parentElement,r=null;for(;t&&!(t instanceof HTMLFieldSetElement);)t instanceof HTMLLegendElement&&(r=t),t=t.parentElement;let n=(t==null?void 0:t.getAttribute("disabled"))==="";return n&&IP(r)?!1:n}function IP(e){if(!e)return!1;let t=e.previousElementSibling;for(;t!==null;){if(t instanceof HTMLLegendElement)return!1;t=t.previousElementSibling}return!0}function LP(e){throw new Error("Unexpected object: "+e)}var Vr=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(Vr||{});function MP(e,t){let r=t.resolveItems();if(r.length<=0)return null;let n=t.resolveActiveIndex(),s=n??-1;switch(e.focus){case 0:{for(let i=0;i<r.length;++i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 1:{for(let i=s-1;i>=0;--i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 2:{for(let i=s+1;i<r.length;++i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 3:{for(let i=r.length-1;i>=0;--i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 4:{for(let i=0;i<r.length;++i)if(t.resolveId(r[i],i,r)===e.id)return i;return n}case 5:return null;default:LP(e)}}var Tt=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(Tt||{});function Uh(){let e=b.useRef(!1);return jr(()=>(e.current=!0,()=>{e.current=!1}),[]),e}let Bg=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function $g(e){var t,r;let n=(t=e.innerText)!=null?t:"",s=e.cloneNode(!0);if(!(s instanceof HTMLElement))return n;let i=!1;for(let o of s.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))o.remove(),i=!0;let a=i?(r=s.innerText)!=null?r:"":n;return Bg.test(a)&&(a=a.replace(Bg,"")),a}function BP(e){let t=e.getAttribute("aria-label");if(typeof t=="string")return t.trim();let r=e.getAttribute("aria-labelledby");if(r){let n=r.split(" ").map(s=>{let i=document.getElementById(s);if(i){let a=i.getAttribute("aria-label");return typeof a=="string"?a.trim():$g(i).trim()}return null}).filter(Boolean);if(n.length>0)return n.join(", ")}return $g(e).trim()}function $P(e){let t=b.useRef(""),r=b.useRef("");return st(()=>{let n=e.current;if(!n)return"";let s=n.innerText;if(t.current===s)return r.current;let i=BP(n).trim().toLowerCase();return t.current=s,r.current=i,i})}var UP=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(UP||{}),WP=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(WP||{}),HP=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItem=5]="RegisterItem",e[e.UnregisterItem=6]="UnregisterItem",e))(HP||{});function H0(e,t=r=>r){let r=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,n=Dw(t(e.items.slice()),i=>i.dataRef.current.domRef.current),s=r?n.indexOf(r):null;return s===-1&&(s=null),{items:n,activeItemIndex:s}}let zP={1(e){return e.menuState===1?e:{...e,activeItemIndex:null,menuState:1}},0(e){return e.menuState===0?e:{...e,__demoMode:!1,menuState:0}},2:(e,t)=>{var r;let n=H0(e),s=MP(t,{resolveItems:()=>n.items,resolveActiveIndex:()=>n.activeItemIndex,resolveId:i=>i.id,resolveDisabled:i=>i.dataRef.current.disabled});return{...e,...n,searchQuery:"",activeItemIndex:s,activationTrigger:(r=t.trigger)!=null?r:1}},3:(e,t)=>{let r=e.searchQuery!==""?0:1,n=e.searchQuery+t.value.toLowerCase(),s=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+r).concat(e.items.slice(0,e.activeItemIndex+r)):e.items).find(a=>{var o;return((o=a.dataRef.current.textValue)==null?void 0:o.startsWith(n))&&!a.dataRef.current.disabled}),i=s?e.items.indexOf(s):-1;return i===-1||i===e.activeItemIndex?{...e,searchQuery:n}:{...e,searchQuery:n,activeItemIndex:i,activationTrigger:1}},4(e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},5:(e,t)=>{let r=H0(e,n=>[...n,{id:t.id,dataRef:t.dataRef}]);return{...e,...r}},6:(e,t)=>{let r=H0(e,n=>{let s=n.findIndex(i=>i.id===t.id);return s!==-1&&n.splice(s,1),n});return{...e,...r,activationTrigger:1}}},Wh=b.createContext(null);Wh.displayName="MenuContext";function Wu(e){let t=b.useContext(Wh);if(t===null){let r=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Wu),r}return t}function VP(e,t){return pr(t.type,zP,e,t)}let GP=b.Fragment;function qP(e,t){let{__demoMode:r=!1,...n}=e,s=b.useReducer(VP,{__demoMode:r,menuState:r?0:1,buttonRef:b.createRef(),itemsRef:b.createRef(),items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:i,itemsRef:a,buttonRef:o},c]=s,u=va(t);CP([o,a],(p,g)=>{var m;c({type:1}),Mh(g,Lh.Loose)||(p.preventDefault(),(m=o.current)==null||m.focus())},i===0);let d=st(()=>{c({type:1})}),f=b.useMemo(()=>({open:i===0,close:d}),[i,d]),h={ref:u};return Ct.createElement(Wh.Provider,{value:s},Ct.createElement(Iw,{value:pr(i,{0:hr.Open,1:hr.Closed})},ya({ourProps:h,theirProps:n,slot:f,defaultTag:GP,name:"Menu"})))}let KP="button";function XP(e,t){var r;let n=Ih(),{id:s=`headlessui-menu-button-${n}`,...i}=e,[a,o]=Wu("Menu.Button"),c=va(a.buttonRef,t),u=$u(),d=st(m=>{switch(m.key){case Tt.Space:case Tt.Enter:case Tt.ArrowDown:m.preventDefault(),m.stopPropagation(),o({type:0}),u.nextFrame(()=>o({type:2,focus:Vr.First}));break;case Tt.ArrowUp:m.preventDefault(),m.stopPropagation(),o({type:0}),u.nextFrame(()=>o({type:2,focus:Vr.Last}));break}}),f=st(m=>{switch(m.key){case Tt.Space:m.preventDefault();break}}),h=st(m=>{if(RP(m.currentTarget))return m.preventDefault();e.disabled||(a.menuState===0?(o({type:1}),u.nextFrame(()=>{var x;return(x=a.buttonRef.current)==null?void 0:x.focus({preventScroll:!0})})):(m.preventDefault(),o({type:0})))}),p=b.useMemo(()=>({open:a.menuState===0}),[a]),g={ref:c,id:s,type:AP(e,a.buttonRef),"aria-haspopup":"menu","aria-controls":(r=a.itemsRef.current)==null?void 0:r.id,"aria-expanded":a.menuState===0,onKeyDown:d,onKeyUp:f,onClick:h};return ya({ourProps:g,theirProps:i,slot:p,defaultTag:KP,name:"Menu.Button"})}let YP="div",JP=Qc.RenderStrategy|Qc.Static;function QP(e,t){var r,n;let s=Ih(),{id:i=`headlessui-menu-items-${s}`,...a}=e,[o,c]=Wu("Menu.Items"),u=va(o.itemsRef,t),d=jP(o.itemsRef),f=$u(),h=$h(),p=h!==null?(h&hr.Open)===hr.Open:o.menuState===0;b.useEffect(()=>{let v=o.itemsRef.current;v&&o.menuState===0&&v!==(d==null?void 0:d.activeElement)&&v.focus({preventScroll:!0})},[o.menuState,o.itemsRef,d]),PP({container:o.itemsRef.current,enabled:o.menuState===0,accept(v){return v.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:v.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(v){v.setAttribute("role","none")}});let g=st(v=>{var y,_;switch(f.dispose(),v.key){case Tt.Space:if(o.searchQuery!=="")return v.preventDefault(),v.stopPropagation(),c({type:3,value:v.key});case Tt.Enter:if(v.preventDefault(),v.stopPropagation(),c({type:1}),o.activeItemIndex!==null){let{dataRef:C}=o.items[o.activeItemIndex];(_=(y=C.current)==null?void 0:y.domRef.current)==null||_.click()}Pw(o.buttonRef.current);break;case Tt.ArrowDown:return v.preventDefault(),v.stopPropagation(),c({type:2,focus:Vr.Next});case Tt.ArrowUp:return v.preventDefault(),v.stopPropagation(),c({type:2,focus:Vr.Previous});case Tt.Home:case Tt.PageUp:return v.preventDefault(),v.stopPropagation(),c({type:2,focus:Vr.First});case Tt.End:case Tt.PageDown:return v.preventDefault(),v.stopPropagation(),c({type:2,focus:Vr.Last});case Tt.Escape:v.preventDefault(),v.stopPropagation(),c({type:1}),An().nextFrame(()=>{var C;return(C=o.buttonRef.current)==null?void 0:C.focus({preventScroll:!0})});break;case Tt.Tab:v.preventDefault(),v.stopPropagation(),c({type:1}),An().nextFrame(()=>{EP(o.buttonRef.current,v.shiftKey?of.Previous:of.Next)});break;default:v.key.length===1&&(c({type:3,value:v.key}),f.setTimeout(()=>c({type:4}),350));break}}),m=st(v=>{switch(v.key){case Tt.Space:v.preventDefault();break}}),x=b.useMemo(()=>({open:o.menuState===0}),[o]),w={"aria-activedescendant":o.activeItemIndex===null||(r=o.items[o.activeItemIndex])==null?void 0:r.id,"aria-labelledby":(n=o.buttonRef.current)==null?void 0:n.id,id:i,onKeyDown:g,onKeyUp:m,role:"menu",tabIndex:0,ref:u};return ya({ourProps:w,theirProps:a,slot:x,defaultTag:YP,features:JP,visible:p,name:"Menu.Items"})}let ZP=b.Fragment;function e8(e,t){let r=Ih(),{id:n=`headlessui-menu-item-${r}`,disabled:s=!1,...i}=e,[a,o]=Wu("Menu.Item"),c=a.activeItemIndex!==null?a.items[a.activeItemIndex].id===n:!1,u=b.useRef(null),d=va(t,u);jr(()=>{if(a.__demoMode||a.menuState!==0||!c||a.activationTrigger===0)return;let C=An();return C.requestAnimationFrame(()=>{var E,T;(T=(E=u.current)==null?void 0:E.scrollIntoView)==null||T.call(E,{block:"nearest"})}),C.dispose},[a.__demoMode,u,c,a.menuState,a.activationTrigger,a.activeItemIndex]);let f=$P(u),h=b.useRef({disabled:s,domRef:u,get textValue(){return f()}});jr(()=>{h.current.disabled=s},[h,s]),jr(()=>(o({type:5,id:n,dataRef:h}),()=>o({type:6,id:n})),[h,n]);let p=st(()=>{o({type:1})}),g=st(C=>{if(s)return C.preventDefault();o({type:1}),Pw(a.buttonRef.current)}),m=st(()=>{if(s)return o({type:2,focus:Vr.Nothing});o({type:2,focus:Vr.Specific,id:n})}),x=FP(),w=st(C=>x.update(C)),v=st(C=>{x.wasMoved(C)&&(s||c||o({type:2,focus:Vr.Specific,id:n,trigger:0}))}),y=st(C=>{x.wasMoved(C)&&(s||c&&o({type:2,focus:Vr.Nothing}))}),_=b.useMemo(()=>({active:c,disabled:s,close:p}),[c,s,p]);return ya({ourProps:{id:n,ref:d,role:"menuitem",tabIndex:s===!0?void 0:-1,"aria-disabled":s===!0?!0:void 0,disabled:void 0,onClick:g,onFocus:m,onPointerEnter:w,onMouseEnter:w,onPointerMove:v,onMouseMove:v,onPointerLeave:y,onMouseLeave:y},theirProps:i,slot:_,defaultTag:ZP,name:"Menu.Item"})}let t8=li(qP),r8=li(XP),n8=li(QP),s8=li(e8),Pa=Object.assign(t8,{Button:r8,Items:n8,Item:s8});function i8(e=0){let[t,r]=b.useState(e),n=Uh(),s=b.useCallback(c=>{n.current&&r(u=>u|c)},[t,n]),i=b.useCallback(c=>!!(t&c),[t]),a=b.useCallback(c=>{n.current&&r(u=>u&~c)},[r,n]),o=b.useCallback(c=>{n.current&&r(u=>u^c)},[r]);return{flags:t,addFlag:s,hasFlag:i,removeFlag:a,toggleFlag:o}}function a8(e){let t={called:!1};return(...r)=>{if(!t.called)return t.called=!0,e(...r)}}function z0(e,...t){e&&t.length>0&&e.classList.add(...t)}function V0(e,...t){e&&t.length>0&&e.classList.remove(...t)}function o8(e,t){let r=An();if(!e)return r.dispose;let{transitionDuration:n,transitionDelay:s}=getComputedStyle(e),[i,a]=[n,s].map(c=>{let[u=0]=c.split(",").filter(Boolean).map(d=>d.includes("ms")?parseFloat(d):parseFloat(d)*1e3).sort((d,f)=>f-d);return u}),o=i+a;if(o!==0){r.group(u=>{u.setTimeout(()=>{t(),u.dispose()},o),u.addEventListener(e,"transitionrun",d=>{d.target===d.currentTarget&&u.dispose()})});let c=r.addEventListener(e,"transitionend",u=>{u.target===u.currentTarget&&(t(),c())})}else t();return r.add(()=>t()),r.dispose}function l8(e,t,r,n){let s=r?"enter":"leave",i=An(),a=n!==void 0?a8(n):()=>{};s==="enter"&&(e.removeAttribute("hidden"),e.style.display="");let o=pr(s,{enter:()=>t.enter,leave:()=>t.leave}),c=pr(s,{enter:()=>t.enterTo,leave:()=>t.leaveTo}),u=pr(s,{enter:()=>t.enterFrom,leave:()=>t.leaveFrom});return V0(e,...t.base,...t.enter,...t.enterTo,...t.enterFrom,...t.leave,...t.leaveFrom,...t.leaveTo,...t.entered),z0(e,...t.base,...o,...u),i.nextFrame(()=>{V0(e,...t.base,...o,...u),z0(e,...t.base,...o,...c),o8(e,()=>(V0(e,...t.base,...o),z0(e,...t.base,...t.entered),a()))}),i.dispose}function c8({immediate:e,container:t,direction:r,classes:n,onStart:s,onStop:i}){let a=Uh(),o=$u(),c=cs(r);jr(()=>{e&&(c.current="enter")},[e]),jr(()=>{let u=An();o.add(u.dispose);let d=t.current;if(d&&c.current!=="idle"&&a.current)return u.dispose(),s.current(c.current),u.add(l8(d,n.current,c.current==="enter",()=>{u.dispose(),i.current(c.current)})),u.dispose},[r])}function Mn(e=""){return e.split(/\s+/).filter(t=>t.length>1)}let Hu=b.createContext(null);Hu.displayName="TransitionContext";var u8=(e=>(e.Visible="visible",e.Hidden="hidden",e))(u8||{});function d8(){let e=b.useContext(Hu);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function f8(){let e=b.useContext(zu);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let zu=b.createContext(null);zu.displayName="NestingContext";function Vu(e){return"children"in e?Vu(e.children):e.current.filter(({el:t})=>t.current!==null).filter(({state:t})=>t==="visible").length>0}function Lw(e,t){let r=cs(e),n=b.useRef([]),s=Uh(),i=$u(),a=st((p,g=Zn.Hidden)=>{let m=n.current.findIndex(({el:x})=>x===p);m!==-1&&(pr(g,{[Zn.Unmount](){n.current.splice(m,1)},[Zn.Hidden](){n.current[m].state="hidden"}}),i.microTask(()=>{var x;!Vu(n)&&s.current&&((x=r.current)==null||x.call(r))}))}),o=st(p=>{let g=n.current.find(({el:m})=>m===p);return g?g.state!=="visible"&&(g.state="visible"):n.current.push({el:p,state:"visible"}),()=>a(p,Zn.Unmount)}),c=b.useRef([]),u=b.useRef(Promise.resolve()),d=b.useRef({enter:[],leave:[],idle:[]}),f=st((p,g,m)=>{c.current.splice(0),t&&(t.chains.current[g]=t.chains.current[g].filter(([x])=>x!==p)),t==null||t.chains.current[g].push([p,new Promise(x=>{c.current.push(x)})]),t==null||t.chains.current[g].push([p,new Promise(x=>{Promise.all(d.current[g].map(([w,v])=>v)).then(()=>x())})]),g==="enter"?u.current=u.current.then(()=>t==null?void 0:t.wait.current).then(()=>m(g)):m(g)}),h=st((p,g,m)=>{Promise.all(d.current[g].splice(0).map(([x,w])=>w)).then(()=>{var x;(x=c.current.shift())==null||x()}).then(()=>m(g))});return b.useMemo(()=>({children:n,register:o,unregister:a,onStart:f,onStop:h,wait:u,chains:d}),[o,a,n,f,h,d,u])}function h8(){}let m8=["beforeEnter","afterEnter","beforeLeave","afterLeave"];function Ug(e){var t;let r={};for(let n of m8)r[n]=(t=e[n])!=null?t:h8;return r}function p8(e){let t=b.useRef(Ug(e));return b.useEffect(()=>{t.current=Ug(e)},[e]),t}let g8="div",Mw=Qc.RenderStrategy;function x8(e,t){var r,n;let{beforeEnter:s,afterEnter:i,beforeLeave:a,afterLeave:o,enter:c,enterFrom:u,enterTo:d,entered:f,leave:h,leaveFrom:p,leaveTo:g,...m}=e,x=b.useRef(null),w=va(x,t),v=(r=m.unmount)==null||r?Zn.Unmount:Zn.Hidden,{show:y,appear:_,initial:C}=d8(),[E,T]=b.useState(y?"visible":"hidden"),M=f8(),{register:A,unregister:B}=M;b.useEffect(()=>A(x),[A,x]),b.useEffect(()=>{if(v===Zn.Hidden&&x.current){if(y&&E!=="visible"){T("visible");return}return pr(E,{hidden:()=>B(x),visible:()=>A(x)})}},[E,x,A,B,y,v]);let z=cs({base:Mn(m.className),enter:Mn(c),enterFrom:Mn(u),enterTo:Mn(d),entered:Mn(f),leave:Mn(h),leaveFrom:Mn(p),leaveTo:Mn(g)}),U=p8({beforeEnter:s,afterEnter:i,beforeLeave:a,afterLeave:o}),V=Rh();b.useEffect(()=>{if(V&&E==="visible"&&x.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[x,E,V]);let pe=C&&!_,ne=_&&y&&C,le=!V||pe?"idle":y?"enter":"leave",ee=i8(0),W=st(I=>pr(I,{enter:()=>{ee.addFlag(hr.Opening),U.current.beforeEnter()},leave:()=>{ee.addFlag(hr.Closing),U.current.beforeLeave()},idle:()=>{}})),G=st(I=>pr(I,{enter:()=>{ee.removeFlag(hr.Opening),U.current.afterEnter()},leave:()=>{ee.removeFlag(hr.Closing),U.current.afterLeave()},idle:()=>{}})),Z=Lw(()=>{T("hidden"),B(x)},M),Q=b.useRef(!1);c8({immediate:ne,container:x,classes:z,direction:le,onStart:cs(I=>{Q.current=!0,Z.onStart(x,I,W)}),onStop:cs(I=>{Q.current=!1,Z.onStop(x,I,G),I==="leave"&&!Vu(Z)&&(T("hidden"),B(x))})});let k=m,P={ref:w};return ne?k={...k,className:Jc(m.className,...z.current.enter,...z.current.enterFrom)}:Q.current&&(k.className=Jc(m.className,(n=x.current)==null?void 0:n.className),k.className===""&&delete k.className),Ct.createElement(zu.Provider,{value:Z},Ct.createElement(Iw,{value:pr(E,{visible:hr.Open,hidden:hr.Closed})|ee.flags},ya({ourProps:P,theirProps:k,defaultTag:g8,features:Mw,visible:E==="visible",name:"Transition.Child"})))}function v8(e,t){let{show:r,appear:n=!1,unmount:s=!0,...i}=e,a=b.useRef(null),o=va(a,t);Rh();let c=$h();if(r===void 0&&c!==null&&(r=(c&hr.Open)===hr.Open),![!0,!1].includes(r))throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[u,d]=b.useState(r?"visible":"hidden"),f=Lw(()=>{d("hidden")}),[h,p]=b.useState(!0),g=b.useRef([r]);jr(()=>{h!==!1&&g.current[g.current.length-1]!==r&&(g.current.push(r),p(!1))},[g,r]);let m=b.useMemo(()=>({show:r,appear:n,initial:h}),[r,n,h]);b.useEffect(()=>{if(r)d("visible");else if(!Vu(f))d("hidden");else{let y=a.current;if(!y)return;let _=y.getBoundingClientRect();_.x===0&&_.y===0&&_.width===0&&_.height===0&&d("hidden")}},[r,f]);let x={unmount:s},w=st(()=>{var y;h&&p(!1),(y=e.beforeEnter)==null||y.call(e)}),v=st(()=>{var y;h&&p(!1),(y=e.beforeLeave)==null||y.call(e)});return Ct.createElement(zu.Provider,{value:f},Ct.createElement(Hu.Provider,{value:m},ya({ourProps:{...x,as:b.Fragment,children:Ct.createElement(Bw,{ref:o,...x,...i,beforeEnter:w,beforeLeave:v})},theirProps:{},defaultTag:b.Fragment,features:Mw,visible:u==="visible",name:"Transition"})))}function y8(e,t){let r=b.useContext(Hu)!==null,n=$h()!==null;return Ct.createElement(Ct.Fragment,null,!r&&n?Ct.createElement(lf,{ref:t,...e}):Ct.createElement(Bw,{ref:t,...e}))}let lf=li(v8),Bw=li(x8),w8=li(y8),_8=Object.assign(lf,{Child:w8,Root:lf});function E8(){const{currentUser:e,logout:t,switchUser:r}=Wt(),[n,s]=b.useState(!1),[i,a]=b.useState(!1),[o,c]=b.useState([]);b.useEffect(()=>{n&&u()},[n]);const u=async()=>{try{const{data:h,error:p}=await xe.from("users").select("*").order("name");if(p){console.error(":",p);return}const g=(h==null?void 0:h.map(m=>({id:m.id,employeeId:m.employee_id,name:m.name,nameKana:m.name_kana,email:m.email,phone:m.phone,department:m.department,role:m.role,defaultWorkDays:m.default_work_days||[]})))||[];c(g)}catch(h){console.error("fetchUsers :",h)}},d=async h=>{a(!0);try{console.log(":",h.name),r(h),s(!1),window.location.reload()}catch(p){console.error("Failed to switch user:",p)}finally{a(!1)}},f=()=>{console.log(""),t(),window.location.href="/user-switch"};return l.jsxs(l.Fragment,{children:[l.jsx(Pa,{as:"div",className:"ml-3 relative",children:({open:h})=>l.jsxs(l.Fragment,{children:[l.jsx("div",{children:l.jsxs(Pa.Button,{className:"max-w-xs bg-white flex items-center text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-600 flex items-center justify-center text-white",children:e==null?void 0:e.name.charAt(0)})]})}),l.jsx(_8,{show:h,as:b.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:l.jsxs(Pa.Items,{static:!0,className:"origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 focus:outline-none",children:[l.jsxs("div",{className:"px-4 py-2",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:e==null?void 0:e.name}),l.jsx("p",{className:"text-xs text-gray-500 truncate",children:e==null?void 0:e.email})]}),l.jsx("div",{className:"border-t border-gray-100"}),l.jsx(Pa.Item,{children:({active:p})=>l.jsxs("button",{onClick:()=>s(!0),className:`${p?"bg-gray-100":""} flex w-full px-4 py-2 text-sm text-gray-700`,children:[l.jsx(Yv,{className:"mr-3 h-5 w-5 text-gray-400","aria-hidden":"true"}),l.jsx("span",{children:""})]})}),l.jsx(Pa.Item,{children:({active:p})=>l.jsxs("button",{onClick:f,className:`${p?"bg-gray-100":""} flex w-full px-4 py-2 text-sm text-gray-700`,children:[l.jsx(wN,{className:"mr-3 h-5 w-5 text-gray-400","aria-hidden":"true"}),l.jsx("span",{children:""})]})})]})})]})}),n&&l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full max-h-[80vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),l.jsx("button",{onClick:()=>s(!1),className:"text-gray-400 hover:text-gray-500",children:l.jsx(Pn,{className:"h-6 w-6"})})]}),l.jsx("div",{className:"space-y-2",children:o.filter(h=>h.id!==(e==null?void 0:e.id)).map(h=>l.jsxs("button",{type:"button",onClick:()=>d(h),disabled:i,className:"w-full flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 transition-colors",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 font-medium text-sm",children:h.name.charAt(0)})}),l.jsxs("div",{className:"ml-3 flex-1 text-left",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:h.name}),l.jsxs("div",{className:"text-xs text-gray-500",children:[h.department,"  ",h.role==="president"?"":h.role==="admin"?"":""]})]}),l.jsx(yN,{className:"h-4 w-4 text-gray-400"})]},h.id))}),l.jsx("div",{className:"flex justify-end mt-6",children:l.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:""})})]})})]})}function S8(){const{currentUser:e}=Wt(),[t,r]=b.useState(!1),[n,s]=b.useState([]),[i,a]=b.useState(0),[o,c]=b.useState(!1);b.useEffect(()=>{e&&console.log("notification_logs")},[e]);const u=g=>{const m=g.metadata;switch(g.category){case"schedule_created":case"schedule_updated":case"schedule_reminder":m!=null&&m.scheduleId&&(window.location.href=`/calendar?scheduleId=${m.scheduleId}`);break;case"leave_request_submitted":case"leave_request_approved":case"leave_request_rejected":window.location.href="/leave-requests";break;default:window.location.href="/dashboard"}r(!1)},d=g=>{switch(g){case"schedule_created":case"schedule_updated":case"schedule_deleted":case"schedule_reminder":return l.jsx(ra,{className:"h-5 w-5"});case"leave_request_submitted":case"leave_request_approved":case"leave_request_rejected":return l.jsx(Hr,{className:"h-5 w-5"});default:return l.jsx(Bs,{className:"h-5 w-5"})}},f=g=>{switch(g){case"sent":return"text-green-600";case"failed":return"text-red-600";case"pending":return"text-yellow-600";default:return"text-gray-600"}},h=g=>{const x=new Date().getTime()-new Date(g).getTime(),w=Math.floor(x/6e4),v=Math.floor(w/60),y=Math.floor(v/24);return w<1?"":w<60?`${w}`:v<24?`${v}`:y<7?`${y}`:be(new Date(g),"MM/dd",{locale:Nr})},p=()=>{a(0)};return l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>r(!t),className:"relative p-2 text-gray-600 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 rounded-full",children:[l.jsx(Bs,{className:"h-6 w-6"}),i>0&&l.jsx("span",{className:"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full",children:i>9?"9+":i})]}),t&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>r(!1)}),l.jsxs("div",{className:"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 z-40",children:[l.jsx("div",{className:"p-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),l.jsxs("div",{className:"flex items-center space-x-2",children:[i>0&&l.jsx("button",{onClick:p,className:"text-sm text-indigo-600 hover:text-indigo-500",children:""}),l.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-500",children:l.jsx(Pn,{className:"h-5 w-5"})})]})]})}),l.jsx("div",{className:"max-h-96 overflow-y-auto",children:o?l.jsx("div",{className:"p-4 text-center text-gray-500",children:"..."}):n.length===0?l.jsxs("div",{className:"p-8 text-center text-gray-500",children:[l.jsx(Bs,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),l.jsx("p",{children:""})]}):l.jsx("div",{className:"divide-y divide-gray-200",children:n.map(g=>l.jsx("div",{className:"p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>u(g),children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("div",{className:`flex-shrink-0 ${f(g.status)}`,children:d(g.category)}),l.jsxs("div",{className:"ml-3 flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:g.subject}),g.content&&l.jsx("p",{className:"mt-1 text-sm text-gray-600 line-clamp-2",children:g.content}),l.jsxs("div",{className:"mt-2 flex items-center text-xs text-gray-500",children:[l.jsxs("span",{className:"flex items-center",children:[g.type==="email"?l.jsx(fh,{className:"h-3 w-3 mr-1"}):l.jsx(Bs,{className:"h-3 w-3 mr-1"}),h(g.createdAt)]}),g.status==="failed"&&l.jsxs("span",{className:"ml-2 flex items-center text-red-600",children:[l.jsx(uN,{className:"h-3 w-3 mr-1"}),""]})]})]})]})},g.id))})}),n.length>0&&l.jsx("div",{className:"p-4 border-t border-gray-200",children:l.jsx("a",{href:"/settings/notifications",className:"text-sm text-indigo-600 hover:text-indigo-500 font-medium",children:""})})]})]})]})}function T8({children:e}){const{sessionInfo:t,checkSessionValidity:r,extendSession:n,logSecurityEvent:s,securitySettings:i}=xv(),{currentUser:a,logout:o}=Wt(),c=Uo(),[u,d]=b.useState(!1),[f,h]=b.useState(0),[p,g]=b.useState(Date.now()),m=5*60*1e3;b.useEffect(()=>{const _=()=>{g(Date.now()),n()},C=["mousedown","keydown","scroll","touchstart","click"];return C.forEach(E=>{document.addEventListener(E,_,!0)}),()=>{C.forEach(E=>{document.removeEventListener(E,_,!0)})}},[n]),b.useEffect(()=>{if(!t||!a)return;const _=setInterval(()=>{if(!r()){s({type:"security_violation",action:"Session expired - forcing logout",severity:"medium"}),x("");return}const C=new Date,E=t.expiresAt.getTime()-C.getTime();E<=m&&E>0?(h(Math.ceil(E/1e3)),d(!0)):d(!1),C.getTime()-p>i.sessionTimeout*60*1e3&&(s({type:"security_violation",action:"Session timeout due to inactivity",severity:"medium"}),x(""))},3e4);return()=>clearInterval(_)},[t,a,p,r,s,i.sessionTimeout]);const x=_=>{d(!1),o(),c("/login",{replace:!0,state:{message:_,type:"warning"}})},w=()=>{n(),d(!1),s({type:"admin_action",action:"User extended session",severity:"low"})},v=()=>{s({type:"logout",action:"User logged out from timeout warning",severity:"low"}),d(!1),o(),c("/login")},y=_=>{const C=Math.floor(_/60),E=_%60;return`${C}:${E.toString().padStart(2,"0")}`};return l.jsxs(l.Fragment,{children:[e,u&&l.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:l.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"}),l.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:""}),l.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",children:[l.jsxs("div",{className:"sm:flex sm:items-start",children:[l.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 sm:mx-0 sm:h-10 sm:w-10",children:l.jsx("svg",{className:"h-6 w-6 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.728-.833-2.498 0L4.316 15.5c-.77.833.192 2.5 1.732 2.5z"})})}),l.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[l.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:""}),l.jsxs("div",{className:"mt-2",children:[l.jsxs("p",{className:"text-sm text-gray-500",children:["",l.jsx("br",{}),": ",l.jsx("span",{className:"font-mono font-bold text-red-600",children:y(f)})]}),l.jsx("p",{className:"text-sm text-gray-500 mt-2",children:" "})]})]})]}),l.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[l.jsx("button",{type:"button",onClick:w,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:""}),l.jsx("button",{type:"button",onClick:v,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:w-auto sm:text-sm",children:""})]})]})]})})]})}function b8(){const[e,t]=b.useState(!1);Wt();const r=()=>{t(!e)};return l.jsx(T8,{children:l.jsxs("div",{className:"h-screen flex overflow-hidden bg-gray-100",children:[l.jsxs("div",{className:`fixed inset-0 flex z-40 md:hidden ${e?"block":"hidden"}`,children:[l.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:r}),l.jsxs("div",{className:"relative flex-1 flex flex-col max-w-xs w-full bg-white",children:[l.jsx("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:l.jsxs("button",{className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:r,children:[l.jsx("span",{className:"sr-only",children:"Close sidebar"}),l.jsx(Pn,{className:"h-6 w-6 text-white"})]})}),l.jsx(Dg,{onClose:r})]})]}),l.jsx("div",{className:"hidden md:flex md:flex-shrink-0",children:l.jsx("div",{className:"flex flex-col w-64",children:l.jsx(Dg,{})})}),l.jsxs("div",{className:"flex flex-col w-0 flex-1 overflow-hidden",children:[l.jsxs("div",{className:"relative z-10 flex-shrink-0 flex h-16 bg-white shadow",children:[l.jsxs("button",{className:"px-4 border-r border-gray-200 text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500 md:hidden",onClick:r,children:[l.jsx("span",{className:"sr-only",children:"Open sidebar"}),l.jsx(_N,{className:"h-6 w-6"})]}),l.jsxs("div",{className:"flex-1 px-4 flex justify-between",children:[l.jsx("div",{className:"flex-1 flex items-center",children:l.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:""})}),l.jsxs("div",{className:"ml-4 flex items-center md:ml-6 space-x-4",children:[l.jsx(S8,{}),l.jsx(E8,{})]})]})]}),l.jsx("main",{className:"flex-1 relative overflow-y-auto focus:outline-none",children:l.jsx("div",{className:"py-6",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8",children:l.jsx(wS,{})})})})]})]})})}function k8(){return b.useEffect(()=>(aN(),()=>{}),[]),l.jsx(jS,{children:l.jsx(ST,{children:l.jsx(bT,{children:l.jsxs(tN,{children:[l.jsx(ET,{position:"top-right"}),l.jsxs(ES,{children:[l.jsx(_t,{path:"/user-switch",element:l.jsx(jN,{})}),l.jsxs(_t,{path:"/",element:l.jsx(Il,{children:l.jsx(b8,{})}),children:[l.jsx(_t,{index:!0,element:l.jsx(i3,{})}),l.jsxs(_t,{path:"calendar",children:[l.jsx(_t,{index:!0,element:l.jsx(uv,{to:"/calendar/my",replace:!0})}),l.jsx(_t,{path:"my",element:l.jsx(u3,{})}),l.jsx(_t,{path:"vehicle",element:l.jsx(d3,{})}),l.jsx(_t,{path:"room",element:l.jsx(f3,{})}),l.jsx(_t,{path:"sample",element:l.jsx(rP,{})})]}),l.jsx(_t,{path:"leave",element:l.jsx(nP,{})}),l.jsx(_t,{path:"settings",children:l.jsx(_t,{path:"notifications",element:l.jsx(uP,{})})}),l.jsxs(_t,{path:"admin",children:[l.jsx(_t,{path:"users",element:l.jsx(Il,{minRole:"admin",children:l.jsx(sP,{})})}),l.jsx(_t,{path:"groups",element:l.jsx(Il,{minRole:"admin",children:l.jsx(iP,{})})}),l.jsx(_t,{path:"equipment",element:l.jsx(Il,{minRole:"admin",children:l.jsx(aP,{})})})]})]})]})]})})})})}ev(document.getElementById("root")).render(l.jsx(b.StrictMode,{children:l.jsx(k8,{})}));
