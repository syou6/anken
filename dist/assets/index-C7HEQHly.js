function l2(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Or=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function c2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function u2(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var qg={exports:{}},iu={},Kg={exports:{}},Pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wo=Symbol.for("react.element"),d2=Symbol.for("react.portal"),f2=Symbol.for("react.fragment"),h2=Symbol.for("react.strict_mode"),m2=Symbol.for("react.profiler"),p2=Symbol.for("react.provider"),g2=Symbol.for("react.context"),x2=Symbol.for("react.forward_ref"),v2=Symbol.for("react.suspense"),y2=Symbol.for("react.memo"),w2=Symbol.for("react.lazy"),sm=Symbol.iterator;function _2(e){return e===null||typeof e!="object"?null:(e=sm&&e[sm]||e["@@iterator"],typeof e=="function"?e:null)}var Xg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Yg=Object.assign,Jg={};function ca(e,t,r){this.props=e,this.context=t,this.refs=Jg,this.updater=r||Xg}ca.prototype.isReactComponent={};ca.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ca.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Qg(){}Qg.prototype=ca.prototype;function mf(e,t,r){this.props=e,this.context=t,this.refs=Jg,this.updater=r||Xg}var pf=mf.prototype=new Qg;pf.constructor=mf;Yg(pf,ca.prototype);pf.isPureReactComponent=!0;var im=Array.isArray,Zg=Object.prototype.hasOwnProperty,gf={current:null},ex={key:!0,ref:!0,__self:!0,__source:!0};function tx(e,t,r){var n,s={},i=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)Zg.call(t,n)&&!ex.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Wo,type:e,key:i,ref:a,props:s,_owner:gf.current}}function E2(e,t){return{$$typeof:Wo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function xf(e){return typeof e=="object"&&e!==null&&e.$$typeof===Wo}function S2(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var am=/\/+/g;function rd(e,t){return typeof e=="object"&&e!==null&&e.key!=null?S2(""+e.key):t.toString(36)}function zl(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Wo:case d2:a=!0}}if(a)return a=e,s=s(a),e=n===""?"."+rd(a,0):n,im(s)?(r="",e!=null&&(r=e.replace(am,"$&/")+"/"),zl(s,t,r,"",function(d){return d})):s!=null&&(xf(s)&&(s=E2(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(am,"$&/")+"/")+e)),t.push(s)),1;if(a=0,n=n===""?".":n+":",im(e))for(var o=0;o<e.length;o++){i=e[o];var c=n+rd(i,o);a+=zl(i,t,r,c,s)}else if(c=_2(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=n+rd(i,o++),a+=zl(i,t,r,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function ll(e,t,r){if(e==null)return e;var n=[],s=0;return zl(e,n,"","",function(i){return t.call(r,i,s++)}),n}function T2(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Jt={current:null},Vl={transition:null},b2={ReactCurrentDispatcher:Jt,ReactCurrentBatchConfig:Vl,ReactCurrentOwner:gf};function rx(){throw Error("act(...) is not supported in production builds of React.")}Pe.Children={map:ll,forEach:function(e,t,r){ll(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return ll(e,function(){t++}),t},toArray:function(e){return ll(e,function(t){return t})||[]},only:function(e){if(!xf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Pe.Component=ca;Pe.Fragment=f2;Pe.Profiler=m2;Pe.PureComponent=mf;Pe.StrictMode=h2;Pe.Suspense=v2;Pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=b2;Pe.act=rx;Pe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Yg({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=gf.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)Zg.call(t,c)&&!ex.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];n.children=o}return{$$typeof:Wo,type:e.type,key:s,ref:i,props:n,_owner:a}};Pe.createContext=function(e){return e={$$typeof:g2,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:p2,_context:e},e.Consumer=e};Pe.createElement=tx;Pe.createFactory=function(e){var t=tx.bind(null,e);return t.type=e,t};Pe.createRef=function(){return{current:null}};Pe.forwardRef=function(e){return{$$typeof:x2,render:e}};Pe.isValidElement=xf;Pe.lazy=function(e){return{$$typeof:w2,_payload:{_status:-1,_result:e},_init:T2}};Pe.memo=function(e,t){return{$$typeof:y2,type:e,compare:t===void 0?null:t}};Pe.startTransition=function(e){var t=Vl.transition;Vl.transition={};try{e()}finally{Vl.transition=t}};Pe.unstable_act=rx;Pe.useCallback=function(e,t){return Jt.current.useCallback(e,t)};Pe.useContext=function(e){return Jt.current.useContext(e)};Pe.useDebugValue=function(){};Pe.useDeferredValue=function(e){return Jt.current.useDeferredValue(e)};Pe.useEffect=function(e,t){return Jt.current.useEffect(e,t)};Pe.useId=function(){return Jt.current.useId()};Pe.useImperativeHandle=function(e,t,r){return Jt.current.useImperativeHandle(e,t,r)};Pe.useInsertionEffect=function(e,t){return Jt.current.useInsertionEffect(e,t)};Pe.useLayoutEffect=function(e,t){return Jt.current.useLayoutEffect(e,t)};Pe.useMemo=function(e,t){return Jt.current.useMemo(e,t)};Pe.useReducer=function(e,t,r){return Jt.current.useReducer(e,t,r)};Pe.useRef=function(e){return Jt.current.useRef(e)};Pe.useState=function(e){return Jt.current.useState(e)};Pe.useSyncExternalStore=function(e,t,r){return Jt.current.useSyncExternalStore(e,t,r)};Pe.useTransition=function(){return Jt.current.useTransition()};Pe.version="18.3.1";Kg.exports=Pe;var b=Kg.exports;const Ct=c2(b),Jd=l2({__proto__:null,default:Ct},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k2=b,N2=Symbol.for("react.element"),j2=Symbol.for("react.fragment"),C2=Object.prototype.hasOwnProperty,A2=k2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,O2={key:!0,ref:!0,__self:!0,__source:!0};function nx(e,t,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)C2.call(t,n)&&!O2.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:N2,type:e,key:i,ref:a,props:s,_owner:A2.current}}iu.Fragment=j2;iu.jsx=nx;iu.jsxs=nx;qg.exports=iu;var l=qg.exports,sx={exports:{}},wr={},ix={exports:{}},ax={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(z,U){var Z=z.length;z.push(U);e:for(;0<Z;){var G=Z-1>>>1,k=z[G];if(0<s(k,U))z[G]=U,z[Z]=k,Z=G;else break e}}function r(z){return z.length===0?null:z[0]}function n(z){if(z.length===0)return null;var U=z[0],Z=z.pop();if(Z!==U){z[0]=Z;e:for(var G=0,k=z.length,F=k>>>1;G<F;){var C=2*(G+1)-1,L=z[C],H=C+1,Q=z[H];if(0>s(L,Z))H<k&&0>s(Q,L)?(z[G]=Q,z[H]=Z,G=H):(z[G]=L,z[C]=Z,G=C);else if(H<k&&0>s(Q,Z))z[G]=Q,z[H]=Z,G=H;else break e}}return U}function s(z,U){var Z=z.sortIndex-U.sortIndex;return Z!==0?Z:z.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var c=[],d=[],u=1,f=null,h=3,p=!1,x=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(z){for(var U=r(d);U!==null;){if(U.callback===null)n(d);else if(U.startTime<=z)n(d),U.sortIndex=U.expirationTime,t(c,U);else break;U=r(d)}}function w(z){if(m=!1,v(z),!x)if(r(c)!==null)x=!0,se(N);else{var U=r(d);U!==null&&le(w,U.startTime-z)}}function N(z,U){x=!1,m&&(m=!1,_(M),M=-1),p=!0;var Z=h;try{for(v(U),f=r(c);f!==null&&(!(f.expirationTime>U)||z&&!W());){var G=f.callback;if(typeof G=="function"){f.callback=null,h=f.priorityLevel;var k=G(f.expirationTime<=U);U=e.unstable_now(),typeof k=="function"?f.callback=k:f===r(c)&&n(c),v(U)}else n(c);f=r(c)}if(f!==null)var F=!0;else{var C=r(d);C!==null&&le(w,C.startTime-U),F=!1}return F}finally{f=null,h=Z,p=!1}}var E=!1,T=null,M=-1,P=5,B=-1;function W(){return!(e.unstable_now()-B<P)}function Y(){if(T!==null){var z=e.unstable_now();B=z;var U=!0;try{U=T(!0,z)}finally{U?J():(E=!1,T=null)}}else E=!1}var J;if(typeof y=="function")J=function(){y(Y)};else if(typeof MessageChannel<"u"){var Te=new MessageChannel,ye=Te.port2;Te.port1.onmessage=Y,J=function(){ye.postMessage(null)}}else J=function(){g(Y,0)};function se(z){T=z,E||(E=!0,J())}function le(z,U){M=g(function(){z(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(z){z.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,se(N))},e.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<z?Math.floor(1e3/z):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(z){switch(h){case 1:case 2:case 3:var U=3;break;default:U=h}var Z=h;h=U;try{return z()}finally{h=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(z,U){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var Z=h;h=z;try{return U()}finally{h=Z}},e.unstable_scheduleCallback=function(z,U,Z){var G=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?G+Z:G):Z=G,z){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=Z+k,z={id:u++,callback:U,priorityLevel:z,startTime:Z,expirationTime:k,sortIndex:-1},Z>G?(z.sortIndex=Z,t(d,z),r(c)===null&&z===r(d)&&(m?(_(M),M=-1):m=!0,le(w,Z-G))):(z.sortIndex=k,t(c,z),x||p||(x=!0,se(N))),z},e.unstable_shouldYield=W,e.unstable_wrapCallback=function(z){var U=h;return function(){var Z=h;h=U;try{return z.apply(this,arguments)}finally{h=Z}}}})(ax);ix.exports=ax;var F2=ix.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P2=b,vr=F2;function ue(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ox=new Set,mo={};function ti(e,t){Yi(e,t),Yi(e+"Capture",t)}function Yi(e,t){for(mo[e]=t,e=0;e<t.length;e++)ox.add(t[e])}var Tn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qd=Object.prototype.hasOwnProperty,D2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,om={},lm={};function R2(e){return Qd.call(lm,e)?!0:Qd.call(om,e)?!1:D2.test(e)?lm[e]=!0:(om[e]=!0,!1)}function I2(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function L2(e,t,r,n){if(t===null||typeof t>"u"||I2(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Qt(e,t,r,n,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var Pt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Pt[e]=new Qt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Pt[t]=new Qt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Pt[e]=new Qt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Pt[e]=new Qt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Pt[e]=new Qt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Pt[e]=new Qt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Pt[e]=new Qt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Pt[e]=new Qt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Pt[e]=new Qt(e,5,!1,e.toLowerCase(),null,!1,!1)});var vf=/[\-:]([a-z])/g;function yf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(vf,yf);Pt[t]=new Qt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(vf,yf);Pt[t]=new Qt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(vf,yf);Pt[t]=new Qt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Pt[e]=new Qt(e,1,!1,e.toLowerCase(),null,!1,!1)});Pt.xlinkHref=new Qt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Pt[e]=new Qt(e,1,!1,e.toLowerCase(),null,!0,!0)});function wf(e,t,r,n){var s=Pt.hasOwnProperty(t)?Pt[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(L2(t,r,s,n)&&(r=null),n||s===null?R2(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Pn=P2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cl=Symbol.for("react.element"),Ti=Symbol.for("react.portal"),bi=Symbol.for("react.fragment"),_f=Symbol.for("react.strict_mode"),Zd=Symbol.for("react.profiler"),lx=Symbol.for("react.provider"),cx=Symbol.for("react.context"),Ef=Symbol.for("react.forward_ref"),e0=Symbol.for("react.suspense"),t0=Symbol.for("react.suspense_list"),Sf=Symbol.for("react.memo"),Wn=Symbol.for("react.lazy"),ux=Symbol.for("react.offscreen"),cm=Symbol.iterator;function Na(e){return e===null||typeof e!="object"?null:(e=cm&&e[cm]||e["@@iterator"],typeof e=="function"?e:null)}var rt=Object.assign,nd;function Ba(e){if(nd===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);nd=t&&t[1]||""}return`
`+nd+e}var sd=!1;function id(e,t){if(!e||sd)return"";sd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==i[o]){var c=`
`+s[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=o);break}}}finally{sd=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ba(e):""}function M2(e){switch(e.tag){case 5:return Ba(e.type);case 16:return Ba("Lazy");case 13:return Ba("Suspense");case 19:return Ba("SuspenseList");case 0:case 2:case 15:return e=id(e.type,!1),e;case 11:return e=id(e.type.render,!1),e;case 1:return e=id(e.type,!0),e;default:return""}}function r0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case bi:return"Fragment";case Ti:return"Portal";case Zd:return"Profiler";case _f:return"StrictMode";case e0:return"Suspense";case t0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case cx:return(e.displayName||"Context")+".Consumer";case lx:return(e._context.displayName||"Context")+".Provider";case Ef:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Sf:return t=e.displayName||null,t!==null?t:r0(e.type)||"Memo";case Wn:t=e._payload,e=e._init;try{return r0(e(t))}catch{}}return null}function B2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return r0(t);case 8:return t===_f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function hs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function dx(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function $2(e){var t=dx(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ul(e){e._valueTracker||(e._valueTracker=$2(e))}function fx(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=dx(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function sc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function n0(e,t){var r=t.checked;return rt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function um(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=hs(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function hx(e,t){t=t.checked,t!=null&&wf(e,"checked",t,!1)}function s0(e,t){hx(e,t);var r=hs(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?i0(e,t.type,r):t.hasOwnProperty("defaultValue")&&i0(e,t.type,hs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function dm(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function i0(e,t,r){(t!=="number"||sc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var $a=Array.isArray;function Li(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+hs(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function a0(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ue(91));return rt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function fm(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ue(92));if($a(r)){if(1<r.length)throw Error(ue(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:hs(r)}}function mx(e,t){var r=hs(t.value),n=hs(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function hm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function px(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function o0(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?px(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var dl,gx=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(dl=dl||document.createElement("div"),dl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=dl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function po(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Ga={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},U2=["Webkit","ms","Moz","O"];Object.keys(Ga).forEach(function(e){U2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ga[t]=Ga[e]})});function xx(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Ga.hasOwnProperty(e)&&Ga[e]?(""+t).trim():t+"px"}function vx(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=xx(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var W2=rt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function l0(e,t){if(t){if(W2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ue(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ue(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ue(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ue(62))}}function c0(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var u0=null;function Tf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var d0=null,Mi=null,Bi=null;function mm(e){if(e=Vo(e)){if(typeof d0!="function")throw Error(ue(280));var t=e.stateNode;t&&(t=uu(t),d0(e.stateNode,e.type,t))}}function yx(e){Mi?Bi?Bi.push(e):Bi=[e]:Mi=e}function wx(){if(Mi){var e=Mi,t=Bi;if(Bi=Mi=null,mm(e),t)for(e=0;e<t.length;e++)mm(t[e])}}function _x(e,t){return e(t)}function Ex(){}var ad=!1;function Sx(e,t,r){if(ad)return e(t,r);ad=!0;try{return _x(e,t,r)}finally{ad=!1,(Mi!==null||Bi!==null)&&(Ex(),wx())}}function go(e,t){var r=e.stateNode;if(r===null)return null;var n=uu(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ue(231,t,typeof r));return r}var f0=!1;if(Tn)try{var ja={};Object.defineProperty(ja,"passive",{get:function(){f0=!0}}),window.addEventListener("test",ja,ja),window.removeEventListener("test",ja,ja)}catch{f0=!1}function H2(e,t,r,n,s,i,a,o,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var qa=!1,ic=null,ac=!1,h0=null,z2={onError:function(e){qa=!0,ic=e}};function V2(e,t,r,n,s,i,a,o,c){qa=!1,ic=null,H2.apply(z2,arguments)}function G2(e,t,r,n,s,i,a,o,c){if(V2.apply(this,arguments),qa){if(qa){var d=ic;qa=!1,ic=null}else throw Error(ue(198));ac||(ac=!0,h0=d)}}function ri(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Tx(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function pm(e){if(ri(e)!==e)throw Error(ue(188))}function q2(e){var t=e.alternate;if(!t){if(t=ri(e),t===null)throw Error(ue(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return pm(s),e;if(i===n)return pm(s),t;i=i.sibling}throw Error(ue(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a)throw Error(ue(189))}}if(r.alternate!==n)throw Error(ue(190))}if(r.tag!==3)throw Error(ue(188));return r.stateNode.current===r?e:t}function bx(e){return e=q2(e),e!==null?kx(e):null}function kx(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=kx(e);if(t!==null)return t;e=e.sibling}return null}var Nx=vr.unstable_scheduleCallback,gm=vr.unstable_cancelCallback,K2=vr.unstable_shouldYield,X2=vr.unstable_requestPaint,ot=vr.unstable_now,Y2=vr.unstable_getCurrentPriorityLevel,bf=vr.unstable_ImmediatePriority,jx=vr.unstable_UserBlockingPriority,oc=vr.unstable_NormalPriority,J2=vr.unstable_LowPriority,Cx=vr.unstable_IdlePriority,au=null,an=null;function Q2(e){if(an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(au,e,void 0,(e.current.flags&128)===128)}catch{}}var qr=Math.clz32?Math.clz32:t_,Z2=Math.log,e_=Math.LN2;function t_(e){return e>>>=0,e===0?32:31-(Z2(e)/e_|0)|0}var fl=64,hl=4194304;function Ua(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function lc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~s;o!==0?n=Ua(o):(i&=a,i!==0&&(n=Ua(i)))}else a=r&~s,a!==0?n=Ua(a):i!==0&&(n=Ua(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-qr(t),s=1<<r,n|=e[r],t&=~s;return n}function r_(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function n_(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-qr(i),o=1<<a,c=s[a];c===-1?(!(o&r)||o&n)&&(s[a]=r_(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}function m0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ax(){var e=fl;return fl<<=1,!(fl&4194240)&&(fl=64),e}function od(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ho(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-qr(t),e[t]=r}function s_(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-qr(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function kf(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-qr(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var Ue=0;function Ox(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Fx,Nf,Px,Dx,Rx,p0=!1,ml=[],ns=null,ss=null,is=null,xo=new Map,vo=new Map,qn=[],i_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xm(e,t){switch(e){case"focusin":case"focusout":ns=null;break;case"dragenter":case"dragleave":ss=null;break;case"mouseover":case"mouseout":is=null;break;case"pointerover":case"pointerout":xo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":vo.delete(t.pointerId)}}function Ca(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Vo(t),t!==null&&Nf(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function a_(e,t,r,n,s){switch(t){case"focusin":return ns=Ca(ns,e,t,r,n,s),!0;case"dragenter":return ss=Ca(ss,e,t,r,n,s),!0;case"mouseover":return is=Ca(is,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return xo.set(i,Ca(xo.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,vo.set(i,Ca(vo.get(i)||null,e,t,r,n,s)),!0}return!1}function Ix(e){var t=Ms(e.target);if(t!==null){var r=ri(t);if(r!==null){if(t=r.tag,t===13){if(t=Tx(r),t!==null){e.blockedOn=t,Rx(e.priority,function(){Px(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Gl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=g0(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);u0=n,r.target.dispatchEvent(n),u0=null}else return t=Vo(r),t!==null&&Nf(t),e.blockedOn=r,!1;t.shift()}return!0}function vm(e,t,r){Gl(e)&&r.delete(t)}function o_(){p0=!1,ns!==null&&Gl(ns)&&(ns=null),ss!==null&&Gl(ss)&&(ss=null),is!==null&&Gl(is)&&(is=null),xo.forEach(vm),vo.forEach(vm)}function Aa(e,t){e.blockedOn===t&&(e.blockedOn=null,p0||(p0=!0,vr.unstable_scheduleCallback(vr.unstable_NormalPriority,o_)))}function yo(e){function t(s){return Aa(s,e)}if(0<ml.length){Aa(ml[0],e);for(var r=1;r<ml.length;r++){var n=ml[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ns!==null&&Aa(ns,e),ss!==null&&Aa(ss,e),is!==null&&Aa(is,e),xo.forEach(t),vo.forEach(t),r=0;r<qn.length;r++)n=qn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<qn.length&&(r=qn[0],r.blockedOn===null);)Ix(r),r.blockedOn===null&&qn.shift()}var $i=Pn.ReactCurrentBatchConfig,cc=!0;function l_(e,t,r,n){var s=Ue,i=$i.transition;$i.transition=null;try{Ue=1,jf(e,t,r,n)}finally{Ue=s,$i.transition=i}}function c_(e,t,r,n){var s=Ue,i=$i.transition;$i.transition=null;try{Ue=4,jf(e,t,r,n)}finally{Ue=s,$i.transition=i}}function jf(e,t,r,n){if(cc){var s=g0(e,t,r,n);if(s===null)xd(e,t,n,uc,r),xm(e,n);else if(a_(s,e,t,r,n))n.stopPropagation();else if(xm(e,n),t&4&&-1<i_.indexOf(e)){for(;s!==null;){var i=Vo(s);if(i!==null&&Fx(i),i=g0(e,t,r,n),i===null&&xd(e,t,n,uc,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else xd(e,t,n,null,r)}}var uc=null;function g0(e,t,r,n){if(uc=null,e=Tf(n),e=Ms(e),e!==null)if(t=ri(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Tx(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return uc=e,null}function Lx(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Y2()){case bf:return 1;case jx:return 4;case oc:case J2:return 16;case Cx:return 536870912;default:return 16}default:return 16}}var Jn=null,Cf=null,ql=null;function Mx(){if(ql)return ql;var e,t=Cf,r=t.length,n,s="value"in Jn?Jn.value:Jn.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===s[i-n];n++);return ql=s.slice(e,1<n?1-n:void 0)}function Kl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function pl(){return!0}function ym(){return!1}function _r(e){function t(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?pl:ym,this.isPropagationStopped=ym,this}return rt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=pl)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=pl)},persist:function(){},isPersistent:pl}),t}var ua={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Af=_r(ua),zo=rt({},ua,{view:0,detail:0}),u_=_r(zo),ld,cd,Oa,ou=rt({},zo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Of,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Oa&&(Oa&&e.type==="mousemove"?(ld=e.screenX-Oa.screenX,cd=e.screenY-Oa.screenY):cd=ld=0,Oa=e),ld)},movementY:function(e){return"movementY"in e?e.movementY:cd}}),wm=_r(ou),d_=rt({},ou,{dataTransfer:0}),f_=_r(d_),h_=rt({},zo,{relatedTarget:0}),ud=_r(h_),m_=rt({},ua,{animationName:0,elapsedTime:0,pseudoElement:0}),p_=_r(m_),g_=rt({},ua,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),x_=_r(g_),v_=rt({},ua,{data:0}),_m=_r(v_),y_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},w_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},__={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function E_(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=__[e])?!!t[e]:!1}function Of(){return E_}var S_=rt({},zo,{key:function(e){if(e.key){var t=y_[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Kl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?w_[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Of,charCode:function(e){return e.type==="keypress"?Kl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Kl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),T_=_r(S_),b_=rt({},ou,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Em=_r(b_),k_=rt({},zo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Of}),N_=_r(k_),j_=rt({},ua,{propertyName:0,elapsedTime:0,pseudoElement:0}),C_=_r(j_),A_=rt({},ou,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),O_=_r(A_),F_=[9,13,27,32],Ff=Tn&&"CompositionEvent"in window,Ka=null;Tn&&"documentMode"in document&&(Ka=document.documentMode);var P_=Tn&&"TextEvent"in window&&!Ka,Bx=Tn&&(!Ff||Ka&&8<Ka&&11>=Ka),Sm=" ",Tm=!1;function $x(e,t){switch(e){case"keyup":return F_.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ux(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ki=!1;function D_(e,t){switch(e){case"compositionend":return Ux(t);case"keypress":return t.which!==32?null:(Tm=!0,Sm);case"textInput":return e=t.data,e===Sm&&Tm?null:e;default:return null}}function R_(e,t){if(ki)return e==="compositionend"||!Ff&&$x(e,t)?(e=Mx(),ql=Cf=Jn=null,ki=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bx&&t.locale!=="ko"?null:t.data;default:return null}}var I_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!I_[e.type]:t==="textarea"}function Wx(e,t,r,n){yx(n),t=dc(t,"onChange"),0<t.length&&(r=new Af("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Xa=null,wo=null;function L_(e){Zx(e,0)}function lu(e){var t=Ci(e);if(fx(t))return e}function M_(e,t){if(e==="change")return t}var Hx=!1;if(Tn){var dd;if(Tn){var fd="oninput"in document;if(!fd){var km=document.createElement("div");km.setAttribute("oninput","return;"),fd=typeof km.oninput=="function"}dd=fd}else dd=!1;Hx=dd&&(!document.documentMode||9<document.documentMode)}function Nm(){Xa&&(Xa.detachEvent("onpropertychange",zx),wo=Xa=null)}function zx(e){if(e.propertyName==="value"&&lu(wo)){var t=[];Wx(t,wo,e,Tf(e)),Sx(L_,t)}}function B_(e,t,r){e==="focusin"?(Nm(),Xa=t,wo=r,Xa.attachEvent("onpropertychange",zx)):e==="focusout"&&Nm()}function $_(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return lu(wo)}function U_(e,t){if(e==="click")return lu(t)}function W_(e,t){if(e==="input"||e==="change")return lu(t)}function H_(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Yr=typeof Object.is=="function"?Object.is:H_;function _o(e,t){if(Yr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Qd.call(t,s)||!Yr(e[s],t[s]))return!1}return!0}function jm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Cm(e,t){var r=jm(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=jm(r)}}function Vx(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Vx(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Gx(){for(var e=window,t=sc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=sc(e.document)}return t}function Pf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function z_(e){var t=Gx(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Vx(r.ownerDocument.documentElement,r)){if(n!==null&&Pf(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=Cm(r,i);var a=Cm(r,n);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var V_=Tn&&"documentMode"in document&&11>=document.documentMode,Ni=null,x0=null,Ya=null,v0=!1;function Am(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;v0||Ni==null||Ni!==sc(n)||(n=Ni,"selectionStart"in n&&Pf(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ya&&_o(Ya,n)||(Ya=n,n=dc(x0,"onSelect"),0<n.length&&(t=new Af("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ni)))}function gl(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ji={animationend:gl("Animation","AnimationEnd"),animationiteration:gl("Animation","AnimationIteration"),animationstart:gl("Animation","AnimationStart"),transitionend:gl("Transition","TransitionEnd")},hd={},qx={};Tn&&(qx=document.createElement("div").style,"AnimationEvent"in window||(delete ji.animationend.animation,delete ji.animationiteration.animation,delete ji.animationstart.animation),"TransitionEvent"in window||delete ji.transitionend.transition);function cu(e){if(hd[e])return hd[e];if(!ji[e])return e;var t=ji[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in qx)return hd[e]=t[r];return e}var Kx=cu("animationend"),Xx=cu("animationiteration"),Yx=cu("animationstart"),Jx=cu("transitionend"),Qx=new Map,Om="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ys(e,t){Qx.set(e,t),ti(t,[e])}for(var md=0;md<Om.length;md++){var pd=Om[md],G_=pd.toLowerCase(),q_=pd[0].toUpperCase()+pd.slice(1);ys(G_,"on"+q_)}ys(Kx,"onAnimationEnd");ys(Xx,"onAnimationIteration");ys(Yx,"onAnimationStart");ys("dblclick","onDoubleClick");ys("focusin","onFocus");ys("focusout","onBlur");ys(Jx,"onTransitionEnd");Yi("onMouseEnter",["mouseout","mouseover"]);Yi("onMouseLeave",["mouseout","mouseover"]);Yi("onPointerEnter",["pointerout","pointerover"]);Yi("onPointerLeave",["pointerout","pointerover"]);ti("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ti("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ti("onBeforeInput",["compositionend","keypress","textInput","paste"]);ti("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ti("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ti("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),K_=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wa));function Fm(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,G2(n,t,void 0,e),e.currentTarget=null}function Zx(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],c=o.instance,d=o.currentTarget;if(o=o.listener,c!==i&&s.isPropagationStopped())break e;Fm(s,o,d),i=c}else for(a=0;a<n.length;a++){if(o=n[a],c=o.instance,d=o.currentTarget,o=o.listener,c!==i&&s.isPropagationStopped())break e;Fm(s,o,d),i=c}}}if(ac)throw e=h0,ac=!1,h0=null,e}function Ge(e,t){var r=t[S0];r===void 0&&(r=t[S0]=new Set);var n=e+"__bubble";r.has(n)||(e1(t,e,2,!1),r.add(n))}function gd(e,t,r){var n=0;t&&(n|=4),e1(r,e,n,t)}var xl="_reactListening"+Math.random().toString(36).slice(2);function Eo(e){if(!e[xl]){e[xl]=!0,ox.forEach(function(r){r!=="selectionchange"&&(K_.has(r)||gd(r,!1,e),gd(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[xl]||(t[xl]=!0,gd("selectionchange",!1,t))}}function e1(e,t,r,n){switch(Lx(t)){case 1:var s=l_;break;case 4:s=c_;break;default:s=jf}r=s.bind(null,t,r,e),s=void 0,!f0||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function xd(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;o!==null;){if(a=Ms(o),a===null)return;if(c=a.tag,c===5||c===6){n=i=a;continue e}o=o.parentNode}}n=n.return}Sx(function(){var d=i,u=Tf(r),f=[];e:{var h=Qx.get(e);if(h!==void 0){var p=Af,x=e;switch(e){case"keypress":if(Kl(r)===0)break e;case"keydown":case"keyup":p=T_;break;case"focusin":x="focus",p=ud;break;case"focusout":x="blur",p=ud;break;case"beforeblur":case"afterblur":p=ud;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=wm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=f_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=N_;break;case Kx:case Xx:case Yx:p=p_;break;case Jx:p=C_;break;case"scroll":p=u_;break;case"wheel":p=O_;break;case"copy":case"cut":case"paste":p=x_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Em}var m=(t&4)!==0,g=!m&&e==="scroll",_=m?h!==null?h+"Capture":null:h;m=[];for(var y=d,v;y!==null;){v=y;var w=v.stateNode;if(v.tag===5&&w!==null&&(v=w,_!==null&&(w=go(y,_),w!=null&&m.push(So(y,w,v)))),g)break;y=y.return}0<m.length&&(h=new p(h,x,null,r,u),f.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==u0&&(x=r.relatedTarget||r.fromElement)&&(Ms(x)||x[bn]))break e;if((p||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=d,x=x?Ms(x):null,x!==null&&(g=ri(x),x!==g||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=d),p!==x)){if(m=wm,w="onMouseLeave",_="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=Em,w="onPointerLeave",_="onPointerEnter",y="pointer"),g=p==null?h:Ci(p),v=x==null?h:Ci(x),h=new m(w,y+"leave",p,r,u),h.target=g,h.relatedTarget=v,w=null,Ms(u)===d&&(m=new m(_,y+"enter",x,r,u),m.target=v,m.relatedTarget=g,w=m),g=w,p&&x)t:{for(m=p,_=x,y=0,v=m;v;v=fi(v))y++;for(v=0,w=_;w;w=fi(w))v++;for(;0<y-v;)m=fi(m),y--;for(;0<v-y;)_=fi(_),v--;for(;y--;){if(m===_||_!==null&&m===_.alternate)break t;m=fi(m),_=fi(_)}m=null}else m=null;p!==null&&Pm(f,h,p,m,!1),x!==null&&g!==null&&Pm(f,g,x,m,!0)}}e:{if(h=d?Ci(d):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var N=M_;else if(bm(h))if(Hx)N=W_;else{N=$_;var E=B_}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(N=U_);if(N&&(N=N(e,d))){Wx(f,N,r,u);break e}E&&E(e,h,d),e==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&i0(h,"number",h.value)}switch(E=d?Ci(d):window,e){case"focusin":(bm(E)||E.contentEditable==="true")&&(Ni=E,x0=d,Ya=null);break;case"focusout":Ya=x0=Ni=null;break;case"mousedown":v0=!0;break;case"contextmenu":case"mouseup":case"dragend":v0=!1,Am(f,r,u);break;case"selectionchange":if(V_)break;case"keydown":case"keyup":Am(f,r,u)}var T;if(Ff)e:{switch(e){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else ki?$x(e,r)&&(M="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(M="onCompositionStart");M&&(Bx&&r.locale!=="ko"&&(ki||M!=="onCompositionStart"?M==="onCompositionEnd"&&ki&&(T=Mx()):(Jn=u,Cf="value"in Jn?Jn.value:Jn.textContent,ki=!0)),E=dc(d,M),0<E.length&&(M=new _m(M,e,null,r,u),f.push({event:M,listeners:E}),T?M.data=T:(T=Ux(r),T!==null&&(M.data=T)))),(T=P_?D_(e,r):R_(e,r))&&(d=dc(d,"onBeforeInput"),0<d.length&&(u=new _m("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=T))}Zx(f,t)})}function So(e,t,r){return{instance:e,listener:t,currentTarget:r}}function dc(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=go(e,r),i!=null&&n.unshift(So(e,i,s)),i=go(e,t),i!=null&&n.push(So(e,i,s))),e=e.return}return n}function fi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Pm(e,t,r,n,s){for(var i=t._reactName,a=[];r!==null&&r!==n;){var o=r,c=o.alternate,d=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&d!==null&&(o=d,s?(c=go(r,i),c!=null&&a.unshift(So(r,c,o))):s||(c=go(r,i),c!=null&&a.push(So(r,c,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var X_=/\r\n?/g,Y_=/\u0000|\uFFFD/g;function Dm(e){return(typeof e=="string"?e:""+e).replace(X_,`
`).replace(Y_,"")}function vl(e,t,r){if(t=Dm(t),Dm(e)!==t&&r)throw Error(ue(425))}function fc(){}var y0=null,w0=null;function _0(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var E0=typeof setTimeout=="function"?setTimeout:void 0,J_=typeof clearTimeout=="function"?clearTimeout:void 0,Rm=typeof Promise=="function"?Promise:void 0,Q_=typeof queueMicrotask=="function"?queueMicrotask:typeof Rm<"u"?function(e){return Rm.resolve(null).then(e).catch(Z_)}:E0;function Z_(e){setTimeout(function(){throw e})}function vd(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),yo(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);yo(t)}function as(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Im(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var da=Math.random().toString(36).slice(2),rn="__reactFiber$"+da,To="__reactProps$"+da,bn="__reactContainer$"+da,S0="__reactEvents$"+da,eE="__reactListeners$"+da,tE="__reactHandles$"+da;function Ms(e){var t=e[rn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[bn]||r[rn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Im(e);e!==null;){if(r=e[rn])return r;e=Im(e)}return t}e=r,r=e.parentNode}return null}function Vo(e){return e=e[rn]||e[bn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ci(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ue(33))}function uu(e){return e[To]||null}var T0=[],Ai=-1;function ws(e){return{current:e}}function qe(e){0>Ai||(e.current=T0[Ai],T0[Ai]=null,Ai--)}function Ve(e,t){Ai++,T0[Ai]=e.current,e.current=t}var ms={},Wt=ws(ms),nr=ws(!1),qs=ms;function Ji(e,t){var r=e.type.contextTypes;if(!r)return ms;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function sr(e){return e=e.childContextTypes,e!=null}function hc(){qe(nr),qe(Wt)}function Lm(e,t,r){if(Wt.current!==ms)throw Error(ue(168));Ve(Wt,t),Ve(nr,r)}function t1(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(ue(108,B2(e)||"Unknown",s));return rt({},r,n)}function mc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ms,qs=Wt.current,Ve(Wt,e),Ve(nr,nr.current),!0}function Mm(e,t,r){var n=e.stateNode;if(!n)throw Error(ue(169));r?(e=t1(e,t,qs),n.__reactInternalMemoizedMergedChildContext=e,qe(nr),qe(Wt),Ve(Wt,e)):qe(nr),Ve(nr,r)}var gn=null,du=!1,yd=!1;function r1(e){gn===null?gn=[e]:gn.push(e)}function rE(e){du=!0,r1(e)}function _s(){if(!yd&&gn!==null){yd=!0;var e=0,t=Ue;try{var r=gn;for(Ue=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}gn=null,du=!1}catch(s){throw gn!==null&&(gn=gn.slice(e+1)),Nx(bf,_s),s}finally{Ue=t,yd=!1}}return null}var Oi=[],Fi=0,pc=null,gc=0,br=[],kr=0,Ks=null,xn=1,vn="";function As(e,t){Oi[Fi++]=gc,Oi[Fi++]=pc,pc=e,gc=t}function n1(e,t,r){br[kr++]=xn,br[kr++]=vn,br[kr++]=Ks,Ks=e;var n=xn;e=vn;var s=32-qr(n)-1;n&=~(1<<s),r+=1;var i=32-qr(t)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,xn=1<<32-qr(t)+s|r<<s|n,vn=i+e}else xn=1<<i|r<<s|n,vn=e}function Df(e){e.return!==null&&(As(e,1),n1(e,1,0))}function Rf(e){for(;e===pc;)pc=Oi[--Fi],Oi[Fi]=null,gc=Oi[--Fi],Oi[Fi]=null;for(;e===Ks;)Ks=br[--kr],br[kr]=null,vn=br[--kr],br[kr]=null,xn=br[--kr],br[kr]=null}var xr=null,pr=null,Ye=!1,Wr=null;function s1(e,t){var r=Nr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Bm(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,xr=e,pr=as(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,xr=e,pr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ks!==null?{id:xn,overflow:vn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Nr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,xr=e,pr=null,!0):!1;default:return!1}}function b0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function k0(e){if(Ye){var t=pr;if(t){var r=t;if(!Bm(e,t)){if(b0(e))throw Error(ue(418));t=as(r.nextSibling);var n=xr;t&&Bm(e,t)?s1(n,r):(e.flags=e.flags&-4097|2,Ye=!1,xr=e)}}else{if(b0(e))throw Error(ue(418));e.flags=e.flags&-4097|2,Ye=!1,xr=e}}}function $m(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xr=e}function yl(e){if(e!==xr)return!1;if(!Ye)return $m(e),Ye=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!_0(e.type,e.memoizedProps)),t&&(t=pr)){if(b0(e))throw i1(),Error(ue(418));for(;t;)s1(e,t),t=as(t.nextSibling)}if($m(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ue(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){pr=as(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}pr=null}}else pr=xr?as(e.stateNode.nextSibling):null;return!0}function i1(){for(var e=pr;e;)e=as(e.nextSibling)}function Qi(){pr=xr=null,Ye=!1}function If(e){Wr===null?Wr=[e]:Wr.push(e)}var nE=Pn.ReactCurrentBatchConfig;function Fa(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ue(309));var n=r.stateNode}if(!n)throw Error(ue(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var o=s.refs;a===null?delete o[i]:o[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(ue(284));if(!r._owner)throw Error(ue(290,e))}return e}function wl(e,t){throw e=Object.prototype.toString.call(t),Error(ue(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Um(e){var t=e._init;return t(e._payload)}function a1(e){function t(_,y){if(e){var v=_.deletions;v===null?(_.deletions=[y],_.flags|=16):v.push(y)}}function r(_,y){if(!e)return null;for(;y!==null;)t(_,y),y=y.sibling;return null}function n(_,y){for(_=new Map;y!==null;)y.key!==null?_.set(y.key,y):_.set(y.index,y),y=y.sibling;return _}function s(_,y){return _=us(_,y),_.index=0,_.sibling=null,_}function i(_,y,v){return _.index=v,e?(v=_.alternate,v!==null?(v=v.index,v<y?(_.flags|=2,y):v):(_.flags|=2,y)):(_.flags|=1048576,y)}function a(_){return e&&_.alternate===null&&(_.flags|=2),_}function o(_,y,v,w){return y===null||y.tag!==6?(y=kd(v,_.mode,w),y.return=_,y):(y=s(y,v),y.return=_,y)}function c(_,y,v,w){var N=v.type;return N===bi?u(_,y,v.props.children,w,v.key):y!==null&&(y.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Wn&&Um(N)===y.type)?(w=s(y,v.props),w.ref=Fa(_,y,v),w.return=_,w):(w=tc(v.type,v.key,v.props,null,_.mode,w),w.ref=Fa(_,y,v),w.return=_,w)}function d(_,y,v,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==v.containerInfo||y.stateNode.implementation!==v.implementation?(y=Nd(v,_.mode,w),y.return=_,y):(y=s(y,v.children||[]),y.return=_,y)}function u(_,y,v,w,N){return y===null||y.tag!==7?(y=zs(v,_.mode,w,N),y.return=_,y):(y=s(y,v),y.return=_,y)}function f(_,y,v){if(typeof y=="string"&&y!==""||typeof y=="number")return y=kd(""+y,_.mode,v),y.return=_,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case cl:return v=tc(y.type,y.key,y.props,null,_.mode,v),v.ref=Fa(_,null,y),v.return=_,v;case Ti:return y=Nd(y,_.mode,v),y.return=_,y;case Wn:var w=y._init;return f(_,w(y._payload),v)}if($a(y)||Na(y))return y=zs(y,_.mode,v,null),y.return=_,y;wl(_,y)}return null}function h(_,y,v,w){var N=y!==null?y.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return N!==null?null:o(_,y,""+v,w);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case cl:return v.key===N?c(_,y,v,w):null;case Ti:return v.key===N?d(_,y,v,w):null;case Wn:return N=v._init,h(_,y,N(v._payload),w)}if($a(v)||Na(v))return N!==null?null:u(_,y,v,w,null);wl(_,v)}return null}function p(_,y,v,w,N){if(typeof w=="string"&&w!==""||typeof w=="number")return _=_.get(v)||null,o(y,_,""+w,N);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case cl:return _=_.get(w.key===null?v:w.key)||null,c(y,_,w,N);case Ti:return _=_.get(w.key===null?v:w.key)||null,d(y,_,w,N);case Wn:var E=w._init;return p(_,y,v,E(w._payload),N)}if($a(w)||Na(w))return _=_.get(v)||null,u(y,_,w,N,null);wl(y,w)}return null}function x(_,y,v,w){for(var N=null,E=null,T=y,M=y=0,P=null;T!==null&&M<v.length;M++){T.index>M?(P=T,T=null):P=T.sibling;var B=h(_,T,v[M],w);if(B===null){T===null&&(T=P);break}e&&T&&B.alternate===null&&t(_,T),y=i(B,y,M),E===null?N=B:E.sibling=B,E=B,T=P}if(M===v.length)return r(_,T),Ye&&As(_,M),N;if(T===null){for(;M<v.length;M++)T=f(_,v[M],w),T!==null&&(y=i(T,y,M),E===null?N=T:E.sibling=T,E=T);return Ye&&As(_,M),N}for(T=n(_,T);M<v.length;M++)P=p(T,_,M,v[M],w),P!==null&&(e&&P.alternate!==null&&T.delete(P.key===null?M:P.key),y=i(P,y,M),E===null?N=P:E.sibling=P,E=P);return e&&T.forEach(function(W){return t(_,W)}),Ye&&As(_,M),N}function m(_,y,v,w){var N=Na(v);if(typeof N!="function")throw Error(ue(150));if(v=N.call(v),v==null)throw Error(ue(151));for(var E=N=null,T=y,M=y=0,P=null,B=v.next();T!==null&&!B.done;M++,B=v.next()){T.index>M?(P=T,T=null):P=T.sibling;var W=h(_,T,B.value,w);if(W===null){T===null&&(T=P);break}e&&T&&W.alternate===null&&t(_,T),y=i(W,y,M),E===null?N=W:E.sibling=W,E=W,T=P}if(B.done)return r(_,T),Ye&&As(_,M),N;if(T===null){for(;!B.done;M++,B=v.next())B=f(_,B.value,w),B!==null&&(y=i(B,y,M),E===null?N=B:E.sibling=B,E=B);return Ye&&As(_,M),N}for(T=n(_,T);!B.done;M++,B=v.next())B=p(T,_,M,B.value,w),B!==null&&(e&&B.alternate!==null&&T.delete(B.key===null?M:B.key),y=i(B,y,M),E===null?N=B:E.sibling=B,E=B);return e&&T.forEach(function(Y){return t(_,Y)}),Ye&&As(_,M),N}function g(_,y,v,w){if(typeof v=="object"&&v!==null&&v.type===bi&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case cl:e:{for(var N=v.key,E=y;E!==null;){if(E.key===N){if(N=v.type,N===bi){if(E.tag===7){r(_,E.sibling),y=s(E,v.props.children),y.return=_,_=y;break e}}else if(E.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Wn&&Um(N)===E.type){r(_,E.sibling),y=s(E,v.props),y.ref=Fa(_,E,v),y.return=_,_=y;break e}r(_,E);break}else t(_,E);E=E.sibling}v.type===bi?(y=zs(v.props.children,_.mode,w,v.key),y.return=_,_=y):(w=tc(v.type,v.key,v.props,null,_.mode,w),w.ref=Fa(_,y,v),w.return=_,_=w)}return a(_);case Ti:e:{for(E=v.key;y!==null;){if(y.key===E)if(y.tag===4&&y.stateNode.containerInfo===v.containerInfo&&y.stateNode.implementation===v.implementation){r(_,y.sibling),y=s(y,v.children||[]),y.return=_,_=y;break e}else{r(_,y);break}else t(_,y);y=y.sibling}y=Nd(v,_.mode,w),y.return=_,_=y}return a(_);case Wn:return E=v._init,g(_,y,E(v._payload),w)}if($a(v))return x(_,y,v,w);if(Na(v))return m(_,y,v,w);wl(_,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,y!==null&&y.tag===6?(r(_,y.sibling),y=s(y,v),y.return=_,_=y):(r(_,y),y=kd(v,_.mode,w),y.return=_,_=y),a(_)):r(_,y)}return g}var Zi=a1(!0),o1=a1(!1),xc=ws(null),vc=null,Pi=null,Lf=null;function Mf(){Lf=Pi=vc=null}function Bf(e){var t=xc.current;qe(xc),e._currentValue=t}function N0(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ui(e,t){vc=e,Lf=Pi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(rr=!0),e.firstContext=null)}function Fr(e){var t=e._currentValue;if(Lf!==e)if(e={context:e,memoizedValue:t,next:null},Pi===null){if(vc===null)throw Error(ue(308));Pi=e,vc.dependencies={lanes:0,firstContext:e}}else Pi=Pi.next=e;return t}var Bs=null;function $f(e){Bs===null?Bs=[e]:Bs.push(e)}function l1(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,$f(t)):(r.next=s.next,s.next=r),t.interleaved=r,kn(e,n)}function kn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Hn=!1;function Uf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function c1(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function wn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function os(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,De&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,kn(e,r)}return s=n.interleaved,s===null?(t.next=t,$f(n)):(t.next=s.next,s.next=t),n.interleaved=t,kn(e,r)}function Xl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,kf(e,r)}}function Wm(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function yc(e,t,r,n){var s=e.updateQueue;Hn=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var c=o,d=c.next;c.next=null,a===null?i=d:a.next=d,a=c;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=d:o.next=d,u.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;a=0,u=d=c=null,o=i;do{var h=o.lane,p=o.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,m=o;switch(h=t,p=r,m.tag){case 1:if(x=m.payload,typeof x=="function"){f=x.call(p,f,h);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=m.payload,h=typeof x=="function"?x.call(p,f,h):x,h==null)break e;f=rt({},f,h);break e;case 2:Hn=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(d=u=p,c=f):u=u.next=p,a|=h;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;h=o,o=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(u===null&&(c=f),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Ys|=a,e.lanes=a,e.memoizedState=f}}function Hm(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(ue(191,s));s.call(n)}}}var Go={},on=ws(Go),bo=ws(Go),ko=ws(Go);function $s(e){if(e===Go)throw Error(ue(174));return e}function Wf(e,t){switch(Ve(ko,t),Ve(bo,e),Ve(on,Go),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:o0(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=o0(t,e)}qe(on),Ve(on,t)}function ea(){qe(on),qe(bo),qe(ko)}function u1(e){$s(ko.current);var t=$s(on.current),r=o0(t,e.type);t!==r&&(Ve(bo,e),Ve(on,r))}function Hf(e){bo.current===e&&(qe(on),qe(bo))}var et=ws(0);function wc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var wd=[];function zf(){for(var e=0;e<wd.length;e++)wd[e]._workInProgressVersionPrimary=null;wd.length=0}var Yl=Pn.ReactCurrentDispatcher,_d=Pn.ReactCurrentBatchConfig,Xs=0,tt=null,mt=null,xt=null,_c=!1,Ja=!1,No=0,sE=0;function It(){throw Error(ue(321))}function Vf(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Yr(e[r],t[r]))return!1;return!0}function Gf(e,t,r,n,s,i){if(Xs=i,tt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Yl.current=e===null||e.memoizedState===null?lE:cE,e=r(n,s),Ja){i=0;do{if(Ja=!1,No=0,25<=i)throw Error(ue(301));i+=1,xt=mt=null,t.updateQueue=null,Yl.current=uE,e=r(n,s)}while(Ja)}if(Yl.current=Ec,t=mt!==null&&mt.next!==null,Xs=0,xt=mt=tt=null,_c=!1,t)throw Error(ue(300));return e}function qf(){var e=No!==0;return No=0,e}function tn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xt===null?tt.memoizedState=xt=e:xt=xt.next=e,xt}function Pr(){if(mt===null){var e=tt.alternate;e=e!==null?e.memoizedState:null}else e=mt.next;var t=xt===null?tt.memoizedState:xt.next;if(t!==null)xt=t,mt=e;else{if(e===null)throw Error(ue(310));mt=e,e={memoizedState:mt.memoizedState,baseState:mt.baseState,baseQueue:mt.baseQueue,queue:mt.queue,next:null},xt===null?tt.memoizedState=xt=e:xt=xt.next=e}return xt}function jo(e,t){return typeof t=="function"?t(e):t}function Ed(e){var t=Pr(),r=t.queue;if(r===null)throw Error(ue(311));r.lastRenderedReducer=e;var n=mt,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=a=null,c=null,d=i;do{var u=d.lane;if((Xs&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(o=c=f,a=n):c=c.next=f,tt.lanes|=u,Ys|=u}d=d.next}while(d!==null&&d!==i);c===null?a=n:c.next=o,Yr(n,t.memoizedState)||(rr=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,tt.lanes|=i,Ys|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Sd(e){var t=Pr(),r=t.queue;if(r===null)throw Error(ue(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);Yr(i,t.memoizedState)||(rr=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function d1(){}function f1(e,t){var r=tt,n=Pr(),s=t(),i=!Yr(n.memoizedState,s);if(i&&(n.memoizedState=s,rr=!0),n=n.queue,Kf(p1.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||xt!==null&&xt.memoizedState.tag&1){if(r.flags|=2048,Co(9,m1.bind(null,r,n,s,t),void 0,null),_t===null)throw Error(ue(349));Xs&30||h1(r,t,s)}return s}function h1(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=tt.updateQueue,t===null?(t={lastEffect:null,stores:null},tt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function m1(e,t,r,n){t.value=r,t.getSnapshot=n,g1(t)&&x1(e)}function p1(e,t,r){return r(function(){g1(t)&&x1(e)})}function g1(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Yr(e,r)}catch{return!0}}function x1(e){var t=kn(e,1);t!==null&&Kr(t,e,1,-1)}function zm(e){var t=tn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jo,lastRenderedState:e},t.queue=e,e=e.dispatch=oE.bind(null,tt,e),[t.memoizedState,e]}function Co(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=tt.updateQueue,t===null?(t={lastEffect:null,stores:null},tt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function v1(){return Pr().memoizedState}function Jl(e,t,r,n){var s=tn();tt.flags|=e,s.memoizedState=Co(1|t,r,void 0,n===void 0?null:n)}function fu(e,t,r,n){var s=Pr();n=n===void 0?null:n;var i=void 0;if(mt!==null){var a=mt.memoizedState;if(i=a.destroy,n!==null&&Vf(n,a.deps)){s.memoizedState=Co(t,r,i,n);return}}tt.flags|=e,s.memoizedState=Co(1|t,r,i,n)}function Vm(e,t){return Jl(8390656,8,e,t)}function Kf(e,t){return fu(2048,8,e,t)}function y1(e,t){return fu(4,2,e,t)}function w1(e,t){return fu(4,4,e,t)}function _1(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function E1(e,t,r){return r=r!=null?r.concat([e]):null,fu(4,4,_1.bind(null,t,e),r)}function Xf(){}function S1(e,t){var r=Pr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Vf(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function T1(e,t){var r=Pr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Vf(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function b1(e,t,r){return Xs&21?(Yr(r,t)||(r=Ax(),tt.lanes|=r,Ys|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,rr=!0),e.memoizedState=r)}function iE(e,t){var r=Ue;Ue=r!==0&&4>r?r:4,e(!0);var n=_d.transition;_d.transition={};try{e(!1),t()}finally{Ue=r,_d.transition=n}}function k1(){return Pr().memoizedState}function aE(e,t,r){var n=cs(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},N1(e))j1(t,r);else if(r=l1(e,t,r,n),r!==null){var s=Xt();Kr(r,e,n,s),C1(r,t,n)}}function oE(e,t,r){var n=cs(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(N1(e))j1(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,o=i(a,r);if(s.hasEagerState=!0,s.eagerState=o,Yr(o,a)){var c=t.interleaved;c===null?(s.next=s,$f(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=l1(e,t,s,n),r!==null&&(s=Xt(),Kr(r,e,n,s),C1(r,t,n))}}function N1(e){var t=e.alternate;return e===tt||t!==null&&t===tt}function j1(e,t){Ja=_c=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function C1(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,kf(e,r)}}var Ec={readContext:Fr,useCallback:It,useContext:It,useEffect:It,useImperativeHandle:It,useInsertionEffect:It,useLayoutEffect:It,useMemo:It,useReducer:It,useRef:It,useState:It,useDebugValue:It,useDeferredValue:It,useTransition:It,useMutableSource:It,useSyncExternalStore:It,useId:It,unstable_isNewReconciler:!1},lE={readContext:Fr,useCallback:function(e,t){return tn().memoizedState=[e,t===void 0?null:t],e},useContext:Fr,useEffect:Vm,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Jl(4194308,4,_1.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Jl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Jl(4,2,e,t)},useMemo:function(e,t){var r=tn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=tn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=aE.bind(null,tt,e),[n.memoizedState,e]},useRef:function(e){var t=tn();return e={current:e},t.memoizedState=e},useState:zm,useDebugValue:Xf,useDeferredValue:function(e){return tn().memoizedState=e},useTransition:function(){var e=zm(!1),t=e[0];return e=iE.bind(null,e[1]),tn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=tt,s=tn();if(Ye){if(r===void 0)throw Error(ue(407));r=r()}else{if(r=t(),_t===null)throw Error(ue(349));Xs&30||h1(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,Vm(p1.bind(null,n,i,e),[e]),n.flags|=2048,Co(9,m1.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=tn(),t=_t.identifierPrefix;if(Ye){var r=vn,n=xn;r=(n&~(1<<32-qr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=No++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=sE++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},cE={readContext:Fr,useCallback:S1,useContext:Fr,useEffect:Kf,useImperativeHandle:E1,useInsertionEffect:y1,useLayoutEffect:w1,useMemo:T1,useReducer:Ed,useRef:v1,useState:function(){return Ed(jo)},useDebugValue:Xf,useDeferredValue:function(e){var t=Pr();return b1(t,mt.memoizedState,e)},useTransition:function(){var e=Ed(jo)[0],t=Pr().memoizedState;return[e,t]},useMutableSource:d1,useSyncExternalStore:f1,useId:k1,unstable_isNewReconciler:!1},uE={readContext:Fr,useCallback:S1,useContext:Fr,useEffect:Kf,useImperativeHandle:E1,useInsertionEffect:y1,useLayoutEffect:w1,useMemo:T1,useReducer:Sd,useRef:v1,useState:function(){return Sd(jo)},useDebugValue:Xf,useDeferredValue:function(e){var t=Pr();return mt===null?t.memoizedState=e:b1(t,mt.memoizedState,e)},useTransition:function(){var e=Sd(jo)[0],t=Pr().memoizedState;return[e,t]},useMutableSource:d1,useSyncExternalStore:f1,useId:k1,unstable_isNewReconciler:!1};function Br(e,t){if(e&&e.defaultProps){t=rt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function j0(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:rt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var hu={isMounted:function(e){return(e=e._reactInternals)?ri(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Xt(),s=cs(e),i=wn(n,s);i.payload=t,r!=null&&(i.callback=r),t=os(e,i,s),t!==null&&(Kr(t,e,s,n),Xl(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Xt(),s=cs(e),i=wn(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=os(e,i,s),t!==null&&(Kr(t,e,s,n),Xl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Xt(),n=cs(e),s=wn(r,n);s.tag=2,t!=null&&(s.callback=t),t=os(e,s,n),t!==null&&(Kr(t,e,n,r),Xl(t,e,n))}};function Gm(e,t,r,n,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,a):t.prototype&&t.prototype.isPureReactComponent?!_o(r,n)||!_o(s,i):!0}function A1(e,t,r){var n=!1,s=ms,i=t.contextType;return typeof i=="object"&&i!==null?i=Fr(i):(s=sr(t)?qs:Wt.current,n=t.contextTypes,i=(n=n!=null)?Ji(e,s):ms),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=hu,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function qm(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&hu.enqueueReplaceState(t,t.state,null)}function C0(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Uf(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Fr(i):(i=sr(t)?qs:Wt.current,s.context=Ji(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(j0(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&hu.enqueueReplaceState(s,s.state,null),yc(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function ta(e,t){try{var r="",n=t;do r+=M2(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Td(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function A0(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var dE=typeof WeakMap=="function"?WeakMap:Map;function O1(e,t,r){r=wn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Tc||(Tc=!0,$0=n),A0(e,t)},r}function F1(e,t,r){r=wn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){A0(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){A0(e,t),typeof n!="function"&&(ls===null?ls=new Set([this]):ls.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function Km(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new dE;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=bE.bind(null,e,t,r),t.then(e,e))}function Xm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ym(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=wn(-1,1),t.tag=2,os(r,t,1))),r.lanes|=1),e)}var fE=Pn.ReactCurrentOwner,rr=!1;function Vt(e,t,r,n){t.child=e===null?o1(t,null,r,n):Zi(t,e.child,r,n)}function Jm(e,t,r,n,s){r=r.render;var i=t.ref;return Ui(t,s),n=Gf(e,t,r,n,i,s),r=qf(),e!==null&&!rr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Nn(e,t,s)):(Ye&&r&&Df(t),t.flags|=1,Vt(e,t,n,s),t.child)}function Qm(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!nh(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,P1(e,t,i,n,s)):(e=tc(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:_o,r(a,n)&&e.ref===t.ref)return Nn(e,t,s)}return t.flags|=1,e=us(i,n),e.ref=t.ref,e.return=t,t.child=e}function P1(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(_o(i,n)&&e.ref===t.ref)if(rr=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(rr=!0);else return t.lanes=e.lanes,Nn(e,t,s)}return O0(e,t,r,n,s)}function D1(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ve(Ri,ur),ur|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ve(Ri,ur),ur|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Ve(Ri,ur),ur|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Ve(Ri,ur),ur|=n;return Vt(e,t,s,r),t.child}function R1(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function O0(e,t,r,n,s){var i=sr(r)?qs:Wt.current;return i=Ji(t,i),Ui(t,s),r=Gf(e,t,r,n,i,s),n=qf(),e!==null&&!rr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Nn(e,t,s)):(Ye&&n&&Df(t),t.flags|=1,Vt(e,t,r,s),t.child)}function Zm(e,t,r,n,s){if(sr(r)){var i=!0;mc(t)}else i=!1;if(Ui(t,s),t.stateNode===null)Ql(e,t),A1(t,r,n),C0(t,r,n,s),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var c=a.context,d=r.contextType;typeof d=="object"&&d!==null?d=Fr(d):(d=sr(r)?qs:Wt.current,d=Ji(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||c!==d)&&qm(t,a,n,d),Hn=!1;var h=t.memoizedState;a.state=h,yc(t,n,a,s),c=t.memoizedState,o!==n||h!==c||nr.current||Hn?(typeof u=="function"&&(j0(t,r,u,n),c=t.memoizedState),(o=Hn||Gm(t,r,o,n,h,c,d))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),a.props=n,a.state=c,a.context=d,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,c1(e,t),o=t.memoizedProps,d=t.type===t.elementType?o:Br(t.type,o),a.props=d,f=t.pendingProps,h=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=Fr(c):(c=sr(r)?qs:Wt.current,c=Ji(t,c));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==f||h!==c)&&qm(t,a,n,c),Hn=!1,h=t.memoizedState,a.state=h,yc(t,n,a,s);var x=t.memoizedState;o!==f||h!==x||nr.current||Hn?(typeof p=="function"&&(j0(t,r,p,n),x=t.memoizedState),(d=Hn||Gm(t,r,d,n,h,x,c)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,x,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,x,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),a.props=n,a.state=x,a.context=c,n=d):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return F0(e,t,r,n,i,s)}function F0(e,t,r,n,s,i){R1(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return s&&Mm(t,r,!1),Nn(e,t,i);n=t.stateNode,fE.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=Zi(t,e.child,null,i),t.child=Zi(t,null,o,i)):Vt(e,t,o,i),t.memoizedState=n.state,s&&Mm(t,r,!0),t.child}function I1(e){var t=e.stateNode;t.pendingContext?Lm(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Lm(e,t.context,!1),Wf(e,t.containerInfo)}function ep(e,t,r,n,s){return Qi(),If(s),t.flags|=256,Vt(e,t,r,n),t.child}var P0={dehydrated:null,treeContext:null,retryLane:0};function D0(e){return{baseLanes:e,cachePool:null,transitions:null}}function L1(e,t,r){var n=t.pendingProps,s=et.current,i=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Ve(et,s&1),e===null)return k0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,i?(n=t.mode,i=t.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=gu(a,n,0,null),e=zs(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=D0(r),t.memoizedState=P0,e):Yf(t,a));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return hE(e,t,a,n,o,s,r);if(i){i=n.fallback,a=t.mode,s=e.child,o=s.sibling;var c={mode:"hidden",children:n.children};return!(a&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=us(s,c),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=us(o,i):(i=zs(i,a,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,a=e.child.memoizedState,a=a===null?D0(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~r,t.memoizedState=P0,n}return i=e.child,e=i.sibling,n=us(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Yf(e,t){return t=gu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function _l(e,t,r,n){return n!==null&&If(n),Zi(t,e.child,null,r),e=Yf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function hE(e,t,r,n,s,i,a){if(r)return t.flags&256?(t.flags&=-257,n=Td(Error(ue(422))),_l(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=gu({mode:"visible",children:n.children},s,0,null),i=zs(i,s,a,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Zi(t,e.child,null,a),t.child.memoizedState=D0(a),t.memoizedState=P0,i);if(!(t.mode&1))return _l(e,t,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(ue(419)),n=Td(i,n,void 0),_l(e,t,a,n)}if(o=(a&e.childLanes)!==0,rr||o){if(n=_t,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,kn(e,s),Kr(n,e,s,-1))}return rh(),n=Td(Error(ue(421))),_l(e,t,a,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=kE.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,pr=as(s.nextSibling),xr=t,Ye=!0,Wr=null,e!==null&&(br[kr++]=xn,br[kr++]=vn,br[kr++]=Ks,xn=e.id,vn=e.overflow,Ks=t),t=Yf(t,n.children),t.flags|=4096,t)}function tp(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),N0(e.return,t,r)}function bd(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function M1(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(Vt(e,t,n.children,r),n=et.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&tp(e,r,t);else if(e.tag===19)tp(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ve(et,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&wc(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),bd(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&wc(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}bd(t,!0,r,null,i);break;case"together":bd(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ql(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Nn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ys|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ue(153));if(t.child!==null){for(e=t.child,r=us(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=us(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function mE(e,t,r){switch(t.tag){case 3:I1(t),Qi();break;case 5:u1(t);break;case 1:sr(t.type)&&mc(t);break;case 4:Wf(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Ve(xc,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Ve(et,et.current&1),t.flags|=128,null):r&t.child.childLanes?L1(e,t,r):(Ve(et,et.current&1),e=Nn(e,t,r),e!==null?e.sibling:null);Ve(et,et.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return M1(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ve(et,et.current),n)break;return null;case 22:case 23:return t.lanes=0,D1(e,t,r)}return Nn(e,t,r)}var B1,R0,$1,U1;B1=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};R0=function(){};$1=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,$s(on.current);var i=null;switch(r){case"input":s=n0(e,s),n=n0(e,n),i=[];break;case"select":s=rt({},s,{value:void 0}),n=rt({},n,{value:void 0}),i=[];break;case"textarea":s=a0(e,s),n=a0(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=fc)}l0(r,n);var a;r=null;for(d in s)if(!n.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var o=s[d];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(mo.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(o=s!=null?s[d]:void 0,n.hasOwnProperty(d)&&c!==o&&(c!=null||o!=null))if(d==="style")if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(mo.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Ge("scroll",e),i||o===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};U1=function(e,t,r,n){r!==n&&(t.flags|=4)};function Pa(e,t){if(!Ye)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Lt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function pE(e,t,r){var n=t.pendingProps;switch(Rf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Lt(t),null;case 1:return sr(t.type)&&hc(),Lt(t),null;case 3:return n=t.stateNode,ea(),qe(nr),qe(Wt),zf(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(yl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Wr!==null&&(H0(Wr),Wr=null))),R0(e,t),Lt(t),null;case 5:Hf(t);var s=$s(ko.current);if(r=t.type,e!==null&&t.stateNode!=null)$1(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ue(166));return Lt(t),null}if(e=$s(on.current),yl(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[rn]=t,n[To]=i,e=(t.mode&1)!==0,r){case"dialog":Ge("cancel",n),Ge("close",n);break;case"iframe":case"object":case"embed":Ge("load",n);break;case"video":case"audio":for(s=0;s<Wa.length;s++)Ge(Wa[s],n);break;case"source":Ge("error",n);break;case"img":case"image":case"link":Ge("error",n),Ge("load",n);break;case"details":Ge("toggle",n);break;case"input":um(n,i),Ge("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Ge("invalid",n);break;case"textarea":fm(n,i),Ge("invalid",n)}l0(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&vl(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&vl(n.textContent,o,e),s=["children",""+o]):mo.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Ge("scroll",n)}switch(r){case"input":ul(n),dm(n,i,!0);break;case"textarea":ul(n),hm(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=fc)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=px(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[rn]=t,e[To]=n,B1(e,t,!1,!1),t.stateNode=e;e:{switch(a=c0(r,n),r){case"dialog":Ge("cancel",e),Ge("close",e),s=n;break;case"iframe":case"object":case"embed":Ge("load",e),s=n;break;case"video":case"audio":for(s=0;s<Wa.length;s++)Ge(Wa[s],e);s=n;break;case"source":Ge("error",e),s=n;break;case"img":case"image":case"link":Ge("error",e),Ge("load",e),s=n;break;case"details":Ge("toggle",e),s=n;break;case"input":um(e,n),s=n0(e,n),Ge("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=rt({},n,{value:void 0}),Ge("invalid",e);break;case"textarea":fm(e,n),s=a0(e,n),Ge("invalid",e);break;default:s=n}l0(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?vx(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&gx(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&po(e,c):typeof c=="number"&&po(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(mo.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ge("scroll",e):c!=null&&wf(e,i,c,a))}switch(r){case"input":ul(e),dm(e,n,!1);break;case"textarea":ul(e),hm(e);break;case"option":n.value!=null&&e.setAttribute("value",""+hs(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Li(e,!!n.multiple,i,!1):n.defaultValue!=null&&Li(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=fc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Lt(t),null;case 6:if(e&&t.stateNode!=null)U1(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ue(166));if(r=$s(ko.current),$s(on.current),yl(t)){if(n=t.stateNode,r=t.memoizedProps,n[rn]=t,(i=n.nodeValue!==r)&&(e=xr,e!==null))switch(e.tag){case 3:vl(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&vl(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[rn]=t,t.stateNode=n}return Lt(t),null;case 13:if(qe(et),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ye&&pr!==null&&t.mode&1&&!(t.flags&128))i1(),Qi(),t.flags|=98560,i=!1;else if(i=yl(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(ue(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ue(317));i[rn]=t}else Qi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Lt(t),i=!1}else Wr!==null&&(H0(Wr),Wr=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||et.current&1?pt===0&&(pt=3):rh())),t.updateQueue!==null&&(t.flags|=4),Lt(t),null);case 4:return ea(),R0(e,t),e===null&&Eo(t.stateNode.containerInfo),Lt(t),null;case 10:return Bf(t.type._context),Lt(t),null;case 17:return sr(t.type)&&hc(),Lt(t),null;case 19:if(qe(et),i=t.memoizedState,i===null)return Lt(t),null;if(n=(t.flags&128)!==0,a=i.rendering,a===null)if(n)Pa(i,!1);else{if(pt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=wc(e),a!==null){for(t.flags|=128,Pa(i,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ve(et,et.current&1|2),t.child}e=e.sibling}i.tail!==null&&ot()>ra&&(t.flags|=128,n=!0,Pa(i,!1),t.lanes=4194304)}else{if(!n)if(e=wc(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Pa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Ye)return Lt(t),null}else 2*ot()-i.renderingStartTime>ra&&r!==1073741824&&(t.flags|=128,n=!0,Pa(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(r=i.last,r!==null?r.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=ot(),t.sibling=null,r=et.current,Ve(et,n?r&1|2:r&1),t):(Lt(t),null);case 22:case 23:return th(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ur&1073741824&&(Lt(t),t.subtreeFlags&6&&(t.flags|=8192)):Lt(t),null;case 24:return null;case 25:return null}throw Error(ue(156,t.tag))}function gE(e,t){switch(Rf(t),t.tag){case 1:return sr(t.type)&&hc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ea(),qe(nr),qe(Wt),zf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Hf(t),null;case 13:if(qe(et),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ue(340));Qi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return qe(et),null;case 4:return ea(),null;case 10:return Bf(t.type._context),null;case 22:case 23:return th(),null;case 24:return null;default:return null}}var El=!1,Mt=!1,xE=typeof WeakSet=="function"?WeakSet:Set,Se=null;function Di(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){nt(e,t,n)}else r.current=null}function I0(e,t,r){try{r()}catch(n){nt(e,t,n)}}var rp=!1;function vE(e,t){if(y0=cc,e=Gx(),Pf(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,o=-1,c=-1,d=0,u=0,f=e,h=null;t:for(;;){for(var p;f!==r||s!==0&&f.nodeType!==3||(o=a+s),f!==i||n!==0&&f.nodeType!==3||(c=a+n),f.nodeType===3&&(a+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===e)break t;if(h===r&&++d===s&&(o=a),h===i&&++u===n&&(c=a),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(w0={focusedElem:e,selectionRange:r},cc=!1,Se=t;Se!==null;)if(t=Se,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Se=e;else for(;Se!==null;){t=Se;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var m=x.memoizedProps,g=x.memoizedState,_=t.stateNode,y=_.getSnapshotBeforeUpdate(t.elementType===t.type?m:Br(t.type,m),g);_.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ue(163))}}catch(w){nt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,Se=e;break}Se=t.return}return x=rp,rp=!1,x}function Qa(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&I0(t,r,i)}s=s.next}while(s!==n)}}function mu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function L0(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function W1(e){var t=e.alternate;t!==null&&(e.alternate=null,W1(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[rn],delete t[To],delete t[S0],delete t[eE],delete t[tE])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function H1(e){return e.tag===5||e.tag===3||e.tag===4}function np(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||H1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function M0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=fc));else if(n!==4&&(e=e.child,e!==null))for(M0(e,t,r),e=e.sibling;e!==null;)M0(e,t,r),e=e.sibling}function B0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(B0(e,t,r),e=e.sibling;e!==null;)B0(e,t,r),e=e.sibling}var Tt=null,$r=!1;function Ln(e,t,r){for(r=r.child;r!==null;)z1(e,t,r),r=r.sibling}function z1(e,t,r){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(au,r)}catch{}switch(r.tag){case 5:Mt||Di(r,t);case 6:var n=Tt,s=$r;Tt=null,Ln(e,t,r),Tt=n,$r=s,Tt!==null&&($r?(e=Tt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Tt.removeChild(r.stateNode));break;case 18:Tt!==null&&($r?(e=Tt,r=r.stateNode,e.nodeType===8?vd(e.parentNode,r):e.nodeType===1&&vd(e,r),yo(e)):vd(Tt,r.stateNode));break;case 4:n=Tt,s=$r,Tt=r.stateNode.containerInfo,$r=!0,Ln(e,t,r),Tt=n,$r=s;break;case 0:case 11:case 14:case 15:if(!Mt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&I0(r,t,a),s=s.next}while(s!==n)}Ln(e,t,r);break;case 1:if(!Mt&&(Di(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){nt(r,t,o)}Ln(e,t,r);break;case 21:Ln(e,t,r);break;case 22:r.mode&1?(Mt=(n=Mt)||r.memoizedState!==null,Ln(e,t,r),Mt=n):Ln(e,t,r);break;default:Ln(e,t,r)}}function sp(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new xE),t.forEach(function(n){var s=NE.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Rr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:Tt=o.stateNode,$r=!1;break e;case 3:Tt=o.stateNode.containerInfo,$r=!0;break e;case 4:Tt=o.stateNode.containerInfo,$r=!0;break e}o=o.return}if(Tt===null)throw Error(ue(160));z1(i,a,s),Tt=null,$r=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){nt(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)V1(t,e),t=t.sibling}function V1(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Rr(t,e),Qr(e),n&4){try{Qa(3,e,e.return),mu(3,e)}catch(m){nt(e,e.return,m)}try{Qa(5,e,e.return)}catch(m){nt(e,e.return,m)}}break;case 1:Rr(t,e),Qr(e),n&512&&r!==null&&Di(r,r.return);break;case 5:if(Rr(t,e),Qr(e),n&512&&r!==null&&Di(r,r.return),e.flags&32){var s=e.stateNode;try{po(s,"")}catch(m){nt(e,e.return,m)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=r!==null?r.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&hx(s,i),c0(o,a);var d=c0(o,i);for(a=0;a<c.length;a+=2){var u=c[a],f=c[a+1];u==="style"?vx(s,f):u==="dangerouslySetInnerHTML"?gx(s,f):u==="children"?po(s,f):wf(s,u,f,d)}switch(o){case"input":s0(s,i);break;case"textarea":mx(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?Li(s,!!i.multiple,p,!1):h!==!!i.multiple&&(i.defaultValue!=null?Li(s,!!i.multiple,i.defaultValue,!0):Li(s,!!i.multiple,i.multiple?[]:"",!1))}s[To]=i}catch(m){nt(e,e.return,m)}}break;case 6:if(Rr(t,e),Qr(e),n&4){if(e.stateNode===null)throw Error(ue(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(m){nt(e,e.return,m)}}break;case 3:if(Rr(t,e),Qr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{yo(t.containerInfo)}catch(m){nt(e,e.return,m)}break;case 4:Rr(t,e),Qr(e);break;case 13:Rr(t,e),Qr(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Zf=ot())),n&4&&sp(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Mt=(d=Mt)||u,Rr(t,e),Mt=d):Rr(t,e),Qr(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(Se=e,u=e.child;u!==null;){for(f=Se=u;Se!==null;){switch(h=Se,p=h.child,h.tag){case 0:case 11:case 14:case 15:Qa(4,h,h.return);break;case 1:Di(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(m){nt(n,r,m)}}break;case 5:Di(h,h.return);break;case 22:if(h.memoizedState!==null){ap(f);continue}}p!==null?(p.return=h,Se=p):ap(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=f.stateNode,c=f.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=xx("display",a))}catch(m){nt(e,e.return,m)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(m){nt(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Rr(t,e),Qr(e),n&4&&sp(e);break;case 21:break;default:Rr(t,e),Qr(e)}}function Qr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(H1(r)){var n=r;break e}r=r.return}throw Error(ue(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(po(s,""),n.flags&=-33);var i=np(e);B0(e,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,o=np(e);M0(e,o,a);break;default:throw Error(ue(161))}}catch(c){nt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function yE(e,t,r){Se=e,G1(e)}function G1(e,t,r){for(var n=(e.mode&1)!==0;Se!==null;){var s=Se,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||El;if(!a){var o=s.alternate,c=o!==null&&o.memoizedState!==null||Mt;o=El;var d=Mt;if(El=a,(Mt=c)&&!d)for(Se=s;Se!==null;)a=Se,c=a.child,a.tag===22&&a.memoizedState!==null?op(s):c!==null?(c.return=a,Se=c):op(s);for(;i!==null;)Se=i,G1(i),i=i.sibling;Se=s,El=o,Mt=d}ip(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Se=i):ip(e)}}function ip(e){for(;Se!==null;){var t=Se;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Mt||mu(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Mt)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Br(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Hm(t,i,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Hm(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&yo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ue(163))}Mt||t.flags&512&&L0(t)}catch(h){nt(t,t.return,h)}}if(t===e){Se=null;break}if(r=t.sibling,r!==null){r.return=t.return,Se=r;break}Se=t.return}}function ap(e){for(;Se!==null;){var t=Se;if(t===e){Se=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Se=r;break}Se=t.return}}function op(e){for(;Se!==null;){var t=Se;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{mu(4,t)}catch(c){nt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){nt(t,s,c)}}var i=t.return;try{L0(t)}catch(c){nt(t,i,c)}break;case 5:var a=t.return;try{L0(t)}catch(c){nt(t,a,c)}}}catch(c){nt(t,t.return,c)}if(t===e){Se=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Se=o;break}Se=t.return}}var wE=Math.ceil,Sc=Pn.ReactCurrentDispatcher,Jf=Pn.ReactCurrentOwner,Cr=Pn.ReactCurrentBatchConfig,De=0,_t=null,ut=null,At=0,ur=0,Ri=ws(0),pt=0,Ao=null,Ys=0,pu=0,Qf=0,Za=null,er=null,Zf=0,ra=1/0,mn=null,Tc=!1,$0=null,ls=null,Sl=!1,Qn=null,bc=0,eo=0,U0=null,Zl=-1,ec=0;function Xt(){return De&6?ot():Zl!==-1?Zl:Zl=ot()}function cs(e){return e.mode&1?De&2&&At!==0?At&-At:nE.transition!==null?(ec===0&&(ec=Ax()),ec):(e=Ue,e!==0||(e=window.event,e=e===void 0?16:Lx(e.type)),e):1}function Kr(e,t,r,n){if(50<eo)throw eo=0,U0=null,Error(ue(185));Ho(e,r,n),(!(De&2)||e!==_t)&&(e===_t&&(!(De&2)&&(pu|=r),pt===4&&Kn(e,At)),ir(e,n),r===1&&De===0&&!(t.mode&1)&&(ra=ot()+500,du&&_s()))}function ir(e,t){var r=e.callbackNode;n_(e,t);var n=lc(e,e===_t?At:0);if(n===0)r!==null&&gm(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&gm(r),t===1)e.tag===0?rE(lp.bind(null,e)):r1(lp.bind(null,e)),Q_(function(){!(De&6)&&_s()}),r=null;else{switch(Ox(n)){case 1:r=bf;break;case 4:r=jx;break;case 16:r=oc;break;case 536870912:r=Cx;break;default:r=oc}r=ev(r,q1.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function q1(e,t){if(Zl=-1,ec=0,De&6)throw Error(ue(327));var r=e.callbackNode;if(Wi()&&e.callbackNode!==r)return null;var n=lc(e,e===_t?At:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=kc(e,n);else{t=n;var s=De;De|=2;var i=X1();(_t!==e||At!==t)&&(mn=null,ra=ot()+500,Hs(e,t));do try{SE();break}catch(o){K1(e,o)}while(!0);Mf(),Sc.current=i,De=s,ut!==null?t=0:(_t=null,At=0,t=pt)}if(t!==0){if(t===2&&(s=m0(e),s!==0&&(n=s,t=W0(e,s))),t===1)throw r=Ao,Hs(e,0),Kn(e,n),ir(e,ot()),r;if(t===6)Kn(e,n);else{if(s=e.current.alternate,!(n&30)&&!_E(s)&&(t=kc(e,n),t===2&&(i=m0(e),i!==0&&(n=i,t=W0(e,i))),t===1))throw r=Ao,Hs(e,0),Kn(e,n),ir(e,ot()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(ue(345));case 2:Os(e,er,mn);break;case 3:if(Kn(e,n),(n&130023424)===n&&(t=Zf+500-ot(),10<t)){if(lc(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Xt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=E0(Os.bind(null,e,er,mn),t);break}Os(e,er,mn);break;case 4:if(Kn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var a=31-qr(n);i=1<<a,a=t[a],a>s&&(s=a),n&=~i}if(n=s,n=ot()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*wE(n/1960))-n,10<n){e.timeoutHandle=E0(Os.bind(null,e,er,mn),n);break}Os(e,er,mn);break;case 5:Os(e,er,mn);break;default:throw Error(ue(329))}}}return ir(e,ot()),e.callbackNode===r?q1.bind(null,e):null}function W0(e,t){var r=Za;return e.current.memoizedState.isDehydrated&&(Hs(e,t).flags|=256),e=kc(e,t),e!==2&&(t=er,er=r,t!==null&&H0(t)),e}function H0(e){er===null?er=e:er.push.apply(er,e)}function _E(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Yr(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Kn(e,t){for(t&=~Qf,t&=~pu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-qr(t),n=1<<r;e[r]=-1,t&=~n}}function lp(e){if(De&6)throw Error(ue(327));Wi();var t=lc(e,0);if(!(t&1))return ir(e,ot()),null;var r=kc(e,t);if(e.tag!==0&&r===2){var n=m0(e);n!==0&&(t=n,r=W0(e,n))}if(r===1)throw r=Ao,Hs(e,0),Kn(e,t),ir(e,ot()),r;if(r===6)throw Error(ue(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Os(e,er,mn),ir(e,ot()),null}function eh(e,t){var r=De;De|=1;try{return e(t)}finally{De=r,De===0&&(ra=ot()+500,du&&_s())}}function Js(e){Qn!==null&&Qn.tag===0&&!(De&6)&&Wi();var t=De;De|=1;var r=Cr.transition,n=Ue;try{if(Cr.transition=null,Ue=1,e)return e()}finally{Ue=n,Cr.transition=r,De=t,!(De&6)&&_s()}}function th(){ur=Ri.current,qe(Ri)}function Hs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,J_(r)),ut!==null)for(r=ut.return;r!==null;){var n=r;switch(Rf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&hc();break;case 3:ea(),qe(nr),qe(Wt),zf();break;case 5:Hf(n);break;case 4:ea();break;case 13:qe(et);break;case 19:qe(et);break;case 10:Bf(n.type._context);break;case 22:case 23:th()}r=r.return}if(_t=e,ut=e=us(e.current,null),At=ur=t,pt=0,Ao=null,Qf=pu=Ys=0,er=Za=null,Bs!==null){for(t=0;t<Bs.length;t++)if(r=Bs[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}Bs=null}return e}function K1(e,t){do{var r=ut;try{if(Mf(),Yl.current=Ec,_c){for(var n=tt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}_c=!1}if(Xs=0,xt=mt=tt=null,Ja=!1,No=0,Jf.current=null,r===null||r.return===null){pt=1,Ao=t,ut=null;break}e:{var i=e,a=r.return,o=r,c=t;if(t=At,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=Xm(a);if(p!==null){p.flags&=-257,Ym(p,a,o,i,t),p.mode&1&&Km(i,d,t),t=p,c=d;var x=t.updateQueue;if(x===null){var m=new Set;m.add(c),t.updateQueue=m}else x.add(c);break e}else{if(!(t&1)){Km(i,d,t),rh();break e}c=Error(ue(426))}}else if(Ye&&o.mode&1){var g=Xm(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),Ym(g,a,o,i,t),If(ta(c,o));break e}}i=c=ta(c,o),pt!==4&&(pt=2),Za===null?Za=[i]:Za.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var _=O1(i,c,t);Wm(i,_);break e;case 1:o=c;var y=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ls===null||!ls.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var w=F1(i,o,t);Wm(i,w);break e}}i=i.return}while(i!==null)}J1(r)}catch(N){t=N,ut===r&&r!==null&&(ut=r=r.return);continue}break}while(!0)}function X1(){var e=Sc.current;return Sc.current=Ec,e===null?Ec:e}function rh(){(pt===0||pt===3||pt===2)&&(pt=4),_t===null||!(Ys&268435455)&&!(pu&268435455)||Kn(_t,At)}function kc(e,t){var r=De;De|=2;var n=X1();(_t!==e||At!==t)&&(mn=null,Hs(e,t));do try{EE();break}catch(s){K1(e,s)}while(!0);if(Mf(),De=r,Sc.current=n,ut!==null)throw Error(ue(261));return _t=null,At=0,pt}function EE(){for(;ut!==null;)Y1(ut)}function SE(){for(;ut!==null&&!K2();)Y1(ut)}function Y1(e){var t=Z1(e.alternate,e,ur);e.memoizedProps=e.pendingProps,t===null?J1(e):ut=t,Jf.current=null}function J1(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=gE(r,t),r!==null){r.flags&=32767,ut=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{pt=6,ut=null;return}}else if(r=pE(r,t,ur),r!==null){ut=r;return}if(t=t.sibling,t!==null){ut=t;return}ut=t=e}while(t!==null);pt===0&&(pt=5)}function Os(e,t,r){var n=Ue,s=Cr.transition;try{Cr.transition=null,Ue=1,TE(e,t,r,n)}finally{Cr.transition=s,Ue=n}return null}function TE(e,t,r,n){do Wi();while(Qn!==null);if(De&6)throw Error(ue(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ue(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(s_(e,i),e===_t&&(ut=_t=null,At=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Sl||(Sl=!0,ev(oc,function(){return Wi(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Cr.transition,Cr.transition=null;var a=Ue;Ue=1;var o=De;De|=4,Jf.current=null,vE(e,r),V1(r,e),z_(w0),cc=!!y0,w0=y0=null,e.current=r,yE(r),X2(),De=o,Ue=a,Cr.transition=i}else e.current=r;if(Sl&&(Sl=!1,Qn=e,bc=s),i=e.pendingLanes,i===0&&(ls=null),Q2(r.stateNode),ir(e,ot()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Tc)throw Tc=!1,e=$0,$0=null,e;return bc&1&&e.tag!==0&&Wi(),i=e.pendingLanes,i&1?e===U0?eo++:(eo=0,U0=e):eo=0,_s(),null}function Wi(){if(Qn!==null){var e=Ox(bc),t=Cr.transition,r=Ue;try{if(Cr.transition=null,Ue=16>e?16:e,Qn===null)var n=!1;else{if(e=Qn,Qn=null,bc=0,De&6)throw Error(ue(331));var s=De;for(De|=4,Se=e.current;Se!==null;){var i=Se,a=i.child;if(Se.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var d=o[c];for(Se=d;Se!==null;){var u=Se;switch(u.tag){case 0:case 11:case 15:Qa(8,u,i)}var f=u.child;if(f!==null)f.return=u,Se=f;else for(;Se!==null;){u=Se;var h=u.sibling,p=u.return;if(W1(u),u===d){Se=null;break}if(h!==null){h.return=p,Se=h;break}Se=p}}}var x=i.alternate;if(x!==null){var m=x.child;if(m!==null){x.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}Se=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Se=a;else e:for(;Se!==null;){if(i=Se,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Qa(9,i,i.return)}var _=i.sibling;if(_!==null){_.return=i.return,Se=_;break e}Se=i.return}}var y=e.current;for(Se=y;Se!==null;){a=Se;var v=a.child;if(a.subtreeFlags&2064&&v!==null)v.return=a,Se=v;else e:for(a=y;Se!==null;){if(o=Se,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:mu(9,o)}}catch(N){nt(o,o.return,N)}if(o===a){Se=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,Se=w;break e}Se=o.return}}if(De=s,_s(),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(au,e)}catch{}n=!0}return n}finally{Ue=r,Cr.transition=t}}return!1}function cp(e,t,r){t=ta(r,t),t=O1(e,t,1),e=os(e,t,1),t=Xt(),e!==null&&(Ho(e,1,t),ir(e,t))}function nt(e,t,r){if(e.tag===3)cp(e,e,r);else for(;t!==null;){if(t.tag===3){cp(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ls===null||!ls.has(n))){e=ta(r,e),e=F1(t,e,1),t=os(t,e,1),e=Xt(),t!==null&&(Ho(t,1,e),ir(t,e));break}}t=t.return}}function bE(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Xt(),e.pingedLanes|=e.suspendedLanes&r,_t===e&&(At&r)===r&&(pt===4||pt===3&&(At&130023424)===At&&500>ot()-Zf?Hs(e,0):Qf|=r),ir(e,t)}function Q1(e,t){t===0&&(e.mode&1?(t=hl,hl<<=1,!(hl&130023424)&&(hl=4194304)):t=1);var r=Xt();e=kn(e,t),e!==null&&(Ho(e,t,r),ir(e,r))}function kE(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Q1(e,r)}function NE(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ue(314))}n!==null&&n.delete(t),Q1(e,r)}var Z1;Z1=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||nr.current)rr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return rr=!1,mE(e,t,r);rr=!!(e.flags&131072)}else rr=!1,Ye&&t.flags&1048576&&n1(t,gc,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ql(e,t),e=t.pendingProps;var s=Ji(t,Wt.current);Ui(t,r),s=Gf(null,t,n,e,s,r);var i=qf();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,sr(n)?(i=!0,mc(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Uf(t),s.updater=hu,t.stateNode=s,s._reactInternals=t,C0(t,n,e,r),t=F0(null,t,n,!0,i,r)):(t.tag=0,Ye&&i&&Df(t),Vt(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Ql(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=CE(n),e=Br(n,e),s){case 0:t=O0(null,t,n,e,r);break e;case 1:t=Zm(null,t,n,e,r);break e;case 11:t=Jm(null,t,n,e,r);break e;case 14:t=Qm(null,t,n,Br(n.type,e),r);break e}throw Error(ue(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Br(n,s),O0(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Br(n,s),Zm(e,t,n,s,r);case 3:e:{if(I1(t),e===null)throw Error(ue(387));n=t.pendingProps,i=t.memoizedState,s=i.element,c1(e,t),yc(t,n,null,r);var a=t.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=ta(Error(ue(423)),t),t=ep(e,t,n,r,s);break e}else if(n!==s){s=ta(Error(ue(424)),t),t=ep(e,t,n,r,s);break e}else for(pr=as(t.stateNode.containerInfo.firstChild),xr=t,Ye=!0,Wr=null,r=o1(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Qi(),n===s){t=Nn(e,t,r);break e}Vt(e,t,n,r)}t=t.child}return t;case 5:return u1(t),e===null&&k0(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,_0(n,s)?a=null:i!==null&&_0(n,i)&&(t.flags|=32),R1(e,t),Vt(e,t,a,r),t.child;case 6:return e===null&&k0(t),null;case 13:return L1(e,t,r);case 4:return Wf(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Zi(t,null,n,r):Vt(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Br(n,s),Jm(e,t,n,s,r);case 7:return Vt(e,t,t.pendingProps,r),t.child;case 8:return Vt(e,t,t.pendingProps.children,r),t.child;case 12:return Vt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,Ve(xc,n._currentValue),n._currentValue=a,i!==null)if(Yr(i.value,a)){if(i.children===s.children&&!nr.current){t=Nn(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=wn(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),N0(i.return,r,t),o.lanes|=r;break}c=c.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(ue(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),N0(a,r,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Vt(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Ui(t,r),s=Fr(s),n=n(s),t.flags|=1,Vt(e,t,n,r),t.child;case 14:return n=t.type,s=Br(n,t.pendingProps),s=Br(n.type,s),Qm(e,t,n,s,r);case 15:return P1(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Br(n,s),Ql(e,t),t.tag=1,sr(n)?(e=!0,mc(t)):e=!1,Ui(t,r),A1(t,n,s),C0(t,n,s,r),F0(null,t,n,!0,e,r);case 19:return M1(e,t,r);case 22:return D1(e,t,r)}throw Error(ue(156,t.tag))};function ev(e,t){return Nx(e,t)}function jE(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nr(e,t,r,n){return new jE(e,t,r,n)}function nh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function CE(e){if(typeof e=="function")return nh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ef)return 11;if(e===Sf)return 14}return 2}function us(e,t){var r=e.alternate;return r===null?(r=Nr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function tc(e,t,r,n,s,i){var a=2;if(n=e,typeof e=="function")nh(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case bi:return zs(r.children,s,i,t);case _f:a=8,s|=8;break;case Zd:return e=Nr(12,r,t,s|2),e.elementType=Zd,e.lanes=i,e;case e0:return e=Nr(13,r,t,s),e.elementType=e0,e.lanes=i,e;case t0:return e=Nr(19,r,t,s),e.elementType=t0,e.lanes=i,e;case ux:return gu(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case lx:a=10;break e;case cx:a=9;break e;case Ef:a=11;break e;case Sf:a=14;break e;case Wn:a=16,n=null;break e}throw Error(ue(130,e==null?e:typeof e,""))}return t=Nr(a,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function zs(e,t,r,n){return e=Nr(7,e,n,t),e.lanes=r,e}function gu(e,t,r,n){return e=Nr(22,e,n,t),e.elementType=ux,e.lanes=r,e.stateNode={isHidden:!1},e}function kd(e,t,r){return e=Nr(6,e,null,t),e.lanes=r,e}function Nd(e,t,r){return t=Nr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function AE(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=od(0),this.expirationTimes=od(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=od(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function sh(e,t,r,n,s,i,a,o,c){return e=new AE(e,t,r,o,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Nr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Uf(i),e}function OE(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ti,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function tv(e){if(!e)return ms;e=e._reactInternals;e:{if(ri(e)!==e||e.tag!==1)throw Error(ue(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(sr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ue(171))}if(e.tag===1){var r=e.type;if(sr(r))return t1(e,r,t)}return t}function rv(e,t,r,n,s,i,a,o,c){return e=sh(r,n,!0,e,s,i,a,o,c),e.context=tv(null),r=e.current,n=Xt(),s=cs(r),i=wn(n,s),i.callback=t??null,os(r,i,s),e.current.lanes=s,Ho(e,s,n),ir(e,n),e}function xu(e,t,r,n){var s=t.current,i=Xt(),a=cs(s);return r=tv(r),t.context===null?t.context=r:t.pendingContext=r,t=wn(i,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=os(s,t,a),e!==null&&(Kr(e,s,a,i),Xl(e,s,a)),a}function Nc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function up(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function ih(e,t){up(e,t),(e=e.alternate)&&up(e,t)}function FE(){return null}var nv=typeof reportError=="function"?reportError:function(e){console.error(e)};function ah(e){this._internalRoot=e}vu.prototype.render=ah.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ue(409));xu(e,t,null,null)};vu.prototype.unmount=ah.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Js(function(){xu(null,e,null,null)}),t[bn]=null}};function vu(e){this._internalRoot=e}vu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Dx();e={blockedOn:null,target:e,priority:t};for(var r=0;r<qn.length&&t!==0&&t<qn[r].priority;r++);qn.splice(r,0,e),r===0&&Ix(e)}};function oh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function yu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function dp(){}function PE(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var d=Nc(a);i.call(d)}}var a=rv(t,n,e,0,null,!1,!1,"",dp);return e._reactRootContainer=a,e[bn]=a.current,Eo(e.nodeType===8?e.parentNode:e),Js(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var d=Nc(c);o.call(d)}}var c=sh(e,0,!1,null,null,!1,!1,"",dp);return e._reactRootContainer=c,e[bn]=c.current,Eo(e.nodeType===8?e.parentNode:e),Js(function(){xu(t,c,r,n)}),c}function wu(e,t,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var o=s;s=function(){var c=Nc(a);o.call(c)}}xu(t,a,e,s)}else a=PE(r,t,e,s,n);return Nc(a)}Fx=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ua(t.pendingLanes);r!==0&&(kf(t,r|1),ir(t,ot()),!(De&6)&&(ra=ot()+500,_s()))}break;case 13:Js(function(){var n=kn(e,1);if(n!==null){var s=Xt();Kr(n,e,1,s)}}),ih(e,1)}};Nf=function(e){if(e.tag===13){var t=kn(e,134217728);if(t!==null){var r=Xt();Kr(t,e,134217728,r)}ih(e,134217728)}};Px=function(e){if(e.tag===13){var t=cs(e),r=kn(e,t);if(r!==null){var n=Xt();Kr(r,e,t,n)}ih(e,t)}};Dx=function(){return Ue};Rx=function(e,t){var r=Ue;try{return Ue=e,t()}finally{Ue=r}};d0=function(e,t,r){switch(t){case"input":if(s0(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=uu(n);if(!s)throw Error(ue(90));fx(n),s0(n,s)}}}break;case"textarea":mx(e,r);break;case"select":t=r.value,t!=null&&Li(e,!!r.multiple,t,!1)}};_x=eh;Ex=Js;var DE={usingClientEntryPoint:!1,Events:[Vo,Ci,uu,yx,wx,eh]},Da={findFiberByHostInstance:Ms,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},RE={bundleType:Da.bundleType,version:Da.version,rendererPackageName:Da.rendererPackageName,rendererConfig:Da.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Pn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=bx(e),e===null?null:e.stateNode},findFiberByHostInstance:Da.findFiberByHostInstance||FE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tl.isDisabled&&Tl.supportsFiber)try{au=Tl.inject(RE),an=Tl}catch{}}wr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DE;wr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!oh(t))throw Error(ue(200));return OE(e,t,null,r)};wr.createRoot=function(e,t){if(!oh(e))throw Error(ue(299));var r=!1,n="",s=nv;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=sh(e,1,!1,null,null,r,!1,n,s),e[bn]=t.current,Eo(e.nodeType===8?e.parentNode:e),new ah(t)};wr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ue(188)):(e=Object.keys(e).join(","),Error(ue(268,e)));return e=bx(t),e=e===null?null:e.stateNode,e};wr.flushSync=function(e){return Js(e)};wr.hydrate=function(e,t,r){if(!yu(t))throw Error(ue(200));return wu(null,e,t,!0,r)};wr.hydrateRoot=function(e,t,r){if(!oh(e))throw Error(ue(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=nv;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=rv(t,null,e,1,r??null,s,!1,i,a),e[bn]=t.current,Eo(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new vu(t)};wr.render=function(e,t,r){if(!yu(t))throw Error(ue(200));return wu(null,e,t,!1,r)};wr.unmountComponentAtNode=function(e){if(!yu(e))throw Error(ue(40));return e._reactRootContainer?(Js(function(){wu(null,null,e,!1,function(){e._reactRootContainer=null,e[bn]=null})}),!0):!1};wr.unstable_batchedUpdates=eh;wr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!yu(r))throw Error(ue(200));if(e==null||e._reactInternals===void 0)throw Error(ue(38));return wu(e,t,r,!1,n)};wr.version="18.3.1-next-f1338f8080-20240426";function sv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sv)}catch(e){console.error(e)}}sv(),sx.exports=wr;var IE=sx.exports,iv,fp=IE;iv=fp.createRoot,fp.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oo(){return Oo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Oo.apply(this,arguments)}var Zn;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Zn||(Zn={}));const hp="popstate";function LE(e){e===void 0&&(e={});function t(n,s){let{pathname:i,search:a,hash:o}=n.location;return z0("",{pathname:i,search:a,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:jc(s)}return BE(t,r,null,e)}function lt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function av(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function ME(){return Math.random().toString(36).substr(2,8)}function mp(e,t){return{usr:e.state,key:e.key,idx:t}}function z0(e,t,r,n){return r===void 0&&(r=null),Oo({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?fa(t):t,{state:r,key:t&&t.key||n||ME()})}function jc(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function fa(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function BE(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,a=s.history,o=Zn.Pop,c=null,d=u();d==null&&(d=0,a.replaceState(Oo({},a.state,{idx:d}),""));function u(){return(a.state||{idx:null}).idx}function f(){o=Zn.Pop;let g=u(),_=g==null?null:g-d;d=g,c&&c({action:o,location:m.location,delta:_})}function h(g,_){o=Zn.Push;let y=z0(m.location,g,_);d=u()+1;let v=mp(y,d),w=m.createHref(y);try{a.pushState(v,"",w)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;s.location.assign(w)}i&&c&&c({action:o,location:m.location,delta:1})}function p(g,_){o=Zn.Replace;let y=z0(m.location,g,_);d=u();let v=mp(y,d),w=m.createHref(y);a.replaceState(v,"",w),i&&c&&c({action:o,location:m.location,delta:0})}function x(g){let _=s.location.origin!=="null"?s.location.origin:s.location.href,y=typeof g=="string"?g:jc(g);return y=y.replace(/ $/,"%20"),lt(_,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,_)}let m={get action(){return o},get location(){return e(s,a)},listen(g){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(hp,f),c=g,()=>{s.removeEventListener(hp,f),c=null}},createHref(g){return t(s,g)},createURL:x,encodeLocation(g){let _=x(g);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:h,replace:p,go(g){return a.go(g)}};return m}var pp;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(pp||(pp={}));function $E(e,t,r){return r===void 0&&(r="/"),UE(e,t,r,!1)}function UE(e,t,r,n){let s=typeof t=="string"?fa(t):t,i=lh(s.pathname||"/",r);if(i==null)return null;let a=ov(e);WE(a);let o=null;for(let c=0;o==null&&c<a.length;++c){let d=ZE(i);o=JE(a[c],d,n)}return o}function ov(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,a,o)=>{let c={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};c.relativePath.startsWith("/")&&(lt(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=ds([n,c.relativePath]),u=r.concat(c);i.children&&i.children.length>0&&(lt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),ov(i.children,t,u,d)),!(i.path==null&&!i.index)&&t.push({path:d,score:XE(d,i.index),routesMeta:u})};return e.forEach((i,a)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))s(i,a);else for(let c of lv(i.path))s(i,a,c)}),t}function lv(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let a=lv(n.join("/")),o=[];return o.push(...a.map(c=>c===""?i:[i,c].join("/"))),s&&o.push(...a),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function WE(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:YE(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const HE=/^:[\w-]+$/,zE=3,VE=2,GE=1,qE=10,KE=-2,gp=e=>e==="*";function XE(e,t){let r=e.split("/"),n=r.length;return r.some(gp)&&(n+=KE),t&&(n+=VE),r.filter(s=>!gp(s)).reduce((s,i)=>s+(HE.test(i)?zE:i===""?GE:qE),n)}function YE(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function JE(e,t,r){let{routesMeta:n}=e,s={},i="/",a=[];for(let o=0;o<n.length;++o){let c=n[o],d=o===n.length-1,u=i==="/"?t:t.slice(i.length)||"/",f=xp({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),h=c.route;if(!f&&d&&r&&!n[n.length-1].route.index&&(f=xp({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!f)return null;Object.assign(s,f.params),a.push({params:s,pathname:ds([i,f.pathname]),pathnameBase:nS(ds([i,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(i=ds([i,f.pathnameBase]))}return a}function xp(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=QE(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((d,u,f)=>{let{paramName:h,isOptional:p}=u;if(h==="*"){let m=o[f]||"";a=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const x=o[f];return p&&!x?d[h]=void 0:d[h]=(x||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:a,pattern:e}}function QE(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),av(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function ZE(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return av(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function lh(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function eS(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?fa(e):e;return{pathname:r?r.startsWith("/")?r:tS(r,t):t,search:sS(n),hash:iS(s)}}function tS(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function jd(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function rS(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function ch(e,t){let r=rS(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function uh(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=fa(e):(s=Oo({},e),lt(!s.pathname||!s.pathname.includes("?"),jd("?","pathname","search",s)),lt(!s.pathname||!s.pathname.includes("#"),jd("#","pathname","hash",s)),lt(!s.search||!s.search.includes("#"),jd("#","search","hash",s)));let i=e===""||s.pathname==="",a=i?"/":s.pathname,o;if(a==null)o=r;else{let f=t.length-1;if(!n&&a.startsWith("..")){let h=a.split("/");for(;h[0]==="..";)h.shift(),f-=1;s.pathname=h.join("/")}o=f>=0?t[f]:"/"}let c=eS(s,o),d=a&&a!=="/"&&a.endsWith("/"),u=(i||a===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const ds=e=>e.join("/").replace(/\/\/+/g,"/"),nS=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),sS=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,iS=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function aS(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const cv=["post","put","patch","delete"];new Set(cv);const oS=["get",...cv];new Set(oS);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fo(){return Fo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fo.apply(this,arguments)}const dh=b.createContext(null),lS=b.createContext(null),Es=b.createContext(null),_u=b.createContext(null),Dn=b.createContext({outlet:null,matches:[],isDataRoute:!1}),uv=b.createContext(null);function cS(e,t){let{relative:r}=t===void 0?{}:t;ha()||lt(!1);let{basename:n,navigator:s}=b.useContext(Es),{hash:i,pathname:a,search:o}=fv(e,{relative:r}),c=a;return n!=="/"&&(c=a==="/"?n:ds([n,a])),s.createHref({pathname:c,search:o,hash:i})}function ha(){return b.useContext(_u)!=null}function ma(){return ha()||lt(!1),b.useContext(_u).location}function dv(e){b.useContext(Es).static||b.useLayoutEffect(e)}function pa(){let{isDataRoute:e}=b.useContext(Dn);return e?TS():uS()}function uS(){ha()||lt(!1);let e=b.useContext(dh),{basename:t,future:r,navigator:n}=b.useContext(Es),{matches:s}=b.useContext(Dn),{pathname:i}=ma(),a=JSON.stringify(ch(s,r.v7_relativeSplatPath)),o=b.useRef(!1);return dv(()=>{o.current=!0}),b.useCallback(function(d,u){if(u===void 0&&(u={}),!o.current)return;if(typeof d=="number"){n.go(d);return}let f=uh(d,JSON.parse(a),i,u.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:ds([t,f.pathname])),(u.replace?n.replace:n.push)(f,u.state,u)},[t,n,a,i,e])}const dS=b.createContext(null);function fS(e){let t=b.useContext(Dn).outlet;return t&&b.createElement(dS.Provider,{value:e},t)}function fv(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=b.useContext(Es),{matches:s}=b.useContext(Dn),{pathname:i}=ma(),a=JSON.stringify(ch(s,n.v7_relativeSplatPath));return b.useMemo(()=>uh(e,JSON.parse(a),i,r==="path"),[e,a,i,r])}function hS(e,t){return mS(e,t)}function mS(e,t,r,n){ha()||lt(!1);let{navigator:s}=b.useContext(Es),{matches:i}=b.useContext(Dn),a=i[i.length-1],o=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let d=ma(),u;if(t){var f;let g=typeof t=="string"?fa(t):t;c==="/"||(f=g.pathname)!=null&&f.startsWith(c)||lt(!1),u=g}else u=d;let h=u.pathname||"/",p=h;if(c!=="/"){let g=c.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(g.length).join("/")}let x=$E(e,{pathname:p}),m=yS(x&&x.map(g=>Object.assign({},g,{params:Object.assign({},o,g.params),pathname:ds([c,s.encodeLocation?s.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?c:ds([c,s.encodeLocation?s.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,r,n);return t&&m?b.createElement(_u.Provider,{value:{location:Fo({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Zn.Pop}},m):m}function pS(){let e=SS(),t=aS(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},t),r?b.createElement("pre",{style:s},r):null,null)}const gS=b.createElement(pS,null);class xS extends b.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?b.createElement(Dn.Provider,{value:this.props.routeContext},b.createElement(uv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function vS(e){let{routeContext:t,match:r,children:n}=e,s=b.useContext(dh);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),b.createElement(Dn.Provider,{value:t},n)}function yS(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let u=a.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);u>=0||lt(!1),a=a.slice(0,Math.min(a.length,u+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<a.length;u++){let f=a[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=u),f.route.id){let{loaderData:h,errors:p}=r,x=f.route.loader&&h[f.route.id]===void 0&&(!p||p[f.route.id]===void 0);if(f.route.lazy||x){c=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((u,f,h)=>{let p,x=!1,m=null,g=null;r&&(p=o&&f.route.id?o[f.route.id]:void 0,m=f.route.errorElement||gS,c&&(d<0&&h===0?(x=!0,g=null):d===h&&(x=!0,g=f.route.hydrateFallbackElement||null)));let _=t.concat(a.slice(0,h+1)),y=()=>{let v;return p?v=m:x?v=g:f.route.Component?v=b.createElement(f.route.Component,null):f.route.element?v=f.route.element:v=u,b.createElement(vS,{match:f,routeContext:{outlet:u,matches:_,isDataRoute:r!=null},children:v})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?b.createElement(xS,{location:r.location,revalidation:r.revalidation,component:m,error:p,children:y(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):y()},null)}var hv=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(hv||{}),Cc=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Cc||{});function wS(e){let t=b.useContext(dh);return t||lt(!1),t}function _S(e){let t=b.useContext(lS);return t||lt(!1),t}function ES(e){let t=b.useContext(Dn);return t||lt(!1),t}function mv(e){let t=ES(),r=t.matches[t.matches.length-1];return r.route.id||lt(!1),r.route.id}function SS(){var e;let t=b.useContext(uv),r=_S(Cc.UseRouteError),n=mv(Cc.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function TS(){let{router:e}=wS(hv.UseNavigateStable),t=mv(Cc.UseNavigateStable),r=b.useRef(!1);return dv(()=>{r.current=!0}),b.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Fo({fromRouteId:t},i)))},[e,t])}function bS(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function pv(e){let{to:t,replace:r,state:n,relative:s}=e;ha()||lt(!1);let{future:i,static:a}=b.useContext(Es),{matches:o}=b.useContext(Dn),{pathname:c}=ma(),d=pa(),u=uh(t,ch(o,i.v7_relativeSplatPath),c,s==="path"),f=JSON.stringify(u);return b.useEffect(()=>d(JSON.parse(f),{replace:r,state:n,relative:s}),[d,f,s,r,n]),null}function kS(e){return fS(e.context)}function Et(e){lt(!1)}function NS(e){let{basename:t="/",children:r=null,location:n,navigationType:s=Zn.Pop,navigator:i,static:a=!1,future:o}=e;ha()&&lt(!1);let c=t.replace(/^\/*/,"/"),d=b.useMemo(()=>({basename:c,navigator:i,static:a,future:Fo({v7_relativeSplatPath:!1},o)}),[c,o,i,a]);typeof n=="string"&&(n=fa(n));let{pathname:u="/",search:f="",hash:h="",state:p=null,key:x="default"}=n,m=b.useMemo(()=>{let g=lh(u,c);return g==null?null:{location:{pathname:g,search:f,hash:h,state:p,key:x},navigationType:s}},[c,u,f,h,p,x,s]);return m==null?null:b.createElement(Es.Provider,{value:d},b.createElement(_u.Provider,{children:r,value:m}))}function jS(e){let{children:t,location:r}=e;return hS(V0(t),r)}new Promise(()=>{});function V0(e,t){t===void 0&&(t=[]);let r=[];return b.Children.forEach(e,(n,s)=>{if(!b.isValidElement(n))return;let i=[...t,s];if(n.type===b.Fragment){r.push.apply(r,V0(n.props.children,i));return}n.type!==Et&&lt(!1),!n.props.index||!n.props.children||lt(!1);let a={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=V0(n.props.children,i)),r.push(a)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function G0(){return G0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},G0.apply(this,arguments)}function CS(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function AS(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function OS(e,t){return e.button===0&&(!t||t==="_self")&&!AS(e)}const FS=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],PS="6";try{window.__reactRouterVersion=PS}catch{}const DS="startTransition",vp=Jd[DS];function RS(e){let{basename:t,children:r,future:n,window:s}=e,i=b.useRef();i.current==null&&(i.current=LE({window:s,v5Compat:!0}));let a=i.current,[o,c]=b.useState({action:a.action,location:a.location}),{v7_startTransition:d}=n||{},u=b.useCallback(f=>{d&&vp?vp(()=>c(f)):c(f)},[c,d]);return b.useLayoutEffect(()=>a.listen(u),[a,u]),b.useEffect(()=>bS(n),[n]),b.createElement(NS,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:a,future:n})}const IS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",LS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yp=b.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:i,replace:a,state:o,target:c,to:d,preventScrollReset:u,viewTransition:f}=t,h=CS(t,FS),{basename:p}=b.useContext(Es),x,m=!1;if(typeof d=="string"&&LS.test(d)&&(x=d,IS))try{let v=new URL(window.location.href),w=d.startsWith("//")?new URL(v.protocol+d):new URL(d),N=lh(w.pathname,p);w.origin===v.origin&&N!=null?d=N+w.search+w.hash:m=!0}catch{}let g=cS(d,{relative:s}),_=MS(d,{replace:a,state:o,target:c,preventScrollReset:u,relative:s,viewTransition:f});function y(v){n&&n(v),v.defaultPrevented||_(v)}return b.createElement("a",G0({},h,{href:x||g,onClick:m||i?n:y,ref:r,target:c}))});var wp;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(wp||(wp={}));var _p;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(_p||(_p={}));function MS(e,t){let{target:r,replace:n,state:s,preventScrollReset:i,relative:a,viewTransition:o}=t===void 0?{}:t,c=pa(),d=ma(),u=fv(e,{relative:a});return b.useCallback(f=>{if(OS(f,r)){f.preventDefault();let h=n!==void 0?n:jc(d)===jc(u);c(e,{replace:h,state:s,preventScrollReset:i,relative:a,viewTransition:o})}},[d,c,u,n,s,r,e,i,a,o])}let BS={data:""},$S=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||BS,US=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,WS=/\/\*[^]*?\*\/|  +/g,Ep=/\n+/g,Xn=(e,t)=>{let r="",n="",s="";for(let i in e){let a=e[i];i[0]=="@"?i[1]=="i"?r=i+" "+a+";":n+=i[1]=="f"?Xn(a,i):i+"{"+Xn(a,i[1]=="k"?"":t)+"}":typeof a=="object"?n+=Xn(a,t?t.replace(/([^,])+/g,o=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,o):o?o+" "+c:c)):i):a!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Xn.p?Xn.p(i,a):i+":"+a+";")}return r+(t&&s?t+"{"+s+"}":s)+n},fn={},gv=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+gv(e[r]);return t}return e},HS=(e,t,r,n,s)=>{let i=gv(e),a=fn[i]||(fn[i]=(c=>{let d=0,u=11;for(;d<c.length;)u=101*u+c.charCodeAt(d++)>>>0;return"go"+u})(i));if(!fn[a]){let c=i!==e?e:(d=>{let u,f,h=[{}];for(;u=US.exec(d.replace(WS,""));)u[4]?h.shift():u[3]?(f=u[3].replace(Ep," ").trim(),h.unshift(h[0][f]=h[0][f]||{})):h[0][u[1]]=u[2].replace(Ep," ").trim();return h[0]})(e);fn[a]=Xn(s?{["@keyframes "+a]:c}:c,r?"":"."+a)}let o=r&&fn.g?fn.g:null;return r&&(fn.g=fn[a]),((c,d,u,f)=>{f?d.data=d.data.replace(f,c):d.data.indexOf(c)===-1&&(d.data=u?c+d.data:d.data+c)})(fn[a],t,n,o),a},zS=(e,t,r)=>e.reduce((n,s,i)=>{let a=t[i];if(a&&a.call){let o=a(r),c=o&&o.props&&o.props.className||/^go/.test(o)&&o;a=c?"."+c:o&&typeof o=="object"?o.props?"":Xn(o,""):o===!1?"":o}return n+s+(a??"")},"");function Eu(e){let t=this||{},r=e.call?e(t.p):e;return HS(r.unshift?r.raw?zS(r,[].slice.call(arguments,1),t.p):r.reduce((n,s)=>Object.assign(n,s&&s.call?s(t.p):s),{}):r,$S(t.target),t.g,t.o,t.k)}let xv,q0,K0;Eu.bind({g:1});let jn=Eu.bind({k:1});function VS(e,t,r,n){Xn.p=t,xv=e,q0=r,K0=n}function Ss(e,t){let r=this||{};return function(){let n=arguments;function s(i,a){let o=Object.assign({},i),c=o.className||s.className;r.p=Object.assign({theme:q0&&q0()},o),r.o=/ *go\d+/.test(c),o.className=Eu.apply(r,n)+(c?" "+c:"");let d=e;return e[0]&&(d=o.as||e,delete o.as),K0&&d[0]&&K0(o),xv(d,o)}return s}}var GS=e=>typeof e=="function",Ac=(e,t)=>GS(e)?e(t):e,qS=(()=>{let e=0;return()=>(++e).toString()})(),vv=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),KS=20,yv=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,KS)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:r}=t;return yv(e,{type:e.toasts.find(i=>i.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=t;return{...e,toasts:e.toasts.map(i=>i.id===n||n===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let s=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+s}))}}},rc=[],Us={toasts:[],pausedAt:void 0},ni=e=>{Us=yv(Us,e),rc.forEach(t=>{t(Us)})},XS={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},YS=(e={})=>{let[t,r]=b.useState(Us),n=b.useRef(Us);b.useEffect(()=>(n.current!==Us&&r(Us),rc.push(r),()=>{let i=rc.indexOf(r);i>-1&&rc.splice(i,1)}),[]);let s=t.toasts.map(i=>{var a,o,c;return{...e,...e[i.type],...i,removeDelay:i.removeDelay||((a=e[i.type])==null?void 0:a.removeDelay)||(e==null?void 0:e.removeDelay),duration:i.duration||((o=e[i.type])==null?void 0:o.duration)||(e==null?void 0:e.duration)||XS[i.type],style:{...e.style,...(c=e[i.type])==null?void 0:c.style,...i.style}}});return{...t,toasts:s}},JS=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||qS()}),qo=e=>(t,r)=>{let n=JS(t,e,r);return ni({type:2,toast:n}),n.id},Kt=(e,t)=>qo("blank")(e,t);Kt.error=qo("error");Kt.success=qo("success");Kt.loading=qo("loading");Kt.custom=qo("custom");Kt.dismiss=e=>{ni({type:3,toastId:e})};Kt.remove=e=>ni({type:4,toastId:e});Kt.promise=(e,t,r)=>{let n=Kt.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(s=>{let i=t.success?Ac(t.success,s):void 0;return i?Kt.success(i,{id:n,...r,...r==null?void 0:r.success}):Kt.dismiss(n),s}).catch(s=>{let i=t.error?Ac(t.error,s):void 0;i?Kt.error(i,{id:n,...r,...r==null?void 0:r.error}):Kt.dismiss(n)}),e};var QS=(e,t)=>{ni({type:1,toast:{id:e,height:t}})},ZS=()=>{ni({type:5,time:Date.now()})},to=new Map,eT=1e3,tT=(e,t=eT)=>{if(to.has(e))return;let r=setTimeout(()=>{to.delete(e),ni({type:4,toastId:e})},t);to.set(e,r)},rT=e=>{let{toasts:t,pausedAt:r}=YS(e);b.useEffect(()=>{if(r)return;let i=Date.now(),a=t.map(o=>{if(o.duration===1/0)return;let c=(o.duration||0)+o.pauseDuration-(i-o.createdAt);if(c<0){o.visible&&Kt.dismiss(o.id);return}return setTimeout(()=>Kt.dismiss(o.id),c)});return()=>{a.forEach(o=>o&&clearTimeout(o))}},[t,r]);let n=b.useCallback(()=>{r&&ni({type:6,time:Date.now()})},[r]),s=b.useCallback((i,a)=>{let{reverseOrder:o=!1,gutter:c=8,defaultPosition:d}=a||{},u=t.filter(p=>(p.position||d)===(i.position||d)&&p.height),f=u.findIndex(p=>p.id===i.id),h=u.filter((p,x)=>x<f&&p.visible).length;return u.filter(p=>p.visible).slice(...o?[h+1]:[0,h]).reduce((p,x)=>p+(x.height||0)+c,0)},[t]);return b.useEffect(()=>{t.forEach(i=>{if(i.dismissed)tT(i.id,i.removeDelay);else{let a=to.get(i.id);a&&(clearTimeout(a),to.delete(i.id))}})},[t]),{toasts:t,handlers:{updateHeight:QS,startPause:ZS,endPause:n,calculateOffset:s}}},nT=jn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,sT=jn`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,iT=jn`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,aT=Ss("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${nT} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${sT} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${iT} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,oT=jn`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,lT=Ss("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${oT} 1s linear infinite;
`,cT=jn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,uT=jn`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,dT=Ss("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${cT} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${uT} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,fT=Ss("div")`
  position: absolute;
`,hT=Ss("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,mT=jn`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,pT=Ss("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${mT} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,gT=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?b.createElement(pT,null,t):t:r==="blank"?null:b.createElement(hT,null,b.createElement(lT,{...n}),r!=="loading"&&b.createElement(fT,null,r==="error"?b.createElement(aT,{...n}):b.createElement(dT,{...n})))},xT=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,vT=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,yT="0%{opacity:0;} 100%{opacity:1;}",wT="0%{opacity:1;} 100%{opacity:0;}",_T=Ss("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,ET=Ss("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,ST=(e,t)=>{let r=e.includes("top")?1:-1,[n,s]=vv()?[yT,wT]:[xT(r),vT(r)];return{animation:t?`${jn(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${jn(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},TT=b.memo(({toast:e,position:t,style:r,children:n})=>{let s=e.height?ST(e.position||t||"top-center",e.visible):{opacity:0},i=b.createElement(gT,{toast:e}),a=b.createElement(ET,{...e.ariaProps},Ac(e.message,e));return b.createElement(_T,{className:e.className,style:{...s,...r,...e.style}},typeof n=="function"?n({icon:i,message:a}):b.createElement(b.Fragment,null,i,a))});VS(b.createElement);var bT=({id:e,className:t,style:r,onHeightUpdate:n,children:s})=>{let i=b.useCallback(a=>{if(a){let o=()=>{let c=a.getBoundingClientRect().height;n(e,c)};o(),new MutationObserver(o).observe(a,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return b.createElement("div",{ref:i,className:t,style:r},s)},kT=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},s=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:vv()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...s}},NT=Eu`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,bl=16,jT=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:s,containerStyle:i,containerClassName:a})=>{let{toasts:o,handlers:c}=rT(r);return b.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:bl,left:bl,right:bl,bottom:bl,pointerEvents:"none",...i},className:a,onMouseEnter:c.startPause,onMouseLeave:c.endPause},o.map(d=>{let u=d.position||t,f=c.calculateOffset(d,{reverseOrder:e,gutter:n,defaultPosition:t}),h=kT(u,f);return b.createElement(bT,{id:d.id,key:d.id,onHeightUpdate:c.updateHeight,className:d.visible?NT:"",style:h},d.type==="custom"?Ac(d.message,d):s?s(d):b.createElement(TT,{toast:d,position:u}))}))},pe=Kt;const wv=b.createContext(void 0);function CT({children:e}){const[t,r]=b.useState(null),[n,s]=b.useState(!1),i=o=>{console.log(":",o.name),r(o),s(!0),localStorage.setItem("currentUser",JSON.stringify(o))},a=()=>{console.log(""),r(null),s(!1),localStorage.removeItem("currentUser")};return b.useEffect(()=>{const o=localStorage.getItem("currentUser");if(o)try{const c=JSON.parse(o);r(c),s(!0),console.log(":",c.name)}catch(c){console.error(":",c),localStorage.removeItem("currentUser")}},[]),l.jsx(wv.Provider,{value:{currentUser:t,isAuthenticated:n,switchUser:i,logout:a},children:e})}function Ht(){const e=b.useContext(wv);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}const AT={sessionTimeout:480,maxLoginAttempts:5,lockoutDuration:30,passwordPolicy:{minLength:8,requireUppercase:!0,requireLowercase:!0,requireNumbers:!0,requireSpecialChars:!1},auditLogRetention:90},Sp={president:{role:"president",permissions:["users:read","users:write","users:delete","users:manage_roles","groups:read","groups:write","groups:delete","groups:manage_members","equipment:read","equipment:write","equipment:delete","schedules:read","schedules:write","schedules:delete","schedules:read_all","schedules:manage_others","leave:read","leave:write","leave:approve","leave:read_all","admin:access","admin:system_settings","admin:audit_logs","system:backup","system:maintenance"],dataAccess:{canViewAllUsers:!0,canViewAllSchedules:!0,canViewAllLeaveRequests:!0,canModifyOthersData:!0}},admin:{role:"admin",permissions:["users:read","users:write","groups:read","groups:write","groups:delete","groups:manage_members","equipment:read","equipment:write","equipment:delete","schedules:read","schedules:write","schedules:delete","schedules:read_all","leave:read","leave:write","leave:approve","leave:read_all","admin:access"],dataAccess:{canViewAllUsers:!0,canViewAllSchedules:!0,canViewAllLeaveRequests:!0,canModifyOthersData:!1}},employee:{role:"employee",permissions:["users:read","groups:read","equipment:read","schedules:read","schedules:write","schedules:delete","leave:read","leave:write"],dataAccess:{canViewAllUsers:!1,canViewAllSchedules:!1,canViewAllLeaveRequests:!1,canModifyOthersData:!1}}},_v=b.createContext(void 0);function OT({children:e}){const{currentUser:t,isAuthenticated:r}=Ht(),[n,s]=b.useState(AT),[i,a]=b.useState(null),[o,c]=b.useState([]),d=t?Sp[t.role]:Sp.employee,u=d.permissions;b.useEffect(()=>{if(r&&t){const w=new Date,N=`session_${t.id}_${w.getTime()}`;a({id:N,userId:t.id,createdAt:w,lastActivity:w,expiresAt:new Date(w.getTime()+n.sessionTimeout*60*1e3),isActive:!0}),setTimeout(()=>{m({type:"login",action:"User logged in",severity:"low"})},0)}else i&&setTimeout(()=>{m({type:"logout",action:"User logged out",severity:"low"})},0),a(null)},[r,t]);const f=w=>!t||!r?!1:u.includes(w),h=w=>!t||!r?!1:w.some(N=>u.includes(N)),p=w=>!t||!r?!1:w.every(N=>u.includes(N)),x=(w,N,E)=>{if(!t||!r)return!1;if(t.role==="president")return!0;const T=E===t.id;switch(w){case"user":if(N==="read")return f("users:read");if(N==="write")return f("users:write")||T;if(N==="delete")return f("users:delete");if(N==="manage_roles")return f("users:manage_roles");break;case"schedule":if(N==="read")return f("schedules:read")&&(f("schedules:read_all")||T);if(N==="write")return f("schedules:write")&&(f("schedules:manage_others")||T);if(N==="delete")return f("schedules:delete")&&(f("schedules:manage_others")||T);break;case"leave_request":if(N==="read")return f("leave:read")&&(f("leave:read_all")||T);if(N==="write")return f("leave:write")||T;if(N==="approve")return f("leave:approve");break;case"group":if(N==="read")return f("groups:read");if(N==="write")return f("groups:write");if(N==="delete")return f("groups:delete");if(N==="manage_members")return f("groups:manage_members");break;case"equipment":if(N==="read")return f("equipment:read");if(N==="write")return f("equipment:write");if(N==="delete")return f("equipment:delete");break;default:return!1}return!1},m=w=>{if(!t)return;const N={id:`event_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date,userId:t.id,userEmail:t.email,userRole:t.role,...w};c(E=>[N,...E].slice(0,1e3))},g=w=>{if(!f("admin:system_settings")){m({type:"permission_denied",action:"Attempted to update security settings",severity:"medium"});return}s(N=>({...N,...w})),m({type:"admin_action",action:"Updated security settings",details:w,severity:"medium"})},_=()=>{if(!i||!i.isActive)return!1;const w=new Date;return w>i.expiresAt?(a(E=>E?{...E,isActive:!1}:null),setTimeout(()=>{m({type:"security_violation",action:"Session expired",severity:"medium"})},0),!1):(a(E=>E?{...E,lastActivity:w}:null),!0)},y=()=>{if(!i)return;const w=new Date;a(N=>N?{...N,lastActivity:w,expiresAt:new Date(w.getTime()+n.sessionTimeout*60*1e3)}:null)},v=w=>{if(!f("admin:audit_logs"))return m({type:"permission_denied",action:"Attempted to access audit logs",severity:"medium"}),[];let N=o;return w&&(N=o.filter(E=>Object.entries(w).every(([T,M])=>M===void 0?!0:E[T]===M))),N};return b.useEffect(()=>{const w=setInterval(()=>{i&&!_()&&(window.location.href="/login")},6e4);return()=>clearInterval(w)},[i]),l.jsx(_v.Provider,{value:{permissions:u,rolePermissions:d,securitySettings:n,sessionInfo:i,securityEvents:o,hasPermission:f,hasAnyPermission:h,hasAllPermissions:p,canAccessResource:x,logSecurityEvent:m,updateSecuritySettings:g,checkSessionValidity:_,extendSession:y,getAuditLogs:v},children:e})}function Ev(){const e=b.useContext(_v);if(e===void 0)throw new Error("useSecurity must be used within a SecurityProvider");return e}function Ke(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function ln(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Bt(e,t){const r=Ke(e);return isNaN(t)?ln(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function FT(e,t){const r=+Ke(e);return ln(e,r+t)}const Sv=6048e5,PT=864e5,DT=36e5;function RT(e,t){return FT(e,t*DT)}let IT={};function Su(){return IT}function Ot(e,t){var o,c,d,u;const r=Su(),n=(t==null?void 0:t.weekStartsOn)??((c=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.weekStartsOn)??0,s=Ke(e),i=s.getDay(),a=(i<n?7:0)+i-n;return s.setDate(s.getDate()-a),s.setHours(0,0,0,0),s}function Oc(e){return Ot(e,{weekStartsOn:1})}function Tv(e){const t=Ke(e),r=t.getFullYear(),n=ln(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const s=Oc(n),i=ln(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const a=Oc(i);return t.getTime()>=s.getTime()?r+1:t.getTime()>=a.getTime()?r:r-1}function Fc(e){const t=Ke(e);return t.setHours(0,0,0,0),t}function Tp(e){const t=Ke(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function LT(e,t){const r=Fc(e),n=Fc(t),s=+r-Tp(r),i=+n-Tp(n);return Math.round((s-i)/PT)}function MT(e){const t=Tv(e),r=ln(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Oc(r)}function BT(e){return ln(e,Date.now())}function X0(e,t){const r=Fc(e),n=Fc(t);return+r==+n}function $T(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function UT(e){if(!$T(e)&&typeof e!="number")return!1;const t=Ke(e);return!isNaN(Number(t))}function Tu(e){const t=Ke(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function bu(e,t){const r=Ke(e.start),n=Ke(e.end);let s=+r>+n;const i=s?+r:+n,a=s?n:r;a.setHours(0,0,0,0);let o=1;const c=[];for(;+a<=i;)c.push(Ke(a)),a.setDate(a.getDate()+o),a.setHours(0,0,0,0);return s?c.reverse():c}function ku(e){const t=Ke(e);return t.setDate(1),t.setHours(0,0,0,0),t}function WT(e){const t=Ke(e),r=ln(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}const HT={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},zT=(e,t,r)=>{let n;const s=HT[e];return typeof s=="string"?n=s:t===1?n=s.one:n=s.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Hi(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const VT={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},GT={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},qT={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},KT={date:Hi({formats:VT,defaultWidth:"full"}),time:Hi({formats:GT,defaultWidth:"full"}),dateTime:Hi({formats:qT,defaultWidth:"full"})},XT={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},YT=(e,t,r,n)=>XT[e];function nn(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):a;s=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[o]||e.values[a]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const JT={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},QT={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},ZT={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},eb={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},tb={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},rb={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},nb=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},sb={ordinalNumber:nb,era:nn({values:JT,defaultWidth:"wide"}),quarter:nn({values:QT,defaultWidth:"wide",argumentCallback:e=>e-1}),month:nn({values:ZT,defaultWidth:"wide"}),day:nn({values:eb,defaultWidth:"wide"}),dayPeriod:nn({values:tb,defaultWidth:"wide",formattingValues:rb,defaultFormattingWidth:"wide"})};function sn(e){return(t,r={})=>{const n=r.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const a=i[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(o)?ab(o,f=>f.test(a)):ib(o,f=>f.test(a));let d;d=e.valueCallback?e.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const u=t.slice(a.length);return{value:d,rest:u}}}function ib(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function ab(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function bv(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const s=n[0],i=t.match(e.parsePattern);if(!i)return null;let a=e.valueCallback?e.valueCallback(i[0]):i[0];a=r.valueCallback?r.valueCallback(a):a;const o=t.slice(s.length);return{value:a,rest:o}}}const ob=/^(\d+)(th|st|nd|rd)?/i,lb=/\d+/i,cb={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ub={any:[/^b/i,/^(a|c)/i]},db={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},fb={any:[/1/i,/2/i,/3/i,/4/i]},hb={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},mb={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},pb={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},gb={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},xb={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},vb={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},yb={ordinalNumber:bv({matchPattern:ob,parsePattern:lb,valueCallback:e=>parseInt(e,10)}),era:sn({matchPatterns:cb,defaultMatchWidth:"wide",parsePatterns:ub,defaultParseWidth:"any"}),quarter:sn({matchPatterns:db,defaultMatchWidth:"wide",parsePatterns:fb,defaultParseWidth:"any",valueCallback:e=>e+1}),month:sn({matchPatterns:hb,defaultMatchWidth:"wide",parsePatterns:mb,defaultParseWidth:"any"}),day:sn({matchPatterns:pb,defaultMatchWidth:"wide",parsePatterns:gb,defaultParseWidth:"any"}),dayPeriod:sn({matchPatterns:xb,defaultMatchWidth:"any",parsePatterns:vb,defaultParseWidth:"any"})},wb={code:"en-US",formatDistance:zT,formatLong:KT,formatRelative:YT,localize:sb,match:yb,options:{weekStartsOn:0,firstWeekContainsDate:1}};function _b(e){const t=Ke(e);return LT(t,WT(t))+1}function Eb(e){const t=Ke(e),r=+Oc(t)-+MT(t);return Math.round(r/Sv)+1}function kv(e,t){var u,f,h,p;const r=Ke(e),n=r.getFullYear(),s=Su(),i=(t==null?void 0:t.firstWeekContainsDate)??((f=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??s.firstWeekContainsDate??((p=(h=s.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??1,a=ln(e,0);a.setFullYear(n+1,0,i),a.setHours(0,0,0,0);const o=Ot(a,t),c=ln(e,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const d=Ot(c,t);return r.getTime()>=o.getTime()?n+1:r.getTime()>=d.getTime()?n:n-1}function Sb(e,t){var o,c,d,u;const r=Su(),n=(t==null?void 0:t.firstWeekContainsDate)??((c=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??1,s=kv(e,t),i=ln(e,0);return i.setFullYear(s,0,n),i.setHours(0,0,0,0),Ot(i,t)}function Tb(e,t){const r=Ke(e),n=+Ot(r,t)-+Sb(r,t);return Math.round(n/Sv)+1}function Me(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Mn={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Me(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Me(r+1,2)},d(e,t){return Me(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Me(e.getHours()%12||12,t.length)},H(e,t){return Me(e.getHours(),t.length)},m(e,t){return Me(e.getMinutes(),t.length)},s(e,t){return Me(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return Me(s,t.length)}},hi={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},bp={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return Mn.y(e,t)},Y:function(e,t,r,n){const s=kv(e,n),i=s>0?s:1-s;if(t==="YY"){const a=i%100;return Me(a,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Me(i,t.length)},R:function(e,t){const r=Tv(e);return Me(r,t.length)},u:function(e,t){const r=e.getFullYear();return Me(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Me(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Me(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Mn.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Me(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const s=Tb(e,n);return t==="wo"?r.ordinalNumber(s,{unit:"week"}):Me(s,t.length)},I:function(e,t,r){const n=Eb(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Me(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Mn.d(e,t)},D:function(e,t,r){const n=_b(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Me(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const s=e.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Me(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const s=e.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Me(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),s=n===0?7:n;switch(t){case"i":return String(s);case"ii":return Me(s,t.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let s;switch(n===12?s=hi.noon:n===0?s=hi.midnight:s=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let s;switch(n>=17?s=hi.evening:n>=12?s=hi.afternoon:n>=4?s=hi.morning:s=hi.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Mn.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Mn.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Me(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Me(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Mn.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Mn.s(e,t)},S:function(e,t){return Mn.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return Np(n);case"XXXX":case"XX":return Fs(n);case"XXXXX":case"XXX":default:return Fs(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return Np(n);case"xxxx":case"xx":return Fs(n);case"xxxxx":case"xxx":default:return Fs(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+kp(n,":");case"OOOO":default:return"GMT"+Fs(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+kp(n,":");case"zzzz":default:return"GMT"+Fs(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return Me(n,t.length)},T:function(e,t,r){const n=e.getTime();return Me(n,t.length)}};function kp(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Math.trunc(n/60),i=n%60;return i===0?r+String(s):r+String(s)+t+Me(i,2)}function Np(e,t){return e%60===0?(e>0?"-":"+")+Me(Math.abs(e)/60,2):Fs(e,t)}function Fs(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Me(Math.trunc(n/60),2),i=Me(n%60,2);return r+s+t+i}const jp=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Nv=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},bb=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return jp(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",jp(n,t)).replace("{{time}}",Nv(s,t))},kb={p:Nv,P:bb},Nb=/^D+$/,jb=/^Y+$/,Cb=["D","DD","YY","YYYY"];function Ab(e){return Nb.test(e)}function Ob(e){return jb.test(e)}function Fb(e,t,r){const n=Pb(e,t,r);if(console.warn(n),Cb.includes(e))throw new RangeError(n)}function Pb(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Db=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Rb=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ib=/^'([^]*?)'?$/,Lb=/''/g,Mb=/[a-zA-Z]/;function be(e,t,r){var u,f,h,p,x,m,g,_;const n=Su(),s=(r==null?void 0:r.locale)??n.locale??wb,i=(r==null?void 0:r.firstWeekContainsDate)??((f=(u=r==null?void 0:r.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((p=(h=n.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??1,a=(r==null?void 0:r.weekStartsOn)??((m=(x=r==null?void 0:r.locale)==null?void 0:x.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((_=(g=n.locale)==null?void 0:g.options)==null?void 0:_.weekStartsOn)??0,o=Ke(e);if(!UT(o))throw new RangeError("Invalid time value");let c=t.match(Rb).map(y=>{const v=y[0];if(v==="p"||v==="P"){const w=kb[v];return w(y,s.formatLong)}return y}).join("").match(Db).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const v=y[0];if(v==="'")return{isToken:!1,value:Bb(y)};if(bp[v])return{isToken:!0,value:y};if(v.match(Mb))throw new RangeError("Format string contains an unescaped latin alphabet character `"+v+"`");return{isToken:!1,value:y}});s.localize.preprocessor&&(c=s.localize.preprocessor(o,c));const d={firstWeekContainsDate:i,weekStartsOn:a,locale:s};return c.map(y=>{if(!y.isToken)return y.value;const v=y.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&Ob(v)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&Ab(v))&&Fb(v,t,String(e));const w=bp[v[0]];return w(o,v,s.localize,d)}).join("")}function Bb(e){const t=e.match(Ib);return t?t[1].replace(Lb,"'"):e}function Nu(e,t){const r=Ke(e),n=Ke(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function ps(e){return X0(e,BT(e))}function Cp(e,t){const r=+Ke(e),[n,s]=[+Ke(t.start),+Ke(t.end)].sort((i,a)=>i-a);return r>=n&&r<=s}function Ap(e,t){return Bt(e,-t)}function $b(e,t){const r=Ke(e);return r.setHours(t),r}function Ub(e,t){const r=Ke(e);return r.setMinutes(t),r}const yn=[{id:"550e8400-e29b-41d4-a716-446655440001",employeeId:"012E3D24690F653F",name:" ",nameKana:" ",email:"yamada@terao-f.co.jp",phone:"03-1234-5678",department:"",role:"president",defaultWorkDays:[{day:1,startTime:"09:00",endTime:"18:00"},{day:2,startTime:"09:00",endTime:"18:00"},{day:3,startTime:"09:00",endTime:"18:00"},{day:4,startTime:"09:00",endTime:"18:00"},{day:5,startTime:"09:00",endTime:"18:00"}]},{id:"550e8400-e29b-41d4-a716-446655440002",employeeId:"112E3D24690F653G",name:" ",nameKana:" ",email:"suzuki@terao-f.co.jp",phone:"03-1234-5679",department:"",role:"admin",defaultWorkDays:[{day:1,startTime:"09:00",endTime:"18:00"},{day:2,startTime:"09:00",endTime:"18:00"},{day:3,startTime:"09:00",endTime:"18:00"},{day:4,startTime:"09:00",endTime:"18:00"},{day:5,startTime:"09:00",endTime:"18:00"}]},{id:"550e8400-e29b-41d4-a716-446655440003",employeeId:"212E3D24690F653H",name:" ",nameKana:" ",email:"sato@terao-f.co.jp",phone:"03-1234-5680",department:"CAD-CAM",role:"employee",defaultWorkDays:[{day:1,startTime:"09:00",endTime:"18:00"},{day:2,startTime:"09:00",endTime:"18:00"},{day:3,startTime:"09:00",endTime:"18:00"},{day:4,startTime:"09:00",endTime:"18:00"},{day:5,startTime:"09:00",endTime:"18:00"}]},{id:"4",employeeId:"312E3D24690F653I",name:" ",nameKana:" ",email:"tanaka@terao-f.co.jp",phone:"03-1234-5681",department:"WEB",role:"employee",defaultWorkDays:[{day:1,startTime:"09:00",endTime:"18:00"},{day:2,startTime:"09:00",endTime:"18:00"},{day:3,startTime:"09:00",endTime:"18:00"},{day:4,startTime:"09:00",endTime:"18:00"},{day:5,startTime:"09:00",endTime:"18:00"}]}],Pc=[{id:"1",name:"",type:"department",members:["1"],createdBy:"1",createdAt:new Date("2025-01-01")},{id:"2",name:"",type:"department",members:["2"],createdBy:"1",createdAt:new Date("2025-01-01")},{id:"3",name:"CAD-CAM",type:"department",members:["3"],createdBy:"1",createdAt:new Date("2025-01-01")},{id:"4",name:"WEB",type:"department",members:["4"],createdBy:"1",createdAt:new Date("2025-01-01")},{id:"5",name:"A",type:"business",members:["1","2","3"],createdBy:"1",createdAt:new Date("2025-01-15")},{id:"6",name:"",type:"leave",members:["1","2"],createdBy:"1",createdAt:new Date("2025-01-01")}],Dc=[{id:"1",name:"",createdBy:"1"},{id:"2",name:"",createdBy:"1"},{id:"3",name:"",createdBy:"1"},{id:"4",name:"Web",createdBy:"1"},{id:"5",name:"LAB",createdBy:"1"}],Rc=[{id:"1",name:"",licensePlate:" 300  12-34",type:"",createdBy:"1"},{id:"2",name:"",licensePlate:" 400  56-78",type:"",createdBy:"1"},{id:"3",name:"",licensePlate:" 500  90-12",type:"",createdBy:"1"}],Ic=[{id:"1",name:"CAD 1",type:"CAD"},{id:"2",name:" 1",type:""},{id:"3",name:" 1",type:""},{id:"4",name:" 1",type:""},{id:"5",name:" 1",type:""},{id:"6",name:" 1",type:""}],Lc=new Date,Mc=new Date(Lc);Mc.setDate(Mc.getDate()+1);const Bc=new Date(Lc);Bc.setDate(Bc.getDate()+2);const Op=[{id:"1",type:"",title:"",details:"",startTime:new Date(Lc.setHours(10,0,0,0)),endTime:new Date(Lc.setHours(11,0,0,0)),isAllDay:!1,recurrence:{type:"weekly",interval:1,endDate:null,count:null,weekdays:[1]},participants:["1","2","3","4"],equipment:[{id:"1",type:"room"}],reminders:[{time:15,methods:["email","notification"]}],createdBy:"1",createdAt:new Date("2025-01-15"),updatedBy:null,updatedAt:null},{id:"2",type:"",title:"A",details:"",startTime:new Date(Mc.setHours(14,0,0,0)),endTime:new Date(Mc.setHours(15,30,0,0)),isAllDay:!1,recurrence:null,participants:["1","2"],equipment:[{id:"4",type:"room"}],reminders:[{time:30,methods:["email"]}],createdBy:"2",createdAt:new Date("2025-01-20"),updatedBy:null,updatedAt:null},{id:"3",type:"",title:"B",details:"",startTime:new Date(Bc.setHours(13,0,0,0)),endTime:new Date(Bc.setHours(16,0,0,0)),isAllDay:!1,recurrence:null,participants:["1","3"],equipment:[{id:"2",type:"room"},{id:"1",type:"vehicle"}],reminders:[{time:60,methods:["email","notification","calendar"]}],createdBy:"1",createdAt:new Date("2025-01-22"),updatedBy:null,updatedAt:null}],Fp=[{id:"1",type:"vacation",userId:"3",date:new Date("2025-02-15"),reason:"",status:"pending",approvers:[{userId:"2",status:"approved",timestamp:new Date("2025-02-10T10:30:00")},{userId:"1",status:"pending",timestamp:null}],createdAt:new Date("2025-02-10")},{id:"2",type:"late",userId:"4",date:new Date("2025-02-12"),reason:"",status:"approved",approvers:[{userId:"2",status:"approved",timestamp:new Date("2025-02-11T09:15:00")},{userId:"1",status:"approved",timestamp:new Date("2025-02-11T14:20:00")}],createdAt:new Date("2025-02-11")}],Wb="modulepreload",Hb=function(e){return"/"+e},Pp={},Ko=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=Hb(c),c in Pp)return;Pp[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":Wb,d||(f.as="script"),f.crossOrigin="",f.href=c,o&&f.setAttribute("nonce",o),document.head.appendChild(f),d)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},zb=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ko(async()=>{const{default:n}=await Promise.resolve().then(()=>ga);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class fh extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Vb extends fh{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Gb extends fh{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class qb extends fh{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Y0;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Y0||(Y0={}));var Kb=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(u){try{d(n.next(u))}catch(f){a(f)}}function c(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?i(u.value):s(u.value).then(o,c)}d((n=n.apply(e,t||[])).next())})};class Xb{constructor(t,{headers:r={},customFetch:n,region:s=Y0.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=zb(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return Kb(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:a}=r;let o={},{region:c}=r;c||(c=this.region),c&&c!=="any"&&(o["x-region"]=c);let d;a&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",d=a):typeof a=="string"?(o["Content-Type"]="text/plain",d=a):typeof FormData<"u"&&a instanceof FormData?d=a:(o["Content-Type"]="application/json",d=JSON.stringify(a)));const u=yield this.fetch(`${this.url}/${t}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:d}).catch(x=>{throw new Vb(x)}),f=u.headers.get("x-relay-error");if(f&&f==="true")throw new Gb(u);if(!u.ok)throw new qb(u);let h=((n=u.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),p;return h==="application/json"?p=yield u.json():h==="application/octet-stream"?p=yield u.blob():h==="text/event-stream"?p=u:h==="multipart/form-data"?p=yield u.formData():p=yield u.text(),{data:p,error:null}}catch(s){return{data:null,error:s}}})}}var tr={},hh={},ju={},Xo={},Cu={},Au={},Yb=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},na=Yb();const Jb=na.fetch,jv=na.fetch.bind(na),Cv=na.Headers,Qb=na.Request,Zb=na.Response,ga=Object.freeze(Object.defineProperty({__proto__:null,Headers:Cv,Request:Qb,Response:Zb,default:jv,fetch:Jb},Symbol.toStringTag,{value:"Module"})),ek=u2(ga);var Ou={};Object.defineProperty(Ou,"__esModule",{value:!0});let tk=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Ou.default=tk;var Av=Or&&Or.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Au,"__esModule",{value:!0});const rk=Av(ek),nk=Av(Ou);let sk=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=rk.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,o,c;let d=null,u=null,f=null,h=i.status,p=i.statusText;if(i.ok){if(this.method!=="HEAD"){const _=await i.text();_===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=_:u=JSON.parse(_))}const m=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),g=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");m&&g&&g.length>1&&(f=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(d={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,f=null,h=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const m=await i.text();try{d=JSON.parse(m),Array.isArray(d)&&i.status===404&&(u=[],d=null,h=200,p="OK")}catch{i.status===404&&m===""?(h=204,p="No Content"):d={message:m}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,h=200,p="OK"),d&&this.shouldThrowOnError)throw new nk.default(d)}return{error:d,data:u,count:f,status:h,statusText:p}});return this.shouldThrowOnError||(s=s.catch(i=>{var a,o,c;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};Au.default=sk;var ik=Or&&Or.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Cu,"__esModule",{value:!0});const ak=ik(Au);let ok=class extends ak.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const a=i?`${i}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"offset":`${s}.offset`,a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(a,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:a="text"}={}){var o;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${d}"; options=${c};`,a==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Cu.default=ok;var lk=Or&&Or.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xo,"__esModule",{value:!0});const ck=lk(Cu);let uk=class extends ck.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${a}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Xo.default=uk;var dk=Or&&Or.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ju,"__esModule",{value:!0});const Ra=dk(Xo);let fk=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=r,this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let i=!1;const a=(t??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),n&&(this.headers.Prefer=`count=${n}`),new Ra.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const a=t.reduce((o,c)=>o.concat(Object.keys(c)),[]);if(a.length>0){const o=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",o.join(","))}}return new Ra.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){const a="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),s&&o.push(`count=${s}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const c=t.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new Ra.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),this.headers.Prefer=s.join(","),new Ra.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Ra.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};ju.default=fk;var Fu={},Pu={};Object.defineProperty(Pu,"__esModule",{value:!0});Pu.version=void 0;Pu.version="0.0.0-automated";Object.defineProperty(Fu,"__esModule",{value:!0});Fu.DEFAULT_HEADERS=void 0;const hk=Pu;Fu.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${hk.version}`};var Ov=Or&&Or.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(hh,"__esModule",{value:!0});const mk=Ov(ju),pk=Ov(Xo),gk=Fu;let xk=class Fv{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},gk.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new mk.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Fv(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:i}={}){let a;const o=new URL(`${this.url}/rpc/${t}`);let c;n||s?(a=n?"HEAD":"GET",Object.entries(r).filter(([u,f])=>f!==void 0).map(([u,f])=>[u,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([u,f])=>{o.searchParams.append(u,f)})):(a="POST",c=r);const d=Object.assign({},this.headers);return i&&(d.Prefer=`count=${i}`),new pk.default({method:a,url:o,headers:d,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};hh.default=xk;var xa=Or&&Or.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tr,"__esModule",{value:!0});tr.PostgrestError=tr.PostgrestBuilder=tr.PostgrestTransformBuilder=tr.PostgrestFilterBuilder=tr.PostgrestQueryBuilder=tr.PostgrestClient=void 0;const Pv=xa(hh);tr.PostgrestClient=Pv.default;const Dv=xa(ju);tr.PostgrestQueryBuilder=Dv.default;const Rv=xa(Xo);tr.PostgrestFilterBuilder=Rv.default;const Iv=xa(Cu);tr.PostgrestTransformBuilder=Iv.default;const Lv=xa(Au);tr.PostgrestBuilder=Lv.default;const Mv=xa(Ou);tr.PostgrestError=Mv.default;var vk=tr.default={PostgrestClient:Pv.default,PostgrestQueryBuilder:Dv.default,PostgrestFilterBuilder:Rv.default,PostgrestTransformBuilder:Iv.default,PostgrestBuilder:Lv.default,PostgrestError:Mv.default};const{PostgrestClient:yk,PostgrestQueryBuilder:RD,PostgrestFilterBuilder:ID,PostgrestTransformBuilder:LD,PostgrestBuilder:MD,PostgrestError:BD}=vk;let J0;typeof window>"u"?J0=require("ws"):J0=window.WebSocket;const wk=J0,_k="2.11.10",Ek={"X-Client-Info":`realtime-js/${_k}`},Sk="1.0.0",Bv=1e4,Tk=1e3;var zi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(zi||(zi={}));var zt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(zt||(zt={}));var Ur;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ur||(Ur={}));var Q0;(function(e){e.websocket="websocket"})(Q0||(Q0={}));var Ds;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ds||(Ds={}));class bk{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2);let a=this.HEADER_LENGTH+2;const o=n.decode(t.slice(a,a+s));a=a+s;const c=n.decode(t.slice(a,a+i));a=a+i;const d=JSON.parse(n.decode(t.slice(a,t.byteLength)));return{ref:null,topic:o,event:c,payload:d}}}class $v{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ze;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ze||(ze={}));const Dp=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,a)=>(i[a]=kk(a,e,t,s),i),{})},kk=(e,t,r,n)=>{const s=t.find(o=>o.name===e),i=s==null?void 0:s.type,a=r[e];return i&&!n.includes(i)?Uv(i,a):Z0(a)},Uv=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Ak(t,r)}switch(e){case ze.bool:return Nk(t);case ze.float4:case ze.float8:case ze.int2:case ze.int4:case ze.int8:case ze.numeric:case ze.oid:return jk(t);case ze.json:case ze.jsonb:return Ck(t);case ze.timestamp:return Ok(t);case ze.abstime:case ze.date:case ze.daterange:case ze.int4range:case ze.int8range:case ze.money:case ze.reltime:case ze.text:case ze.time:case ze.timestamptz:case ze.timetz:case ze.tsrange:case ze.tstzrange:return Z0(t);default:return Z0(t)}},Z0=e=>e,Nk=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},jk=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Ck=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Ak=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const a=e.slice(1,r);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>Uv(t,o))}return e},Ok=e=>typeof e=="string"?e.replace(" ","T"):e,Wv=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Cd{constructor(t,r,n={},s=Bv){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Rp;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Rp||(Rp={}));class ro{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ro.syncState(this.state,s,i,a),this.pendingDiffs.forEach(c=>{this.state=ro.syncDiff(this.state,c,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=ro.syncDiff(this.state,s,i,a),o())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const i=this.cloneDeep(t),a=this.transformState(r),o={},c={};return this.map(i,(d,u)=>{a[d]||(c[d]=u)}),this.map(a,(d,u)=>{const f=i[d];if(f){const h=u.map(g=>g.presence_ref),p=f.map(g=>g.presence_ref),x=u.filter(g=>p.indexOf(g.presence_ref)<0),m=f.filter(g=>h.indexOf(g.presence_ref)<0);x.length>0&&(o[d]=x),m.length>0&&(c[d]=m)}else o[d]=u}),this.syncDiff(i,{joins:o,leaves:c},n,s)}static syncDiff(t,r,n,s){const{joins:i,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(o,c)=>{var d;const u=(d=t[o])!==null&&d!==void 0?d:[];if(t[o]=this.cloneDeep(c),u.length>0){const f=t[o].map(p=>p.presence_ref),h=u.filter(p=>f.indexOf(p.presence_ref)<0);t[o].unshift(...h)}n(o,u,c)}),this.map(a,(o,c)=>{let d=t[o];if(!d)return;const u=c.map(f=>f.presence_ref);d=d.filter(f=>u.indexOf(f.presence_ref)<0),t[o]=d,s(o,d,c),d.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ip;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Ip||(Ip={}));var Lp;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Lp||(Lp={}));var pn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(pn||(pn={}));class mh{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=zt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Cd(this,Ur.join,this.params,this.timeout),this.rejoinTimer=new $v(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=zt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=zt.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=zt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ur.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new ro(this),this.broadcastEndpointURL=Wv(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a,private:o}}=this.params;this._onError(u=>t==null?void 0:t(pn.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(pn.CLOSED));const c={},d={broadcast:i,presence:a,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&s!==void 0?s:[],private:o};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:d},c)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var f;if(this.socket.setAuth(),u===void 0){t==null||t(pn.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,p=(f=h==null?void 0:h.length)!==null&&f!==void 0?f:0,x=[];for(let m=0;m<p;m++){const g=h[m],{filter:{event:_,schema:y,table:v,filter:w}}=g,N=u&&u[m];if(N&&N.event===_&&N.schema===y&&N.table===v&&N.filter===w)x.push(Object.assign(Object.assign({},g),{id:N.id}));else{this.unsubscribe(),this.state=zt.errored,t==null||t(pn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(pn.SUBSCRIBED);return}}).receive("error",u=>{this.state=zt.errored,t==null||t(pn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(pn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:a}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,c;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=zt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ur.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(n=>{const s=new Cd(this,Ur.leave,{},t);s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Cd(this,t,r,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,i;const a=t.toLocaleLowerCase(),{close:o,error:c,leave:d,join:u}=Ur;if(n&&[o,c,d,u].indexOf(a)>=0&&n!==this._joinRef())return;let h=this._onMessage(a,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var x,m,g;return((x=p.filter)===null||x===void 0?void 0:x.event)==="*"||((g=(m=p.filter)===null||m===void 0?void 0:m.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===a}).map(p=>p.callback(h,n)):(i=this.bindings[a])===null||i===void 0||i.filter(p=>{var x,m,g,_,y,v;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in p){const w=p.id,N=(x=p.filter)===null||x===void 0?void 0:x.event;return w&&((m=r.ids)===null||m===void 0?void 0:m.includes(w))&&(N==="*"||(N==null?void 0:N.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const w=(y=(_=p==null?void 0:p.filter)===null||_===void 0?void 0:_.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return w==="*"||w===((v=r==null?void 0:r.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===a}).map(p=>{if(typeof h=="object"&&"ids"in h){const x=h.data,{schema:m,table:g,commit_timestamp:_,type:y,errors:v}=x;h=Object.assign(Object.assign({},{schema:m,table:g,commit_timestamp:_,eventType:y,new:{},old:{},errors:v}),this._getPayloadRecords(x))}p.callback(h,n)})}_isClosed(){return this.state===zt.closed}_isJoined(){return this.state===zt.joined}_isJoining(){return this.state===zt.joining}_isLeaving(){return this.state===zt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&mh.isEqual(s.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ur.close,{},t)}_onError(t){this._on(Ur.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=zt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Dp(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Dp(t.columns,t.old_record)),r}}const Mp=()=>{},Fk=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Pk{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=Ek,this.params={},this.timeout=Bv,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Mp,this.ref=0,this.logger=Mp,this.conn=null,this.sendBuffer=[],this.serializer=new bk,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>Ko(async()=>{const{default:c}=await Promise.resolve().then(()=>ga);return{default:c}},void 0).then(({default:c})=>c(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${t}/${Q0.websocket}`,this.httpEndpoint=Wv(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const s=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,a)=>a(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new $v(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=wk),this.transport){typeof window<"u"&&this.transport===window.WebSocket?this.conn=new this.transport(this.endpointURL()):this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection();return}this.conn=new Dk(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Sk}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels=this.channels.filter(n=>n._joinRef!==t._joinRef),this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case zi.connecting:return Ds.Connecting;case zi.open:return Ds.Open;case zi.closing:return Ds.Closing;default:return Ds.Closed}}isConnected(){return this.connectionState()===Ds.Open}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new mh(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:s,ref:i}=t,a=()=>{this.encode(t,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{r&&n.updateJoinPayload({access_token:r,version:this.headers&&this.headers["X-Client-Info"]}),n.joinedOnce&&n._isJoined()&&n._push(Ur.access_token,{access_token:r})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(Tk,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:s,payload:i,ref:a}=r;n==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${a&&"("+a+")"||""}`,i),Array.from(this.channels).filter(o=>o._isMember(n)).forEach(o=>o._trigger(s,i,a)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ur.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Fk],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class Dk{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=zi.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class ph extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function gt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Rk extends ph{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class ef extends ph{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var Ik=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(u){try{d(n.next(u))}catch(f){a(f)}}function c(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?i(u.value):s(u.value).then(o,c)}d((n=n.apply(e,t||[])).next())})};const Hv=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ko(async()=>{const{default:n}=await Promise.resolve().then(()=>ga);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Lk=()=>Ik(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ko(()=>Promise.resolve().then(()=>ga),void 0)).Response:Response}),tf=e=>{if(Array.isArray(e))return e.map(r=>tf(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=tf(n)}),t};var si=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(u){try{d(n.next(u))}catch(f){a(f)}}function c(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?i(u.value):s(u.value).then(o,c)}d((n=n.apply(e,t||[])).next())})};const Ad=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Mk=(e,t,r)=>si(void 0,void 0,void 0,function*(){const n=yield Lk();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{t(new Rk(Ad(s),e.status||500))}).catch(s=>{t(new ef(Ad(s),s))}):t(new ef(Ad(e),e))}),Bk=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),r))};function Yo(e,t,r,n,s,i){return si(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,Bk(t,n,s,i)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>a(c)).catch(c=>Mk(c,o,n))})})}function $c(e,t,r,n){return si(this,void 0,void 0,function*(){return Yo(e,"GET",t,r,n)})}function zn(e,t,r,n,s){return si(this,void 0,void 0,function*(){return Yo(e,"POST",t,n,s,r)})}function $k(e,t,r,n,s){return si(this,void 0,void 0,function*(){return Yo(e,"PUT",t,n,s,r)})}function Uk(e,t,r,n){return si(this,void 0,void 0,function*(){return Yo(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function zv(e,t,r,n,s){return si(this,void 0,void 0,function*(){return Yo(e,"DELETE",t,n,s,r)})}var Zt=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(u){try{d(n.next(u))}catch(f){a(f)}}function c(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?i(u.value):s(u.value).then(o,c)}d((n=n.apply(e,t||[])).next())})};const Wk={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Bp={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Hk{constructor(t,r={},n,s){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Hv(s)}uploadOrUpdate(t,r,n,s){return Zt(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},Bp),s);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,c&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),f=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:i,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),h=yield f.json();return f.ok?{data:{path:d,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(i){if(gt(i))return{data:null,error:i};throw i}})}upload(t,r,n){return Zt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return Zt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:Bp.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const f=yield this.fetch(o.toString(),{method:"PUT",body:c,headers:u}),h=yield f.json();return f.ok?{data:{path:i,fullPath:h.Key},error:null}:{data:null,error:h}}catch(c){if(gt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Zt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield zn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new ph("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:o},error:null}}catch(n){if(gt(n))return{data:null,error:n};throw n}})}update(t,r,n){return Zt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Zt(this,void 0,void 0,function*(){try{return{data:yield zn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(gt(s))return{data:null,error:s};throw s}})}copy(t,r,n){return Zt(this,void 0,void 0,function*(){try{return{data:{path:(yield zn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(gt(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return Zt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield zn(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(s){if(gt(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return Zt(this,void 0,void 0,function*(){try{const s=yield zn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(s){if(gt(s))return{data:null,error:s};throw s}})}download(t,r){return Zt(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield $c(this.fetch,`${this.url}/${s}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(gt(o))return{data:null,error:o};throw o}})}info(t){return Zt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield $c(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:tf(n),error:null}}catch(n){if(gt(n))return{data:null,error:n};throw n}})}exists(t){return Zt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield Uk(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(gt(n)&&n instanceof ef){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&s.push(c);let d=s.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${d}`)}}}remove(t){return Zt(this,void 0,void 0,function*(){try{return{data:yield zv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(gt(r))return{data:null,error:r};throw r}})}list(t,r,n){return Zt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Wk),r),{prefix:t||""});return{data:yield zn(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(gt(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const zk="2.7.1",Vk={"X-Client-Info":`storage-js/${zk}`};var mi=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(u){try{d(n.next(u))}catch(f){a(f)}}function c(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?i(u.value):s(u.value).then(o,c)}d((n=n.apply(e,t||[])).next())})};class Gk{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},Vk),r),this.fetch=Hv(n)}listBuckets(){return mi(this,void 0,void 0,function*(){try{return{data:yield $c(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(gt(t))return{data:null,error:t};throw t}})}getBucket(t){return mi(this,void 0,void 0,function*(){try{return{data:yield $c(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(gt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return mi(this,void 0,void 0,function*(){try{return{data:yield zn(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(gt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return mi(this,void 0,void 0,function*(){try{return{data:yield $k(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(gt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return mi(this,void 0,void 0,function*(){try{return{data:yield zn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(gt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return mi(this,void 0,void 0,function*(){try{return{data:yield zv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(gt(r))return{data:null,error:r};throw r}})}}class qk extends Gk{constructor(t,r={},n){super(t,r,n)}from(t){return new Hk(this.url,this.headers,t,this.fetch)}}const Kk="2.50.0";let Ha="";typeof Deno<"u"?Ha="deno":typeof document<"u"?Ha="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ha="react-native":Ha="node";const Xk={"X-Client-Info":`supabase-js-${Ha}/${Kk}`},Yk={headers:Xk},Jk={schema:"public"},Qk={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Zk={};var e4=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(u){try{d(n.next(u))}catch(f){a(f)}}function c(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?i(u.value):s(u.value).then(o,c)}d((n=n.apply(e,t||[])).next())})};const t4=e=>{let t;return e?t=e:typeof fetch>"u"?t=jv:t=fetch,(...r)=>t(...r)},r4=()=>typeof Headers>"u"?Cv:Headers,n4=(e,t,r)=>{const n=t4(r),s=r4();return(i,a)=>e4(void 0,void 0,void 0,function*(){var o;const c=(o=yield t())!==null&&o!==void 0?o:e;let d=new s(a==null?void 0:a.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),n(i,Object.assign(Object.assign({},a),{headers:d}))})};var s4=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(u){try{d(n.next(u))}catch(f){a(f)}}function c(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?i(u.value):s(u.value).then(o,c)}d((n=n.apply(e,t||[])).next())})};function i4(e){return e.endsWith("/")?e:e+"/"}function a4(e,t){var r,n;const{db:s,auth:i,realtime:a,global:o}=e,{db:c,auth:d,realtime:u,global:f}=t,h={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},u),a),global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>s4(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}const Vv="2.70.0",Ei=30*1e3,rf=3,Od=rf*Ei,o4="http://localhost:9999",l4="supabase.auth.token",c4={"X-Client-Info":`gotrue-js/${Vv}`},nf="X-Supabase-Api-Version",Gv={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},u4=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,d4=6e5;class gh extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ne(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class f4 extends gh{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function h4(e){return Ne(e)&&e.name==="AuthApiError"}class qv extends gh{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ts extends gh{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class Un extends Ts{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function m4(e){return Ne(e)&&e.name==="AuthSessionMissingError"}class kl extends Ts{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Nl extends Ts{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class jl extends Ts{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function p4(e){return Ne(e)&&e.name==="AuthImplicitGrantRedirectError"}class $p extends Ts{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class sf extends Ts{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Fd(e){return Ne(e)&&e.name==="AuthRetryableFetchError"}class Up extends Ts{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class no extends Ts{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Uc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Wp=` 	
\r=`.split(""),g4=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Wp.length;t+=1)e[Wp[t].charCodeAt(0)]=-2;for(let t=0;t<Uc.length;t+=1)e[Uc[t].charCodeAt(0)]=t;return e})();function Hp(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Uc[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Uc[n]),t.queuedBits-=6}}function Kv(e,t,r){const n=g4[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function zp(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=a=>{y4(a,n,r)};for(let a=0;a<e.length;a+=1)Kv(e.charCodeAt(a),s,i);return t.join("")}function x4(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function v4(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}x4(n,t)}}function y4(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function w4(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)Kv(e.charCodeAt(s),r,n);return new Uint8Array(t)}function _4(e){const t=[];return v4(e,r=>t.push(r)),new Uint8Array(t)}function E4(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>Hp(s,r,n)),Hp(null,r,n),t.join("")}function S4(e){return Math.round(Date.now()/1e3)+e}function T4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Mr=()=>typeof window<"u"&&typeof document<"u",Cs={tested:!1,writable:!1},so=()=>{if(!Mr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Cs.tested)return Cs.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Cs.tested=!0,Cs.writable=!0}catch{Cs.tested=!0,Cs.writable=!1}return Cs.writable};function b4(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const Xv=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ko(async()=>{const{default:n}=await Promise.resolve().then(()=>ga);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},k4=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Yv=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Cl=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Al=async(e,t)=>{await e.removeItem(t)};class Du{constructor(){this.promise=new Du.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Du.promiseConstructor=Promise;function Pd(e){const t=e.split(".");if(t.length!==3)throw new no("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!u4.test(t[n]))throw new no("JWT not in base64url format");return{header:JSON.parse(zp(t[0])),payload:JSON.parse(zp(t[1])),signature:w4(t[2]),raw:{header:t[0],payload:t[1]}}}async function N4(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function j4(e,t){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await e(i);if(!t(i,null,a)){n(a);return}}catch(a){if(!t(i,a)){s(a);return}}})()})}function C4(e){return("0"+e.toString(16)).substr(-2)}function A4(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,C4).join("")}async function O4(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function F4(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await O4(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function pi(e,t,r=!1){const n=A4();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await Yv(e,`${t}-code-verifier`,s);const i=await F4(n);return[i,n===i?"plain":"s256"]}const P4=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function D4(e){const t=e.headers.get(nf);if(!t||!t.match(P4))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function R4(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function I4(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const L4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function gi(e){if(!L4.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var M4=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const Ps=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),B4=[502,503,504];async function Vp(e){var t;if(!k4(e))throw new sf(Ps(e),0);if(B4.includes(e.status))throw new sf(Ps(e),e.status);let r;try{r=await e.json()}catch(i){throw new qv(Ps(i),i)}let n;const s=D4(e);if(s&&s.getTime()>=Gv["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Up(Ps(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Un}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new Up(Ps(r),e.status,r.weak_password.reasons);throw new f4(Ps(r),e.status||500,n)}const $4=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Fe(e,t,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[nf]||(i[nf]=Gv["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const a=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await U4(e,t,r+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function U4(e,t,r,n,s,i){const a=$4(t,n,s,i);let o;try{o=await e(r,Object.assign({},a))}catch(c){throw console.error(c),new sf(Ps(c),0)}if(o.ok||await Vp(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(c){await Vp(c)}}function hn(e){var t;let r=null;V4(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=S4(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Gp(e){const t=hn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Yn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function W4(e){return{data:e,error:null}}function H4(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,a=M4(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},c=Object.assign({},a);return{data:{properties:o,user:c},error:null}}function z4(e){return e}function V4(e){return e.access_token&&e.refresh_token&&e.expires_in}const Dd=["global","local","others"];var G4=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class q4{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Xv(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=Dd[0]){if(Dd.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Dd.join(", ")}`);try{return await Fe(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ne(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Fe(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Yn})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=G4(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Fe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:H4,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ne(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Fe(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Yn})}catch(r){if(Ne(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,i,a,o,c;try{const d={nextPage:null,lastPage:0,total:0},u=await Fe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:z4});if(u.error)throw u.error;const f=await u.json(),h=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(c=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(x=>{const m=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(x.split(";")[1].split("=")[1]);d[`${g}Page`]=m}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Ne(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){gi(t);try{return await Fe(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Yn})}catch(r){if(Ne(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){gi(t);try{return await Fe(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Yn})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){gi(t);try{return await Fe(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Yn})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){gi(t.userId);try{const{data:r,error:n}=await Fe(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _deleteFactor(t){gi(t.userId),gi(t.id);try{return{data:await Fe(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}}const K4={getItem:e=>so()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{so()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{so()&&globalThis.localStorage.removeItem(e)}};function qp(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function X4(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const xi={debug:!!(globalThis&&so()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Jv extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Y4 extends Jv{}async function J4(e,t,r){xi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),xi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){xi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{xi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw xi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Y4(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(xi.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}X4();const Q4={url:o4,storageKey:l4,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:c4,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Kp(e,t,r){return await r()}class Po{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Po.nextInstanceID,Po.nextInstanceID+=1,this.instanceID>0&&Mr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},Q4),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new q4({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Xv(s.fetch),this.lock=s.lock||Kp,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Mr()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=J4:this.lock=Kp,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:so()?this.storage=K4:(this.memoryStorage={},this.storage=qp(this.memoryStorage)):(this.memoryStorage={},this.storage=qp(this.memoryStorage)),Mr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Vv}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=b4(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Mr()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),p4(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ne(r)?{error:r}:{error:new qv("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const i=await Fe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:hn}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const c=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Ne(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,s;try{let i;if("email"in t){const{email:u,password:f,options:h}=t;let p=null,x=null;this.flowType==="pkce"&&([p,x]=await pi(this.storage,this.storageKey)),i=await Fe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:x},xform:hn})}else if("phone"in t){const{phone:u,password:f,options:h}=t;i=await Fe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:hn})}else throw new Nl("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const c=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Ne(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:a,options:o}=t;r=await Fe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Gp})}else if("phone"in t){const{phone:i,password:a,options:o}=t;r=await Fe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Gp})}else throw new Nl("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new kl}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Ne(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,s,i,a,o,c,d,u,f,h,p;let x,m;if("message"in t)x=t.message,m=t.signature;else{const{chain:g,wallet:_,statement:y,options:v}=t;let w;if(Mr())if(typeof _=="object")w=_;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))w=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=_}const N=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const E=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:N.host,uri:N.href}),y?{statement:y}:null));let T;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")T=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)T=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)x=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),m=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${N.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${N.href}`,`Issued At: ${(s=(n=v==null?void 0:v.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=v==null?void 0:v.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((a=v==null?void 0:v.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((d=v==null?void 0:v.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((f=(u=v==null?void 0:v.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...v.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const E=await w.signMessage(new TextEncoder().encode(x),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=E}}try{const{data:g,error:_}=await Fe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:E4(m)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:hn});if(_)throw _;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new kl}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:_})}catch(g){if(Ne(g))return{data:{user:null,session:null},error:g};throw g}}async _exchangeCodeForSession(t){const r=await Cl(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:a}=await Fe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:hn});if(await Al(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new kl}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(Ne(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:i,nonce:a}=t,o=await Fe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:hn}),{data:c,error:d}=o;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new kl}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(r){if(Ne(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,i,a;try{if("email"in t){const{email:o,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await pi(this.storage,this.storageKey));const{error:f}=await Fe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:o,options:c}=t,{data:d,error:u}=await Fe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(a=c==null?void 0:c.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new Nl("You must provide either an email or phone number.")}catch(o){if(Ne(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await Fe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:hn});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,d=a.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(s){if(Ne(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await pi(this.storage,this.storageKey)),await Fe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:W4})}catch(i){if(Ne(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Un;const{error:s}=await Fe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(Ne(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:i}=t,{error:a}=await Fe(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){const{phone:n,type:s,options:i}=t,{data:a,error:o}=await Fe(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new Nl("You must provide either an email or phone number and a type")}catch(r){if(Ne(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Cl(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Od:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let a=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,d,u)=>(!a&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:t},error:null}}const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Fe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Yn}):await this._useSession(async r=>{var n,s,i;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Un}:await Fe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Yn})})}catch(r){if(Ne(r))return m4(r)&&(await this._removeSession(),await Al(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new Un;const a=s.session;let o=null,c=null;this.flowType==="pkce"&&t.email!=null&&([o,c]=await pi(this.storage,this.storageKey));const{data:d,error:u}=await Fe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:c}),jwt:a.access_token,xform:Yn});if(u)throw u;return a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Un;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:a}=Pd(t.access_token);if(a.exp&&(n=a.exp,s=n<=r),s){const{session:o,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Ne(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:o}=r;if(o)throw o;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Un;const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Ne(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Mr())throw new jl("No browser detected.");if(t.error||t.error_description||t.error_code)throw new jl(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new $p("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new jl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new $p("No code detected.");const{data:y,error:v}=await this._exchangeCodeForSession(t.code);if(v)throw v;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:o,expires_at:c,token_type:d}=t;if(!i||!o||!a||!d)throw new jl("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let h=u+f;c&&(h=parseInt(c));const p=h-u;p*1e3<=Ei&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${f}s`);const x=h-f;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,h,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,h,u);const{data:m,error:g}=await this._getUser(i);if(g)throw g;const _={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:f,expires_at:h,refresh_token:a,token_type:d,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:_,redirectType:t.type},error:null}}catch(n){if(Ne(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Cl(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const a=(n=s.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,t);if(o&&!(h4(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await Al(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=T4(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await pi(this.storage,this.storageKey,!0));try{return await Fe(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Ne(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var a,o,c,d,u;const{data:f,error:h}=i;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Fe(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return Mr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Ne(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)throw a;return await Fe(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await j4(async s=>(s>0&&await N4(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Fe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:hn})),(s,i)=>{const a=200*Math.pow(2,s);return i&&Fd(i)&&Date.now()+a-n<Ei})}catch(n){if(this._debug(r,"error",n),Ne(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Mr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await Cl(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const s=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Od;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${Od}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),Fd(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Un;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Du;const{data:i,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!i.session)throw new Un;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),Ne(i)){const a={session:null,error:i};return Fd(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(c){i.push(c)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Yv(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await Al(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Mr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ei);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/Ei);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Ei}ms, refresh threshold is ${rf} ticks`),s<=rf&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Jv)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Mr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,a]=await pi(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Fe(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:d}=await Fe(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:a,error:o}=await Fe(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Fe(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:i}=t;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Pd(s.access_token);let o=null;a.aal&&(o=a.aal);let c=o;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(a=>a.kid===t);if(n||(n=this.jwks.keys.find(a=>a.kid===t),n&&this.jwks_cached_at+d4>Date.now()))return n;const{data:s,error:i}=await Fe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new no("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(a=>a.kid===t),!n)throw new no("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:p,error:x}=await this.getSession();if(x||!p.session)return{data:null,error:x};n=p.session.access_token}const{header:s,payload:i,signature:a,raw:{header:o,payload:c}}=Pd(n);if(R4(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:i,header:s,signature:a},error:null}}const d=I4(s.alg),u=await this.fetchJwk(s.kid,r),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,a,_4(`${o}.${c}`)))throw new no("Invalid JWT signature");return{data:{claims:i,header:s,signature:a},error:null}}catch(n){if(Ne(n))return{data:null,error:n};throw n}}}Po.nextInstanceID=0;const Z4=Po;class eN extends Z4{constructor(t){super(t)}}var tN=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(u){try{d(n.next(u))}catch(f){a(f)}}function c(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?i(u.value):s(u.value).then(o,c)}d((n=n.apply(e,t||[])).next())})};class rN{constructor(t,r,n){var s,i,a;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=i4(t),c=new URL(o);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,u={db:Jk,realtime:Zk,auth:Object.assign(Object.assign({},Qk),{storageKey:d}),global:Yk},f=a4(n??{},u);this.storageKey=(s=f.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=f.global.headers)!==null&&i!==void 0?i:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=f.auth)!==null&&a!==void 0?a:{},this.headers,f.global.fetch),this.fetch=n4(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new yk(new URL("rest/v1",c).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new Xb(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new qk(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return tN(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:i,flowType:a,lock:o,debug:c},d,u){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new eN({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),d),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,flowType:a,lock:o,debug:c,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Pk(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const nN=(e,t,r)=>new rN(e,t,r),Wc="https://nyzdivpchfwywpsdgihw.supabase.co".trim(),Vi="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im55emRpdnBjaGZ3eXdwc2RnaWh3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkwNDAwNzYsImV4cCI6MjA2NDYxNjA3Nn0.Pb72YvgROvQ2jGCgyvVFIRzzadWYQuoxeuXX4MWAGA0".trim();console.log("Supabase URL:",Wc);console.log("Supabase Key length:",Vi==null?void 0:Vi.length);if(!Wc||Wc==="undefined")throw new Error("Missing or invalid VITE_SUPABASE_URL environment variable");if(!Vi||Vi==="undefined")throw new Error("Missing or invalid VITE_SUPABASE_ANON_KEY environment variable");const me=nN(Wc,Vi,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),vi={emailService:{from:"noreply@company.com",fromName:"",replyTo:"support@company.com"},pushService:{vapidPublicKey:"",vapidPrivateKey:"",subject:"mailto:support@company.com"},appUrl:"http://localhost:5173"};class sN{async getUserPreferences(t){try{const{data:r,error:n}=await me.from("notification_preferences").select("*").eq("user_id",t).single();return n?(console.error("Error fetching notification preferences:",n),null):this.mapPreferencesFromDb(r)}catch(r){return console.error("Error in getUserPreferences:",r),null}}async updateUserPreferences(t,r){try{const n=this.mapPreferencesToDb(r),{error:s}=await me.from("notification_preferences").upsert({user_id:t,...n},{onConflict:"user_id"});return s?(console.error("Error updating notification preferences:",s),!1):!0}catch(n){return console.error("Error in updateUserPreferences:",n),!1}}async sendEmail(t){try{const{data:r,error:n}=await me.functions.invoke("send-email",{body:{to:t.to,templateName:t.templateName,variables:t.variables,from:vi.emailService.from,fromName:vi.emailService.fromName,replyTo:vi.emailService.replyTo}});if(n)throw n;return t.userId&&await this.logNotification({userId:t.userId,type:"email",category:this.getNotificationCategory(t.templateName),subject:r.subject,content:r.bodyText,metadata:t.metadata||{},status:"sent",sentAt:new Date}),{success:!0,messageId:r.messageId}}catch(r){return console.error("Error sending email:",r),t.userId&&await this.logNotification({userId:t.userId,type:"email",category:this.getNotificationCategory(t.templateName),metadata:t.metadata||{},status:"failed",errorMessage:r instanceof Error?r.message:"Unknown error"}),{success:!1,error:r instanceof Error?r.message:"Failed to send email"}}}async sendPush(t){try{const r=await this.getUserPreferences(t.userId);if(!(r!=null&&r.pushEnabled)||!r.pushSubscription)return{success:!1,error:"Push notifications not enabled for user"};const{data:n,error:s}=await me.functions.invoke("send-push",{body:{subscription:r.pushSubscription,notification:{title:t.title,body:t.body,icon:t.icon||"/icon-192x192.png",badge:t.badge||"/badge-72x72.png",tag:t.tag,data:t.data,requireInteraction:t.requireInteraction,actions:t.actions}}});if(s)throw s;return await this.logNotification({userId:t.userId,type:"push",category:this.getCategoryFromData(t.data),subject:t.title,content:t.body,metadata:t.data||{},status:"sent",sentAt:new Date}),{success:!0}}catch(r){return console.error("Error sending push notification:",r),await this.logNotification({userId:t.userId,type:"push",category:this.getCategoryFromData(t.data),subject:t.title,content:t.body,metadata:t.data||{},status:"failed",errorMessage:r instanceof Error?r.message:"Unknown error"}),{success:!1,error:r instanceof Error?r.message:"Failed to send push notification"}}}async subscribeToPush(t,r){try{const{error:n}=await me.from("notification_preferences").update({push_subscription:r,push_enabled:!0}).eq("user_id",t);return n?(console.error("Error saving push subscription:",n),!1):!0}catch(n){return console.error("Error in subscribeToPush:",n),!1}}async unsubscribeFromPush(t){try{const{error:r}=await me.from("notification_preferences").update({push_subscription:null,push_enabled:!1}).eq("user_id",t);return r?(console.error("Error removing push subscription:",r),!1):!0}catch(r){return console.error("Error in unsubscribeFromPush:",r),!1}}async notifyScheduleCreated(t){console.log(`=== notifyScheduleCreated: ${t.user.name} ===`);const r=`${t.schedule.title}`,n=`${this.formatDateTime(t.schedule.startTime)} - ${this.formatDateTime(t.schedule.endTime)}${t.schedule.location?`
: ${t.schedule.location}`:""}`;await this.logNotification({userId:t.user.id,type:"email",category:"schedule_created",subject:r,content:n,metadata:{scheduleId:t.schedule.id,scheduleTitle:t.schedule.title,scheduleType:t.schedule.type,startTime:t.schedule.startTime,endTime:t.schedule.endTime},status:"sent",sentAt:new Date,isRead:!1}),console.log("");const s=await this.getUserPreferences(t.user.id);if(console.log(":",s),!s){console.log("");return}s.emailEnabled&&s.emailScheduleCreated&&await this.sendEmail({to:t.user.email,templateName:"schedule_created",variables:{userName:t.user.name,title:t.schedule.title,startTime:this.formatDateTime(t.schedule.startTime),endTime:this.formatDateTime(t.schedule.endTime),type:t.schedule.type,location:t.schedule.location||"",details:t.schedule.details||"",meetLink:t.schedule.meetLink||"",calendarLink:`${vi.appUrl}/calendar`},userId:t.user.id,metadata:{scheduleId:t.schedule.id}}),s.pushEnabled&&s.pushScheduleCreated&&await this.sendPush({userId:t.user.id,title:"",body:`${t.schedule.title} - ${this.formatDateTime(t.schedule.startTime)}`,tag:`schedule-${t.schedule.id}`,data:{type:"schedule_created",scheduleId:t.schedule.id},actions:[{action:"view",title:""},{action:"dismiss",title:""}]})}async notifyScheduleUpdated(t){var n;const r=await this.getUserPreferences(t.user.id);r&&(r.emailEnabled&&r.emailScheduleUpdated&&await this.sendEmail({to:t.user.email,templateName:"schedule_updated",variables:{userName:t.user.name,title:t.schedule.title,startTime:this.formatDateTime(t.schedule.startTime),endTime:this.formatDateTime(t.schedule.endTime),type:t.schedule.type,location:t.schedule.location||"",details:t.schedule.details||"",meetLink:t.schedule.meetLink||"",changes:((n=t.changes)==null?void 0:n.join(`
`))||"",calendarLink:`${vi.appUrl}/calendar`},userId:t.user.id,metadata:{scheduleId:t.schedule.id}}),r.pushEnabled&&r.pushScheduleUpdated&&await this.sendPush({userId:t.user.id,title:"",body:`${t.schedule.title} - ${this.formatDateTime(t.schedule.startTime)}`,tag:`schedule-${t.schedule.id}`,data:{type:"schedule_updated",scheduleId:t.schedule.id}}))}async notifyScheduleDeleted(t){const r=await this.getUserPreferences(t.user.id);r&&(r.emailEnabled&&r.emailScheduleDeleted&&await this.sendEmail({to:t.user.email,templateName:"schedule_deleted",variables:{userName:t.user.name,title:t.schedule.title,startTime:this.formatDateTime(t.schedule.startTime),endTime:this.formatDateTime(t.schedule.endTime),type:t.schedule.type,deletedBy:t.deletedBy||"",reason:t.reason||""},userId:t.user.id,metadata:{scheduleId:t.schedule.id}}),r.pushEnabled&&r.pushScheduleDeleted&&await this.sendPush({userId:t.user.id,title:"",body:`${t.schedule.title} - ${this.formatDateTime(t.schedule.startTime)}`,tag:`schedule-${t.schedule.id}`,data:{type:"schedule_deleted",scheduleId:t.schedule.id}}))}async notifyScheduleReminder(t){const r=await this.getUserPreferences(t.user.id);r&&(r.emailEnabled&&r.emailScheduleReminder&&await this.sendEmail({to:t.user.email,templateName:"schedule_reminder",variables:{userName:t.user.name,title:t.schedule.title,startTime:this.formatDateTime(t.schedule.startTime),endTime:this.formatDateTime(t.schedule.endTime),type:t.schedule.type,location:t.schedule.location||"",details:t.schedule.details||"",meetLink:t.schedule.meetLink||"",participants:t.schedule.participants.join(", "),timeUntilEvent:t.timeUntilEvent||"15",calendarLink:`${vi.appUrl}/calendar`},userId:t.user.id,metadata:{scheduleId:t.schedule.id}}),r.pushEnabled&&r.pushScheduleReminder&&await this.sendPush({userId:t.user.id,title:`: ${t.schedule.title}`,body:`${t.timeUntilEvent}`,tag:`reminder-${t.schedule.id}`,data:{type:"schedule_reminder",scheduleId:t.schedule.id},requireInteraction:!0,actions:[{action:"view",title:""},{action:"join",title:""}]}))}async getUserNotificationLogs(t,r=50,n=0){try{const{data:s,error:i}=await me.from("notification_logs").select("*").eq("user_id",t).order("created_at",{ascending:!1}).range(n,n+r-1);return i?(console.error("Error fetching notification logs:",i),[]):s.map(this.mapNotificationLogFromDb)}catch(s){return console.error("Error in getUserNotificationLogs:",s),[]}}async markNotificationAsRead(t){try{const{error:r}=await me.from("notification_logs").update({is_read:!0,read_at:new Date().toISOString()}).eq("id",t);return r?(console.error("Error marking notification as read:",r),!1):!0}catch(r){return console.error("Error in markNotificationAsRead:",r),!1}}async markAllNotificationsAsRead(t){try{const{error:r}=await me.from("notification_logs").update({is_read:!0,read_at:new Date().toISOString()}).eq("user_id",t).eq("is_read",!1);return r?(console.error("Error marking all notifications as read:",r),!1):!0}catch(r){return console.error("Error in markAllNotificationsAsRead:",r),!1}}async logNotification(t){try{console.log("===  ==="),console.log(":",t);const{data:r,error:n}=await me.from("notification_logs").insert({user_id:t.userId,type:t.type,category:t.category,subject:t.subject,content:t.content,metadata:t.metadata,status:t.status,error_message:t.errorMessage,sent_at:t.sentAt}).select();n?(console.error(":",n),console.error(":",n.details,n.hint,n.message)):console.log(":",r)}catch(r){console.error("Error in logNotification:",r)}}formatDateTime(t){return new Intl.DateTimeFormat("ja-JP",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Tokyo"}).format(t)}getNotificationCategory(t){return{schedule_created:"schedule_created",schedule_updated:"schedule_updated",schedule_deleted:"schedule_deleted",schedule_reminder:"schedule_reminder",leave_request_submitted:"leave_request_submitted",leave_request_approved:"leave_request_approved",leave_request_rejected:"leave_request_rejected"}[t]||"schedule_created"}getCategoryFromData(t){return t!=null&&t.type&&{schedule_created:"schedule_created",schedule_updated:"schedule_updated",schedule_deleted:"schedule_deleted",schedule_reminder:"schedule_reminder",leave_request:"leave_request_submitted",leave_approved:"leave_request_approved",leave_rejected:"leave_request_rejected"}[t.type]||"schedule_created"}mapNotificationLogFromDb(t){return{id:t.id,userId:t.user_id,type:t.type,category:t.category,subject:t.subject,content:t.content,metadata:t.metadata||{},status:t.status,errorMessage:t.error_message,sentAt:t.sent_at?new Date(t.sent_at):void 0,createdAt:new Date(t.created_at),isRead:t.is_read||!1,readAt:t.read_at?new Date(t.read_at):void 0}}mapPreferencesFromDb(t){return{id:t.id,userId:t.user_id,emailEnabled:t.email_enabled,emailScheduleCreated:t.email_schedule_created,emailScheduleUpdated:t.email_schedule_updated,emailScheduleDeleted:t.email_schedule_deleted,emailScheduleReminder:t.email_schedule_reminder,emailLeaveRequest:t.email_leave_request,emailLeaveApproval:t.email_leave_approval,pushEnabled:t.push_enabled,pushScheduleCreated:t.push_schedule_created,pushScheduleUpdated:t.push_schedule_updated,pushScheduleDeleted:t.push_schedule_deleted,pushScheduleReminder:t.push_schedule_reminder,pushLeaveRequest:t.push_leave_request,pushLeaveApproval:t.push_leave_approval,pushSubscription:t.push_subscription,defaultReminderTime:t.default_reminder_time,quietHoursEnabled:t.quiet_hours_enabled,quietHoursStart:t.quiet_hours_start,quietHoursEnd:t.quiet_hours_end,createdAt:new Date(t.created_at),updatedAt:new Date(t.updated_at)}}mapPreferencesToDb(t){const r={};return t.emailEnabled!==void 0&&(r.email_enabled=t.emailEnabled),t.emailScheduleCreated!==void 0&&(r.email_schedule_created=t.emailScheduleCreated),t.emailScheduleUpdated!==void 0&&(r.email_schedule_updated=t.emailScheduleUpdated),t.emailScheduleDeleted!==void 0&&(r.email_schedule_deleted=t.emailScheduleDeleted),t.emailScheduleReminder!==void 0&&(r.email_schedule_reminder=t.emailScheduleReminder),t.emailLeaveRequest!==void 0&&(r.email_leave_request=t.emailLeaveRequest),t.emailLeaveApproval!==void 0&&(r.email_leave_approval=t.emailLeaveApproval),t.pushEnabled!==void 0&&(r.push_enabled=t.pushEnabled),t.pushScheduleCreated!==void 0&&(r.push_schedule_created=t.pushScheduleCreated),t.pushScheduleUpdated!==void 0&&(r.push_schedule_updated=t.pushScheduleUpdated),t.pushScheduleDeleted!==void 0&&(r.push_schedule_deleted=t.pushScheduleDeleted),t.pushScheduleReminder!==void 0&&(r.push_schedule_reminder=t.pushScheduleReminder),t.pushLeaveRequest!==void 0&&(r.push_leave_request=t.pushLeaveRequest),t.pushLeaveApproval!==void 0&&(r.push_leave_approval=t.pushLeaveApproval),t.pushSubscription!==void 0&&(r.push_subscription=t.pushSubscription),t.defaultReminderTime!==void 0&&(r.default_reminder_time=t.defaultReminderTime),t.quietHoursEnabled!==void 0&&(r.quiet_hours_enabled=t.quietHoursEnabled),t.quietHoursStart!==void 0&&(r.quiet_hours_start=t.quietHoursStart),t.quietHoursEnd!==void 0&&(r.quiet_hours_end=t.quietHoursEnd),r}}const Ze=new sN,Qv=b.createContext(void 0);function iN({children:e}){const[t,r]=b.useState(new Date),[n,s]=b.useState("week"),[i,a]=b.useState([]),[o,c]=b.useState(()=>{const E=localStorage.getItem("visibleUsers");return E?JSON.parse(E):[]}),d=b.useCallback(async()=>{try{const{data:E,error:T}=await me.from("schedules").select("*").order("start_time");if(T)console.error("Failed to fetch schedules from Supabase:",T),console.warn("Using mock data for schedules"),a(Op);else if(E){const M=E.map(P=>({id:P.id,type:P.type,title:P.title,details:P.details||"",startTime:new Date(P.start_time),endTime:new Date(P.end_time),isAllDay:P.is_all_day,recurrence:P.recurrence,participants:P.participants||[],equipment:P.equipment||[],reminders:P.reminders||[],meetLink:P.meet_link,meetingType:P.meeting_type||"in-person",createdBy:P.created_by,createdAt:new Date(P.created_at),updatedBy:P.updated_by,updatedAt:P.updated_at?new Date(P.updated_at):null}));a(M)}}catch(E){console.error("Error fetching schedules:",E),console.warn("Using mock data for schedules"),a(Op)}},[]);b.useEffect(()=>{d()},[d]),b.useEffect(()=>{localStorage.setItem("visibleUsers",JSON.stringify(o))},[o]);const u=b.useCallback(()=>{r(E=>{switch(n){case"day":return Bt(E,1);case"week":return Bt(E,7);case"month":const T=new Date(E);return T.setMonth(T.getMonth()+1),T;default:return E}})},[n]),f=b.useCallback(()=>{r(E=>{switch(n){case"day":return Ap(E,1);case"week":return Ap(E,7);case"month":const T=new Date(E);return T.setMonth(T.getMonth()-1),T;default:return E}})},[n]),h=b.useCallback(()=>{r(new Date)},[]),p=b.useCallback(E=>{c(T=>T.includes(E)?T.filter(M=>M!==E):[...T,E])},[]),x=b.useCallback(E=>i.filter(T=>!!(X0(new Date(T.startTime),E)||X0(new Date(T.endTime),E)||new Date(T.startTime)<E&&new Date(T.endTime)>E)),[i]),m=b.useCallback((E,T)=>i.filter(M=>{const P=new Date(M.startTime),B=new Date(M.endTime);return Cp(P,{start:E,end:T})||Cp(B,{start:E,end:T})||P<=E&&B>=T}),[i]),g=b.useCallback((E,T,M,P)=>{const B=i.filter(W=>{if(!(E>=W.startTime&&E<W.endTime||T>W.startTime&&T<=W.endTime||E<=W.startTime&&T>=W.endTime))return!1;const J=M.some(ye=>W.participants.includes(ye)),Te=P.some(ye=>W.equipment.some(se=>se.id===ye.id&&se.type===ye.type));return J||Te});return{hasConflicts:B.length>0,conflicts:B}},[i]),_=b.useCallback(async E=>{if(x(E.startTime).length>=10)return pe.error("110"),!1;const{hasConflicts:M,conflicts:P}=g(E.startTime,E.endTime,E.participants,E.equipment);if(M&&!window.confirm(`

`+P.map(W=>`${W.title} (${W.participants.length})`).join(`
`)))return!1;try{if(console.log("Schedule data before saving:",{type:E.type,title:E.title,startTime:E.startTime,endTime:E.endTime,participants:E.participants,createdBy:E.createdBy}),!E.type||!E.title||!E.startTime||!E.endTime)return console.error("Required fields missing:",{type:E.type,title:E.title,startTime:E.startTime,endTime:E.endTime}),pe.error(""),!1;const{data:B,error:W}=await me.from("schedules").insert([{type:E.type,title:E.title,details:E.details||null,start_time:E.startTime.toISOString(),end_time:E.endTime.toISOString(),is_all_day:E.isAllDay||!1,recurrence:E.recurrence||null,participants:E.participants||[],equipment:E.equipment||[],reminders:E.reminders||[],meet_link:E.meetLink||null,meeting_type:E.meetingType||"in-person",created_by:E.createdBy||null}]).select().single();if(W)return console.error("Supabase error details:",W),console.error("Error code:",W.code),console.error("Error message:",W.message),console.error("Error details:",W.details),pe.error(`: ${W.message}`),!1;const Y={id:B.id,type:B.type,title:B.title,details:B.details||"",startTime:new Date(B.start_time),endTime:new Date(B.end_time),isAllDay:B.is_all_day,recurrence:B.recurrence,participants:B.participants||[],equipment:B.equipment||[],reminders:B.reminders||[],meetLink:B.meet_link,meetingType:B.meeting_type||"in-person",createdBy:B.created_by,createdAt:new Date(B.created_at),updatedBy:B.updated_by,updatedAt:B.updated_at?new Date(B.updated_at):null};a(J=>[...J,Y]),pe.success("");try{console.log("===  ==="),console.log(":",Y.participants);const J=Y.participants.map(async Te=>{console.log(` ${Te} `);const{data:ye,error:se}=await me.from("users").select("id, name, email").eq("id",Te).single();if(se){console.error(` (${Te}):`,se);return}if(ye){console.log(":",ye);try{await Ze.notifyScheduleCreated({schedule:{id:Y.id,title:Y.title,type:Y.type,startTime:Y.startTime,endTime:Y.endTime,details:Y.details,meetLink:Y.meetLink,participants:Y.participants,location:Rd(Y.equipment)},user:{id:ye.id,name:ye.name,email:ye.email}}),console.log(`: ${ye.name}`)}catch(le){console.error(` (${ye.name}):`,le)}}});await Promise.all(J),console.log("===  ===")}catch(J){console.error("Notification error:",J)}return!0}catch(B){return console.error("Error creating schedule:",B),pe.error(""),!1}},[i,x,g]),y=b.useCallback(async E=>{try{const T=i.find(P=>P.id===E.id);if(!T)return;const{error:M}=await me.from("schedules").update({type:E.type,title:E.title,details:E.details||null,start_time:E.startTime.toISOString(),end_time:E.endTime.toISOString(),is_all_day:E.isAllDay||!1,recurrence:E.recurrence||null,participants:E.participants||[],equipment:E.equipment||[],reminders:E.reminders||[],meet_link:E.meetLink||null,meeting_type:E.meetingType||"in-person",updated_by:E.updatedBy||null,updated_at:new Date().toISOString()}).eq("id",E.id);if(M){console.error("Error updating schedule:",M),pe.error("");return}a(P=>P.map(B=>B.id===E.id?{...E,updatedAt:new Date}:B)),pe.success("");try{const P=[];T.title!==E.title&&P.push(`: ${T.title}  ${E.title}`),(T.startTime.getTime()!==E.startTime.getTime()||T.endTime.getTime()!==E.endTime.getTime())&&P.push(""),T.meetLink!==E.meetLink&&P.push("");const B=new Set([...T.participants,...E.participants]),W=Array.from(B).map(async Y=>{const{data:J}=await me.from("users").select("id, name, email").eq("id",Y).single();J&&await Ze.notifyScheduleUpdated({schedule:{id:E.id,title:E.title,type:E.type,startTime:E.startTime,endTime:E.endTime,details:E.details,meetLink:E.meetLink,participants:E.participants,location:Rd(E.equipment)},user:{id:J.id,name:J.name,email:J.email},changes:P})});await Promise.all(W)}catch(P){console.error("Notification error:",P)}}catch(T){console.error("Error updating schedule:",T),pe.error("")}},[i]),v=b.useCallback(async(E,T,M)=>{try{const P=i.find(W=>W.id===E);if(!P)return;const{error:B}=await me.from("schedules").delete().eq("id",E);if(B){console.error("Error deleting schedule:",B),pe.error("");return}a(W=>W.filter(Y=>Y.id!==E)),pe.success("");try{const W=P.participants.map(async Y=>{const{data:J}=await me.from("users").select("id, name, email").eq("id",Y).single();if(J){const{data:Te}=T?await me.from("users").select("name").eq("id",T).single():{data:null};await Ze.notifyScheduleDeleted({schedule:{id:P.id,title:P.title,type:P.type,startTime:P.startTime,endTime:P.endTime,details:P.details,meetLink:P.meetLink,participants:P.participants,location:Rd(P.equipment)},user:{id:J.id,name:J.name,email:J.email},deletedBy:Te==null?void 0:Te.name,reason:M})}});await Promise.all(W)}catch(W){console.error("Notification error:",W)}}catch(P){console.error("Error deleting schedule:",P),pe.error("")}},[i]),w=b.useCallback(E=>i.filter(T=>T.participants.includes(E)||T.createdBy===E),[i]),N=b.useCallback((E,T)=>i.filter(M=>M.equipment.some(P=>P.id===E&&P.type===T)),[i]);return l.jsx(Qv.Provider,{value:{currentDate:t,view:n,schedules:i,visibleUsers:o,setCurrentDate:r,setView:s,goToNextPeriod:u,goToPreviousPeriod:f,goToToday:h,toggleUserVisibility:p,addSchedule:_,updateSchedule:y,deleteSchedule:v,getSchedulesForDate:x,getSchedulesForDateRange:m,getSchedulesForUser:w,getSchedulesForEquipment:N,checkScheduleConflicts:g,refreshSchedules:d},children:e})}function Rd(e){if(!e||e.length===0)return;const t=e.filter(r=>r.type==="room");if(t.length>0)return t.map(r=>r.name).join(", ")}function Jo(){const e=b.useContext(Qv);if(e===void 0)throw new Error("useCalendar must be used within a CalendarProvider");return e}const aN="";function Qo(){return"Notification"in window&&"serviceWorker"in navigator&&"PushManager"in window}async function oN(){return Qo()?await Notification.requestPermission():(console.warn("This browser does not support notifications"),"denied")}async function Zv(e){try{if(!Qo())return console.warn("Push notifications not supported"),!1;if(await oN()!=="granted")return console.warn("Notification permission denied"),!1;const r=await navigator.serviceWorker.register("/sw.js");await navigator.serviceWorker.ready;let n=await r.pushManager.getSubscription();n||(n=await r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:cN(aN)}));const s=n.toJSON(),i=await Ze.subscribeToPush(e,s);return i&&(console.log("Push notification registered successfully"),await ey("",{body:"",icon:"/icon-192x192.png",badge:"/badge-72x72.png"})),i}catch(t){return console.error("Error registering push notification:",t),!1}}async function lN(e){try{const r=await(await navigator.serviceWorker.ready).pushManager.getSubscription();return r&&await r.unsubscribe(),await Ze.unsubscribeFromPush(e)}catch(t){return console.error("Error unregistering push notification:",t),!1}}async function ey(e,t){if(!Qo()||await Notification.requestPermission()!=="granted")return;await(await navigator.serviceWorker.ready).showNotification(e,{...t,timestamp:Date.now()})}function cN(e){const t="=".repeat((4-e.length%4)%4),r=(e+t).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(r),s=new Uint8Array(n.length);for(let i=0;i<n.length;++i)s[i]=n.charCodeAt(i);return s}function uN(){Qo()&&navigator.serviceWorker.addEventListener("message",e=>{var t;((t=e.data)==null?void 0:t.type)==="notification-click"&&dN(e.data)})}function dN(e){const{action:t,notificationData:r}=e;switch(r==null?void 0:r.type){case"schedule_created":case"schedule_updated":case"schedule_reminder":(t==="view"||t==="join")&&(window.location.href=`/calendar?scheduleId=${r.scheduleId}`);break;case"leave_request":window.location.href="/leave-requests";break;default:window.location.href="/dashboard"}}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var fN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hN=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ae=(e,t)=>{const r=b.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:o="",children:c,...d},u)=>b.createElement("svg",{ref:u,...fN,width:s,height:s,stroke:n,strokeWidth:a?Number(i)*24/Number(s):i,className:["lucide",`lucide-${hN(e)}`,o].join(" "),...d},[...t.map(([f,h])=>b.createElement(f,h)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ty=Ae("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nc=Ae("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mN=Ae("ArrowDownUp",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pN=Ae("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gN=Ae("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=Ae("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=Ae("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xN=Ae("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=Ae("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=Ae("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=Ae("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vN=Ae("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yN=Ae("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ru=Ae("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=Ae("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Do=Ae("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=Ae("DoorOpen",[["path",{d:"M13 4h3a2 2 0 0 1 2 2v14",key:"hrm0s9"}],["path",{d:"M2 20h3",key:"1gaodv"}],["path",{d:"M13 20h9",key:"s90cdi"}],["path",{d:"M10 12v.01",key:"vx6srw"}],["path",{d:"M13 4.562v16.157a1 1 0 0 1-1.242.97L5 20V5.562a2 2 0 0 1 1.515-1.94l4-1A2 2 0 0 1 13 4.561Z",key:"199qr4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wN=Ae("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _N=Ae("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=Ae("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EN=Ae("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SN=Ae("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xh=Ae("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TN=Ae("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bN=Ae("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=Ae("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=Ae("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kN=Ae("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NN=Ae("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jN=Ae("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CN=Ae("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=Ae("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AN=Ae("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ry=Ae("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=Ae("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=Ae("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=Ae("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=Ae("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function ON(){const[e,t]=b.useState([]),[r,n]=b.useState(!0),[s,i]=b.useState(""),a=pa(),{switchUser:o}=Ht();b.useEffect(()=>{c()},[]);const c=async()=>{try{n(!0),console.log("DB");const{data:u,error:f}=await me.from("users").select("*").order("name_kana");if(f){console.error(":",f),i("");return}console.log(":",u);const h=(u==null?void 0:u.map(p=>({id:p.id,employeeId:p.employee_id,name:p.name,nameKana:p.name_kana,email:p.email,phone:p.phone,department:p.department,role:p.role,defaultWorkDays:p.default_work_days||[]})))||[];t(h),console.log(":",h)}catch(u){console.error("fetchUsers :",u),i("")}finally{n(!1)}},d=u=>{console.log(":",u);const f=e.find(h=>h.id===u);console.log(":",f),f?(console.log("switchUser"),o(f),console.log("navigate"),a("/")):console.error(":",u)};return l.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[l.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[l.jsx("div",{className:"flex justify-center",children:l.jsx(ia,{className:"h-12 w-12 text-blue-600"})}),l.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:""}),l.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"PC"})]}),l.jsxs("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:[l.jsx("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:r?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"..."})]}):s?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("p",{className:"text-red-600 mb-4",children:s}),l.jsx("button",{onClick:c,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:""})]}):l.jsx("div",{className:"space-y-3",children:e.map(u=>l.jsxs("button",{onClick:()=>d(u.id),className:"w-full flex items-center p-4 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all",children:[l.jsx("div",{className:"flex-shrink-0 h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 font-medium text-lg",children:u.name.charAt(0)})}),l.jsxs("div",{className:"ml-4 flex-1 text-left",children:[l.jsx("div",{className:"text-lg font-medium text-gray-900",children:u.name}),l.jsxs("div",{className:"text-sm text-gray-500",children:[u.department,"  ",u.role==="president"?"":u.role==="admin"?"":""]})]}),l.jsx(ry,{className:"h-5 w-5 text-gray-400"})]},u.id))})}),l.jsx("div",{className:"mt-6 text-center",children:l.jsx("p",{className:"text-xs text-gray-500",children:"PC"})})]})]})}const FN={lessThanXSeconds:{one:"1",other:"{{count}}",oneWithSuffix:"1",otherWithSuffix:"{{count}}"},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1",other:"{{count}}",oneWithSuffix:"1",otherWithSuffix:"{{count}}"},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:"1",other:"{{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:"1",other:"{{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:"1",other:"{{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:"1",other:"{{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1",other:"{{count}}"},almostXYears:{one:"1",other:"{{count}}"}},PN=(e,t,r)=>{r=r||{};let n;const s=FN[e];return typeof s=="string"?n=s:t===1?r.addSuffix&&s.oneWithSuffix?n=s.oneWithSuffix:n=s.one:r.addSuffix&&s.otherWithSuffix?n=s.otherWithSuffix.replace("{{count}}",String(t)):n=s.other.replace("{{count}}",String(t)),r.addSuffix?r.comparison&&r.comparison>0?n+"":n+"":n},DN={full:"yMdEEEE",long:"yMd",medium:"y/MM/dd",short:"y/MM/dd"},RN={full:"Hmmss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},IN={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},LN={date:Hi({formats:DN,defaultWidth:"full"}),time:Hi({formats:RN,defaultWidth:"full"}),dateTime:Hi({formats:IN,defaultWidth:"full"})},MN={lastWeek:"eeeep",yesterday:"p",today:"p",tomorrow:"p",nextWeek:"eeeep",other:"P"},BN=(e,t,r,n)=>MN[e],$N={narrow:["BC","AC"],abbreviated:["",""],wide:["",""]},UN={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},WN={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},HN={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},zN={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},VN={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},GN=(e,t)=>{const r=Number(e);switch(String(t==null?void 0:t.unit)){case"year":return`${r}`;case"quarter":return`${r}`;case"month":return`${r}`;case"week":return`${r}`;case"date":return`${r}`;case"hour":return`${r}`;case"minute":return`${r}`;case"second":return`${r}`;default:return`${r}`}},qN={ordinalNumber:GN,era:nn({values:$N,defaultWidth:"wide"}),quarter:nn({values:UN,defaultWidth:"wide",argumentCallback:e=>Number(e)-1}),month:nn({values:WN,defaultWidth:"wide"}),day:nn({values:HN,defaultWidth:"wide"}),dayPeriod:nn({values:zN,defaultWidth:"wide",formattingValues:VN,defaultFormattingWidth:"wide"})},KN=/^?\d+(|||||||)?/i,XN=/\d+/i,YN={narrow:/^(B\.?C\.?|A\.?D\.?)/i,abbreviated:/^([]|)/i,wide:/^([]|)/i},JN={narrow:[/^B/i,/^A/i],any:[/^()/i,/^(|)/i]},QN={narrow:/^[1234]/i,abbreviated:/^Q[1234]/i,wide:/^[1234]/i},ZN={any:[/(1||)/i,/(2||)/i,/(3||)/i,/(4||)/i]},e3={narrow:/^([123456789]|1[012])/,abbreviated:/^([123456789]|1[012])/i,wide:/^([123456789]|1[012])/i},t3={any:[/^1\D/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},r3={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},n3={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},s3={any:/^(AM|PM|||||||)/i},i3={any:{am:/^(A|)/i,pm:/^(P|)/i,midnight:/^|/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},a3={ordinalNumber:bv({matchPattern:KN,parsePattern:XN,valueCallback:function(e){return parseInt(e,10)}}),era:sn({matchPatterns:YN,defaultMatchWidth:"wide",parsePatterns:JN,defaultParseWidth:"any"}),quarter:sn({matchPatterns:QN,defaultMatchWidth:"wide",parsePatterns:ZN,defaultParseWidth:"any",valueCallback:e=>e+1}),month:sn({matchPatterns:e3,defaultMatchWidth:"wide",parsePatterns:t3,defaultParseWidth:"any"}),day:sn({matchPatterns:r3,defaultMatchWidth:"wide",parsePatterns:n3,defaultParseWidth:"any"}),dayPeriod:sn({matchPatterns:s3,defaultMatchWidth:"any",parsePatterns:i3,defaultParseWidth:"any"})},jr={code:"ja",formatDistance:PN,formatLong:LN,formatRelative:BN,localize:qN,match:a3,options:{weekStartsOn:0,firstWeekContainsDate:1}};function o3(){const e=pa(),{currentUser:t}=Ht(),{getSchedulesForDate:r,refreshSchedules:n}=Jo();Ct.useEffect(()=>{n()},[n]);const s=new Date,a=r(s).filter(c=>c.participants.includes((t==null?void 0:t.id)||"")||c.createdBy===(t==null?void 0:t.id)),o=[{name:"",description:"",icon:l.jsx(ia,{className:"h-8 w-8 text-white"}),href:"/calendar/my",color:"bg-blue-600"},{name:"",description:"",icon:l.jsx(aa,{className:"h-8 w-8 text-white"}),href:"/calendar/vehicle",color:"bg-amber-600"},{name:"",description:"",icon:l.jsx(oa,{className:"h-8 w-8 text-white"}),href:"/calendar/room",color:"bg-emerald-600"},{name:"",description:"",icon:l.jsx(sa,{className:"h-8 w-8 text-white"}),href:"/calendar/sample",color:"bg-purple-600"},{name:"",description:"",icon:l.jsx(Do,{className:"h-8 w-8 text-white"}),href:"/leave",color:"bg-rose-600"}];return((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="president")&&o.push({name:"",description:"",icon:l.jsx(zr,{className:"h-8 w-8 text-white"}),href:"/admin/users",color:"bg-indigo-600"}),l.jsxs("div",{children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:""}),l.jsx("p",{className:"mt-1 text-sm text-gray-500",children:be(s,"yyyyMdEEEE",{locale:jr})})]}),l.jsx("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3",children:o.map(c=>l.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg cursor-pointer hover:shadow-md transition-shadow duration-200",onClick:()=>e(c.href),children:l.jsx("div",{className:"p-5",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:`flex-shrink-0 rounded-md p-3 ${c.color}`,children:c.icon}),l.jsxs("div",{className:"ml-5",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:c.name}),l.jsx("p",{className:"text-sm text-gray-500",children:c.description})]})]})})},c.name))}),l.jsxs("div",{className:"mt-8",children:[l.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:""}),l.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:a.length>0?l.jsx("ul",{className:"divide-y divide-gray-200",children:a.map(c=>l.jsx("li",{children:l.jsx("div",{className:"px-4 py-4 sm:px-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:`
                          flex-shrink-0 h-10 w-10 rounded-md flex items-center justify-center
                          ${c.type===""?"bg-blue-100 text-blue-600":c.type===""?"bg-purple-100 text-purple-600":c.type===""?"bg-amber-100 text-amber-600":c.type===""?"bg-emerald-100 text-emerald-600":"bg-gray-100 text-gray-600"}
                        `,children:l.jsx(ia,{className:"h-6 w-6"})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:c.title}),l.jsxs("div",{className:"text-sm text-gray-500",children:[be(c.startTime,"HH:mm")," - ",be(c.endTime,"HH:mm")]})]})]}),l.jsxs("div",{className:"flex items-center",children:[c.equipment.map(d=>l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 mr-2",children:d.type==="room"?"":d.type==="vehicle"?"":""},d.id)),l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:c.type})]})]})})},c.id))}):l.jsx("div",{className:"px-4 py-5 sm:px-6 text-center text-gray-500",children:""})})]})]})}function af({selectedParticipants:e,onChange:t,showBusinessGroups:r=!0,showLeaveGroups:n=!1,readOnlyLeaveGroup:s=!1}){const{currentUser:i}=Ht(),[a,o]=b.useState([]),[c,d]=b.useState([]),[u,f]=b.useState(new Set),[h,p]=b.useState(!0);b.useEffect(()=>{x()},[]);const x=async()=>{try{const{data:E,error:T}=await me.from("users").select("id, name, name_kana, department, role").order("name_kana");if(!T&&E){const B=E.map(W=>({...W,nameKana:W.name_kana}));o(B)}const{data:M,error:P}=await me.from("groups").select("*").order("type, name");if(!P&&M){let B=M;r||(B=B.filter(W=>W.type!=="business")),n||(B=B.filter(W=>W.type!=="leave")),r&&i&&(B=B.filter(W=>W.type!=="business"||W.members.includes(i.id))),d(B)}}catch(E){console.error("Error fetching data:",E)}finally{p(!1)}},m=E=>{const T=new Set(u);T.has(E)?T.delete(E):T.add(E),f(T)},g=E=>{const T=e.includes(E)?e.filter(M=>M!==E):[...e,E];t(T)},_=(E,T)=>{const M=E.members.filter(P=>a.find(B=>B.id===P));if(T){const P=[...new Set([...e,...M])];t(P)}else{const P=e.filter(B=>!M.includes(B));t(P)}},y=E=>{const T=E.members.filter(M=>a.find(P=>P.id===M));return T.length>0&&T.every(M=>e.includes(M))},v=E=>{switch(E){case"department":return"";case"business":return"";case"leave":return"";default:return""}},w=()=>a.filter(E=>e.includes(E.id));if(h)return l.jsx("div",{className:"text-center py-4",children:"..."});const N=c.reduce((E,T)=>(E[T.type]||(E[T.type]=[]),E[T.type].push(T),E),{});return l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:""}),l.jsx("div",{className:"border border-gray-200 rounded-lg max-h-80 overflow-y-auto",children:Object.entries(N).map(([E,T])=>l.jsxs("div",{className:"border-b border-gray-100 last:border-b-0",children:[l.jsx("div",{className:"bg-gray-50 px-3 py-2 text-xs font-medium text-gray-600 uppercase",children:v(E)}),T.map(M=>{const P=u.has(M.id),B=y(M),W=a.filter(J=>M.members.includes(J.id)),Y=s&&M.type==="leave";return l.jsxs("div",{className:"border-b border-gray-100 last:border-b-0",children:[l.jsxs("div",{className:"flex items-center px-3 py-2 hover:bg-gray-50",children:[l.jsx("button",{onClick:()=>m(M.id),className:"flex items-center mr-2 text-gray-400 hover:text-gray-600",children:P?l.jsx(yN,{className:"h-4 w-4"}):l.jsx(Zo,{className:"h-4 w-4"})}),l.jsxs("label",{className:"flex items-center flex-1 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:B,onChange:J=>_(M,J.target.checked),disabled:Y,className:"mr-2 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 disabled:opacity-50"}),l.jsx("span",{className:"text-sm text-gray-900",children:M.name}),l.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",W.length,")"]})]})]}),P&&l.jsxs("div",{className:"pl-8 pb-2",children:[l.jsx("div",{className:"mb-2",children:l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:B,onChange:J=>_(M,J.target.checked),disabled:Y,className:"mr-2 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 disabled:opacity-50"}),l.jsx("span",{className:"text-sm text-gray-700 font-medium",children:""})]})}),l.jsx("div",{className:"space-y-1",children:W.sort((J,Te)=>(J.nameKana||J.name).localeCompare(Te.nameKana||Te.name,"ja")).map(J=>l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:e.includes(J.id),onChange:()=>g(J.id),disabled:Y,className:"mr-2 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 disabled:opacity-50"}),l.jsx("span",{className:"text-sm text-gray-700",children:J.name}),l.jsxs("span",{className:"ml-1 text-xs text-gray-500",children:["(",J.department,")"]})]},J.id))})]})]},M.id)})]},E))})]}),l.jsxs("div",{children:[l.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:[" (",e.length,")"]}),l.jsx("div",{className:"border border-gray-200 rounded-lg p-3 max-h-80 overflow-y-auto",children:w().length===0?l.jsxs("div",{className:"text-center py-8 text-gray-500",children:[l.jsx(zr,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),l.jsx("p",{className:"text-sm",children:""})]}):l.jsx("div",{className:"space-y-2",children:w().sort((E,T)=>(E.nameKana||E.name).localeCompare(T.nameKana||T.name,"ja")).map(E=>l.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-900",children:E.name}),l.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",E.department,")"]})]}),l.jsx("button",{onClick:()=>g(E.id),className:"text-red-600 hover:text-red-800 text-xs",children:""})]},E.id))})})]})]})})}const Xp={:{allowsMeetLink:!0,defaultType:"online",autoGenerateMeetLink:!0},"15":{allowsMeetLink:!0,defaultType:"online",autoGenerateMeetLink:!0},:{allowsMeetLink:!0,defaultType:"hybrid",autoGenerateMeetLink:!1},:{allowsMeetLink:!0,defaultType:"hybrid",autoGenerateMeetLink:!1},:{allowsMeetLink:!0,defaultType:"hybrid",autoGenerateMeetLink:!1},:{allowsMeetLink:!0,defaultType:"hybrid",autoGenerateMeetLink:!1},:{allowsMeetLink:!0,defaultType:"hybrid",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},"CAD":{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},"":{allowsMeetLink:!1,defaultType:"in-person",autoGenerateMeetLink:!1},:{allowsMeetLink:!0,defaultType:"hybrid",autoGenerateMeetLink:!1}};function Ol(e,t){return`https://meet.google.com/${l3(e,t)}`}function l3(e,t){const r=t.getTime(),n=c3(e),s=Math.random().toString(36).substring(2,5);return`${n.substring(0,3)}-${r.toString(36).substring(-4)}-${s}`}function c3(e){let t=0;for(let r=0;r<e.length;r++){const n=e.charCodeAt(r);t=(t<<5)-t+n,t=t&t}return Math.abs(t).toString(36)}function vh(e){return Xp[e]||Xp.}function Id(e){return vh(e).allowsMeetLink}function Yp(e){return vh(e).defaultType}function Jp(e){return vh(e).autoGenerateMeetLink}function Fl(e){return e?[/^https:\/\/meet\.google\.com\/[a-z0-9\-]{3,}$/i,/^https:\/\/meet\.google\.com\/[a-z]{3}-[a-z]{4}-[a-z]{3}$/i,/^https:\/\/meet\.google\.com\/lookup\/[a-z0-9]+$/i].some(r=>r.test(e)):!1}function u3(e){switch(e){case"in-person":return"";case"online":return"";case"hybrid":return"";default:return""}}function d3(e){switch(e){case"in-person":return"bg-gray-100 text-gray-800";case"online":return"bg-blue-100 text-blue-800";case"hybrid":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}}function Iu({isOpen:e,onClose:t,onSubmit:r,selectedDate:n,selectedEquipment:s,selectedParticipant:i,type:a,editingSchedule:o}){var z,U,Z,G,k,F,C,L,H,Q,ne,ae;const{currentUser:c}=Ht(),d=()=>{if(o)return{...o,startTime:new Date(o.startTime),endTime:new Date(o.endTime)};const ee=Ub($b(n||new Date,9),0),oe=RT(ee,1),xe=a==="vehicle"?"":a==="room"?"":a==="sample"?"":"15",_e=Yp(xe);return{type:xe,title:"",details:"",startTime:ee,endTime:oe,isAllDay:!1,participants:i?[i]:c?[c.id]:[],equipment:s?[{id:s.id,name:s.name||"",type:s.type}]:[],reminders:[{time:15,methods:["email"]}],recurrence:null,meetingType:_e,meetLink:Jp(xe)?Ol("",ee):""}},[u,f]=b.useState(d()),[h,p]=b.useState([]),[x,m]=b.useState([]),[g,_]=b.useState([]),[y,v]=b.useState(!1),[w,N]=b.useState(null),[E,T]=b.useState(null);b.useEffect(()=>{e&&(M(),o?(f(d()),P()):(N(null),T(null)))},[e,o]);const M=async()=>{try{const[A,ee]=await Promise.all([me.from("rooms").select("*").order("name"),me.from("vehicles").select("*").order("name")]);A.data&&p(A.data),ee.data&&m(ee.data)}catch(A){console.error("Error loading equipment:",A)}},P=async()=>{if(o)try{const A=[o.createdBy,o.updatedBy].filter(Boolean);if(A.length===0)return;const{data:ee,error:oe}=await me.from("users").select("id, name, employee_id").in("id",A);if(oe){console.error("Error loading user info:",oe);return}const xe=ee==null?void 0:ee.find(Ce=>Ce.id===o.createdBy),_e=ee==null?void 0:ee.find(Ce=>Ce.id===o.updatedBy);N(xe||null),T(_e||null)}catch(A){console.error("Error loading user info:",A)}},W=(()=>{const A=[];for(let ee=0;ee<24;ee++)for(let oe=0;oe<60;oe+=15){const xe=`${ee.toString().padStart(2,"0")}:${oe.toString().padStart(2,"0")}`;A.push(xe)}return A})(),Y=()=>{if(u.title&&u.startTime){const A=Ol(u.title,u.startTime);f({...u,meetLink:A}),pe.success("Google Meet ")}else pe.error("")},J=A=>{const ee={meetingType:A};A==="online"&&!u.meetLink&&u.title&&u.startTime&&(ee.meetLink=Ol(u.title,u.startTime)),A==="in-person"&&(ee.meetLink=""),f({...u,...ee})},Te=A=>{const ee=Id(A),oe=Yp(A),xe=Jp(A),_e={type:A,meetingType:oe};ee?xe&&u.title&&u.startTime&&(_e.meetLink=Ol(u.title,u.startTime)):(_e.meetLink="",_e.meetingType="in-person"),f({...u,..._e})},ye=async A=>{var oe,xe;if(!A.participants||A.participants.length===0)return[];const ee=A.participants.filter(_e=>_e&&_e.trim()!=="");if(ee.length===0)return[];try{let _e=me.from("schedules").select("*").overlaps("participants",ee).gte("end_time",(oe=A.startTime)==null?void 0:oe.toISOString()).lte("start_time",(xe=A.endTime)==null?void 0:xe.toISOString());o!=null&&o.id&&(_e=_e.neq("id",o.id));const{data:Ce,error:Oe}=await _e;if(Oe)throw Oe;return Ce||[]}catch(_e){return console.error("Error checking conflicts:",_e),[]}},se=async A=>{var xe;A.preventDefault();const ee=[];if((xe=u.title)!=null&&xe.trim()||ee.push(""),u.type||ee.push(""),!u.startTime||!u.endTime?ee.push(""):u.startTime>=u.endTime&&ee.push(""),(!u.participants||u.participants.length===0)&&ee.push(""),a==="vehicle"?(!u.equipment||u.equipment.length===0)&&ee.push(""):a==="room"?(!u.equipment||u.equipment.length===0)&&ee.push(""):a==="sample"&&(u.assignedTo||ee.push(""),(!u.quantity||u.quantity<1)&&ee.push("")),ee.length>0){pe.error(ee[0]);return}const oe=await ye(u);if(oe.length>0&&!y){_(oe),v(!0);return}console.log("Submitting form data:",u),r({...u,createdBy:c==null?void 0:c.id,updatedBy:c==null?void 0:c.id}),t(),v(!1)},le=()=>{r({...u,createdBy:c==null?void 0:c.id,updatedBy:c==null?void 0:c.id}),t(),v(!1)};return e?l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:a==="room"?"":a==="vehicle"?"":""}),l.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:l.jsx(Rn,{className:"h-6 w-6"})})]}),l.jsxs("form",{onSubmit:se,className:"space-y-4",children:[a==="general"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:u.type||"",onChange:A=>Te(A.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0,children:[l.jsx("option",{value:"15",children:"15"}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""})]})]}),a==="general"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:u.title||"",onChange:A=>f({...u,title:A.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),a==="general"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("textarea",{value:u.details||"",onChange:A=>f({...u,details:A.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),a==="general"&&Id(u.type||"")&&l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[l.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[l.jsx(Gn,{className:"h-4 w-4 mr-2"}),""]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",name:"meetingType",value:"in-person",checked:u.meetingType==="in-person",onChange:A=>J(A.target.value),className:"h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),l.jsxs("span",{className:"ml-2 text-sm text-gray-700 flex items-center",children:[l.jsx(zr,{className:"h-4 w-4 mr-1"}),""]})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",name:"meetingType",value:"online",checked:u.meetingType==="online",onChange:A=>J(A.target.value),className:"h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),l.jsxs("span",{className:"ml-2 text-sm text-gray-700 flex items-center",children:[l.jsx(Gn,{className:"h-4 w-4 mr-1"}),""]})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",name:"meetingType",value:"hybrid",checked:u.meetingType==="hybrid",onChange:A=>J(A.target.value),className:"h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),l.jsxs("span",{className:"ml-2 text-sm text-gray-700 flex items-center",children:[l.jsx(Gn,{className:"h-4 w-4 mr-1"}),l.jsx(zr,{className:"h-4 w-4 mr-1"}),""]})]})]})]}),(u.meetingType==="online"||u.meetingType==="hybrid")&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Google Meet "}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("input",{type:"url",value:u.meetLink||"",onChange:A=>f({...u,meetLink:A.target.value}),placeholder:"https://meet.google.com/...",className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),l.jsxs("button",{type:"button",onClick:Y,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[l.jsx(za,{className:"h-4 w-4 mr-1"}),""]})]}),u.meetLink&&!Fl(u.meetLink)&&l.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Google Meet URL"}),u.meetLink&&Fl(u.meetLink)&&l.jsxs("div",{className:"mt-2 flex items-center",children:[l.jsx(za,{className:"h-4 w-4 text-green-600 mr-1"}),l.jsx("a",{href:u.meetLink,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-green-600 hover:text-green-800 underline",children:""})]})]})]}),a==="general"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:""}),l.jsx(af,{selectedParticipants:u.participants||[],onChange:A=>f({...u,participants:A}),showBusinessGroups:!0,showLeaveGroups:!1})]}),(a==="general"||a==="room"||a==="vehicle")&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("div",{className:"mt-2 space-y-2",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600",children:""}),l.jsx("div",{className:"mt-1 space-y-1",children:h.map(A=>l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:(u.equipment||[]).some(ee=>ee.id===A.id&&ee.type==="room"),onChange:ee=>{const oe=u.equipment||[];ee.target.checked?f({...u,equipment:[...oe,{id:A.id,name:A.name,type:"room"}]}):f({...u,equipment:oe.filter(xe=>!(xe.id===A.id&&xe.type==="room"))})},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-2 text-sm text-gray-700",children:A.name})]},A.id))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm text-gray-600",children:""}),l.jsx("div",{className:"mt-1 space-y-1",children:x.map(A=>l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:(u.equipment||[]).some(ee=>ee.id===A.id&&ee.type==="vehicle"),onChange:ee=>{const oe=u.equipment||[];ee.target.checked?f({...u,equipment:[...oe,{id:A.id,name:A.name,type:"vehicle"}]}):f({...u,equipment:oe.filter(xe=>!(xe.id===A.id&&xe.type==="vehicle"))})},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-2 text-sm text-gray-700",children:A.name})]},A.id))})]})]})]}),a==="vehicle"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:u.type||"",onChange:A=>f({...u,type:A.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:u.title||"",onChange:A=>f({...u,title:A.target.value}),placeholder:": A",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("textarea",{value:u.details||"",onChange:A=>f({...u,details:A.target.value}),placeholder:": ",rows:2,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),a==="room"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:u.type||"",onChange:A=>f({...u,type:A.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:u.title||"",onChange:A=>f({...u,title:A.target.value}),placeholder:": ",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("textarea",{value:u.details||"",onChange:A=>f({...u,details:A.target.value}),placeholder:": ",rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:""}),l.jsx(af,{selectedParticipants:u.participants||[],onChange:A=>f({...u,participants:A}),showBusinessGroups:!0,showLeaveGroups:!1})]}),Id(u.type||"")&&l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[l.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[l.jsx(Gn,{className:"h-4 w-4 mr-2"}),""]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",name:"meetingType",value:"in-person",checked:u.meetingType==="in-person",onChange:A=>J(A.target.value),className:"h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),l.jsxs("span",{className:"ml-2 text-sm text-gray-700 flex items-center",children:[l.jsx(zr,{className:"h-4 w-4 mr-1"}),""]})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",name:"meetingType",value:"online",checked:u.meetingType==="online",onChange:A=>J(A.target.value),className:"h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),l.jsxs("span",{className:"ml-2 text-sm text-gray-700 flex items-center",children:[l.jsx(Gn,{className:"h-4 w-4 mr-1"}),""]})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",name:"meetingType",value:"hybrid",checked:u.meetingType==="hybrid",onChange:A=>J(A.target.value),className:"h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),l.jsxs("span",{className:"ml-2 text-sm text-gray-700 flex items-center",children:[l.jsx(Gn,{className:"h-4 w-4 mr-1"}),l.jsx(zr,{className:"h-4 w-4 mr-1"}),""]})]})]})]}),(u.meetingType==="online"||u.meetingType==="hybrid")&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Google Meet "}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("input",{type:"url",value:u.meetLink||"",onChange:A=>f({...u,meetLink:A.target.value}),placeholder:"https://meet.google.com/...",className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),l.jsxs("button",{type:"button",onClick:Y,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[l.jsx(za,{className:"h-4 w-4 mr-1"}),""]})]}),u.meetLink&&!Fl(u.meetLink)&&l.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Google Meet URL"}),u.meetLink&&Fl(u.meetLink)&&l.jsxs("div",{className:"mt-2 flex items-center",children:[l.jsx(za,{className:"h-4 w-4 text-green-600 mr-1"}),l.jsx("a",{href:u.meetLink,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-green-600 hover:text-green-800 underline",children:""})]})]})]})]}),a==="sample"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:u.type||"",onChange:A=>f({...u,type:A.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"CAD",children:"CAD"}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:u.title||"",onChange:A=>f({...u,title:A.target.value}),placeholder:": 22186",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:u.details||"",onChange:A=>f({...u,details:A.target.value}),placeholder:": Acka-424",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"number",min:"1",value:u.quantity||"1",onChange:A=>f({...u,quantity:parseInt(A.target.value)}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:u.assignedTo||"",onChange:A=>f({...u,assignedTo:A.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"",children:""}),yn.map(A=>l.jsxs("option",{value:A.id,children:[A.name," (",A.department,")"]},A.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("textarea",{value:u.notes||"",onChange:A=>f({...u,notes:A.target.value}),placeholder:": ",rows:2,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"date",value:u.startTime?be(u.startTime,"yyyy-MM-dd"):"",onChange:A=>{const ee=new Date(A.target.value),oe=u.startTime||new Date,xe=u.endTime||new Date,_e=new Date(ee);_e.setHours(oe.getHours(),oe.getMinutes());const Ce=new Date(ee);Ce.setHours(xe.getHours(),xe.getMinutes()),f({...u,startTime:_e,endTime:Ce})},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("select",{value:u.startTime?be(u.startTime,"HH:mm"):"",onChange:A=>{const[ee,oe]=A.target.value.split(":").map(Number),xe=new Date(u.startTime||new Date);xe.setHours(ee,oe,0,0),f({...u,startTime:xe})},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0,children:W.map(A=>l.jsx("option",{value:A,children:A},A))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("select",{value:u.endTime?be(u.endTime,"HH:mm"):"",onChange:A=>{const[ee,oe]=A.target.value.split(":").map(Number),xe=new Date(u.endTime||new Date);xe.setHours(ee,oe,0,0),f({...u,endTime:xe})},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0,children:W.map(A=>l.jsx("option",{value:A,children:A},A))})]})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:u.isAllDay||!1,onChange:A=>f({...u,isAllDay:A.target.checked}),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("label",{className:"ml-2 text-sm text-gray-700",children:""})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("div",{children:l.jsxs("select",{value:((z=u.recurrence)==null?void 0:z.frequency)||"none",onChange:A=>{const ee=A.target.value;f(ee==="none"?{...u,recurrence:null}:{...u,recurrence:{frequency:ee,interval:1,endType:"never",endDate:null,count:null,weekdays:[]}})},className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"none",children:""}),l.jsx("option",{value:"daily",children:""}),l.jsx("option",{value:"weekly",children:""}),l.jsx("option",{value:"monthly",children:""}),l.jsx("option",{value:"yearly",children:""}),l.jsx("option",{value:"weekdays",children:""}),l.jsx("option",{value:"custom",children:""})]})}),u.recurrence&&u.recurrence.frequency!=="none"&&u.recurrence.frequency!=="weekdays"&&l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600",children:""}),l.jsx("input",{type:"number",min:"1",max:"365",value:u.recurrence.interval||1,onChange:A=>f({...u,recurrence:{...u.recurrence,interval:parseInt(A.target.value)}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600",children:""}),l.jsxs("select",{value:u.recurrence.endType||"never",onChange:A=>f({...u,recurrence:{...u.recurrence,endType:A.target.value}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"never",children:""}),l.jsx("option",{value:"date",children:""}),l.jsx("option",{value:"count",children:""})]})]})]}),((U=u.recurrence)==null?void 0:U.endType)==="date"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600",children:""}),l.jsx("input",{type:"date",value:u.recurrence.endDate?be(new Date(u.recurrence.endDate),"yyyy-MM-dd"):"",onChange:A=>f({...u,recurrence:{...u.recurrence,endDate:new Date(A.target.value)}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),((Z=u.recurrence)==null?void 0:Z.endType)==="count"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600",children:""}),l.jsx("input",{type:"number",min:"1",max:"999",value:u.recurrence.count||"",onChange:A=>f({...u,recurrence:{...u.recurrence,count:parseInt(A.target.value)}}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),((G=u.recurrence)==null?void 0:G.frequency)==="custom"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600 mb-2",children:""}),l.jsx("div",{className:"grid grid-cols-7 gap-1",children:["","","","","","",""].map((A,ee)=>{var oe,xe;return l.jsxs("label",{className:"flex flex-col items-center",children:[l.jsx("input",{type:"checkbox",checked:((xe=(oe=u.recurrence)==null?void 0:oe.weekdays)==null?void 0:xe.includes(ee))||!1,onChange:_e=>{var Oe;const Ce=((Oe=u.recurrence)==null?void 0:Oe.weekdays)||[];_e.target.checked?f({...u,recurrence:{...u.recurrence,weekdays:[...Ce,ee]}}):f({...u,recurrence:{...u.recurrence,weekdays:Ce.filter(ve=>ve!==ee)}})},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"text-xs text-gray-600 mt-1",children:A})]},ee)})})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsx("div",{className:"space-y-2",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("select",{value:((F=(k=u.reminders)==null?void 0:k[0])==null?void 0:F.time)||15,onChange:A=>{var oe,xe;const ee=parseInt(A.target.value);f({...u,reminders:[{time:ee,methods:((xe=(oe=u.reminders)==null?void 0:oe[0])==null?void 0:xe.methods)||["email"]}]})},className:"rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:5,children:"5"}),l.jsx("option",{value:10,children:"10"}),l.jsx("option",{value:15,children:"15"}),l.jsx("option",{value:30,children:"30"}),l.jsx("option",{value:60,children:"60"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:((H=(L=(C=u.reminders)==null?void 0:C[0])==null?void 0:L.methods)==null?void 0:H.includes("email"))||!1,onChange:A=>{var xe,_e,Ce,Oe;const ee=((_e=(xe=u.reminders)==null?void 0:xe[0])==null?void 0:_e.methods)||[],oe=A.target.checked?[...ee.filter(ve=>ve!=="email"),"email"]:ee.filter(ve=>ve!=="email");f({...u,reminders:[{time:((Oe=(Ce=u.reminders)==null?void 0:Ce[0])==null?void 0:Oe.time)||15,methods:oe}]})},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-1 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:((ae=(ne=(Q=u.reminders)==null?void 0:Q[0])==null?void 0:ne.methods)==null?void 0:ae.includes("notification"))||!1,onChange:A=>{var xe,_e,Ce,Oe;const ee=((_e=(xe=u.reminders)==null?void 0:xe[0])==null?void 0:_e.methods)||[],oe=A.target.checked?[...ee.filter(ve=>ve!=="notification"),"notification"]:ee.filter(ve=>ve!=="notification");f({...u,reminders:[{time:((Oe=(Ce=u.reminders)==null?void 0:Ce[0])==null?void 0:Oe.time)||15,methods:oe}]})},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-1 text-sm text-gray-700",children:""})]})]})]})})]}),o&&l.jsxs("div",{className:"border-t pt-4",children:[l.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:""}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[w&&l.jsxs("div",{className:"flex items-center justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:":"}),l.jsxs("span",{className:"text-gray-900",children:[w.name," (ID: ",w.employee_id,")",o.createdAt&&l.jsx("span",{className:"ml-2 text-gray-500",children:be(new Date(o.createdAt),"yyyy/MM/dd HH:mm")})]})]}),E&&o.updatedAt&&l.jsxs("div",{className:"flex items-center justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:":"}),l.jsxs("span",{className:"text-gray-900",children:[E.name," (ID: ",E.employee_id,")",l.jsx("span",{className:"ml-2 text-gray-500",children:be(new Date(o.updatedAt),"yyyy/MM/dd HH:mm")})]})]})]})]}),l.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[l.jsx("div",{children:o&&l.jsx("button",{type:"button",onClick:()=>{confirm("")&&(r({...u,_delete:!0}),t())},className:"px-4 py-2 border border-red-300 rounded-md shadow-sm text-sm font-medium text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:""})}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:""}),l.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:o?"":""})]})]})]}),y&&l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(nc,{className:"h-6 w-6 text-yellow-600 mr-2"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("p",{className:"text-sm text-gray-600 mb-2",children:""}),l.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:g.map(A=>{const ee=A.startTime||A.start_time,oe=A.endTime||A.end_time,xe=ee?new Date(ee):null,_e=oe?new Date(oe):null;return!xe||!_e||isNaN(xe.getTime())||isNaN(_e.getTime())?(console.error("Invalid date in conflicting schedule:",A),l.jsxs("div",{className:"p-2 bg-red-50 rounded border border-red-200",children:[l.jsx("div",{className:"font-medium text-red-800",children:A.title}),l.jsx("div",{className:"text-sm text-red-600",children:""})]},A.id)):l.jsxs("div",{className:"p-2 bg-red-50 rounded border border-red-200",children:[l.jsx("div",{className:"font-medium text-red-800",children:A.title}),l.jsxs("div",{className:"text-sm text-red-600",children:[be(xe,"MM/dd HH:mm")," - ",be(_e,"HH:mm")]})]},A.id)})})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx("button",{type:"button",onClick:()=>v(!1),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:""}),l.jsx("button",{type:"button",onClick:le,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700",children:""})]})]})})]})}):null}function f3(){const{currentUser:e}=Ht(),{currentDate:t,view:r,visibleUsers:n,setView:s,goToNextPeriod:i,goToPreviousPeriod:a,goToToday:o,toggleUserVisibility:c,getSchedulesForDateRange:d,addSchedule:u,updateSchedule:f,refreshSchedules:h}=Jo(),[p,x]=b.useState(n.length>0?n:[]),[m,g]=b.useState([]),[_,y]=b.useState(!0),[v,w]=b.useState(!1),[N,E]=b.useState(null),[T,M]=b.useState(null),[P,B]=b.useState(null);b.useEffect(()=>{W()},[]);const W=async()=>{try{y(!0);const{data:F,error:C}=await me.from("users").select("*").order("name_kana");if(C){console.error("Error fetching users:",C);const L=[...yn].sort((H,Q)=>(H.nameKana||H.name).localeCompare(Q.nameKana||Q.name,"ja",{sensitivity:"base",numeric:!0}));g(L)}else{const L=(F==null?void 0:F.map(Q=>({id:Q.id,employeeId:Q.employee_id,name:Q.name,nameKana:Q.name_kana,email:Q.email,phone:Q.phone,department:Q.department,role:Q.role,defaultWorkDays:Q.default_work_days||[]})))||[],H=L.sort((Q,ne)=>(Q.nameKana||Q.name).localeCompare(ne.nameKana||ne.name,"ja"));if(g(H),n.length===0){const Q=L.map(ne=>ne.id);x(Q),Q.forEach(ne=>c(ne))}}}catch(F){console.error("Error fetching users:",F),g(yn)}finally{y(!1)}},J=(()=>{switch(r){case"day":return[t];case"week":const F=Ot(t,{weekStartsOn:1});return Array.from({length:7},(ne,ae)=>Bt(F,ae));case"month":const C=ku(t),L=Tu(t),H=Ot(C,{weekStartsOn:1}),Q=Bt(Ot(Bt(L,6),{weekStartsOn:1}),6);return bu({start:H,end:Q});default:return[]}})(),Te=J.length>0?d(J[0],Bt(J[J.length-1],1)):[],ye=F=>{x(C=>C.includes(F)?C.filter(L=>L!==F):[...C,F]),c(F)},se=()=>{if(p.length===m.length)x([]),m.forEach(F=>{n.includes(F.id)&&c(F.id)});else{const F=m.map(C=>C.id);x(F),F.forEach(C=>{n.includes(C)||c(C)})}},le=(F,C)=>{M(F),B(C||null),E(null),w(!0)},z=(F,C)=>Te.filter(L=>(L.participants.includes(F)||L.createdBy===F)&&new Date(L.startTime).toDateString()===C.toDateString()),U=(F,C)=>{const L=new Date(F.startTime),H=new Date(F.endTime);return C.some(Q=>{if(Q.id===F.id)return!1;const ne=new Date(Q.startTime),ae=new Date(Q.endTime);return F.participants.some(ee=>Q.participants.includes(ee))?L<ae&&H>ne:!1})},Z=()=>r==="month"?G():k(),G=()=>{const F=[];for(let C=0;C<J.length;C+=7)F.push(J.slice(C,C+7));return l.jsxs("div",{className:"bg-white",children:[l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200 bg-gray-50",children:["","","","","","",""].map((C,L)=>l.jsx("div",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:C},L))}),F.map((C,L)=>l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:C.map((H,Q)=>{const ne=Nu(H,t),ae=p.flatMap(A=>z(A,H));return l.jsxs("div",{className:`min-h-[120px] p-2 border-r border-gray-200 ${ne?"bg-white":"bg-gray-50 text-gray-400"}`,children:[l.jsx("div",{className:`text-sm font-medium mb-1 ${ps(H)?"bg-blue-100 text-blue-800 rounded-full w-6 h-6 flex items-center justify-center":""}`,children:be(H,"d")}),l.jsxs("div",{className:"space-y-1",children:[ae.slice(0,3).map(A=>{var xe,_e;const ee=m.find(Ce=>A.participants.includes(Ce.id)||A.createdBy===Ce.id),oe=U(A,Te);return l.jsx("div",{onClick:()=>{E(A),w(!0)},className:`text-xs px-1 py-0.5 rounded truncate cursor-pointer hover:opacity-80
                            ${A.type===""?"bg-blue-100 text-blue-800":A.type===""?"bg-purple-100 text-purple-800":A.type===""?"bg-amber-100 text-amber-800":A.type===""?"bg-emerald-100 text-emerald-800":A.type===""?"bg-yellow-100 text-yellow-800":A.type===""||A.type==="CAD"||A.type===""||A.type===""||A.type===""||A.type===""||A.type===""?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,title:`${ee==null?void 0:ee.name}: ${A.title}${((xe=A.equipment)==null?void 0:xe.length)>0?` [${A.equipment.map(Ce=>Ce.name).join(", ")}]`:""}${A.meetLink?" (Google Meet)":""}${oe?"  ":""}`,children:l.jsxs("div",{className:"flex items-center space-x-1",children:[oe&&l.jsx(nc,{className:"h-3 w-3 flex-shrink-0 text-red-600"}),A.meetLink&&l.jsx(Gn,{className:"h-3 w-3 flex-shrink-0"}),l.jsxs("span",{className:"truncate",children:[A.title,((_e=A.equipment)==null?void 0:_e.length)>0&&l.jsxs("span",{className:"text-xs opacity-75 ml-1",children:["[",A.equipment.map(Ce=>Ce.name).join(", "),"]"]})]})]})},A.id)}),ae.length>3&&l.jsxs("div",{className:"text-xs text-gray-500",children:["+",ae.length-3,""]}),ae.length>=10&&l.jsxs("div",{className:"text-xs text-red-600 font-medium",children:[l.jsx(nc,{className:"h-3 w-3 inline mr-1"}),""]})]})]},Q)})},L))]})},k=()=>l.jsxs("div",{className:"bg-white",children:[l.jsx("div",{className:`grid ${r==="day"?"grid-cols-1":"grid-cols-7"} border-b border-gray-200 bg-gray-50`,children:J.map((F,C)=>l.jsx("div",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("span",{children:be(F,r==="day"?"yyyyMd EEEE":"EEEE",{locale:jr})}),r!=="day"&&l.jsx("span",{className:`mt-1 text-sm ${ps(F)?"bg-blue-100 text-blue-800 rounded-full w-7 h-7 flex items-center justify-center":""}`,children:be(F,"d")})]})},C))}),l.jsx("div",{className:"divide-y divide-gray-200",children:p.map(F=>{const C=m.find(L=>L.id===F);return C?l.jsxs("div",{className:"divide-y divide-gray-200",children:[l.jsx("div",{className:"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:C.name}),l.jsx("div",{className:`grid ${r==="day"?"grid-cols-1":"grid-cols-7"} divide-x divide-gray-200`,children:J.map((L,H)=>{const Q=z(F,L);return l.jsxs("div",{className:"min-h-[100px] px-2 py-2 text-sm text-gray-900 relative group",children:[l.jsx("button",{onClick:()=>le(L,F),className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200 bg-blue-100 rounded-full p-1 hover:bg-blue-200",children:l.jsx(Cn,{className:"h-4 w-4 text-blue-600"})}),Q.map(ne=>{var A;const ae=U(ne,Te);return l.jsxs("div",{onClick:()=>{E(ne),w(!0)},className:`mb-1 px-2 py-1 rounded text-xs cursor-pointer hover:opacity-80
                                ${ne.type===""?"bg-blue-100 text-blue-800":ne.type===""?"bg-purple-100 text-purple-800":ne.type===""?"bg-amber-100 text-amber-800":ne.type===""?"bg-emerald-100 text-emerald-800":ne.type===""?"bg-yellow-100 text-yellow-800":ne.type===""||ne.type==="CAD"||ne.type===""||ne.type===""||ne.type===""||ne.type===""||ne.type===""?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:[l.jsxs("div",{className:"font-medium flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-1",children:[ae&&l.jsx(nc,{className:"h-3 w-3 flex-shrink-0 text-red-600"}),l.jsxs("span",{children:[be(ne.startTime,"HH:mm"),"-",be(ne.endTime,"HH:mm")]})]}),ne.meetLink&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Gn,{className:"h-3 w-3"}),ne.meetingType&&l.jsx("span",{className:`px-1 py-0.5 rounded text-xs ${d3(ne.meetingType)}`,children:u3(ne.meetingType)})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("span",{className:"truncate",children:[ne.title,((A=ne.equipment)==null?void 0:A.length)>0&&l.jsxs("span",{className:"text-xs opacity-75 ml-1",children:["[",ne.equipment.map(ee=>ee.name).join(", "),"]"]})]}),ne.meetLink&&l.jsx("a",{href:ne.meetLink,target:"_blank",rel:"noopener noreferrer",onClick:ee=>ee.stopPropagation(),className:"ml-1 text-blue-600 hover:text-blue-800",title:"Google Meet",children:l.jsx(za,{className:"h-3 w-3"})})]})]},ne.id)})]},H)})})]},F):null})})]});return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{E(null),M(null),B(null),w(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[l.jsx(Cn,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsxs("div",{className:"bg-white shadow rounded-lg",children:[l.jsx("div",{className:"px-4 py-5 border-b border-gray-200 sm:px-6",children:l.jsxs("div",{className:"flex items-center justify-between flex-wrap sm:flex-nowrap",children:[l.jsx("div",{children:l.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:be(t,"yyyyM",{locale:jr})})}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("div",{className:"inline-flex shadow-sm rounded-md",children:[l.jsx("button",{type:"button",onClick:()=>s("day"),className:`relative inline-flex items-center px-4 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium ${r==="day"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>s("week"),className:`relative inline-flex items-center px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium ${r==="week"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>s("month"),className:`relative inline-flex items-center px-4 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium ${r==="month"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""})]}),l.jsxs("div",{className:"inline-flex rounded-md shadow-sm",children:[l.jsxs("button",{type:"button",onClick:a,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx(Ru,{className:"h-5 w-5"})]}),l.jsx("button",{type:"button",onClick:o,className:"relative inline-flex items-center px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",children:""}),l.jsxs("button",{type:"button",onClick:i,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx(Zo,{className:"h-5 w-5"})]})]})]})]})}),l.jsxs("div",{className:"flex flex-1",children:[l.jsxs("div",{className:"w-60 border-r border-gray-200 bg-gray-50 p-4",children:[l.jsxs("div",{className:"flex items-center mb-3",children:[l.jsx("input",{id:"select-all",name:"select-all",type:"checkbox",className:"h-4 w-4 text-blue-600 border-gray-300 rounded",checked:p.length===m.length&&m.length>0,onChange:se}),l.jsx("label",{htmlFor:"select-all",className:"ml-2 block text-sm text-gray-900 font-semibold",children:""})]}),l.jsx("div",{className:"space-y-2 max-h-[calc(100vh-250px)] overflow-auto",children:_?l.jsx("div",{className:"text-center py-4",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"})}):[...m].sort((F,C)=>{const L=p.includes(F.id),H=p.includes(C.id);if(L&&!H)return-1;if(!L&&H)return 1;const Q=F.nameKana||F.name,ne=C.nameKana||C.name;return Q.localeCompare(ne,"ja",{sensitivity:"base",numeric:!0})}).map(F=>l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{id:`user-${F.id}`,name:`user-${F.id}`,type:"checkbox",className:"h-4 w-4 text-blue-600 border-gray-300 rounded",checked:p.includes(F.id),onChange:()=>ye(F.id)}),l.jsxs("label",{htmlFor:`user-${F.id}`,className:"ml-2 block text-sm text-gray-700",children:[F.name,l.jsxs("span",{className:"ml-1 text-xs text-gray-500",children:["(",F.department,")"]})]})]},F.id))})]}),l.jsx("div",{className:"flex-1 overflow-auto",children:Z()})]})]}),l.jsx(Iu,{isOpen:v,onClose:()=>{w(!1),E(null),M(null),B(null)},onSubmit:async F=>{try{if(console.log("MyCalendar onSubmit called with:",F),console.log("Current user:",e),console.log("Editing schedule:",N),F._delete&&N)try{const{error:C}=await me.from("schedules").delete().eq("id",N.id);if(C)throw C;await h();return}catch(C){console.error("Error deleting schedule:",C),alert("");return}if(N){const C={...N,...F,id:N.id,createdAt:N.createdAt,createdBy:N.createdBy,updatedBy:e==null?void 0:e.id,updatedAt:new Date};console.log("Updating schedule:",C),f(C)}else{const C={...F,createdBy:e==null?void 0:e.id};console.log("Creating schedule:",C);const L=await u(C);if(console.log("addSchedule result:",L),!L){console.error("addSchedule returned false");return}}}catch(C){console.error("Error saving schedule - Full error object:",C),console.error("Error message:",C==null?void 0:C.message),console.error("Error stack:",C==null?void 0:C.stack),alert(`: ${(C==null?void 0:C.message)||"Unknown error"}`)}},selectedDate:T,selectedParticipant:P,type:"general",editingSchedule:N})]})}function h3(){const{currentDate:e,view:t,setView:r,goToNextPeriod:n,goToPreviousPeriod:s,goToToday:i,getSchedulesForEquipment:a,addSchedule:o,refreshSchedules:c}=Jo(),[d,u]=b.useState(!1),[f,h]=b.useState(null),[p,x]=b.useState(null),[m,g]=b.useState(null),[_,y]=b.useState([]),[v,w]=b.useState([]);b.useEffect(()=>{N(),E()},[]);const N=async()=>{try{const{data:U,error:Z}=await me.from("vehicles").select("*").order("name");if(Z)console.error("Error fetching vehicles:",Z),y(Rc);else{const G=(U==null?void 0:U.map(k=>({id:k.id,name:k.name,licensePlate:k.license_plate,type:k.type,createdBy:k.created_by})))||[];y(G)}}catch(U){console.error("Error fetching vehicles:",U),y(Rc)}},E=async()=>{try{const{data:U,error:Z}=await me.from("users").select("id, name, employee_id").order("name");Z?console.error("Error fetching users:",Z):w(U||[])}catch(U){console.error("Error fetching users:",U)}},M=(()=>{switch(t){case"day":return[e];case"week":const U=Ot(e,{weekStartsOn:1});return Array.from({length:7},(C,L)=>Bt(U,L));case"month":const Z=ku(e),G=Tu(e),k=Ot(Z,{weekStartsOn:1}),F=Bt(Ot(Bt(G,6),{weekStartsOn:1}),6);return bu({start:k,end:F});default:return[]}})(),[P,B]=b.useState([]);b.useEffect(()=>{W()},[e,t]);const W=async()=>{try{if(M.length===0)return;const U=be(M[0],"yyyy-MM-dd"),Z=be(M[M.length-1],"yyyy-MM-dd"),{data:G,error:k}=await me.from("schedules").select("*").gte("start_time",`${U}T00:00:00.000Z`).lte("start_time",`${Z}T23:59:59.999Z`).order("start_time");k?console.error("Error fetching vehicle schedules:",k):B(G||[])}catch(U){console.error("Error fetching vehicle schedules:",U)}},Y=(U,Z)=>P.filter(G=>{var F;return new Date(G.start_time).toDateString()===Z.toDateString()&&((F=G.equipment)==null?void 0:F.some(C=>C.id===U&&C.type==="vehicle"))}).map(G=>({...G,startTime:new Date(G.start_time),endTime:new Date(G.end_time)})),J=U=>!U||U.length===0?"":U.map(G=>{var k;return(k=v.find(F=>F.id===G))==null?void 0:k.name}).filter(Boolean).join(", "),Te=(U,Z)=>{h({id:U.id,name:U.name,type:"vehicle"}),x(Z),g(null),u(!0)},ye=async U=>{try{await o(U)&&(await c(),await W(),u(!1))}catch(Z){console.error("Error saving vehicle reservation:",Z),alert("")}},se=()=>t==="month"?z():le(),le=()=>l.jsx("div",{className:"overflow-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-48",children:""}),M.map((U,Z)=>l.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("span",{children:be(U,t==="day"?"yyyyMd EEEE":"EEEE",{locale:jr})}),t!=="day"&&l.jsx("span",{className:`mt-1 text-sm ${ps(U)?"bg-blue-100 text-blue-800 rounded-full w-7 h-7 flex items-center justify-center":""}`,children:be(U,"d")})]})},Z))]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:_.map(U=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-amber-100 flex items-center justify-center",children:l.jsx(aa,{className:"h-6 w-6 text-amber-600"})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:U.name}),l.jsx("div",{className:"text-xs text-gray-500",children:U.licensePlate})]})]})}),M.map((Z,G)=>{const k=Y(U.id,Z);return l.jsxs("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-500 relative group border border-gray-100",children:[l.jsx("button",{onClick:()=>Te(U,Z),className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200 bg-amber-100 rounded-full p-1",children:l.jsx(Cn,{className:"h-4 w-4 text-amber-600"})}),l.jsx("div",{className:t==="day"?"min-h-[120px]":"min-h-[80px]",children:k.map(F=>l.jsxs("div",{className:"mb-1 px-2 py-1 rounded text-xs bg-amber-100 text-amber-800 border-l-4 border-amber-500 cursor-pointer hover:bg-amber-200",onClick:()=>{g(F),u(!0)},children:[l.jsxs("div",{className:"font-medium",children:[be(F.startTime,"HH:mm"),"-",be(F.endTime,"HH:mm")]}),l.jsx("div",{className:"truncate",children:F.title}),l.jsx("div",{className:"text-xs text-amber-600",children:J(F.participants||[])}),F.details&&l.jsx("div",{className:"text-xs text-amber-500 truncate",children:F.details})]},F.id))})]},G)})]},U.id))})]})}),z=()=>{const U=[];for(let Z=0;Z<M.length;Z+=7)U.push(M.slice(Z,Z+7));return l.jsxs("div",{className:"overflow-auto",children:[l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200 bg-gray-50",children:["","","","","","",""].map((Z,G)=>l.jsx("div",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:Z},G))}),U.map((Z,G)=>l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:Z.map((k,F)=>{const C=Nu(k,e),L=_.flatMap(H=>Y(H.id,k));return l.jsxs("div",{className:`min-h-[120px] p-2 border-r border-gray-200 ${C?"bg-white":"bg-gray-50 text-gray-400"}`,children:[l.jsx("div",{className:`text-sm font-medium mb-1 ${ps(k)?"bg-blue-100 text-blue-800 rounded-full w-6 h-6 flex items-center justify-center":""}`,children:be(k,"d")}),l.jsxs("div",{className:"space-y-1",children:[L.slice(0,3).map(H=>{const Q=_.find(ne=>{var ae;return(ae=H.equipment)==null?void 0:ae.some(A=>A.id===ne.id&&A.type==="vehicle")});return l.jsxs("div",{onClick:()=>{g(H),u(!0)},className:"text-xs px-1 py-0.5 rounded truncate cursor-pointer hover:opacity-80 bg-amber-100 text-amber-800",title:`${Q==null?void 0:Q.name}: ${H.title} [${J(H.participants||[])}]`,children:[l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(aa,{className:"h-3 w-3 flex-shrink-0"}),l.jsx("span",{className:"truncate",children:H.title})]}),l.jsx("div",{className:"text-xs text-amber-600 truncate mt-1",children:J(H.participants||[])})]},H.id)}),L.length>3&&l.jsxs("div",{className:"text-xs text-gray-500",children:["+",L.length-3,""]})]})]},F)})},G))]})};return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{h(null),x(null),g(null),u(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-amber-600 hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500",children:[l.jsx(Cn,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsxs("div",{className:"bg-white shadow rounded-lg",children:[l.jsx("div",{className:"px-4 py-5 border-b border-gray-200 sm:px-6",children:l.jsxs("div",{className:"flex items-center justify-between flex-wrap sm:flex-nowrap",children:[l.jsx("div",{children:l.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:be(e,"yyyyM",{locale:jr})})}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("div",{className:"inline-flex shadow-sm rounded-md",children:[l.jsx("button",{type:"button",onClick:()=>r("day"),className:`relative inline-flex items-center px-4 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium ${t==="day"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>r("week"),className:`relative inline-flex items-center px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium ${t==="week"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>r("month"),className:`relative inline-flex items-center px-4 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium ${t==="month"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""})]}),l.jsxs("div",{className:"inline-flex rounded-md shadow-sm",children:[l.jsxs("button",{type:"button",onClick:s,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx(Ru,{className:"h-5 w-5"})]}),l.jsx("button",{type:"button",onClick:i,className:"relative inline-flex items-center px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",children:""}),l.jsxs("button",{type:"button",onClick:n,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx(Zo,{className:"h-5 w-5"})]})]})]})]})}),se()]}),l.jsx(Iu,{isOpen:d,onClose:()=>u(!1),onSubmit:ye,selectedDate:p||void 0,selectedEquipment:f||void 0,type:"vehicle",editingSchedule:m})]})}function m3(){const{currentDate:e,view:t,setView:r,goToNextPeriod:n,goToPreviousPeriod:s,goToToday:i,getSchedulesForEquipment:a,addSchedule:o}=Jo(),[c,d]=b.useState(!1),[u,f]=b.useState(null),[h,p]=b.useState(null),[x,m]=b.useState(null),[g,_]=b.useState([]),[y,v]=b.useState([]);b.useEffect(()=>{w(),N()},[]);const w=async()=>{try{const{data:z,error:U}=await me.from("rooms").select("*").order("name");U?(console.error("Error fetching rooms:",U),_(Dc)):_(z||[])}catch(z){console.error("Error fetching rooms:",z),_(Dc)}},N=async()=>{try{const{data:z,error:U}=await me.from("users").select("id, name, employee_id").order("name");U?console.error("Error fetching users:",U):v(z||[])}catch(z){console.error("Error fetching users:",z)}},T=(()=>{switch(t){case"day":return[e];case"week":const z=Ot(e,{weekStartsOn:1});return Array.from({length:7},(F,C)=>Bt(z,C));case"month":const U=ku(e),Z=Tu(e),G=Ot(U,{weekStartsOn:1}),k=Bt(Ot(Bt(Z,6),{weekStartsOn:1}),6);return bu({start:G,end:k});default:return[]}})(),[M,P]=b.useState([]);b.useEffect(()=>{B()},[e,t]);const B=async()=>{try{if(T.length===0)return;const z=be(T[0],"yyyy-MM-dd"),U=be(T[T.length-1],"yyyy-MM-dd"),{data:Z,error:G}=await me.from("schedules").select("*").gte("start_time",`${z}T00:00:00.000Z`).lte("start_time",`${U}T23:59:59.999Z`).order("start_time");G?console.error("Error fetching room schedules:",G):P(Z||[])}catch(z){console.error("Error fetching room schedules:",z)}},W=(z,U)=>M.filter(Z=>{var k;return new Date(Z.start_time).toDateString()===U.toDateString()&&((k=Z.equipment)==null?void 0:k.some(F=>F.id===z&&F.type==="room"))}).map(Z=>({...Z,startTime:new Date(Z.start_time),endTime:new Date(Z.end_time)})),Y=z=>!z||z.length===0?"":z.map(Z=>{var G;return(G=y.find(k=>k.id===Z))==null?void 0:G.name}).filter(Boolean).join(", "),J=(z,U)=>{f({id:z.id,name:z.name,type:"room"}),p(U),m(null),d(!0)},Te=async z=>{try{await o(z)&&(await B(),d(!1))}catch(U){console.error("Error saving room reservation:",U),alert("")}},ye=()=>t==="month"?le():se(),se=()=>l.jsx("div",{className:"overflow-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-48",children:""}),T.map((z,U)=>l.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("span",{children:be(z,t==="day"?"yyyyMd EEEE":"EEEE",{locale:jr})}),t!=="day"&&l.jsx("span",{className:`mt-1 text-sm ${ps(z)?"bg-blue-100 text-blue-800 rounded-full w-7 h-7 flex items-center justify-center":""}`,children:be(z,"d")})]})},U))]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(z=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-emerald-100 flex items-center justify-center",children:l.jsx(oa,{className:"h-6 w-6 text-emerald-600"})}),l.jsx("div",{className:"ml-4",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:z.name})})]})}),T.map((U,Z)=>{const G=W(z.id,U);return l.jsxs("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-500 relative group border border-gray-100",children:[l.jsx("button",{onClick:()=>J(z,U),className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200 bg-emerald-100 rounded-full p-1",children:l.jsx(Cn,{className:"h-4 w-4 text-emerald-600"})}),l.jsx("div",{className:t==="day"?"min-h-[120px]":"min-h-[80px]",children:G.map(k=>l.jsxs("div",{className:"mb-1 px-2 py-1 rounded text-xs bg-emerald-100 text-emerald-800 border-l-4 border-emerald-500 cursor-pointer hover:bg-emerald-200",onClick:()=>{m(k),d(!0)},children:[l.jsxs("div",{className:"font-medium",children:[be(k.startTime,"HH:mm"),"-",be(k.endTime,"HH:mm")]}),l.jsx("div",{className:"truncate",children:k.title}),l.jsx("div",{className:"text-xs text-emerald-600",children:Y(k.participants||[])}),k.details&&l.jsx("div",{className:"text-xs text-emerald-500 truncate",children:k.details})]},k.id))})]},Z)})]},z.id))})]})}),le=()=>{const z=[];for(let U=0;U<T.length;U+=7)z.push(T.slice(U,U+7));return l.jsxs("div",{className:"overflow-auto",children:[l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200 bg-gray-50",children:["","","","","","",""].map((U,Z)=>l.jsx("div",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:U},Z))}),z.map((U,Z)=>l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:U.map((G,k)=>{const F=Nu(G,e),C=g.flatMap(L=>W(L.id,G));return l.jsxs("div",{className:`min-h-[120px] p-2 border-r border-gray-200 ${F?"bg-white":"bg-gray-50 text-gray-400"}`,children:[l.jsx("div",{className:`text-sm font-medium mb-1 ${ps(G)?"bg-blue-100 text-blue-800 rounded-full w-6 h-6 flex items-center justify-center":""}`,children:be(G,"d")}),l.jsxs("div",{className:"space-y-1",children:[C.slice(0,3).map(L=>{const H=g.find(Q=>{var ne;return(ne=L.equipment)==null?void 0:ne.some(ae=>ae.id===Q.id&&ae.type==="room")});return l.jsxs("div",{onClick:()=>{m(L),d(!0)},className:"text-xs px-1 py-0.5 rounded truncate cursor-pointer hover:opacity-80 bg-emerald-100 text-emerald-800",title:`${H==null?void 0:H.name}: ${L.title} [${Y(L.participants||[])}]`,children:[l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(oa,{className:"h-3 w-3 flex-shrink-0"}),l.jsx("span",{className:"truncate",children:L.title})]}),l.jsx("div",{className:"text-xs text-emerald-600 truncate mt-1",children:Y(L.participants||[])})]},L.id)}),C.length>3&&l.jsxs("div",{className:"text-xs text-gray-500",children:["+",C.length-3,""]})]})]},k)})},Z))]})};return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{f(null),p(null),d(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500",children:[l.jsx(Cn,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsxs("div",{className:"bg-white shadow rounded-lg",children:[l.jsx("div",{className:"px-4 py-5 border-b border-gray-200 sm:px-6",children:l.jsxs("div",{className:"flex items-center justify-between flex-wrap sm:flex-nowrap",children:[l.jsx("div",{children:l.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:be(e,"yyyyM",{locale:jr})})}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("div",{className:"inline-flex shadow-sm rounded-md",children:[l.jsx("button",{type:"button",onClick:()=>r("day"),className:`relative inline-flex items-center px-4 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium ${t==="day"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>r("week"),className:`relative inline-flex items-center px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium ${t==="week"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>r("month"),className:`relative inline-flex items-center px-4 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium ${t==="month"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""})]}),l.jsxs("div",{className:"inline-flex rounded-md shadow-sm",children:[l.jsxs("button",{type:"button",onClick:s,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx(Ru,{className:"h-5 w-5"})]}),l.jsx("button",{type:"button",onClick:i,className:"relative inline-flex items-center px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",children:""}),l.jsxs("button",{type:"button",onClick:n,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx(Zo,{className:"h-5 w-5"})]})]})]})]})}),ye()]}),l.jsx(Iu,{isOpen:c,onClose:()=>d(!1),onSubmit:Te,selectedDate:h||void 0,selectedEquipment:u||void 0,type:"room",editingSchedule:x})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Hc={};Hc.version="0.18.5";var ny=1252,p3=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],sy=function(e){p3.indexOf(e)!=-1&&(ny=e)};function g3(){sy(1252)}var Ro=function(e){sy(e)};function x3(){Ro(1200),g3()}var Pl=function(t){return String.fromCharCode(t)},Qp=function(t){return String.fromCharCode(t)},Is,es="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Io(e){for(var t="",r=0,n=0,s=0,i=0,a=0,o=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,n=e.charCodeAt(d++),a=(r&3)<<4|n>>4,s=e.charCodeAt(d++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=es.charAt(i)+es.charAt(a)+es.charAt(o)+es.charAt(c);return t}function An(e){var t="",r=0,n=0,s=0,i=0,a=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=es.indexOf(e.charAt(d++)),a=es.indexOf(e.charAt(d++)),r=i<<2|a>>4,t+=String.fromCharCode(r),o=es.indexOf(e.charAt(d++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=es.indexOf(e.charAt(d++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Ie=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),In=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Qs(e){return Ie?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Zp(e){return Ie?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Hr=function(t){return Ie?In(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Lu(e){if(typeof ArrayBuffer>"u")return Hr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function el(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function v3(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Nt=Ie?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:In(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function y3(e){for(var t=[],r=0,n=e.length+250,s=Qs(e.length+255),i=0;i<e.length;++i){var a=e.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Qs(65535),n=65530)}return t.push(s.slice(0,r)),Nt(t)}var oo=/\u0000/g,Dl=/[\u0001-\u0006]/g;function Gi(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Vr(e,t){var r=""+e;return r.length>=t?r:st("0",t-r.length)+r}function yh(e,t){var r=""+e;return r.length>=t?r:st(" ",t-r.length)+r}function zc(e,t){var r=""+e;return r.length>=t?r:r+st(" ",t-r.length)}function w3(e,t){var r=""+Math.round(e);return r.length>=t?r:st("0",t-r.length)+r}function _3(e,t){var r=""+e;return r.length>=t?r:st("0",t-r.length)+r}var eg=Math.pow(2,32);function yi(e,t){if(e>eg||e<-eg)return w3(e,t);var r=Math.round(e);return _3(r,t)}function Vc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var tg=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ld=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function E3(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var at={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},rg={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},S3={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Gc(e,t,r){for(var n=e<0?-1:1,s=e*n,i=0,a=1,o=0,c=1,d=0,u=0,f=Math.floor(s);d<t&&(f=Math.floor(s),o=f*a+i,u=f*d+c,!(s-f<5e-8));)s=1/(s-f),i=a,a=o,c=d,d=u;if(u>t&&(d>t?(u=c,o=i):(u=d,o=a)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function Rl(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),i=0,a=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=A3(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var iy=new Date(1899,11,31,0,0,0),T3=iy.getTime(),b3=new Date(1900,2,1,0,0,0);function ay(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=b3&&(r+=24*60*60*1e3),(r-(T3+(e.getTimezoneOffset()-iy.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function wh(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function k3(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function N3(e){var t=e<0?12:11,r=wh(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function j3(e){var t=wh(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function C3(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=N3(e):t===10?r=e.toFixed(10).substr(0,12):r=j3(e),wh(k3(r.toUpperCase()))}function of(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):C3(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return gs(14,ay(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function A3(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function O3(e,t,r,n){var s="",i=0,a=0,o=r.y,c,d=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,d=2;break;default:c=o%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return Ld[r.m-1][1];case 5:return Ld[r.m-1][0];default:return Ld[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return tg[r.q][0];default:return tg[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Vr(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),t==="s"?i===0?"0":""+i/a:(s=Vr(i,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=o,d=1;break}var u=d>0?Vr(c,d):"";return u}function ts(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var oy=/%/g;function F3(e,t,r){var n=t.replace(oy,""),s=t.length-n.length;return _n(e,n,r*Math.pow(10,2*s))+st("%",s)}function P3(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return _n(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function ly(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ly(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,u){return c+d+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var cy=/# (\?+)( ?)\/( ?)(\d+)/;function D3(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?st(" ",e[1].length+1+e[4].length):yh(a,e[1].length)+e[2]+"/"+e[3]+Vr(o,e[4].length))}function R3(e,t,r){return r+(t===0?"":""+t)+st(" ",e[1].length+2+e[4].length)}var uy=/^#*0*\.([0#]+)/,dy=/\).*[0#]/,fy=/\(###\) ###\\?-####/;function Gt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function ng(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function sg(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function I3(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function L3(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Sr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(dy)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Sr("n",n,r):"("+Sr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return P3(e,t,r);if(t.indexOf("%")!==-1)return F3(e,t,r);if(t.indexOf("E")!==-1)return ly(t,r);if(t.charCodeAt(0)===36)return"$"+Sr(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,a,o,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+yi(c,t.length);if(t.match(/^[#?]+$/))return s=yi(r,0),s==="0"&&(s=""),s.length>t.length?s:Gt(t.substr(0,t.length-s.length))+s;if(i=t.match(cy))return D3(i,c,d);if(t.match(/^#+0+$/))return d+yi(c,t.length-t.indexOf("0"));if(i=t.match(uy))return s=ng(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Gt(i[1])).replace(/\.$/,"."+Gt(i[1])).replace(/\.(\d*)$/,function(x,m){return"."+m+st("0",Gt(i[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+ng(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+ts(yi(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Sr(e,t,-r):ts(""+(Math.floor(r)+I3(r,i[1].length)))+"."+Vr(sg(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Sr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Gi(Sr(e,t.replace(/[\\-]/g,""),r)),a=0,Gi(Gi(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<s.length?s.charAt(a++):x==="0"?"0":""}));if(t.match(fy))return s=Sr(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=Gc(c,Math.pow(10,a)-1,!1),s=""+d,u=_n("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=zc(o[2],a),u.length<i[4].length&&(u=Gt(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=Gc(c,Math.pow(10,a)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?yh(o[1],a)+i[2]+"/"+i[3]+zc(o[2],a):st(" ",2*a+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=yi(r,0),t.length<=s.length?s:Gt(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var f=t.indexOf(".")-a,h=t.length-s.length-f;return Gt(t.substr(0,f)+s+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return a=sg(r,i[1].length),r<0?"-"+Sr(e,t,-r):ts(L3(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Vr(0,3-x.length):"")+x})+"."+Vr(a,i[1].length);switch(t){case"###,##0.00":return Sr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=ts(yi(c,0));return p!=="0"?d+p:"";case"###,###.00":return Sr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Sr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function M3(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return _n(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function B3(e,t,r){var n=t.replace(oy,""),s=t.length-n.length;return _n(e,n,r*Math.pow(10,2*s))+st("%",s)}function hy(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+hy(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,u){return c+d+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Zr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(dy)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Zr("n",n,r):"("+Zr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return M3(e,t,r);if(t.indexOf("%")!==-1)return B3(e,t,r);if(t.indexOf("E")!==-1)return hy(t,r);if(t.charCodeAt(0)===36)return"$"+Zr(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,a,o,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Vr(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Gt(t.substr(0,t.length-s.length))+s;if(i=t.match(cy))return R3(i,c,d);if(t.match(/^#+0+$/))return d+Vr(c,t.length-t.indexOf("0"));if(i=t.match(uy))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Gt(i[1])).replace(/\.$/,"."+Gt(i[1])),s=s.replace(/\.(\d*)$/,function(x,m){return"."+m+st("0",Gt(i[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+ts(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Zr(e,t,-r):ts(""+r)+"."+st("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Zr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Gi(Zr(e,t.replace(/[\\-]/g,""),r)),a=0,Gi(Gi(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<s.length?s.charAt(a++):x==="0"?"0":""}));if(t.match(fy))return s=Zr(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=Gc(c,Math.pow(10,a)-1,!1),s=""+d,u=_n("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=zc(o[2],a),u.length<i[4].length&&(u=Gt(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=Gc(c,Math.pow(10,a)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?yh(o[1],a)+i[2]+"/"+i[3]+zc(o[2],a):st(" ",2*a+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Gt(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var f=t.indexOf(".")-a,h=t.length-s.length-f;return Gt(t.substr(0,f)+s+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Zr(e,t,-r):ts(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Vr(0,3-x.length):"")+x})+"."+Vr(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=ts(""+c);return p!=="0"?d+p:"";default:if(t.match(/\.[0#?]*$/))return Zr(e,t.slice(0,t.lastIndexOf(".")),r)+Gt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function _n(e,t,r){return(r|0)===r?Zr(e,t,r):Sr(e,t,r)}function $3(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var my=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function py(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Vc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(my))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function U3(e,t,r,n){for(var s=[],i="",a=0,o="",c="t",d,u,f,h="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!Vc(e,a))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(f=e.charCodeAt(++a))!==34&&a<e.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++a;break;case"\\":var p=e.charAt(++a),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(d==null&&(d=Rl(t,r,e.charAt(a+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Rl(t,r),d==null))return"";for(i=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var m={t:o,v:o};if(d==null&&(d=Rl(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(d!=null&&(m.v=d.H>=12?"P":"A"),m.t="T",h="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(d!=null&&(m.v=d.H>=12?"PM":"AM"),m.t="T",a+=5,h="h"):e.substr(a,5).toUpperCase()==="/"?(d!=null&&(m.v=d.H>=12?"":""),m.t="T",a+=5,h="h"):(m.t="t",++a),d==null&&m.t==="T")return"";s[s.length]=m,c=o;break;case"[":for(i=o;e.charAt(a++)!=="]"&&a<e.length;)i+=e.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(my)){if(d==null&&(d=Rl(t,r),d==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",py(e)||(s[s.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=o;++a<e.length&&(o=e.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},c=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)i+=e.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++a;break}var g=0,_=0,y;for(a=s.length-1,c="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=h,c="h",g<1&&(g=1);break;case"s":(y=s[a].v.match(/\.0+$/))&&(_=Math.max(_,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=s[a].t;break;case"m":c==="s"&&(s[a].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&s[a].v.match(/[Hh]/)&&(g=1),g<2&&s[a].v.match(/[Mm]/)&&(g=2),g<3&&s[a].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var v="",w;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=O3(s[a].t.charCodeAt(0),s[a].v,d,_),s[a].t="t";break;case"n":case"?":for(w=a+1;s[w]!=null&&((o=s[w].t)==="?"||o==="D"||(o===" "||o==="t")&&s[w+1]!=null&&(s[w+1].t==="?"||s[w+1].t==="t"&&s[w+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[w].v==="/"||s[w].v===" "&&s[w+1]!=null&&s[w+1].t=="?"));)s[a].v+=s[w].v,s[w]={v:"",t:";"},++w;v+=s[a].v,a=w-1;break;case"G":s[a].t="t",s[a].v=of(t,r);break}var N="",E,T;if(v.length>0){v.charCodeAt(0)==40?(E=t<0&&v.charCodeAt(0)===45?-t:t,T=_n("n",v,E)):(E=t<0&&n>1?-t:t,T=_n("n",v,E),E<0&&s[0]&&s[0].t=="t"&&(T=T.substr(1),s[0].v="-"+s[0].v)),w=T.length-1;var M=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){M=a;break}var P=s.length;if(M===s.length&&T.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(w>=s[a].v.length-1?(w-=s[a].v.length,s[a].v=T.substr(w+1,s[a].v.length)):w<0?s[a].v="":(s[a].v=T.substr(0,w+1),w=-1),s[a].t="t",P=a);w>=0&&P<s.length&&(s[P].v=T.substr(0,w+1)+s[P].v)}else if(M!==s.length&&T.indexOf("E")===-1){for(w=T.indexOf(".")-1,a=M;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(u=s[a].v.indexOf(".")>-1&&a===M?s[a].v.indexOf(".")-1:s[a].v.length-1,N=s[a].v.substr(u+1);u>=0;--u)w>=0&&(s[a].v.charAt(u)==="0"||s[a].v.charAt(u)==="#")&&(N=T.charAt(w--)+N);s[a].v=N,s[a].t="t",P=a}for(w>=0&&P<s.length&&(s[P].v=T.substr(0,w+1)+s[P].v),w=T.indexOf(".")+1,a=M;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==M)){for(u=s[a].v.indexOf(".")>-1&&a===M?s[a].v.indexOf(".")+1:0,N=s[a].v.substr(0,u);u<s[a].v.length;++u)w<T.length&&(N+=T.charAt(w++));s[a].v=N,s[a].t="t",P=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(E=n>1&&t<0&&a>0&&s[a-1].v==="-"?-t:t,s[a].v=_n(s[a].t,s[a].v,E),s[a].t="t");var B="";for(a=0;a!==s.length;++a)s[a]!=null&&(B+=s[a].v);return B}var ig=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ag(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function W3(e,t){var r=$3(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(ig),o=r[1].match(ig);return ag(t,a)?[n,r[0]]:ag(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function gs(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:at)[e],n==null&&(n=r.table&&r.table[rg[e]]||at[rg[e]]),n==null&&(n=S3[e]||"General");break}if(Vc(n,0))return of(t,r);t instanceof Date&&(t=ay(t,r.date1904));var s=W3(n,t);if(Vc(s[1]))return of(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return U3(s[1],t,r,s[0])}function gy(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(at[r]==null){t<0&&(t=r);continue}if(at[r]==e){t=r;break}}t<0&&(t=391)}return at[t]=e,t}function Mu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&gy(e[t],t)}function Bu(){at=E3()}var xy=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function H3(e){var t=typeof e=="number"?at[e]:e;return t=t.replace(xy,"(\\d+)"),new RegExp("^"+t+"$")}function z3(e,t,r){var n=-1,s=-1,i=-1,a=-1,o=-1,c=-1;(t.match(xy)||[]).forEach(function(f,h){var p=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":i=p;break;case"h":a=p;break;case"s":c=p;break;case"m":a>=0?o=p:s=p;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?d:n==-1&&s==-1&&i==-1?u:d+"T"+u}var V3=function(){var e={};e.version="1.2.0";function t(){for(var T=0,M=new Array(256),P=0;P!=256;++P)T=P,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,M[P]=T;return typeof Int32Array<"u"?new Int32Array(M):M}var r=t();function n(T){var M=0,P=0,B=0,W=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)W[B]=T[B];for(B=0;B!=256;++B)for(P=T[B],M=256+B;M<4096;M+=256)P=W[M]=P>>>8^T[P&255];var Y=[];for(B=1;B!=16;++B)Y[B-1]=typeof Int32Array<"u"?W.subarray(B*256,B*256+256):W.slice(B*256,B*256+256);return Y}var s=n(r),i=s[0],a=s[1],o=s[2],c=s[3],d=s[4],u=s[5],f=s[6],h=s[7],p=s[8],x=s[9],m=s[10],g=s[11],_=s[12],y=s[13],v=s[14];function w(T,M){for(var P=M^-1,B=0,W=T.length;B<W;)P=P>>>8^r[(P^T.charCodeAt(B++))&255];return~P}function N(T,M){for(var P=M^-1,B=T.length-15,W=0;W<B;)P=v[T[W++]^P&255]^y[T[W++]^P>>8&255]^_[T[W++]^P>>16&255]^g[T[W++]^P>>>24]^m[T[W++]]^x[T[W++]]^p[T[W++]]^h[T[W++]]^f[T[W++]]^u[T[W++]]^d[T[W++]]^c[T[W++]]^o[T[W++]]^a[T[W++]]^i[T[W++]]^r[T[W++]];for(B+=15;W<B;)P=P>>>8^r[(P^T[W++])&255];return~P}function E(T,M){for(var P=M^-1,B=0,W=T.length,Y=0,J=0;B<W;)Y=T.charCodeAt(B++),Y<128?P=P>>>8^r[(P^Y)&255]:Y<2048?(P=P>>>8^r[(P^(192|Y>>6&31))&255],P=P>>>8^r[(P^(128|Y&63))&255]):Y>=55296&&Y<57344?(Y=(Y&1023)+64,J=T.charCodeAt(B++)&1023,P=P>>>8^r[(P^(240|Y>>8&7))&255],P=P>>>8^r[(P^(128|Y>>2&63))&255],P=P>>>8^r[(P^(128|J>>6&15|(Y&3)<<4))&255],P=P>>>8^r[(P^(128|J&63))&255]):(P=P>>>8^r[(P^(224|Y>>12&15))&255],P=P>>>8^r[(P^(128|Y>>6&63))&255],P=P>>>8^r[(P^(128|Y&63))&255]);return~P}return e.table=r,e.bstr=w,e.buf=N,e.str=E,e}(),He=function(){var t={};t.version="1.2.1";function r(S,D){for(var j=S.split("/"),O=D.split("/"),R=0,I=0,q=Math.min(j.length,O.length);R<q;++R){if(I=j[R].length-O[R].length)return I;if(j[R]!=O[R])return j[R]<O[R]?-1:1}return j.length-O.length}function n(S){if(S.charAt(S.length-1)=="/")return S.slice(0,-1).indexOf("/")===-1?S:n(S.slice(0,-1));var D=S.lastIndexOf("/");return D===-1?S:S.slice(0,D+1)}function s(S){if(S.charAt(S.length-1)=="/")return s(S.slice(0,-1));var D=S.lastIndexOf("/");return D===-1?S:S.slice(D+1)}function i(S,D){typeof D=="string"&&(D=new Date(D));var j=D.getHours();j=j<<6|D.getMinutes(),j=j<<5|D.getSeconds()>>>1,S.write_shift(2,j);var O=D.getFullYear()-1980;O=O<<4|D.getMonth()+1,O=O<<5|D.getDate(),S.write_shift(2,O)}function a(S){var D=S.read_shift(2)&65535,j=S.read_shift(2)&65535,O=new Date,R=j&31;j>>>=5;var I=j&15;j>>>=4,O.setMilliseconds(0),O.setFullYear(j+1980),O.setMonth(I-1),O.setDate(R);var q=D&31;D>>>=5;var re=D&63;return D>>>=6,O.setHours(D),O.setMinutes(re),O.setSeconds(q<<1),O}function o(S){dr(S,0);for(var D={},j=0;S.l<=S.length-4;){var O=S.read_shift(2),R=S.read_shift(2),I=S.l+R,q={};switch(O){case 21589:j=S.read_shift(1),j&1&&(q.mtime=S.read_shift(4)),R>5&&(j&2&&(q.atime=S.read_shift(4)),j&4&&(q.ctime=S.read_shift(4))),q.mtime&&(q.mt=new Date(q.mtime*1e3));break}S.l=I,D[O]=q}return D}var c;function d(){return c||(c={})}function u(S,D){if(S[0]==80&&S[1]==75)return nm(S,D);if((S[0]|32)==109&&(S[1]|32)==105)return r2(S,D);if(S.length<512)throw new Error("CFB file size "+S.length+" < 512");var j=3,O=512,R=0,I=0,q=0,re=0,V=0,K=[],X=S.slice(0,512);dr(X,0);var ce=f(X);switch(j=ce[0],j){case 3:O=512;break;case 4:O=4096;break;case 0:if(ce[1]==0)return nm(S,D);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}O!==512&&(X=S.slice(0,O),dr(X,28));var ge=S.slice(0,O);h(X,j);var Ee=X.read_shift(4,"i");if(j===3&&Ee!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ee);X.l+=4,q=X.read_shift(4,"i"),X.l+=4,X.chk("00100000","Mini Stream Cutoff Size: "),re=X.read_shift(4,"i"),R=X.read_shift(4,"i"),V=X.read_shift(4,"i"),I=X.read_shift(4,"i");for(var de=-1,we=0;we<109&&(de=X.read_shift(4,"i"),!(de<0));++we)K[we]=de;var ke=p(S,O);g(V,I,ke,O,K);var Je=y(ke,q,K,O);Je[q].name="!Directory",R>0&&re!==J&&(Je[re].name="!MiniFAT"),Je[K[0]].name="!FAT",Je.fat_addrs=K,Je.ssz=O;var Qe={},Rt=[],Ta=[],ba=[];v(q,Je,ke,Rt,R,Qe,Ta,re),x(Ta,ba,Rt),Rt.shift();var ka={FileIndex:Ta,FullPaths:ba};return D&&D.raw&&(ka.raw={header:ge,sectors:ke}),ka}function f(S){if(S[S.l]==80&&S[S.l+1]==75)return[0,0];S.chk(Te,"Header Signature: "),S.l+=16;var D=S.read_shift(2,"u");return[S.read_shift(2,"u"),D]}function h(S,D){var j=9;switch(S.l+=2,j=S.read_shift(2)){case 9:if(D!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(D!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}S.chk("0600","Mini Sector Shift: "),S.chk("000000000000","Reserved: ")}function p(S,D){for(var j=Math.ceil(S.length/D)-1,O=[],R=1;R<j;++R)O[R-1]=S.slice(R*D,(R+1)*D);return O[j-1]=S.slice(j*D),O}function x(S,D,j){for(var O=0,R=0,I=0,q=0,re=0,V=j.length,K=[],X=[];O<V;++O)K[O]=X[O]=O,D[O]=j[O];for(;re<X.length;++re)O=X[re],R=S[O].L,I=S[O].R,q=S[O].C,K[O]===O&&(R!==-1&&K[R]!==R&&(K[O]=K[R]),I!==-1&&K[I]!==I&&(K[O]=K[I])),q!==-1&&(K[q]=O),R!==-1&&O!=K[O]&&(K[R]=K[O],X.lastIndexOf(R)<re&&X.push(R)),I!==-1&&O!=K[O]&&(K[I]=K[O],X.lastIndexOf(I)<re&&X.push(I));for(O=1;O<V;++O)K[O]===O&&(I!==-1&&K[I]!==I?K[O]=K[I]:R!==-1&&K[R]!==R&&(K[O]=K[R]));for(O=1;O<V;++O)if(S[O].type!==0){if(re=O,re!=K[re])do re=K[re],D[O]=D[re]+"/"+D[O];while(re!==0&&K[re]!==-1&&re!=K[re]);K[O]=-1}for(D[0]+="/",O=1;O<V;++O)S[O].type!==2&&(D[O]+="/")}function m(S,D,j){for(var O=S.start,R=S.size,I=[],q=O;j&&R>0&&q>=0;)I.push(D.slice(q*Y,q*Y+Y)),R-=Y,q=Ls(j,q*4);return I.length===0?te(0):Nt(I).slice(0,S.size)}function g(S,D,j,O,R){var I=J;if(S===J){if(D!==0)throw new Error("DIFAT chain shorter than expected")}else if(S!==-1){var q=j[S],re=(O>>>2)-1;if(!q)return;for(var V=0;V<re&&(I=Ls(q,V*4))!==J;++V)R.push(I);g(Ls(q,O-4),D-1,j,O,R)}}function _(S,D,j,O,R){var I=[],q=[];R||(R=[]);var re=O-1,V=0,K=0;for(V=D;V>=0;){R[V]=!0,I[I.length]=V,q.push(S[V]);var X=j[Math.floor(V*4/O)];if(K=V*4&re,O<4+K)throw new Error("FAT boundary crossed: "+V+" 4 "+O);if(!S[X])break;V=Ls(S[X],K)}return{nodes:I,data:mg([q])}}function y(S,D,j,O){var R=S.length,I=[],q=[],re=[],V=[],K=O-1,X=0,ce=0,ge=0,Ee=0;for(X=0;X<R;++X)if(re=[],ge=X+D,ge>=R&&(ge-=R),!q[ge]){V=[];var de=[];for(ce=ge;ce>=0;){de[ce]=!0,q[ce]=!0,re[re.length]=ce,V.push(S[ce]);var we=j[Math.floor(ce*4/O)];if(Ee=ce*4&K,O<4+Ee)throw new Error("FAT boundary crossed: "+ce+" 4 "+O);if(!S[we]||(ce=Ls(S[we],Ee),de[ce]))break}I[ge]={nodes:re,data:mg([V])}}return I}function v(S,D,j,O,R,I,q,re){for(var V=0,K=O.length?2:0,X=D[S].data,ce=0,ge=0,Ee;ce<X.length;ce+=128){var de=X.slice(ce,ce+128);dr(de,64),ge=de.read_shift(2),Ee=bh(de,0,ge-K),O.push(Ee);var we={name:Ee,type:de.read_shift(1),color:de.read_shift(1),L:de.read_shift(4,"i"),R:de.read_shift(4,"i"),C:de.read_shift(4,"i"),clsid:de.read_shift(16),state:de.read_shift(4,"i"),start:0,size:0},ke=de.read_shift(2)+de.read_shift(2)+de.read_shift(2)+de.read_shift(2);ke!==0&&(we.ct=w(de,de.l-8));var Je=de.read_shift(2)+de.read_shift(2)+de.read_shift(2)+de.read_shift(2);Je!==0&&(we.mt=w(de,de.l-8)),we.start=de.read_shift(4,"i"),we.size=de.read_shift(4,"i"),we.size<0&&we.start<0&&(we.size=we.type=0,we.start=J,we.name=""),we.type===5?(V=we.start,R>0&&V!==J&&(D[V].name="!StreamData")):we.size>=4096?(we.storage="fat",D[we.start]===void 0&&(D[we.start]=_(j,we.start,D.fat_addrs,D.ssz)),D[we.start].name=we.name,we.content=D[we.start].data.slice(0,we.size)):(we.storage="minifat",we.size<0?we.size=0:V!==J&&we.start!==J&&D[V]&&(we.content=m(we,D[V].data,(D[re]||{}).data))),we.content&&dr(we.content,0),I[Ee]=we,q.push(we)}}function w(S,D){return new Date((hr(S,D+4)/1e7*Math.pow(2,32)+hr(S,D)/1e7-11644473600)*1e3)}function N(S,D){return d(),u(c.readFileSync(S),D)}function E(S,D){var j=D&&D.type;switch(j||Ie&&Buffer.isBuffer(S)&&(j="buffer"),j||"base64"){case"file":return N(S,D);case"base64":return u(Hr(An(S)),D);case"binary":return u(Hr(S),D)}return u(S,D)}function T(S,D){var j=D||{},O=j.root||"Root Entry";if(S.FullPaths||(S.FullPaths=[]),S.FileIndex||(S.FileIndex=[]),S.FullPaths.length!==S.FileIndex.length)throw new Error("inconsistent CFB structure");S.FullPaths.length===0&&(S.FullPaths[0]=O+"/",S.FileIndex[0]={name:O,type:5}),j.CLSID&&(S.FileIndex[0].clsid=j.CLSID),M(S)}function M(S){var D="Sh33tJ5";if(!He.find(S,"/"+D)){var j=te(4);j[0]=55,j[1]=j[3]=50,j[2]=54,S.FileIndex.push({name:D,type:2,content:j,size:4,L:69,R:69,C:69}),S.FullPaths.push(S.FullPaths[0]+D),P(S)}}function P(S,D){T(S);for(var j=!1,O=!1,R=S.FullPaths.length-1;R>=0;--R){var I=S.FileIndex[R];switch(I.type){case 0:O?j=!0:(S.FileIndex.pop(),S.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(I.R*I.L*I.C)&&(j=!0),I.R>-1&&I.L>-1&&I.R==I.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!D)){var q=new Date(1987,1,19),re=0,V=Object.create?Object.create(null):{},K=[];for(R=0;R<S.FullPaths.length;++R)V[S.FullPaths[R]]=!0,S.FileIndex[R].type!==0&&K.push([S.FullPaths[R],S.FileIndex[R]]);for(R=0;R<K.length;++R){var X=n(K[R][0]);O=V[X],O||(K.push([X,{name:s(X).replace("/",""),type:1,clsid:se,ct:q,mt:q,content:null}]),V[X]=!0)}for(K.sort(function(Ee,de){return r(Ee[0],de[0])}),S.FullPaths=[],S.FileIndex=[],R=0;R<K.length;++R)S.FullPaths[R]=K[R][0],S.FileIndex[R]=K[R][1];for(R=0;R<K.length;++R){var ce=S.FileIndex[R],ge=S.FullPaths[R];if(ce.name=s(ge).replace("/",""),ce.L=ce.R=ce.C=-(ce.color=1),ce.size=ce.content?ce.content.length:0,ce.start=0,ce.clsid=ce.clsid||se,R===0)ce.C=K.length>1?1:-1,ce.size=0,ce.type=5;else if(ge.slice(-1)=="/"){for(re=R+1;re<K.length&&n(S.FullPaths[re])!=ge;++re);for(ce.C=re>=K.length?-1:re,re=R+1;re<K.length&&n(S.FullPaths[re])!=n(ge);++re);ce.R=re>=K.length?-1:re,ce.type=1}else n(S.FullPaths[R+1]||"")==n(ge)&&(ce.R=R+1),ce.type=2}}}function B(S,D){var j=D||{};if(j.fileType=="mad")return n2(S,j);switch(P(S),j.fileType){case"zip":return Yw(S,j)}var O=function(Ee){for(var de=0,we=0,ke=0;ke<Ee.FileIndex.length;++ke){var Je=Ee.FileIndex[ke];if(Je.content){var Qe=Je.content.length;Qe>0&&(Qe<4096?de+=Qe+63>>6:we+=Qe+511>>9)}}for(var Rt=Ee.FullPaths.length+3>>2,Ta=de+7>>3,ba=de+127>>7,ka=Ta+we+Rt+ba,js=ka+127>>7,td=js<=109?0:Math.ceil((js-109)/127);ka+js+td+127>>7>js;)td=++js<=109?0:Math.ceil((js-109)/127);var dn=[1,td,js,ba,Rt,we,de,0];return Ee.FileIndex[0].size=de<<6,dn[7]=(Ee.FileIndex[0].start=dn[0]+dn[1]+dn[2]+dn[3]+dn[4]+dn[5])+(dn[6]+7>>3),dn}(S),R=te(O[7]<<9),I=0,q=0;{for(I=0;I<8;++I)R.write_shift(1,ye[I]);for(I=0;I<8;++I)R.write_shift(2,0);for(R.write_shift(2,62),R.write_shift(2,3),R.write_shift(2,65534),R.write_shift(2,9),R.write_shift(2,6),I=0;I<3;++I)R.write_shift(2,0);for(R.write_shift(4,0),R.write_shift(4,O[2]),R.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),R.write_shift(4,0),R.write_shift(4,4096),R.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:J),R.write_shift(4,O[3]),R.write_shift(-4,O[1]?O[0]-1:J),R.write_shift(4,O[1]),I=0;I<109;++I)R.write_shift(-4,I<O[2]?O[1]+I:-1)}if(O[1])for(q=0;q<O[1];++q){for(;I<236+q*127;++I)R.write_shift(-4,I<O[2]?O[1]+I:-1);R.write_shift(-4,q===O[1]-1?J:q+1)}var re=function(Ee){for(q+=Ee;I<q-1;++I)R.write_shift(-4,I+1);Ee&&(++I,R.write_shift(-4,J))};for(q=I=0,q+=O[1];I<q;++I)R.write_shift(-4,le.DIFSECT);for(q+=O[2];I<q;++I)R.write_shift(-4,le.FATSECT);re(O[3]),re(O[4]);for(var V=0,K=0,X=S.FileIndex[0];V<S.FileIndex.length;++V)X=S.FileIndex[V],X.content&&(K=X.content.length,!(K<4096)&&(X.start=q,re(K+511>>9)));for(re(O[6]+7>>3);R.l&511;)R.write_shift(-4,le.ENDOFCHAIN);for(q=I=0,V=0;V<S.FileIndex.length;++V)X=S.FileIndex[V],X.content&&(K=X.content.length,!(!K||K>=4096)&&(X.start=q,re(K+63>>6)));for(;R.l&511;)R.write_shift(-4,le.ENDOFCHAIN);for(I=0;I<O[4]<<2;++I){var ce=S.FullPaths[I];if(!ce||ce.length===0){for(V=0;V<17;++V)R.write_shift(4,0);for(V=0;V<3;++V)R.write_shift(4,-1);for(V=0;V<12;++V)R.write_shift(4,0);continue}X=S.FileIndex[I],I===0&&(X.start=X.size?X.start-1:J);var ge=I===0&&j.root||X.name;if(K=2*(ge.length+1),R.write_shift(64,ge,"utf16le"),R.write_shift(2,K),R.write_shift(1,X.type),R.write_shift(1,X.color),R.write_shift(-4,X.L),R.write_shift(-4,X.R),R.write_shift(-4,X.C),X.clsid)R.write_shift(16,X.clsid,"hex");else for(V=0;V<4;++V)R.write_shift(4,0);R.write_shift(4,X.state||0),R.write_shift(4,0),R.write_shift(4,0),R.write_shift(4,0),R.write_shift(4,0),R.write_shift(4,X.start),R.write_shift(4,X.size),R.write_shift(4,0)}for(I=1;I<S.FileIndex.length;++I)if(X=S.FileIndex[I],X.size>=4096)if(R.l=X.start+1<<9,Ie&&Buffer.isBuffer(X.content))X.content.copy(R,R.l,0,X.size),R.l+=X.size+511&-512;else{for(V=0;V<X.size;++V)R.write_shift(1,X.content[V]);for(;V&511;++V)R.write_shift(1,0)}for(I=1;I<S.FileIndex.length;++I)if(X=S.FileIndex[I],X.size>0&&X.size<4096)if(Ie&&Buffer.isBuffer(X.content))X.content.copy(R,R.l,0,X.size),R.l+=X.size+63&-64;else{for(V=0;V<X.size;++V)R.write_shift(1,X.content[V]);for(;V&63;++V)R.write_shift(1,0)}if(Ie)R.l=R.length;else for(;R.l<R.length;)R.write_shift(1,0);return R}function W(S,D){var j=S.FullPaths.map(function(V){return V.toUpperCase()}),O=j.map(function(V){var K=V.split("/");return K[K.length-(V.slice(-1)=="/"?2:1)]}),R=!1;D.charCodeAt(0)===47?(R=!0,D=j[0].slice(0,-1)+D):R=D.indexOf("/")!==-1;var I=D.toUpperCase(),q=R===!0?j.indexOf(I):O.indexOf(I);if(q!==-1)return S.FileIndex[q];var re=!I.match(Dl);for(I=I.replace(oo,""),re&&(I=I.replace(Dl,"!")),q=0;q<j.length;++q)if((re?j[q].replace(Dl,"!"):j[q]).replace(oo,"")==I||(re?O[q].replace(Dl,"!"):O[q]).replace(oo,"")==I)return S.FileIndex[q];return null}var Y=64,J=-2,Te="d0cf11e0a1b11ae1",ye=[208,207,17,224,161,177,26,225],se="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:J,FREESECT:-1,HEADER_SIGNATURE:Te,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function z(S,D,j){d();var O=B(S,j);c.writeFileSync(D,O)}function U(S){for(var D=new Array(S.length),j=0;j<S.length;++j)D[j]=String.fromCharCode(S[j]);return D.join("")}function Z(S,D){var j=B(S,D);switch(D&&D.type||"buffer"){case"file":return d(),c.writeFileSync(D.filename,j),j;case"binary":return typeof j=="string"?j:U(j);case"base64":return Io(typeof j=="string"?j:U(j));case"buffer":if(Ie)return Buffer.isBuffer(j)?j:In(j);case"array":return typeof j=="string"?Hr(j):j}return j}var G;function k(S){try{var D=S.InflateRaw,j=new D;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)G=S;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function F(S,D){if(!G)return tm(S,D);var j=G.InflateRaw,O=new j,R=O._processChunk(S.slice(S.l),O._finishFlushFlag);return S.l+=O.bytesRead,R}function C(S){return G?G.deflateRawSync(S):Xh(S)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ne(S){var D=(S<<1|S<<11)&139536|(S<<5|S<<15)&558144;return(D>>16|D>>8|D)&255}for(var ae=typeof Uint8Array<"u",A=ae?new Uint8Array(256):[],ee=0;ee<256;++ee)A[ee]=ne(ee);function oe(S,D){var j=A[S&255];return D<=8?j>>>8-D:(j=j<<8|A[S>>8&255],D<=16?j>>>16-D:(j=j<<8|A[S>>16&255],j>>>24-D))}function xe(S,D){var j=D&7,O=D>>>3;return(S[O]|(j<=6?0:S[O+1]<<8))>>>j&3}function _e(S,D){var j=D&7,O=D>>>3;return(S[O]|(j<=5?0:S[O+1]<<8))>>>j&7}function Ce(S,D){var j=D&7,O=D>>>3;return(S[O]|(j<=4?0:S[O+1]<<8))>>>j&15}function Oe(S,D){var j=D&7,O=D>>>3;return(S[O]|(j<=3?0:S[O+1]<<8))>>>j&31}function ve(S,D){var j=D&7,O=D>>>3;return(S[O]|(j<=1?0:S[O+1]<<8))>>>j&127}function Er(S,D,j){var O=D&7,R=D>>>3,I=(1<<j)-1,q=S[R]>>>O;return j<8-O||(q|=S[R+1]<<8-O,j<16-O)||(q|=S[R+2]<<16-O,j<24-O)||(q|=S[R+3]<<24-O),q&I}function un(S,D,j){var O=D&7,R=D>>>3;return O<=5?S[R]|=(j&7)<<O:(S[R]|=j<<O&255,S[R+1]=(j&7)>>8-O),D+3}function ks(S,D,j){var O=D&7,R=D>>>3;return j=(j&1)<<O,S[R]|=j,D+1}function di(S,D,j){var O=D&7,R=D>>>3;return j<<=O,S[R]|=j&255,j>>>=8,S[R+1]=j,D+8}function Kh(S,D,j){var O=D&7,R=D>>>3;return j<<=O,S[R]|=j&255,j>>>=8,S[R+1]=j&255,S[R+2]=j>>>8,D+16}function Ju(S,D){var j=S.length,O=2*j>D?2*j:D+5,R=0;if(j>=D)return S;if(Ie){var I=Zp(O);if(S.copy)S.copy(I);else for(;R<S.length;++R)I[R]=S[R];return I}else if(ae){var q=new Uint8Array(O);if(q.set)q.set(S);else for(;R<j;++R)q[R]=S[R];return q}return S.length=O,S}function Jr(S){for(var D=new Array(S),j=0;j<S;++j)D[j]=0;return D}function al(S,D,j){var O=1,R=0,I=0,q=0,re=0,V=S.length,K=ae?new Uint16Array(32):Jr(32);for(I=0;I<32;++I)K[I]=0;for(I=V;I<j;++I)S[I]=0;V=S.length;var X=ae?new Uint16Array(V):Jr(V);for(I=0;I<V;++I)K[R=S[I]]++,O<R&&(O=R),X[I]=0;for(K[0]=0,I=1;I<=O;++I)K[I+16]=re=re+K[I-1]<<1;for(I=0;I<V;++I)re=S[I],re!=0&&(X[I]=K[re+16]++);var ce=0;for(I=0;I<V;++I)if(ce=S[I],ce!=0)for(re=oe(X[I],O)>>O-ce,q=(1<<O+4-ce)-1;q>=0;--q)D[re|q<<ce]=ce&15|I<<4;return O}var Qu=ae?new Uint16Array(512):Jr(512),Zu=ae?new Uint16Array(32):Jr(32);if(!ae){for(var Ns=0;Ns<512;++Ns)Qu[Ns]=0;for(Ns=0;Ns<32;++Ns)Zu[Ns]=0}(function(){for(var S=[],D=0;D<32;D++)S.push(5);al(S,Zu,32);var j=[];for(D=0;D<=143;D++)j.push(8);for(;D<=255;D++)j.push(9);for(;D<=279;D++)j.push(7);for(;D<=287;D++)j.push(8);al(j,Qu,288)})();var Gw=function(){for(var D=ae?new Uint8Array(32768):[],j=0,O=0;j<Q.length-1;++j)for(;O<Q[j+1];++O)D[O]=j;for(;O<32768;++O)D[O]=29;var R=ae?new Uint8Array(259):[];for(j=0,O=0;j<H.length-1;++j)for(;O<H[j+1];++O)R[O]=j;function I(re,V){for(var K=0;K<re.length;){var X=Math.min(65535,re.length-K),ce=K+X==re.length;for(V.write_shift(1,+ce),V.write_shift(2,X),V.write_shift(2,~X&65535);X-- >0;)V[V.l++]=re[K++]}return V.l}function q(re,V){for(var K=0,X=0,ce=ae?new Uint16Array(32768):[];X<re.length;){var ge=Math.min(65535,re.length-X);if(ge<10){for(K=un(V,K,+(X+ge==re.length)),K&7&&(K+=8-(K&7)),V.l=K/8|0,V.write_shift(2,ge),V.write_shift(2,~ge&65535);ge-- >0;)V[V.l++]=re[X++];K=V.l*8;continue}K=un(V,K,+(X+ge==re.length)+2);for(var Ee=0;ge-- >0;){var de=re[X];Ee=(Ee<<5^de)&32767;var we=-1,ke=0;if((we=ce[Ee])&&(we|=X&-32768,we>X&&(we-=32768),we<X))for(;re[we+ke]==re[X+ke]&&ke<250;)++ke;if(ke>2){de=R[ke],de<=22?K=di(V,K,A[de+1]>>1)-1:(di(V,K,3),K+=5,di(V,K,A[de-23]>>5),K+=3);var Je=de<8?0:de-4>>2;Je>0&&(Kh(V,K,ke-H[de]),K+=Je),de=D[X-we],K=di(V,K,A[de]>>3),K-=3;var Qe=de<4?0:de-2>>1;Qe>0&&(Kh(V,K,X-we-Q[de]),K+=Qe);for(var Rt=0;Rt<ke;++Rt)ce[Ee]=X&32767,Ee=(Ee<<5^re[X])&32767,++X;ge-=ke-1}else de<=143?de=de+48:K=ks(V,K,1),K=di(V,K,A[de]),ce[Ee]=X&32767,++X}K=di(V,K,0)-1}return V.l=(K+7)/8|0,V.l}return function(V,K){return V.length<8?I(V,K):q(V,K)}}();function Xh(S){var D=te(50+Math.floor(S.length*1.1)),j=Gw(S,D);return D.slice(0,j)}var Yh=ae?new Uint16Array(32768):Jr(32768),Jh=ae?new Uint16Array(32768):Jr(32768),Qh=ae?new Uint16Array(128):Jr(128),Zh=1,em=1;function qw(S,D){var j=Oe(S,D)+257;D+=5;var O=Oe(S,D)+1;D+=5;var R=Ce(S,D)+4;D+=4;for(var I=0,q=ae?new Uint8Array(19):Jr(19),re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],V=1,K=ae?new Uint8Array(8):Jr(8),X=ae?new Uint8Array(8):Jr(8),ce=q.length,ge=0;ge<R;++ge)q[L[ge]]=I=_e(S,D),V<I&&(V=I),K[I]++,D+=3;var Ee=0;for(K[0]=0,ge=1;ge<=V;++ge)X[ge]=Ee=Ee+K[ge-1]<<1;for(ge=0;ge<ce;++ge)(Ee=q[ge])!=0&&(re[ge]=X[Ee]++);var de=0;for(ge=0;ge<ce;++ge)if(de=q[ge],de!=0){Ee=A[re[ge]]>>8-de;for(var we=(1<<7-de)-1;we>=0;--we)Qh[Ee|we<<de]=de&7|ge<<3}var ke=[];for(V=1;ke.length<j+O;)switch(Ee=Qh[ve(S,D)],D+=Ee&7,Ee>>>=3){case 16:for(I=3+xe(S,D),D+=2,Ee=ke[ke.length-1];I-- >0;)ke.push(Ee);break;case 17:for(I=3+_e(S,D),D+=3;I-- >0;)ke.push(0);break;case 18:for(I=11+ve(S,D),D+=7;I-- >0;)ke.push(0);break;default:ke.push(Ee),V<Ee&&(V=Ee);break}var Je=ke.slice(0,j),Qe=ke.slice(j);for(ge=j;ge<286;++ge)Je[ge]=0;for(ge=O;ge<30;++ge)Qe[ge]=0;return Zh=al(Je,Yh,286),em=al(Qe,Jh,30),D}function Kw(S,D){if(S[0]==3&&!(S[1]&3))return[Qs(D),2];for(var j=0,O=0,R=Zp(D||1<<18),I=0,q=R.length>>>0,re=0,V=0;!(O&1);){if(O=_e(S,j),j+=3,O>>>1)O>>1==1?(re=9,V=5):(j=qw(S,j),re=Zh,V=em);else{j&7&&(j+=8-(j&7));var K=S[j>>>3]|S[(j>>>3)+1]<<8;if(j+=32,K>0)for(!D&&q<I+K&&(R=Ju(R,I+K),q=R.length);K-- >0;)R[I++]=S[j>>>3],j+=8;continue}for(;;){!D&&q<I+32767&&(R=Ju(R,I+32767),q=R.length);var X=Er(S,j,re),ce=O>>>1==1?Qu[X]:Yh[X];if(j+=ce&15,ce>>>=4,!(ce>>>8&255))R[I++]=ce;else{if(ce==256)break;ce-=257;var ge=ce<8?0:ce-4>>2;ge>5&&(ge=0);var Ee=I+H[ce];ge>0&&(Ee+=Er(S,j,ge),j+=ge),X=Er(S,j,V),ce=O>>>1==1?Zu[X]:Jh[X],j+=ce&15,ce>>>=4;var de=ce<4?0:ce-2>>1,we=Q[ce];for(de>0&&(we+=Er(S,j,de),j+=de),!D&&q<Ee&&(R=Ju(R,Ee+100),q=R.length);I<Ee;)R[I]=R[I-we],++I}}}return D?[R,j+7>>>3]:[R.slice(0,I),j+7>>>3]}function tm(S,D){var j=S.slice(S.l||0),O=Kw(j,D);return S.l+=O[1],O[0]}function rm(S,D){if(S)typeof console<"u"&&console.error(D);else throw new Error(D)}function nm(S,D){var j=S;dr(j,0);var O=[],R=[],I={FileIndex:O,FullPaths:R};T(I,{root:D.root});for(var q=j.length-4;(j[q]!=80||j[q+1]!=75||j[q+2]!=5||j[q+3]!=6)&&q>=0;)--q;j.l=q+4,j.l+=4;var re=j.read_shift(2);j.l+=6;var V=j.read_shift(4);for(j.l=V,q=0;q<re;++q){j.l+=20;var K=j.read_shift(4),X=j.read_shift(4),ce=j.read_shift(2),ge=j.read_shift(2),Ee=j.read_shift(2);j.l+=8;var de=j.read_shift(4),we=o(j.slice(j.l+ce,j.l+ce+ge));j.l+=ce+ge+Ee;var ke=j.l;j.l=de+4,Xw(j,K,X,I,we),j.l=ke}return I}function Xw(S,D,j,O,R){S.l+=2;var I=S.read_shift(2),q=S.read_shift(2),re=a(S);if(I&8257)throw new Error("Unsupported ZIP encryption");for(var V=S.read_shift(4),K=S.read_shift(4),X=S.read_shift(4),ce=S.read_shift(2),ge=S.read_shift(2),Ee="",de=0;de<ce;++de)Ee+=String.fromCharCode(S[S.l++]);if(ge){var we=o(S.slice(S.l,S.l+ge));(we[21589]||{}).mt&&(re=we[21589].mt),((R||{})[21589]||{}).mt&&(re=R[21589].mt)}S.l+=ge;var ke=S.slice(S.l,S.l+K);switch(q){case 8:ke=F(S,X);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+q)}var Je=!1;I&8&&(V=S.read_shift(4),V==134695760&&(V=S.read_shift(4),Je=!0),K=S.read_shift(4),X=S.read_shift(4)),K!=D&&rm(Je,"Bad compressed size: "+D+" != "+K),X!=j&&rm(Je,"Bad uncompressed size: "+j+" != "+X),ed(O,Ee,ke,{unsafe:!0,mt:re})}function Yw(S,D){var j=D||{},O=[],R=[],I=te(1),q=j.compression?8:0,re=0,V=0,K=0,X=0,ce=0,ge=S.FullPaths[0],Ee=ge,de=S.FileIndex[0],we=[],ke=0;for(V=1;V<S.FullPaths.length;++V)if(Ee=S.FullPaths[V].slice(ge.length),de=S.FileIndex[V],!(!de.size||!de.content||Ee=="Sh33tJ5")){var Je=X,Qe=te(Ee.length);for(K=0;K<Ee.length;++K)Qe.write_shift(1,Ee.charCodeAt(K)&127);Qe=Qe.slice(0,Qe.l),we[ce]=V3.buf(de.content,0);var Rt=de.content;q==8&&(Rt=C(Rt)),I=te(30),I.write_shift(4,67324752),I.write_shift(2,20),I.write_shift(2,re),I.write_shift(2,q),de.mt?i(I,de.mt):I.write_shift(4,0),I.write_shift(-4,we[ce]),I.write_shift(4,Rt.length),I.write_shift(4,de.content.length),I.write_shift(2,Qe.length),I.write_shift(2,0),X+=I.length,O.push(I),X+=Qe.length,O.push(Qe),X+=Rt.length,O.push(Rt),I=te(46),I.write_shift(4,33639248),I.write_shift(2,0),I.write_shift(2,20),I.write_shift(2,re),I.write_shift(2,q),I.write_shift(4,0),I.write_shift(-4,we[ce]),I.write_shift(4,Rt.length),I.write_shift(4,de.content.length),I.write_shift(2,Qe.length),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(4,0),I.write_shift(4,Je),ke+=I.l,R.push(I),ke+=Qe.length,R.push(Qe),++ce}return I=te(22),I.write_shift(4,101010256),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,ce),I.write_shift(2,ce),I.write_shift(4,ke),I.write_shift(4,X),I.write_shift(2,0),Nt([Nt(O),Nt(R),I])}var ol={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Jw(S,D){if(S.ctype)return S.ctype;var j=S.name||"",O=j.match(/\.([^\.]+)$/);return O&&ol[O[1]]||D&&(O=(j=D).match(/[\.\\]([^\.\\])+$/),O&&ol[O[1]])?ol[O[1]]:"application/octet-stream"}function Qw(S){for(var D=Io(S),j=[],O=0;O<D.length;O+=76)j.push(D.slice(O,O+76));return j.join(`\r
`)+`\r
`}function Zw(S){var D=S.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(K){var X=K.charCodeAt(0).toString(16).toUpperCase();return"="+(X.length==1?"0"+X:X)});D=D.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),D.charAt(0)==`
`&&(D="=0D"+D.slice(1)),D=D.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],O=D.split(`\r
`),R=0;R<O.length;++R){var I=O[R];if(I.length==0){j.push("");continue}for(var q=0;q<I.length;){var re=76,V=I.slice(q,q+re);V.charAt(re-1)=="="?re--:V.charAt(re-2)=="="?re-=2:V.charAt(re-3)=="="&&(re-=3),V=I.slice(q,q+re),q+=re,q<I.length&&(V+="="),j.push(V)}}return j.join(`\r
`)}function e2(S){for(var D=[],j=0;j<S.length;++j){for(var O=S[j];j<=S.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+S[++j];D.push(O)}for(var R=0;R<D.length;++R)D[R]=D[R].replace(/[=][0-9A-Fa-f]{2}/g,function(I){return String.fromCharCode(parseInt(I.slice(1),16))});return Hr(D.join(`\r
`))}function t2(S,D,j){for(var O="",R="",I="",q,re=0;re<10;++re){var V=D[re];if(!V||V.match(/^\s*$/))break;var K=V.match(/^(.*?):\s*([^\s].*)$/);if(K)switch(K[1].toLowerCase()){case"content-location":O=K[2].trim();break;case"content-type":I=K[2].trim();break;case"content-transfer-encoding":R=K[2].trim();break}}switch(++re,R.toLowerCase()){case"base64":q=Hr(An(D.slice(re).join("")));break;case"quoted-printable":q=e2(D.slice(re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+R)}var X=ed(S,O.slice(j.length),q,{unsafe:!0});I&&(X.ctype=I)}function r2(S,D){if(U(S.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=D&&D.root||"",O=(Ie&&Buffer.isBuffer(S)?S.toString("binary"):U(S)).split(`\r
`),R=0,I="";for(R=0;R<O.length;++R)if(I=O[R],!!/^Content-Location:/i.test(I)&&(I=I.slice(I.indexOf("file")),j||(j=I.slice(0,I.lastIndexOf("/")+1)),I.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),I.slice(0,j.length)!=j););var q=(O[1]||"").match(/boundary="(.*?)"/);if(!q)throw new Error("MAD cannot find boundary");var re="--"+(q[1]||""),V=[],K=[],X={FileIndex:V,FullPaths:K};T(X);var ce,ge=0;for(R=0;R<O.length;++R){var Ee=O[R];Ee!==re&&Ee!==re+"--"||(ge++&&t2(X,O.slice(ce,R),j),ce=R)}return X}function n2(S,D){var j=D||{},O=j.boundary||"SheetJS";O="------="+O;for(var R=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],I=S.FullPaths[0],q=I,re=S.FileIndex[0],V=1;V<S.FullPaths.length;++V)if(q=S.FullPaths[V].slice(I.length),re=S.FileIndex[V],!(!re.size||!re.content||q=="Sh33tJ5")){q=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ke){return"_x"+ke.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ke){return"_u"+ke.charCodeAt(0).toString(16)+"_"});for(var K=re.content,X=Ie&&Buffer.isBuffer(K)?K.toString("binary"):U(K),ce=0,ge=Math.min(1024,X.length),Ee=0,de=0;de<=ge;++de)(Ee=X.charCodeAt(de))>=32&&Ee<128&&++ce;var we=ce>=ge*4/5;R.push(O),R.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+q),R.push("Content-Transfer-Encoding: "+(we?"quoted-printable":"base64")),R.push("Content-Type: "+Jw(re,q)),R.push(""),R.push(we?Zw(X):Qw(X))}return R.push(O+`--\r
`),R.join(`\r
`)}function s2(S){var D={};return T(D,S),D}function ed(S,D,j,O){var R=O&&O.unsafe;R||T(S);var I=!R&&He.find(S,D);if(!I){var q=S.FullPaths[0];D.slice(0,q.length)==q?q=D:(q.slice(-1)!="/"&&(q+="/"),q=(q+D).replace("//","/")),I={name:s(D),type:2},S.FileIndex.push(I),S.FullPaths.push(q),R||He.utils.cfb_gc(S)}return I.content=j,I.size=j?j.length:0,O&&(O.CLSID&&(I.clsid=O.CLSID),O.mt&&(I.mt=O.mt),O.ct&&(I.ct=O.ct)),I}function i2(S,D){T(S);var j=He.find(S,D);if(j){for(var O=0;O<S.FileIndex.length;++O)if(S.FileIndex[O]==j)return S.FileIndex.splice(O,1),S.FullPaths.splice(O,1),!0}return!1}function a2(S,D,j){T(S);var O=He.find(S,D);if(O){for(var R=0;R<S.FileIndex.length;++R)if(S.FileIndex[R]==O)return S.FileIndex[R].name=s(j),S.FullPaths[R]=j,!0}return!1}function o2(S){P(S,!0)}return t.find=W,t.read=E,t.parse=u,t.write=Z,t.writeFile=z,t.utils={cfb_new:s2,cfb_add:ed,cfb_del:i2,cfb_mov:a2,cfb_gc:o2,ReadShift:co,CheckField:Ry,prep_blob:dr,bconcat:Nt,use_zlib:k,_deflateRaw:Xh,_inflateRaw:tm,consts:le},t}();function G3(e){return typeof e=="string"?Lu(e):Array.isArray(e)?v3(e):e}function tl(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Lu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Mo(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([G3(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=el(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Dt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function og(e,t){for(var r=[],n=Dt(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function _h(e){for(var t=[],r=Dt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function $u(e){for(var t=[],r=Dt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function q3(e){for(var t=[],r=Dt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var qc=new Date(1899,11,30,0,0,0);function or(e,t){var r=e.getTime(),n=qc.getTime()+(e.getTimezoneOffset()-qc.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var vy=new Date,K3=qc.getTime()+(vy.getTimezoneOffset()-qc.getTimezoneOffset())*6e4,lg=vy.getTimezoneOffset();function yy(e){var t=new Date;return t.setTime(e*24*60*60*1e3+K3),t.getTimezoneOffset()!==lg&&t.setTime(t.getTime()+(t.getTimezoneOffset()-lg)*6e4),t}var cg=new Date("2017-02-19T19:06:09.000Z"),wy=isNaN(cg.getFullYear())?new Date("2/19/17"):cg,X3=wy.getFullYear()==2017;function Yt(e,t){var r=new Date(e);if(X3)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(wy.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Uu(e,t){if(Ie&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function lr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=lr(e[r]));return t}function st(e,t){for(var r="";r.length<t;)r+=e;return r}function En(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var Y3=["january","february","march","april","may","june","july","august","september","october","november","december"];function Lo(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&Y3.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function je(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ie?n=In(r):n=y3(r),He.utils.cfb_add(e,t,n)}He.utils.cfb_add(e,t,r)}else e.file(t,r)}function Eh(){return He.utils.cfb_new()}var ft=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,J3={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Sh=_h(J3),Th=/[&<>'"]/g,Q3=/[\u0000-\u0008\u000b-\u001f]/g;function $e(e){var t=e+"";return t.replace(Th,function(r){return Sh[r]}).replace(Q3,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ug(e){return $e(e).replace(/ /g,"_x0020_")}var _y=/[\u0000-\u001f]/g;function Z3(e){var t=e+"";return t.replace(Th,function(r){return Sh[r]}).replace(/\n/g,"<br/>").replace(_y,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function ej(e){var t=e+"";return t.replace(Th,function(r){return Sh[r]}).replace(_y,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function tj(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function rj(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Md(e){for(var t="",r=0,n=0,s=0,i=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,t+=String.fromCharCode(a);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function dg(e){var t=Qs(2*e.length),r,n,s=1,i=0,a=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[i++]=a&255,t[i++]=a>>>8,a=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function fg(e){return In(e,"binary").toString("utf8")}var Il="foo bar baz",lo=Ie&&(fg(Il)==Md(Il)&&fg||dg(Il)==Md(Il)&&dg)||Md,Mo=Ie?function(e){return In(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},nj=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),Ey=/(^\s|\s$|\n)/;function jt(e,t){return"<"+e+(t.match(Ey)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Bo(e){return Dt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function fe(e,t,r){return"<"+e+(r!=null?Bo(r):"")+(t!=null?(t.match(Ey)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function lf(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function sj(e,t){switch(typeof e){case"string":var r=fe("vt:lpwstr",$e(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return fe((e|0)==e?"vt:i4":"vt:r8",$e(String(e)));case"boolean":return fe("vt:bool",e?"true":"false")}if(e instanceof Date)return fe("vt:filetime",lf(e));throw new Error("Unable to serialize "+e)}var vt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},va=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],fr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function ij(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function aj(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,a=n?-t:t;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|n}var hg=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,i=e[0][n].length;s<i;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},mg=Ie?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:In(t)})):hg(e)}:hg,pg=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Va(e,s)));return n.join("").replace(oo,"")},bh=Ie?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(oo,""):pg(e,t,r)}:pg,gg=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},Sy=Ie?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):gg(e,t,r)}:gg,xg=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Si(e,s)));return n.join("")},rl=Ie?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):xg(t,r,n)}:xg,Ty=function(e,t){var r=hr(e,t);return r>0?rl(e,t+4,t+4+r-1):""},by=Ty,ky=function(e,t){var r=hr(e,t);return r>0?rl(e,t+4,t+4+r-1):""},Ny=ky,jy=function(e,t){var r=2*hr(e,t);return r>0?rl(e,t+4,t+4+r-1):""},Cy=jy,Ay=function(t,r){var n=hr(t,r);return n>0?bh(t,r+4,r+4+n):""},Oy=Ay,Fy=function(e,t){var r=hr(e,t);return r>0?rl(e,t+4,t+4+r):""},Py=Fy,Dy=function(e,t){return ij(e,t)},Kc=Dy,kh=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ie&&(by=function(t,r){if(!Buffer.isBuffer(t))return Ty(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Ny=function(t,r){if(!Buffer.isBuffer(t))return ky(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Cy=function(t,r){if(!Buffer.isBuffer(t))return jy(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Oy=function(t,r){if(!Buffer.isBuffer(t))return Ay(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Py=function(t,r){if(!Buffer.isBuffer(t))return Fy(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Kc=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Dy(t,r)},kh=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Si=function(e,t){return e[t]},Va=function(e,t){return e[t+1]*256+e[t]},oj=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},hr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ls=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},lj=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function co(e,t){var r="",n,s,i=[],a,o,c,d;switch(t){case"dbcs":if(d=this.l,Ie&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Va(this,d)),d+=2;e*=2;break;case"utf8":r=rl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=bh(this,this.l,this.l+e);break;case"wstr":return co.call(this,e,"dbcs");case"lpstr-ansi":r=by(this,this.l),e=4+hr(this,this.l);break;case"lpstr-cp":r=Ny(this,this.l),e=4+hr(this,this.l);break;case"lpwstr":r=Cy(this,this.l),e=4+2*hr(this,this.l);break;case"lpp4":e=4+hr(this,this.l),r=Oy(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+hr(this,this.l),r=Py(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=Si(this,this.l+e++))!==0;)i.push(Pl(a));r=i.join("");break;case"_wstr":for(e=0,r="";(a=Va(this,this.l+e))!==0;)i.push(Pl(a)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return a=Si(this,d),this.l=d+1,o=co.call(this,e-c,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Pl(Va(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return a=Si(this,d),this.l=d+1,o=co.call(this,e-c,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Pl(Si(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return n=Si(this,this.l),this.l++,n;case 2:return n=(t==="i"?oj:Va)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ls:lj)(this,this.l),this.l+=4,n):(s=hr(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Kc(this,this.l):s=Kc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=Sy(this,this.l,e);break}}return this.l+=e,r}var cj=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},uj=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},dj=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function fj(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)dj(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var a=t.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,cj(this,t,this.l);break;case 8:if(n=8,r==="f"){aj(this,t,this.l);break}case 16:break;case-4:n=4,uj(this,t,this.l);break}return this.l+=n,this}function Ry(e,t){var r=Sy(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function dr(e,t){e.l=t,e.read_shift=co,e.chk=Ry,e.write_shift=fj}function cn(e,t){e.l+=t}function te(e){var t=Qs(e);return dr(t,0),t}function ar(){var e=[],t=Ie?256:2048,r=function(d){var u=te(d);return dr(u,0),u},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(s(),n=r(Math.max(d+1,t)))},a=function(){return s(),Nt(e)},o=function(d){s(),n=d,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:a,_bufs:e}}function ie(e,t,r,n){var s=+t,i;if(!isNaN(s)){n||(n=iF[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var a=e.next(i);s<=127?a.write_shift(1,s):(a.write_shift(1,(s&127)+128),a.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&kh(r)&&e.push(r)}}function uo(e,t,r){var n=lr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function vg(e,t,r){var n=lr(e);return n.s=uo(n.s,t.s,r),n.e=uo(n.e,t.s,r),n}function fo(e,t){if(e.cRel&&e.c<0)for(e=lr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=lr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=We(e);return!e.cRel&&e.cRel!=null&&(r=pj(r)),!e.rRel&&e.rRel!=null&&(r=hj(r)),r}function Bd(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+$t(e.s.c)+":"+(e.e.cRel?"":"$")+$t(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ft(e.s.r)+":"+(e.e.rRel?"":"$")+Ft(e.e.r):fo(e.s,t.biff)+":"+fo(e.e,t.biff)}function Nh(e){return parseInt(mj(e),10)-1}function Ft(e){return""+(e+1)}function hj(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function mj(e){return e.replace(/\$(\d+)$/,"$1")}function jh(e){for(var t=gj(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function $t(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function pj(e){return e.replace(/^([A-Z])/,"$$$1")}function gj(e){return e.replace(/^\$([A-Z])/,"$1")}function xj(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function yt(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function We(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function yr(e){var t=e.indexOf(":");return t==-1?{s:yt(e),e:yt(e)}:{s:yt(e.slice(0,t)),e:yt(e.slice(t+1))}}function dt(e,t){return typeof t>"u"||typeof t=="number"?dt(e.s,e.e):(typeof e!="string"&&(e=We(e)),typeof t!="string"&&(t=We(t)),e==t?e:e+":"+t)}function Xe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=e.length;for(r=0;n<i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function yg(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=gs(e.z,r?or(t):t)}catch{}try{return e.w=gs((e.XF||{}).numFmtId||(r?14:0),r?or(t):t)}catch{return""+t}}function On(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?nl[e.v]||e.v:t==null?yg(e,e.v):yg(e,t))}function ii(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Iy(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,i=e||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?yt(n.origin):n.origin;a=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Xe(i["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),a==-1&&(d.e.r=a=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var p={v:t[f][h]},x=a+f,m=o+h;if(d.s.r>x&&(d.s.r=x),d.s.c>m&&(d.s.c=m),d.e.r<x&&(d.e.r=x),d.e.c<m&&(d.e.c=m),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))p=t[f][h];else if(Array.isArray(p.v)&&(p.f=t[f][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||at[14],n.cellDates?(p.t="d",p.w=gs(p.z,or(p.v))):(p.t="n",p.v=or(p.v),p.w=gs(p.z,p.v))):p.t="s";if(s)i[x]||(i[x]=[]),i[x][m]&&i[x][m].z&&(p.z=i[x][m].z),i[x][m]=p;else{var g=We({c:m,r:x});i[g]&&i[g].z&&(p.z=i[g].z),i[g]=p}}}return d.s.c<1e7&&(i["!ref"]=dt(d)),i}function ya(e,t){return Iy(null,e,t)}function vj(e){return e.read_shift(4,"i")}function Xr(e,t){return t||(t=te(4)),t.write_shift(4,e),t}function Ut(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function wt(e,t){var r=!1;return t==null&&(r=!0,t=te(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function yj(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function wj(e,t){return t||(t=te(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Ch(e,t){var r=e.l,n=e.read_shift(1),s=Ut(e),i=[],a={t:s,h:s};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(yj(e));a.r=i}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function _j(e,t){var r=!1;return t==null&&(r=!0,t=te(15+4*e.t.length)),t.write_shift(1,0),wt(e.t,t),r?t.slice(0,t.l):t}var Ej=Ch;function Sj(e,t){var r=!1;return t==null&&(r=!0,t=te(23+4*e.t.length)),t.write_shift(1,1),wt(e.t,t),t.write_shift(4,1),wj({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function Dr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ai(e,t){return t==null&&(t=te(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function oi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function li(e,t){return t==null&&(t=te(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Tj=Ut,Ly=wt;function Ah(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Xc(e,t){var r=!1;return t==null&&(r=!0,t=te(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var bj=Ut,cf=Ah,Oh=Xc;function My(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?Kc([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ls(t,0)>>2;return r?s/100:s}function By(e,t){t==null&&(t=te(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function $y(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function kj(e,t){return t||(t=te(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ci=$y,wa=kj;function _a(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Zs(e,t){return(t||te(8)).write_shift(8,e,"f")}function Nj(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var d=Ij[s];d&&(t.rgb=Ag(d));break;case 2:t.rgb=Ag([a,o,c]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Yc(e,t){if(t||(t=te(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function jj(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Cj(e,t){t||(t=te(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var Uy=2,cr=3,Ll=11,Jc=19,Ml=64,Aj=65,Oj=71,Fj=4108,Pj=4126,kt=80,wg={1:{n:"CodePage",t:Uy},2:{n:"Category",t:kt},3:{n:"PresentationFormat",t:kt},4:{n:"ByteCount",t:cr},5:{n:"LineCount",t:cr},6:{n:"ParagraphCount",t:cr},7:{n:"SlideCount",t:cr},8:{n:"NoteCount",t:cr},9:{n:"HiddenCount",t:cr},10:{n:"MultimediaClipCount",t:cr},11:{n:"ScaleCrop",t:Ll},12:{n:"HeadingPairs",t:Fj},13:{n:"TitlesOfParts",t:Pj},14:{n:"Manager",t:kt},15:{n:"Company",t:kt},16:{n:"LinksUpToDate",t:Ll},17:{n:"CharacterCount",t:cr},19:{n:"SharedDoc",t:Ll},22:{n:"HyperlinksChanged",t:Ll},23:{n:"AppVersion",t:cr,p:"version"},24:{n:"DigSig",t:Aj},26:{n:"ContentType",t:kt},27:{n:"ContentStatus",t:kt},28:{n:"Language",t:kt},29:{n:"Version",t:kt},255:{},2147483648:{n:"Locale",t:Jc},2147483651:{n:"Behavior",t:Jc},1919054434:{}},_g={1:{n:"CodePage",t:Uy},2:{n:"Title",t:kt},3:{n:"Subject",t:kt},4:{n:"Author",t:kt},5:{n:"Keywords",t:kt},6:{n:"Comments",t:kt},7:{n:"Template",t:kt},8:{n:"LastAuthor",t:kt},9:{n:"RevNumber",t:kt},10:{n:"EditTime",t:Ml},11:{n:"LastPrinted",t:Ml},12:{n:"CreatedDate",t:Ml},13:{n:"ModifiedDate",t:Ml},14:{n:"PageCount",t:cr},15:{n:"WordCount",t:cr},16:{n:"CharCount",t:cr},17:{n:"Thumbnail",t:Oj},18:{n:"Application",t:kt},19:{n:"DocSecurity",t:cr},255:{},2147483648:{n:"Locale",t:Jc},2147483651:{n:"Behavior",t:Jc},1919054434:{}};function Dj(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Rj=Dj([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ij=lr(Rj),nl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Lj={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Bl={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Wy(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Hy(e,t){var r=q3(Lj),n=[],s;n[n.length]=ft,n[n.length]=fe("Types",null,{xmlns:vt.CT,"xmlns:xsd":vt.xsd,"xmlns:xsi":vt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return fe("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=fe("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Bl[c][t.bookType]||Bl[c].xlsx}))},a=function(c){(e[c]||[]).forEach(function(d){n[n.length]=fe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Bl[c][t.bookType]||Bl[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(d){n[n.length]=fe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return i("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Re={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function zy(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function qi(e){var t=[ft,fe("Relationships",null,{xmlns:vt.RELS})];return Dt(e["!id"]).forEach(function(r){t[t.length]=fe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Be(e,t,r,n,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[Re.HLINK,Re.XPATH,Re.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}function Mj(e){var t=[ft];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Eg(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Bj(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function $j(e){var t=[ft];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Eg(e[r][0],e[r][1])),t.push(Bj("",e[r][0]));return t.push(Eg("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Vy(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Hc.version+"</meta:generator></office:meta></office:document-meta>"}var Vs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function $d(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=$e(t),n[n.length]=r?fe(e,t,r):jt(e,t))}function Gy(e,t){var r=t||{},n=[ft,fe("cp:coreProperties",null,{"xmlns:cp":vt.CORE_PROPS,"xmlns:dc":vt.dc,"xmlns:dcterms":vt.dcterms,"xmlns:dcmitype":vt.dcmitype,"xmlns:xsi":vt.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&$d("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:lf(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&$d("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:lf(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=Vs.length;++i){var a=Vs[i],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&$d(a[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ki=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],qy=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ky(e){var t=[],r=fe;return e||(e={}),e.Application="SheetJS",t[t.length]=ft,t[t.length]=fe("Properties",null,{xmlns:vt.EXT_PROPS,"xmlns:vt":vt.vt}),Ki.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=$e(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+$e(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Xy(e){var t=[ft,fe("Properties",null,{xmlns:vt.CUST_PROPS,"xmlns:vt":vt.vt})];if(!e)return t.join("");var r=1;return Dt(e).forEach(function(s){++r,t[t.length]=fe("property",sj(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:$e(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Sg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Uj(e,t){var r=[];return Dt(Sg).map(function(n){for(var s=0;s<Vs.length;++s)if(Vs[s][1]==n)return Vs[s];for(s=0;s<Ki.length;++s)if(Ki[s][1]==n)return Ki[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(jt(Sg[n[1]]||n[1],s))}}),fe("DocumentProperties",r.join(""),{xmlns:fr.o})}function Wj(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Dt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var a=0;a<Vs.length;++a)if(i==Vs[a][1])return;for(a=0;a<Ki.length;++a)if(i==Ki[a][1])return;for(a=0;a<r.length;++a)if(i==r[a])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(fe(ug(i),o,{"dt:dt":c}))}}),t&&Dt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var a=t[i],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),s.push(fe(ug(i),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+fr.o+'">'+s.join("")+"</"+n+">"}function Hj(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var a=te(8);return a.write_shift(4,n),a.write_shift(4,s),a}function Tg(e,t){var r=te(4),n=te(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=te(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=Hj(t);break;case 31:case 80:for(n=te(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Nt([r,n])}var Yy=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function zj(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function bg(e,t,r){var n=te(8),s=[],i=[],a=8,o=0,c=te(8),d=te(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),s.push(d),a+=8+c.length,!t){d=te(8),d.write_shift(4,0),s.unshift(d);var u=[te(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=te(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=Nt(u),i.unshift(c),a+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(Yy.indexOf(e[o][0])>-1||qy.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],p=0;if(t){p=+t[e[o][0]];var x=r[p];if(x.p=="version"&&typeof h=="string"){var m=h.split(".");h=(+m[0]<<16)+(+m[1]||0)}c=Tg(x.t,h)}else{var g=zj(h);g==-1&&(g=31,h=String(h)),c=Tg(g,h)}i.push(c),d=te(8),d.write_shift(4,t?p:2+o),s.push(d),a+=8+c.length}var _=8*(i.length+1);for(o=0;o<i.length;++o)s[o].write_shift(4,_),_+=i[o].length;return n.write_shift(4,a),n.write_shift(4,i.length),Nt([n].concat(s).concat(i))}function kg(e,t,r,n,s,i){var a=te(s?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,He.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,s?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,s?68:48);var c=bg(e,r,n);if(o.push(c),s){var d=bg(s,null,null);a.write_shift(16,i,"hex"),a.write_shift(4,68+c.length),o.push(d)}return Nt(o)}function Vj(e,t){t||(t=te(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Gj(e,t){return e.read_shift(t)===1}function qt(e,t){return t||(t=te(2)),t.write_shift(2,+!!e),t}function Jy(e){return e.read_shift(2,"u")}function Tr(e,t){return t||(t=te(2)),t.write_shift(2,e),t}function Qy(e,t,r){return r||(r=te(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Zy(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?e.read_shift(n,s):"";return a}function qj(e){var t=e.t||"",r=te(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=te(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Nt(s)}function Kj(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Xj(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Kj(e,n,r)}function Yj(e,t,r){if(r.biff>5)return Xj(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function ew(e,t,r){return r||(r=te(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Ng(e,t){t||(t=te(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Jj(e){var t=te(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(i==28)n=n.slice(1),Ng(n,t);else if(i&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&Ng(s>-1?n.slice(s+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function ei(e,t,r,n){return n||(n=te(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Qj(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),i=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[s,i,a]}function Zj(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function tw(e,t){return t||(t=te(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Fh(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=te(s);return i.write_shift(2,n),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function eC(e,t){var r=!t||t.biff==8,n=te(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function tC(e,t){var r=!t||t.biff>=8?2:1,n=te(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function rC(e,t){var r=te(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=qj(e[s]);var i=Nt([r].concat(n));return i.parts=[r.length].concat(n.map(function(a){return a.length})),i}function nC(){var e=te(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function sC(e){var t=te(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function iC(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,i=te(s);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function aC(e,t,r,n){var s=te(10);return ei(e,t,n,s),s.write_shift(4,r),s}function oC(e,t,r,n,s){var i=!s||s.biff==8,a=te(8+ +i+(1+i)*r.length);return ei(e,t,n,a),a.write_shift(2,r.length),i&&a.write_shift(1,1),a.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),a}function lC(e,t,r,n){var s=r&&r.biff==5;n||(n=te(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function cC(e,t){var r=t.biff==8||!t.biff?4:2,n=te(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function jg(e,t,r,n){var s=r&&r.biff==5;n||(n=te(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function uC(e){var t=te(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function dC(e,t,r,n,s,i){var a=te(8);return ei(e,t,n,a),Qy(r,i,a),a}function fC(e,t,r,n){var s=te(14);return ei(e,t,n,s),Zs(r,s),s}function hC(e,t,r){if(r.biff<8)return mC(e,t,r);for(var n=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(Qj(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function mC(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Zy(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function pC(e){var t=te(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)tw(e[r],t);return t}function gC(e){var t=te(24),r=yt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Nt([t,Jj(e[1])])}function xC(e){var t=e[1].Tooltip,r=te(10+2*(t.length+1));r.write_shift(2,2048);var n=yt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function vC(e){return e||(e=te(4)),e.write_shift(2,1),e.write_shift(2,1),e}function yC(e,t,r){if(!r.cellStyles)return cn(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),i=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var d={s,e:i,w:a,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function wC(e,t){var r=te(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function _C(e){for(var t=te(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function EC(e,t,r){var n=te(15);return il(n,e,t),n.write_shift(8,r,"f"),n}function SC(e,t,r){var n=te(9);return il(n,e,t),n.write_shift(2,r),n}var TC=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=_h({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var d=[],u=Qs(1);switch(c.type){case"base64":u=Hr(An(o));break;case"binary":u=Hr(o);break;case"buffer":case"array":u=o;break}dr(u,0);var f=u.read_shift(1),h=!!(f&136),p=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,g=521;f==2&&(m=u.read_shift(2)),u.l+=3,f!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(g=u.read_shift(2));var _=u.read_shift(2),y=c.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(y=e[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var v=[],w={},N=Math.min(u.length,f==2?521:g-10-(p?264:0)),E=x?32:11;u.l<N&&u[u.l]!=13;)switch(w={},w.name=Is.utils.decode(y,u.slice(u.l,u.l+E)).replace(/[\u0000\r\n].*$/g,""),u.l+=E,w.type=String.fromCharCode(u.read_shift(1)),f!=2&&!x&&(w.offset=u.read_shift(4)),w.len=u.read_shift(1),f==2&&(w.offset=u.read_shift(2)),w.dec=u.read_shift(1),w.name.length&&v.push(w),f!=2&&(u.l+=x?13:14),w.type){case"B":(!p||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var T=0,M=0;for(d[0]=[],M=0;M!=v.length;++M)d[0][M]=v[M].name;for(;m-- >0;){if(u[u.l]===42){u.l+=_;continue}for(++u.l,d[++T]=[],M=0,M=0;M!=v.length;++M){var P=u.slice(u.l,u.l+v[M].len);u.l+=v[M].len,dr(P,0);var B=Is.utils.decode(y,P);switch(v[M].type){case"C":B.trim().length&&(d[T][M]=B.replace(/\s+$/,""));break;case"D":B.length===8?d[T][M]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):d[T][M]=B;break;case"F":d[T][M]=parseFloat(B.trim());break;case"+":case"I":d[T][M]=x?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":d[T][M]=!0;break;case"N":case"F":d[T][M]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));d[T][M]="##MEMO##"+(x?parseInt(B.trim(),10):P.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(d[T][M]=+B||0);break;case"@":d[T][M]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":d[T][M]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":d[T][M]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[T][M]=-P.read_shift(-8,"f");break;case"B":if(p&&v[M].len==8){d[T][M]=P.read_shift(8,"f");break}case"G":case"P":P.l+=v[M].len;break;case"0":if(v[M].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[M].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=v,d}function n(o,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=ya(r(o,d),d);return u["!cols"]=d.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete d.DBF,u}function s(o,c){try{return ii(n(o,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var d=c||{};if(+d.codepage>=0&&Ro(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=ar(),f=ru(o,{header:1,raw:!0,cellDates:!0}),h=f[0],p=f.slice(1),x=o["!cols"]||[],m=0,g=0,_=0,y=1;for(m=0;m<h.length;++m){if(((x[m]||{}).DBF||{}).name){h[m]=x[m].DBF.name,++_;continue}if(h[m]!=null){if(++_,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(g=0;g<1024;++g)if(h.indexOf(h[m]+"_"+g)==-1){h[m]+="_"+g;break}}}}var v=Xe(o["!ref"]),w=[],N=[],E=[];for(m=0;m<=v.e.c-v.s.c;++m){var T="",M="",P=0,B=[];for(g=0;g<p.length;++g)p[g][m]!=null&&B.push(p[g][m]);if(B.length==0||h[m]==null){w[m]="?";continue}for(g=0;g<B.length;++g){switch(typeof B[g]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=B[g]instanceof Date?"D":"C";break;default:M="C"}P=Math.max(P,String(B[g]).length),T=T&&T!=M?"C":M}P>250&&(P=250),M=((x[m]||{}).DBF||{}).type,M=="C"&&x[m].DBF.len>P&&(P=x[m].DBF.len),T=="B"&&M=="N"&&(T="N",E[m]=x[m].DBF.dec,P=x[m].DBF.len),N[m]=T=="C"||M=="N"?P:i[T]||0,y+=N[m],w[m]=T}var W=u.next(32);for(W.write_shift(4,318902576),W.write_shift(4,p.length),W.write_shift(2,296+32*_),W.write_shift(2,y),m=0;m<4;++m)W.write_shift(4,0);for(W.write_shift(4,0|(+t[ny]||3)<<8),m=0,g=0;m<h.length;++m)if(h[m]!=null){var Y=u.next(32),J=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Y.write_shift(1,J,"sbcs"),Y.write_shift(1,w[m]=="?"?"C":w[m],"sbcs"),Y.write_shift(4,g),Y.write_shift(1,N[m]||i[w[m]]||0),Y.write_shift(1,E[m]||0),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(1,0),Y.write_shift(4,0),Y.write_shift(4,0),g+=N[m]||i[w[m]]||0}var Te=u.next(264);for(Te.write_shift(4,13),m=0;m<65;++m)Te.write_shift(4,0);for(m=0;m<p.length;++m){var ye=u.next(y);for(ye.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(w[g]){case"L":ye.write_shift(1,p[m][g]==null?63:p[m][g]?84:70);break;case"B":ye.write_shift(8,p[m][g]||0,"f");break;case"N":var se="0";for(typeof p[m][g]=="number"&&(se=p[m][g].toFixed(E[g]||0)),_=0;_<N[g]-se.length;++_)ye.write_shift(1,32);ye.write_shift(1,se,"sbcs");break;case"D":p[m][g]?(ye.write_shift(4,("0000"+p[m][g].getFullYear()).slice(-4),"sbcs"),ye.write_shift(2,("00"+(p[m][g].getMonth()+1)).slice(-2),"sbcs"),ye.write_shift(2,("00"+p[m][g].getDate()).slice(-2),"sbcs")):ye.write_shift(8,"00000000","sbcs");break;case"C":var le=String(p[m][g]!=null?p[m][g]:"").slice(0,N[g]);for(ye.write_shift(1,le,"sbcs"),_=0;_<N[g]-le.length;++_)ye.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),bC=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Dt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var x=e[p];return typeof x=="number"?Qp(x):x},n=function(h,p,x){var m=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return m==59?h:Qp(m)};e["|"]=254;function s(h,p){switch(p.type){case"base64":return i(An(h),p);case"binary":return i(h,p);case"buffer":return i(Ie&&Buffer.isBuffer(h)?h.toString("binary"):el(h),p);case"array":return i(Uu(h),p)}throw new Error("Unrecognized type "+p.type)}function i(h,p){var x=h.split(/[\n\r]+/),m=-1,g=-1,_=0,y=0,v=[],w=[],N=null,E={},T=[],M=[],P=[],B=0,W;for(+p.codepage>=0&&Ro(+p.codepage);_!==x.length;++_){B=0;var Y=x[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),J=Y.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),Te=J[0],ye;if(Y.length>0)switch(Te){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":J[1].charAt(0)=="P"&&w.push(Y.slice(3).replace(/;;/g,";"));break;case"C":var se=!1,le=!1,z=!1,U=!1,Z=-1,G=-1;for(y=1;y<J.length;++y)switch(J[y].charAt(0)){case"A":break;case"X":g=parseInt(J[y].slice(1))-1,le=!0;break;case"Y":for(m=parseInt(J[y].slice(1))-1,le||(g=0),W=v.length;W<=m;++W)v[W]=[];break;case"K":ye=J[y].slice(1),ye.charAt(0)==='"'?ye=ye.slice(1,ye.length-1):ye==="TRUE"?ye=!0:ye==="FALSE"?ye=!1:isNaN(En(ye))?isNaN(Lo(ye).getDate())||(ye=Yt(ye)):(ye=En(ye),N!==null&&py(N)&&(ye=yy(ye))),se=!0;break;case"E":U=!0;var k=SA(J[y].slice(1),{r:m,c:g});v[m][g]=[v[m][g],k];break;case"S":z=!0,v[m][g]=[v[m][g],"S5S"];break;case"G":break;case"R":Z=parseInt(J[y].slice(1))-1;break;case"C":G=parseInt(J[y].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+Y)}if(se&&(v[m][g]&&v[m][g].length==2?v[m][g][0]=ye:v[m][g]=ye,N=null),z){if(U)throw new Error("SYLK shared formula cannot have own formula");var F=Z>-1&&v[Z][G];if(!F||!F[1])throw new Error("SYLK shared formula cannot find base");v[m][g][1]=TA(F[1],{r:m-Z,c:g-G})}break;case"F":var C=0;for(y=1;y<J.length;++y)switch(J[y].charAt(0)){case"X":g=parseInt(J[y].slice(1))-1,++C;break;case"Y":for(m=parseInt(J[y].slice(1))-1,W=v.length;W<=m;++W)v[W]=[];break;case"M":B=parseInt(J[y].slice(1))/20;break;case"F":break;case"G":break;case"P":N=w[parseInt(J[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=J[y].slice(1).split(" "),W=parseInt(P[0],10);W<=parseInt(P[1],10);++W)B=parseInt(P[2],10),M[W-1]=B===0?{hidden:!0}:{wch:B},Ph(M[W-1]);break;case"C":g=parseInt(J[y].slice(1))-1,M[g]||(M[g]={});break;case"R":m=parseInt(J[y].slice(1))-1,T[m]||(T[m]={}),B>0?(T[m].hpt=B,T[m].hpx=aw(B)):B===0&&(T[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+Y)}C<1&&(N=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+Y)}}return T.length>0&&(E["!rows"]=T),M.length>0&&(E["!cols"]=M),p&&p.sheetRows&&(v=v.slice(0,p.sheetRows)),[v,E]}function a(h,p){var x=s(h,p),m=x[0],g=x[1],_=ya(m,p);return Dt(g).forEach(function(y){_[y]=g[y]}),_}function o(h,p){return ii(a(h,p),p)}function c(h,p,x,m){var g="C;Y"+(x+1)+";X"+(m+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+Rh(h.f,{r:x,c:m}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function d(h,p){p.forEach(function(x,m){var g="F;W"+(m+1)+" "+(m+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Qc(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Zc(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function u(h,p){p.forEach(function(x,m){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*eu(x.hpx)+";"),g.length>2&&h.push(g+"R"+(m+1))})}function f(h,p){var x=["ID;PWXL;N;E"],m=[],g=Xe(h["!ref"]),_,y=Array.isArray(h),v=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&d(x,h["!cols"]),h["!rows"]&&u(x,h["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var w=g.s.r;w<=g.e.r;++w)for(var N=g.s.c;N<=g.e.c;++N){var E=We({r:w,c:N});_=y?(h[w]||[])[N]:h[E],!(!_||_.v==null&&(!_.f||_.F))&&m.push(c(_,h,w,N))}return x.join(v)+v+m.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),kC=function(){function e(i,a){switch(a.type){case"base64":return t(An(i),a);case"binary":return t(i,a);case"buffer":return t(Ie&&Buffer.isBuffer(i)?i.toString("binary"):el(i),a);case"array":return t(Uu(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){for(var o=i.split(`
`),c=-1,d=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++c]=[],d=0;continue}if(!(c<0)){var h=o[u].trim().split(","),p=h[0],x=h[1];++u;for(var m=o[u]||"";(m.match(/["]/g)||[]).length&1&&u<o.length-1;)m+=`
`+o[++u];switch(m=m.trim(),+p){case-1:if(m==="BOT"){f[++c]=[],d=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[c][d]=!0:m==="FALSE"?f[c][d]=!1:isNaN(En(x))?isNaN(Lo(x).getDate())?f[c][d]=x:f[c][d]=Yt(x):f[c][d]=En(x),++d;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[c][d++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(i,a){return ya(e(i,a),a)}function n(i,a){return ii(r(i,a),a)}var s=function(){var i=function(c,d,u,f,h){c.push(d),c.push(u+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},a=function(c,d,u,f){c.push(d+","+u),c.push(d==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var d=[],u=Xe(c["!ref"]),f,h=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,u.e.r-u.s.r+1,""),i(d,"TUPLES",0,u.e.c-u.s.c+1,""),i(d,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){a(d,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var m=We({r:p,c:x});if(f=h?(c[p]||[])[x]:c[m],!f){a(d,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?a(d,1,0,"="+f.f):a(d,1,0,""):a(d,0,g,"V");break;case"b":a(d,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(d,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=gs(f.z||at[14],or(Yt(f.v)))),a(d,0,f.w,"V");break;default:a(d,1,0,"")}}}a(d,-1,0,"EOD");var _=`\r
`,y=d.join(_);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),rw=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var p=f.split(`
`),x=-1,m=-1,g=0,_=[];g!==p.length;++g){var y=p[g].trim().split(":");if(y[0]==="cell"){var v=yt(y[1]);if(_.length<=v.r)for(x=_.length;x<=v.r;++x)_[x]||(_[x]=[]);switch(x=v.r,m=v.c,y[2]){case"t":_[x][m]=e(y[3]);break;case"v":_[x][m]=+y[3];break;case"vtf":var w=y[y.length-1];case"vtc":switch(y[3]){case"nl":_[x][m]=!!+y[4];break;default:_[x][m]=+y[4];break}y[2]=="vtf"&&(_[x][m]=[_[x][m],w])}}}return h&&h.sheetRows&&(_=_.slice(0,h.sheetRows)),_}function n(f,h){return ya(r(f,h),h)}function s(f,h){return ii(n(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],x,m="",g=yr(f["!ref"]),_=Array.isArray(f),y=g.s.r;y<=g.e.r;++y)for(var v=g.s.c;v<=g.e.c;++v)if(m=We({r:y,c:v}),x=_?(f[y]||[])[v]:f[m],!(!x||x.v==null||x.t==="z")){switch(p=["cell",m,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var w=or(Yt(x.v));p[2]="vtc",p[3]="nd",p[4]=""+w,p[5]=x.w||gs(x.z||at[14],w);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[i,a,o,a,d(f),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),NC=function(){function e(u,f,h,p,x){x.raw?f[h][p]=u:u===""||(u==="TRUE"?f[h][p]=!0:u==="FALSE"?f[h][p]=!1:isNaN(En(u))?isNaN(Lo(u).getDate())?f[h][p]=u:f[h][p]=Yt(u):f[h][p]=En(u))}function t(u,f){var h=f||{},p=[];if(!u||u.length===0)return p;for(var x=u.split(/[\r\n]/),m=x.length-1;m>=0&&x[m].length===0;)--m;for(var g=10,_=0,y=0;y<=m;++y)_=x[y].indexOf(" "),_==-1?_=x[y].length:_++,g=Math.max(g,_);for(y=0;y<=m;++y){p[y]=[];var v=0;for(e(x[y].slice(0,g).trim(),p,y,v,h),v=1;v<=(x[y].length-g)/10+1;++v)e(x[y].slice(g+(v-1)*10,g+v*10).trim(),p,y,v,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var f={},h=!1,p=0,x=0;p<u.length;++p)(x=u.charCodeAt(p))==34?h=!h:!h&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p]);if(!x.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p])}return x.sort(function(m,g){return m[0]-g[0]||n[m[1]]-n[g[1]]}),r[x.pop()[1]]||44}function i(u,f){var h=f||{},p="",x=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=s(u.slice(0,1024)):h&&h.FS?p=h.FS:p=s(u.slice(0,1024));var g=0,_=0,y=0,v=0,w=0,N=p.charCodeAt(0),E=!1,T=0,M=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var P=h.dateNF!=null?H3(h.dateNF):null;function B(){var W=u.slice(v,w),Y={};if(W.charAt(0)=='"'&&W.charAt(W.length-1)=='"'&&(W=W.slice(1,-1).replace(/""/g,'"')),W.length===0)Y.t="z";else if(h.raw)Y.t="s",Y.v=W;else if(W.trim().length===0)Y.t="s",Y.v=W;else if(W.charCodeAt(0)==61)W.charCodeAt(1)==34&&W.charCodeAt(W.length-1)==34?(Y.t="s",Y.v=W.slice(2,-1).replace(/""/g,'"')):bA(W)?(Y.t="n",Y.f=W.slice(1)):(Y.t="s",Y.v=W);else if(W=="TRUE")Y.t="b",Y.v=!0;else if(W=="FALSE")Y.t="b",Y.v=!1;else if(!isNaN(y=En(W)))Y.t="n",h.cellText!==!1&&(Y.w=W),Y.v=y;else if(!isNaN(Lo(W).getDate())||P&&W.match(P)){Y.z=h.dateNF||at[14];var J=0;P&&W.match(P)&&(W=z3(W,h.dateNF,W.match(P)||[]),J=1),h.cellDates?(Y.t="d",Y.v=Yt(W,J)):(Y.t="n",Y.v=or(Yt(W,J))),h.cellText!==!1&&(Y.w=gs(Y.z,Y.v instanceof Date?or(Y.v):Y.v)),h.cellNF||delete Y.z}else Y.t="s",Y.v=W;if(Y.t=="z"||(h.dense?(x[g]||(x[g]=[]),x[g][_]=Y):x[We({c:_,r:g})]=Y),v=w+1,M=u.charCodeAt(v),m.e.c<_&&(m.e.c=_),m.e.r<g&&(m.e.r=g),T==N)++_;else if(_=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;w<u.length;++w)switch(T=u.charCodeAt(w)){case 34:M===34&&(E=!E);break;case N:case 10:case 13:if(!E&&B())break e;break}return w-v>0&&B(),x["!ref"]=dt(m),x}function a(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):ya(t(u,f),f)}function o(u,f){var h="",p=f.type=="string"?[0,0,0,0]:BF(u,f);switch(f.type){case"base64":h=An(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof Is<"u"?h=Is.utils.decode(f.codepage,u):h=Ie&&Buffer.isBuffer(u)?u.toString("binary"):el(u);break;case"array":h=Uu(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=lo(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=lo(h):f.type=="binary"&&typeof Is<"u"&&f.codepage&&(h=Is.utils.decode(f.codepage,Is.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?rw.to_sheet(f.type=="string"?h:lo(h),f):a(h,f)}function c(u,f){return ii(o(u,f),f)}function d(u){for(var f=[],h=Xe(u["!ref"]),p,x=Array.isArray(u),m=h.s.r;m<=h.e.r;++m){for(var g=[],_=h.s.c;_<=h.e.c;++_){var y=We({r:m,c:_});if(p=x?(u[m]||[])[_]:u[y],!p||p.v==null){g.push("          ");continue}for(var v=(p.w||(On(p),p.w)||"").slice(0,10);v.length<10;)v+=" ";g.push(v+(_===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:d}}(),Cg=function(){function e(k,F,C){if(k){dr(k,k.l||0);for(var L=C.Enum||Z;k.l<k.length;){var H=k.read_shift(2),Q=L[H]||L[65535],ne=k.read_shift(2),ae=k.l+ne,A=Q.f&&Q.f(k,ne,C);if(k.l=ae,F(A,Q,H))return}}}function t(k,F){switch(F.type){case"base64":return r(Hr(An(k)),F);case"binary":return r(Hr(k),F);case"buffer":case"array":return r(k,F)}throw"Unsupported type "+F.type}function r(k,F){if(!k)return k;var C=F||{},L=C.dense?[]:{},H="Sheet1",Q="",ne=0,ae={},A=[],ee=[],oe={s:{r:0,c:0},e:{r:0,c:0}},xe=C.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)C.Enum=Z,e(k,function(ve,Er,un){switch(un){case 0:C.vers=ve,ve>=4096&&(C.qpro=!0);break;case 6:oe=ve;break;case 204:ve&&(Q=ve);break;case 222:Q=ve;break;case 15:case 51:C.qpro||(ve[1].v=ve[1].v.slice(1));case 13:case 14:case 16:un==14&&(ve[2]&112)==112&&(ve[2]&15)>1&&(ve[2]&15)<15&&(ve[1].z=C.dateNF||at[14],C.cellDates&&(ve[1].t="d",ve[1].v=yy(ve[1].v))),C.qpro&&ve[3]>ne&&(L["!ref"]=dt(oe),ae[H]=L,A.push(H),L=C.dense?[]:{},oe={s:{r:0,c:0},e:{r:0,c:0}},ne=ve[3],H=Q||"Sheet"+(ne+1),Q="");var ks=C.dense?(L[ve[0].r]||[])[ve[0].c]:L[We(ve[0])];if(ks){ks.t=ve[1].t,ks.v=ve[1].v,ve[1].z!=null&&(ks.z=ve[1].z),ve[1].f!=null&&(ks.f=ve[1].f);break}C.dense?(L[ve[0].r]||(L[ve[0].r]=[]),L[ve[0].r][ve[0].c]=ve[1]):L[We(ve[0])]=ve[1];break}},C);else if(k[2]==26||k[2]==14)C.Enum=G,k[2]==14&&(C.qpro=!0,k.l=0),e(k,function(ve,Er,un){switch(un){case 204:H=ve;break;case 22:ve[1].v=ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ve[3]>ne&&(L["!ref"]=dt(oe),ae[H]=L,A.push(H),L=C.dense?[]:{},oe={s:{r:0,c:0},e:{r:0,c:0}},ne=ve[3],H="Sheet"+(ne+1)),xe>0&&ve[0].r>=xe)break;C.dense?(L[ve[0].r]||(L[ve[0].r]=[]),L[ve[0].r][ve[0].c]=ve[1]):L[We(ve[0])]=ve[1],oe.e.c<ve[0].c&&(oe.e.c=ve[0].c),oe.e.r<ve[0].r&&(oe.e.r=ve[0].r);break;case 27:ve[14e3]&&(ee[ve[14e3][0]]=ve[14e3][1]);break;case 1537:ee[ve[0]]=ve[1],ve[0]==ne&&(H=ve[1]);break}},C);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(L["!ref"]=dt(oe),ae[Q||H]=L,A.push(Q||H),!ee.length)return{SheetNames:A,Sheets:ae};for(var _e={},Ce=[],Oe=0;Oe<ee.length;++Oe)ae[A[Oe]]?(Ce.push(ee[Oe]||A[Oe]),_e[ee[Oe]]=ae[ee[Oe]]||ae[A[Oe]]):(Ce.push(ee[Oe]),_e[ee[Oe]]={"!ref":"A1"});return{SheetNames:Ce,Sheets:_e}}function n(k,F){var C=F||{};if(+C.codepage>=0&&Ro(+C.codepage),C.type=="string")throw new Error("Cannot write WK1 to JS string");var L=ar(),H=Xe(k["!ref"]),Q=Array.isArray(k),ne=[];he(L,0,i(1030)),he(L,6,c(H));for(var ae=Math.min(H.e.r,8191),A=H.s.r;A<=ae;++A)for(var ee=Ft(A),oe=H.s.c;oe<=H.e.c;++oe){A===H.s.r&&(ne[oe]=$t(oe));var xe=ne[oe]+ee,_e=Q?(k[A]||[])[oe]:k[xe];if(!(!_e||_e.t=="z"))if(_e.t=="n")(_e.v|0)==_e.v&&_e.v>=-32768&&_e.v<=32767?he(L,13,p(A,oe,_e.v)):he(L,14,m(A,oe,_e.v));else{var Ce=On(_e);he(L,15,f(A,oe,Ce.slice(0,239)))}}return he(L,1),L.end()}function s(k,F){var C=F||{};if(+C.codepage>=0&&Ro(+C.codepage),C.type=="string")throw new Error("Cannot write WK3 to JS string");var L=ar();he(L,0,a(k));for(var H=0,Q=0;H<k.SheetNames.length;++H)(k.Sheets[k.SheetNames[H]]||{})["!ref"]&&he(L,27,U(k.SheetNames[H],Q++));var ne=0;for(H=0;H<k.SheetNames.length;++H){var ae=k.Sheets[k.SheetNames[H]];if(!(!ae||!ae["!ref"])){for(var A=Xe(ae["!ref"]),ee=Array.isArray(ae),oe=[],xe=Math.min(A.e.r,8191),_e=A.s.r;_e<=xe;++_e)for(var Ce=Ft(_e),Oe=A.s.c;Oe<=A.e.c;++Oe){_e===A.s.r&&(oe[Oe]=$t(Oe));var ve=oe[Oe]+Ce,Er=ee?(ae[_e]||[])[Oe]:ae[ve];if(!(!Er||Er.t=="z"))if(Er.t=="n")he(L,23,B(_e,Oe,ne,Er.v));else{var un=On(Er);he(L,22,T(_e,Oe,ne,un.slice(0,239)))}}++ne}}return he(L,1),L.end()}function i(k){var F=te(2);return F.write_shift(2,k),F}function a(k){var F=te(26);F.write_shift(2,4096),F.write_shift(2,4),F.write_shift(4,0);for(var C=0,L=0,H=0,Q=0;Q<k.SheetNames.length;++Q){var ne=k.SheetNames[Q],ae=k.Sheets[ne];if(!(!ae||!ae["!ref"])){++H;var A=yr(ae["!ref"]);C<A.e.r&&(C=A.e.r),L<A.e.c&&(L=A.e.c)}}return C>8191&&(C=8191),F.write_shift(2,C),F.write_shift(1,H),F.write_shift(1,L),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(1,1),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(4,0),F}function o(k,F,C){var L={s:{c:0,r:0},e:{c:0,r:0}};return F==8&&C.qpro?(L.s.c=k.read_shift(1),k.l++,L.s.r=k.read_shift(2),L.e.c=k.read_shift(1),k.l++,L.e.r=k.read_shift(2),L):(L.s.c=k.read_shift(2),L.s.r=k.read_shift(2),F==12&&C.qpro&&(k.l+=2),L.e.c=k.read_shift(2),L.e.r=k.read_shift(2),F==12&&C.qpro&&(k.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function c(k){var F=te(8);return F.write_shift(2,k.s.c),F.write_shift(2,k.s.r),F.write_shift(2,k.e.c),F.write_shift(2,k.e.r),F}function d(k,F,C){var L=[{c:0,r:0},{t:"n",v:0},0,0];return C.qpro&&C.vers!=20768?(L[0].c=k.read_shift(1),L[3]=k.read_shift(1),L[0].r=k.read_shift(2),k.l+=2):(L[2]=k.read_shift(1),L[0].c=k.read_shift(2),L[0].r=k.read_shift(2)),L}function u(k,F,C){var L=k.l+F,H=d(k,F,C);if(H[1].t="s",C.vers==20768){k.l++;var Q=k.read_shift(1);return H[1].v=k.read_shift(Q,"utf8"),H}return C.qpro&&k.l++,H[1].v=k.read_shift(L-k.l,"cstr"),H}function f(k,F,C){var L=te(7+C.length);L.write_shift(1,255),L.write_shift(2,F),L.write_shift(2,k),L.write_shift(1,39);for(var H=0;H<L.length;++H){var Q=C.charCodeAt(H);L.write_shift(1,Q>=128?95:Q)}return L.write_shift(1,0),L}function h(k,F,C){var L=d(k,F,C);return L[1].v=k.read_shift(2,"i"),L}function p(k,F,C){var L=te(7);return L.write_shift(1,255),L.write_shift(2,F),L.write_shift(2,k),L.write_shift(2,C,"i"),L}function x(k,F,C){var L=d(k,F,C);return L[1].v=k.read_shift(8,"f"),L}function m(k,F,C){var L=te(13);return L.write_shift(1,255),L.write_shift(2,F),L.write_shift(2,k),L.write_shift(8,C,"f"),L}function g(k,F,C){var L=k.l+F,H=d(k,F,C);if(H[1].v=k.read_shift(8,"f"),C.qpro)k.l=L;else{var Q=k.read_shift(2);w(k.slice(k.l,k.l+Q),H),k.l+=Q}return H}function _(k,F,C){var L=F&32768;return F&=-32769,F=(L?k:0)+(F>=8192?F-16384:F),(L?"":"$")+(C?$t(F):Ft(F))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(k,F){dr(k,0);for(var C=[],L=0,H="",Q="",ne="",ae="";k.l<k.length;){var A=k[k.l++];switch(A){case 0:C.push(k.read_shift(8,"f"));break;case 1:Q=_(F[0].c,k.read_shift(2),!0),H=_(F[0].r,k.read_shift(2),!1),C.push(Q+H);break;case 2:{var ee=_(F[0].c,k.read_shift(2),!0),oe=_(F[0].r,k.read_shift(2),!1);Q=_(F[0].c,k.read_shift(2),!0),H=_(F[0].r,k.read_shift(2),!1),C.push(ee+oe+":"+Q+H)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:C.push("("+C.pop()+")");break;case 5:C.push(k.read_shift(2));break;case 6:{for(var xe="";A=k[k.l++];)xe+=String.fromCharCode(A);C.push('"'+xe.replace(/"/g,'""')+'"')}break;case 8:C.push("-"+C.pop());break;case 23:C.push("+"+C.pop());break;case 22:C.push("NOT("+C.pop()+")");break;case 20:case 21:ae=C.pop(),ne=C.pop(),C.push(["AND","OR"][A-20]+"("+ne+","+ae+")");break;default:if(A<32&&v[A])ae=C.pop(),ne=C.pop(),C.push(ne+v[A]+ae);else if(y[A]){if(L=y[A][1],L==69&&(L=k[k.l++]),L>C.length){console.error("WK1 bad formula parse 0x"+A.toString(16)+":|"+C.join("|")+"|");return}var _e=C.slice(-L);C.length-=L,C.push(y[A][0]+"("+_e.join(",")+")")}else return A<=7?console.error("WK1 invalid opcode "+A.toString(16)):A<=24?console.error("WK1 unsupported op "+A.toString(16)):A<=30?console.error("WK1 invalid opcode "+A.toString(16)):A<=115?console.error("WK1 unsupported function opcode "+A.toString(16)):console.error("WK1 unrecognized opcode "+A.toString(16))}}C.length==1?F[1].f=""+C[0]:console.error("WK1 bad formula parse |"+C.join("|")+"|")}function N(k){var F=[{c:0,r:0},{t:"n",v:0},0];return F[0].r=k.read_shift(2),F[3]=k[k.l++],F[0].c=k[k.l++],F}function E(k,F){var C=N(k);return C[1].t="s",C[1].v=k.read_shift(F-4,"cstr"),C}function T(k,F,C,L){var H=te(6+L.length);H.write_shift(2,k),H.write_shift(1,C),H.write_shift(1,F),H.write_shift(1,39);for(var Q=0;Q<L.length;++Q){var ne=L.charCodeAt(Q);H.write_shift(1,ne>=128?95:ne)}return H.write_shift(1,0),H}function M(k,F){var C=N(k);C[1].v=k.read_shift(2);var L=C[1].v>>1;if(C[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return C[1].v=L,C}function P(k,F){var C=N(k),L=k.read_shift(4),H=k.read_shift(4),Q=k.read_shift(2);if(Q==65535)return L===0&&H===3221225472?(C[1].t="e",C[1].v=15):L===0&&H===3489660928?(C[1].t="e",C[1].v=42):C[1].v=0,C;var ne=Q&32768;return Q=(Q&32767)-16446,C[1].v=(1-ne*2)*(H*Math.pow(2,Q+32)+L*Math.pow(2,Q)),C}function B(k,F,C,L){var H=te(14);if(H.write_shift(2,k),H.write_shift(1,C),H.write_shift(1,F),L==0)return H.write_shift(4,0),H.write_shift(4,0),H.write_shift(2,65535),H;var Q=0,ne=0,ae=0,A=0;return L<0&&(Q=1,L=-L),ne=Math.log2(L)|0,L/=Math.pow(2,ne-31),A=L>>>0,A&2147483648||(L/=2,++ne,A=L>>>0),L-=A,A|=2147483648,A>>>=0,L*=Math.pow(2,32),ae=L>>>0,H.write_shift(4,ae),H.write_shift(4,A),ne+=16383+(Q?32768:0),H.write_shift(2,ne),H}function W(k,F){var C=P(k);return k.l+=F-14,C}function Y(k,F){var C=N(k),L=k.read_shift(4);return C[1].v=L>>6,C}function J(k,F){var C=N(k),L=k.read_shift(8,"f");return C[1].v=L,C}function Te(k,F){var C=J(k);return k.l+=F-10,C}function ye(k,F){return k[k.l+F-1]==0?k.read_shift(F,"cstr"):""}function se(k,F){var C=k[k.l++];C>F-1&&(C=F-1);for(var L="";L.length<C;)L+=String.fromCharCode(k[k.l++]);return L}function le(k,F,C){if(!(!C.qpro||F<21)){var L=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var H=k.read_shift(F-21,"cstr");return[L,H]}}function z(k,F){for(var C={},L=k.l+F;k.l<L;){var H=k.read_shift(2);if(H==14e3){for(C[H]=[0,""],C[H][0]=k.read_shift(2);k[k.l];)C[H][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return C}function U(k,F){var C=te(5+k.length);C.write_shift(2,14e3),C.write_shift(2,F);for(var L=0;L<k.length;++L){var H=k.charCodeAt(L);C[C.l++]=H>127?95:H}return C[C.l++]=0,C}var Z={0:{n:"BOF",f:Jy},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ye},222:{n:"SHEETNAMELP",f:se},65535:{n:""}},G={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:M},25:{n:"FORMULA19",f:W},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:z},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Y},38:{n:"??"},39:{n:"NUMBER27",f:J},40:{n:"FORMULA28",f:Te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ye},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}(),jC=/^\s|\s$|[\t\n\r]/;function nw(e,t){if(!t.bookSST)return"";var r=[ft];r[r.length]=fe("sst",null,{xmlns:va[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(jC)&&(i+=' xml:space="preserve"'),i+=">"+$e(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function CC(e){return[e.read_shift(4),e.read_shift(4)]}function AC(e,t){return t||(t=te(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var OC=_j;function FC(e){var t=ar();ie(t,159,AC(e));for(var r=0;r<e.length;++r)ie(t,19,OC(e[r]));return ie(t,160),t.end()}function PC(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function sw(e){var t=0,r,n=PC(e),s=n.length+1,i,a,o,c,d;for(r=Qs(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=t&16384?1:0,c=t<<1&32767,d=o|c,t=d^a;return t^52811}var DC=function(){function e(s,i){switch(i.type){case"base64":return t(An(s),i);case"binary":return t(s,i);case"buffer":return t(Ie&&Buffer.isBuffer(s)?s.toString("binary"):el(s),i);case"array":return t(Uu(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var a=i||{},o=a.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,p=0,x,m=-1;x=h.exec(u);){switch(x[0]){case"\\cell":var g=u.slice(p,h.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++m,g.length){var _={v:g,t:"s"};Array.isArray(o)?o[f][m]=_:o[We({r:f,c:m})]=_}break}p=h.lastIndex}m>d.e.c&&(d.e.c=m)}),o["!ref"]=dt(d),o}function r(s,i){return ii(e(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=Xe(s["!ref"]),o,c=Array.isArray(s),d=a.s.r;d<=a.e.r;++d){i.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var f=We({r:d,c:u});o=c?(s[d]||[])[u]:s[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(On(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Ag(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var RC=6,Sn=RC;function Qc(e){return Math.floor((e+Math.round(128/Sn)/256)*Sn)}function Zc(e){return Math.floor((e-5)/Sn*100+.5)/100}function uf(e){return Math.round((e*Sn+5)/Sn*256)/256}function Ph(e){e.width?(e.wpx=Qc(e.width),e.wch=Zc(e.wpx),e.MDW=Sn):e.wpx?(e.wch=Zc(e.wpx),e.width=uf(e.wch),e.MDW=Sn):typeof e.wch=="number"&&(e.width=uf(e.wch),e.wpx=Qc(e.width),e.MDW=Sn),e.customWidth&&delete e.customWidth}var IC=96,iw=IC;function eu(e){return e*96/iw}function aw(e){return e*iw/96}function LC(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=fe("numFmt",null,{numFmtId:n,formatCode:$e(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=fe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function MC(e){var t=[];return t[t.length]=fe("cellXfs",null),e.forEach(function(r){t[t.length]=fe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=fe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function ow(e,t){var r=[ft,fe("styleSheet",null,{xmlns:va[0],"xmlns:vt":vt.vt})],n;return e.SSF&&(n=LC(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=MC(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function BC(e,t){var r=e.read_shift(2),n=Ut(e);return[r,n]}function $C(e,t,r){r||(r=te(6+4*t.length)),r.write_shift(2,e),wt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function UC(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=jj(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=Nj(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ut(e),n}function WC(e,t){t||(t=te(25+4*32)),t.write_shift(2,e.sz*20),Cj(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Yc(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),wt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var HC=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ud,zC=cn;function Og(e,t){t||(t=te(4*3+8*7+16*1)),Ud||(Ud=_h(HC));var r=Ud[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Yc({auto:1},t),Yc({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function VC(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function lw(e,t,r){r||(r=te(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ia(e,t){return t||(t=te(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var GC=cn;function qC(e,t){return t||(t=te(51)),t.write_shift(1,0),Ia(null,t),Ia(null,t),Ia(null,t),Ia(null,t),Ia(null,t),t.length>t.l?t.slice(0,t.l):t}function KC(e,t){return t||(t=te(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),Xc(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function XC(e,t,r){var n=te(2052);return n.write_shift(4,e),Xc(t,n),Xc(r,n),n.length>n.l?n.slice(0,n.l):n}function YC(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(ie(e,615,Xr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&ie(e,44,$C(s,t[s]))}),ie(e,616))}}function JC(e){var t=1;ie(e,611,Xr(t)),ie(e,43,WC({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ie(e,612)}function QC(e){var t=2;ie(e,603,Xr(t)),ie(e,45,Og({patternType:"none"})),ie(e,45,Og({patternType:"gray125"})),ie(e,604)}function ZC(e){var t=1;ie(e,613,Xr(t)),ie(e,46,qC()),ie(e,614)}function eA(e){var t=1;ie(e,626,Xr(t)),ie(e,47,lw({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ie(e,627)}function tA(e,t){ie(e,617,Xr(t.length)),t.forEach(function(r){ie(e,47,lw(r,0))}),ie(e,618)}function rA(e){var t=1;ie(e,619,Xr(t)),ie(e,48,KC({xfId:0,builtinId:0,name:"Normal"})),ie(e,620)}function nA(e){var t=0;ie(e,505,Xr(t)),ie(e,506)}function sA(e){var t=0;ie(e,508,XC(t,"TableStyleMedium9","PivotStyleMedium4")),ie(e,509)}function iA(e,t){var r=ar();return ie(r,278),YC(r,e.SSF),JC(r),QC(r),ZC(r),eA(r),tA(r,t.cellXfs),rA(r),nA(r),sA(r),ie(r,279),r.end()}function cw(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ft];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function aA(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ut(e)}}function oA(e){var t=te(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),wt(e.name,t),t.slice(0,t.l)}function lA(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function cA(e){var t=te(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function uA(e,t){var r=te(8+2*t.length);return r.write_shift(4,e),wt(t,r),r.slice(0,r.l)}function dA(e){return e.l+=4,e.read_shift(4)!=0}function fA(e,t){var r=te(8);return r.write_shift(4,e),r.write_shift(4,1),r}function hA(){var e=ar();return ie(e,332),ie(e,334,Xr(1)),ie(e,335,oA({name:"XLDAPR",version:12e4,flags:3496657072})),ie(e,336),ie(e,339,uA(1,"XLDAPR")),ie(e,52),ie(e,35,Xr(514)),ie(e,4096,Xr(0)),ie(e,4097,Tr(1)),ie(e,36),ie(e,53),ie(e,340),ie(e,337,fA(1)),ie(e,51,cA([[1,0]])),ie(e,338),ie(e,333),e.end()}function uw(){var e=[ft];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function mA(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=We(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Ii=1024;function dw(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[fe("xml",null,{"xmlns:v":fr.v,"xmlns:o":fr.o,"xmlns:x":fr.x,"xmlns:mv":fr.mv}).replace(/\/>/,">"),fe("o:shapelayout",fe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),fe("v:shapetype",[fe("v:stroke",null,{joinstyle:"miter"}),fe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ii<e*1e3;)Ii+=1e3;return t.forEach(function(i){var a=yt(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?fe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=fe("v:fill",c,o),u={on:"t",obscured:"t"};++Ii,s=s.concat(["<v:shape"+Bo({id:"_x0000_s"+Ii,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,fe("v:shadow",null,u),fe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",jt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),jt("x:AutoFill","False"),jt("x:Row",String(a.r)),jt("x:Column",String(a.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function fw(e){var t=[ft,fe("comments",null,{xmlns:va[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var i=$e(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf($e(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(jt("t",$e(i[0]||"")));else{for(var a=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)a+=`Reply:
    `+i[o]+`
`;t.push(jt("t",$e(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function pA(e,t,r){var n=[ft,fe("ThreadedComments",null,{xmlns:vt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(fe("threadedComment",jt("text",a.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function gA(e){var t=[ft,fe("personList",null,{xmlns:vt.TCMNT,"xmlns:x":va[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(fe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function xA(e){var t={};t.iauthor=e.read_shift(4);var r=ci(e);return t.rfx=r.s,t.ref=We(r.s),e.l+=16,t}function vA(e,t){return t==null&&(t=te(36)),t.write_shift(4,e[1].iauthor),wa(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var yA=Ut;function wA(e){return wt(e.slice(0,54))}function _A(e){var t=ar(),r=[];return ie(t,628),ie(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),ie(t,632,wA(s.a)))})}),ie(t,631),ie(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:yt(n[0]),e:yt(n[0])};ie(t,635,vA([i,s])),s.t&&s.t.length>0&&ie(t,637,Sj(s)),ie(t,636),delete s.iauthor})}),ie(t,634),ie(t,629),t.end()}function EA(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&He.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var hw=["xlsb","xlsm","xlam","biff8","xla"],SA=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,i,a){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=t.c:--u,c?d+=t.r:--d,s+(o?"":"$")+$t(u)+(c?"":"$")+Ft(d)}return function(s,i){return t=i,s.replace(e,r)}}(),Dh=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Rh=function(){return function(t,r){return t.replace(Dh,function(n,s,i,a,o,c){var d=jh(a)-(i?0:r.c),u=Nh(c)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",h=d==0?"":i?d+1:"["+d+"]";return s+"R"+f+"C"+h})}}();function TA(e,t){return e.replace(Dh,function(r,n,s,i,a,o){return n+(s=="$"?s+i:$t(jh(i)+t.c))+(a=="$"?a+o:Ft(Nh(o)+t.r))})}function bA(e){return e.length!=1}function ct(e){e.l+=1}function xs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function mw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return pw(e);r.biff==12&&(n=4)}var s=e.read_shift(n),i=e.read_shift(n),a=xs(e),o=xs(e);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function pw(e){var t=xs(e),r=xs(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function kA(e,t,r){if(r.biff<8)return pw(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=xs(e),a=xs(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function gw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return NA(e);var n=e.read_shift(r&&r.biff==12?4:2),s=xs(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function NA(e){var t=xs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function jA(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function CA(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return AA(e);var s=e.read_shift(n>=12?4:2),i=e.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function AA(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function OA(e,t,r){var n=(e[e.l++]&96)>>5,s=mw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function FA(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var a=mw(e,i,r);return[n,s,a]}function PA(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function DA(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,s]}function RA(e,t,r){var n=(e[e.l++]&96)>>5,s=kA(e,t-1,r);return[n,s]}function IA(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Fg(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function LA(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function MA(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function BA(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function $A(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function UA(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function xw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function WA(e){return e.read_shift(2),xw(e)}function HA(e){return e.read_shift(2),xw(e)}function zA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=gw(e,0,r);return[n,s]}function VA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=CA(e,0,r);return[n,s]}function GA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=gw(e,0,r);return[n,s,i]}function qA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[q5[s],ww[s],n]}function KA(e,t,r){var n=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:XA(e);return[s,(i[0]===0?ww:G5)[i[1]]]}function XA(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function YA(e,t,r){e.l+=r&&r.biff==2?3:4}function JA(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function QA(e){return e.l++,nl[e.read_shift(1)]}function ZA(e){return e.l++,e.read_shift(2)}function e5(e){return e.l++,e.read_shift(1)!==0}function t5(e){return e.l++,_a(e)}function r5(e,t,r){return e.l++,Zy(e,t-1,r)}function n5(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Gj(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=nl[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=_a(e);break;case 2:r[1]=Yj(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function s5(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?ci:Zj)(e));return s}function i5(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=n5(e,r.biff);return a}function a5(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function o5(e,t,r){if(r.biff==5)return l5(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[n,s,i]}function l5(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function c5(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function u5(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function d5(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function f5(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,s]}var h5=cn,m5=cn,p5=cn;function sl(e,t,r){return e.l+=2,[jA(e)]}function Ih(e){return e.l+=6,[]}var g5=sl,x5=Ih,v5=Ih,y5=sl;function vw(e){return e.l+=2,[Jy(e),e.read_shift(2)&1]}var w5=sl,_5=vw,E5=Ih,S5=sl,T5=sl,b5=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function k5(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),a=b5[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:s,C:i}}function N5(e){return e.l+=2,[e.read_shift(4)]}function j5(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function C5(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function A5(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function O5(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function F5(e){return e.l+=4,[0,0]}var Pg={1:{n:"PtgExp",f:JA},2:{n:"PtgTbl",f:p5},3:{n:"PtgAdd",f:ct},4:{n:"PtgSub",f:ct},5:{n:"PtgMul",f:ct},6:{n:"PtgDiv",f:ct},7:{n:"PtgPower",f:ct},8:{n:"PtgConcat",f:ct},9:{n:"PtgLt",f:ct},10:{n:"PtgLe",f:ct},11:{n:"PtgEq",f:ct},12:{n:"PtgGe",f:ct},13:{n:"PtgGt",f:ct},14:{n:"PtgNe",f:ct},15:{n:"PtgIsect",f:ct},16:{n:"PtgUnion",f:ct},17:{n:"PtgRange",f:ct},18:{n:"PtgUplus",f:ct},19:{n:"PtgUminus",f:ct},20:{n:"PtgPercent",f:ct},21:{n:"PtgParen",f:ct},22:{n:"PtgMissArg",f:ct},23:{n:"PtgStr",f:r5},26:{n:"PtgSheet",f:j5},27:{n:"PtgEndSheet",f:C5},28:{n:"PtgErr",f:QA},29:{n:"PtgBool",f:e5},30:{n:"PtgInt",f:ZA},31:{n:"PtgNum",f:t5},32:{n:"PtgArray",f:IA},33:{n:"PtgFunc",f:qA},34:{n:"PtgFuncVar",f:KA},35:{n:"PtgName",f:a5},36:{n:"PtgRef",f:zA},37:{n:"PtgArea",f:OA},38:{n:"PtgMemArea",f:c5},39:{n:"PtgMemErr",f:h5},40:{n:"PtgMemNoMem",f:m5},41:{n:"PtgMemFunc",f:u5},42:{n:"PtgRefErr",f:d5},43:{n:"PtgAreaErr",f:PA},44:{n:"PtgRefN",f:VA},45:{n:"PtgAreaN",f:RA},46:{n:"PtgMemAreaN",f:A5},47:{n:"PtgMemNoMemN",f:O5},57:{n:"PtgNameX",f:o5},58:{n:"PtgRef3d",f:GA},59:{n:"PtgArea3d",f:FA},60:{n:"PtgRefErr3d",f:f5},61:{n:"PtgAreaErr3d",f:DA},255:{}},P5={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},D5={1:{n:"PtgElfLel",f:vw},2:{n:"PtgElfRw",f:S5},3:{n:"PtgElfCol",f:g5},6:{n:"PtgElfRwV",f:T5},7:{n:"PtgElfColV",f:y5},10:{n:"PtgElfRadical",f:w5},11:{n:"PtgElfRadicalS",f:E5},13:{n:"PtgElfColS",f:x5},15:{n:"PtgElfColSV",f:v5},16:{n:"PtgElfRadicalLel",f:_5},25:{n:"PtgList",f:k5},29:{n:"PtgSxName",f:N5},255:{}},R5={0:{n:"PtgAttrNoop",f:F5},1:{n:"PtgAttrSemi",f:UA},2:{n:"PtgAttrIf",f:BA},4:{n:"PtgAttrChoose",f:LA},8:{n:"PtgAttrGoto",f:MA},16:{n:"PtgAttrSum",f:YA},32:{n:"PtgAttrBaxcel",f:Fg},33:{n:"PtgAttrBaxcel",f:Fg},64:{n:"PtgAttrSpace",f:WA},65:{n:"PtgAttrSpaceSemi",f:HA},128:{n:"PtgAttrIfError",f:$A},255:{}};function I5(e,t,r,n){if(n.biff<8)return cn(e,t);for(var s=e.l+t,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=i5(e,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=s5(e,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=s-e.l,t!==0&&i.push(cn(e,t)),i}function L5(e,t,r){for(var n=e.l+t,s,i,a=[];n!=e.l;)t=n-e.l,i=e[e.l],s=Pg[i]||Pg[P5[i]],(i===24||i===25)&&(s=(i===24?D5:R5)[e[e.l+1]]),!s||!s.f?cn(e,t):a.push([s.n,s.f(e,t,r)]);return a}function M5(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var B5={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function $5(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function yw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Dg(e,t,r){var n=yw(e,t,r);return n=="#REF"?n:$5(n,r)}function la(e,t,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,d,u,f=0,h=0,p,x="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",_=0,y=e[0].length;_<y;++_){var v=e[0][_];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),d=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=st(" ",e[0][m][1][1]);break;case 1:g=st("\r",e[0][m][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}d=d+g,m=-1}o.push(d+B5[v[0]]+c);break;case"PtgIsect":c=o.pop(),d=o.pop(),o.push(d+" "+c);break;case"PtgUnion":c=o.pop(),d=o.pop(),o.push(d+","+c);break;case"PtgRange":c=o.pop(),d=o.pop(),o.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=uo(v[1][1],a,s),o.push(fo(u,i));break;case"PtgRefN":u=r?uo(v[1][1],r,s):v[1][1],o.push(fo(u,i));break;case"PtgRef3d":f=v[1][1],u=uo(v[1][2],a,s),x=Dg(n,f,s),o.push(x+"!"+fo(u,i));break;case"PtgFunc":case"PtgFuncVar":var w=v[1][0],N=v[1][1];w||(w=0),w&=127;var E=w==0?[]:o.slice(-w);o.length-=w,N==="User"&&(N=E.shift()),o.push(N+"("+E.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":p=vg(v[1][1],r?{s:r}:a,s),o.push(Bd(p,s));break;case"PtgArea":p=vg(v[1][1],a,s),o.push(Bd(p,s));break;case"PtgArea3d":f=v[1][1],p=v[1][2],x=Dg(n,f,s),o.push(x+"!"+Bd(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var T=(n.names||[])[h-1]||(n[0]||[])[h],M=T?T.Name:"SH33TJSNAME"+String(h);M&&M.slice(0,6)=="_xlfn."&&!s.xlfn&&(M=M.slice(6)),o.push(M);break;case"PtgNameX":var P=v[1][1];h=v[1][2];var B;if(s.biff<=5)P<0&&(P=-P),n[P]&&(B=n[P][h]);else{var W="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][h]&&n[P][h].itab>0&&(W=n.SheetNames[n[P][h].itab-1]+"!"):W=n.SheetNames[h-1]+"!"),n[P]&&n[P][h])W+=n[P][h].Name;else if(n[0]&&n[0][h])W+=n[0][h].Name;else{var Y=(yw(n,P,s)||"").split(";;");Y[h-1]?W=Y[h-1]:W+="SH33TJSERRX"}o.push(W);break}B||(B={Name:"SH33TJSERRY"}),o.push(B.Name);break;case"PtgParen":var J="(",Te=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:J=st(" ",e[0][m][1][1])+J;break;case 3:J=st("\r",e[0][m][1][1])+J;break;case 4:Te=st(" ",e[0][m][1][1])+Te;break;case 5:Te=st("\r",e[0][m][1][1])+Te;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(J+o.pop()+Te);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:v[1][1],r:v[1][0]};var ye={c:r.c,r:r.r};if(n.sharedf[We(u)]){var se=n.sharedf[We(u)];o.push(la(se,a,ye,n,s))}else{var le=!1;for(c=0;c!=n.arrayf.length;++c)if(d=n.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){o.push(la(d[1],a,ye,n,s)),le=!0;break}le||o.push(v[1])}break;case"PtgArray":o.push("{"+M5(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&m>=0&&z.indexOf(e[0][_][0])==-1){v=e[0][m];var U=!0;switch(v[1][0]){case 4:U=!1;case 0:g=st(" ",v[1][1]);break;case 5:U=!1;case 1:g=st("\r",v[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((U?g:"")+o.pop()+(U?"":g)),m=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function U5(e){if(e==null){var t=te(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Zs(e);return Zs(0)}function W5(e,t,r,n,s){var i=ei(t,r,s),a=U5(e.v),o=te(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var d=te(e.bf.length),u=0;u<e.bf.length;++u)d[u]=e.bf[u];var f=Nt([i,a,o,d]);return f}function Wu(e,t,r){var n=e.read_shift(4),s=L5(e,n,r),i=e.read_shift(4),a=i>0?I5(e,i,s,r):null;return[s,a]}var H5=Wu,Hu=Wu,z5=Wu,V5=Wu,G5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ww={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},q5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function K5(e){var t="of:="+e.replace(Dh,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function X5(e){return e.replace(/\./,"!")}var ho=typeof Map<"u";function Lh(e,t,r){var n=0,s=e.length;if(r){if(ho?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=ho?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(ho?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function zu(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Sn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Zc(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=uf(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function _w(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function bs(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){gy(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===n)return s;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Y5(e,t,r){if(e&&e["!ref"]){var n=Xe(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function J5(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+dt(e[r])+'"/>';return t+"</mergeCells>"}function Q5(e,t,r,n,s){var i=!1,a={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,a.codeName=Mo($e(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),o=(o||"")+fe("outlinePr",null,d)}!i&&!o||(s[s.length]=fe("sheetPr",o,a))}var Z5=["objects","scenarios","selectLockedCells","selectUnlockedCells"],e6=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function t6(e){var t={sheet:1};return Z5.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),e6.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=sw(e.password).toString(16).toUpperCase()),fe("sheetProtection",null,t)}function r6(e){return _w(e),fe("pageMargins",null,e)}function n6(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=fe("col",null,zu(s,n)));return r[r.length]="</cols>",r.join("")}function s6(e,t,r,n){var s=typeof e.ref=="string"?e.ref:dt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,a=yr(s);a.s.r==a.e.r&&(a.e.r=yr(t["!ref"]).e.r,s=dt(a));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),fe("autoFilter",null,{ref:s})}function i6(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),fe("sheetViews",fe("sheetView",null,s),{})}function a6(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=nl[e.v];break;case"d":n&&n.cellDates?s=Yt(e.v,-1).toISOString():(e=lr(e),e.t="n",s=""+(e.v=or(Yt(e.v)))),typeof e.z>"u"&&(e.z=at[14]);break;default:s=e.v;break}var o=jt("v",$e(s)),c={r:t},d=bs(n.cellXfs,e,n);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=jt("v",""+Lh(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=a),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=fe("f",$e(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),fe("c",o,c)}function o6(e,t,r,n){var s=[],i=[],a=Xe(e["!ref"]),o="",c,d="",u=[],f=0,h=0,p=e["!rows"],x=Array.isArray(e),m={r:d},g,_=-1;for(h=a.s.c;h<=a.e.c;++h)u[h]=$t(h);for(f=a.s.r;f<=a.e.r;++f){for(i=[],d=Ft(f),h=a.s.c;h<=a.e.c;++h){c=u[h]+d;var y=x?(e[f]||[])[h]:e[c];y!==void 0&&(o=a6(y,c,e,t))!=null&&i.push(o)}(i.length>0||p&&p[f])&&(m={r:d},p&&p[f]&&(g=p[f],g.hidden&&(m.hidden=1),_=-1,g.hpx?_=eu(g.hpx):g.hpt&&(_=g.hpt),_>-1&&(m.ht=_,m.customHeight=1),g.level&&(m.outlineLevel=g.level)),s[s.length]=fe("row",i.join(""),m))}if(p)for(;f<p.length;++f)p&&p[f]&&(m={r:f+1},g=p[f],g.hidden&&(m.hidden=1),_=-1,g.hpx?_=eu(g.hpx):g.hpt&&(_=g.hpt),_>-1&&(m.ht=_,m.customHeight=1),g.level&&(m.outlineLevel=g.level),s[s.length]=fe("row","",m));return s.join("")}function Ew(e,t,r,n){var s=[ft,fe("worksheet",null,{xmlns:va[0],"xmlns:r":vt.r})],i=r.SheetNames[e],a=0,o="",c=r.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",u=Xe(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=dt(u)}n||(n={}),c["!comments"]=[];var f=[];Q5(c,r,e,t,s),s[s.length]=fe("dimension",null,{ref:d}),s[s.length]=i6(c,t,e,r),t.sheetFormat&&(s[s.length]=fe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=n6(c,c["!cols"])),s[a=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=o6(c,t),o.length>0&&(s[s.length]=o)),s.length>a+1&&(s[s.length]="</sheetData>",s[a]=s[a].replace("/>",">")),c["!protect"]&&(s[s.length]=t6(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=s6(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=J5(c["!merges"]));var h=-1,p,x=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(x=Be(n,-1,$e(m[1].Target).replace(/#.*$/,""),Re.HLINK),p["r:id"]="rId"+x),(h=m[1].Target.indexOf("#"))>-1&&(p.location=$e(m[1].Target.slice(h+1))),m[1].Tooltip&&(p.tooltip=$e(m[1].Tooltip)),s[s.length]=fe("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=r6(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=jt("ignoredErrors",fe("ignoredError",null,{numberStoredAsText:1,sqref:d}))),f.length>0&&(x=Be(n,-1,"../drawings/drawing"+(e+1)+".xml",Re.DRAW),s[s.length]=fe("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=Be(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Re.VML),s[s.length]=fe("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function l6(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function c6(e,t,r){var n=te(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;s.hpx?i=eu(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var a=0;s.level&&(a|=s.level),s.hidden&&(a|=16),(s.hpx||s.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var d={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,h=-1,p=u<<10;p<u+1<<10;++p){d.c=p;var x=Array.isArray(r)?(r[d.r]||[])[d.c]:r[We(d)];x&&(f<0&&(f=p),h=p)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var m=n.l;return n.l=c,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function u6(e,t,r,n){var s=c6(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&ie(e,0,s)}var d6=ci,f6=wa;function h6(){}function m6(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Tj(e),r}function p6(e,t,r){r==null&&(r=te(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return Yc({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Ly(e,r),r.slice(0,r.l)}function g6(e){var t=Dr(e);return[t]}function x6(e,t,r){return r==null&&(r=te(8)),ai(t,r)}function v6(e){var t=oi(e);return[t]}function y6(e,t,r){return r==null&&(r=te(4)),li(t,r)}function w6(e){var t=Dr(e),r=e.read_shift(1);return[t,r,"b"]}function _6(e,t,r){return r==null&&(r=te(9)),ai(t,r),r.write_shift(1,e.v?1:0),r}function E6(e){var t=oi(e),r=e.read_shift(1);return[t,r,"b"]}function S6(e,t,r){return r==null&&(r=te(5)),li(t,r),r.write_shift(1,e.v?1:0),r}function T6(e){var t=Dr(e),r=e.read_shift(1);return[t,r,"e"]}function b6(e,t,r){return r==null&&(r=te(9)),ai(t,r),r.write_shift(1,e.v),r}function k6(e){var t=oi(e),r=e.read_shift(1);return[t,r,"e"]}function N6(e,t,r){return r==null&&(r=te(8)),li(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function j6(e){var t=Dr(e),r=e.read_shift(4);return[t,r,"s"]}function C6(e,t,r){return r==null&&(r=te(12)),ai(t,r),r.write_shift(4,t.v),r}function A6(e){var t=oi(e),r=e.read_shift(4);return[t,r,"s"]}function O6(e,t,r){return r==null&&(r=te(8)),li(t,r),r.write_shift(4,t.v),r}function F6(e){var t=Dr(e),r=_a(e);return[t,r,"n"]}function P6(e,t,r){return r==null&&(r=te(16)),ai(t,r),Zs(e.v,r),r}function D6(e){var t=oi(e),r=_a(e);return[t,r,"n"]}function R6(e,t,r){return r==null&&(r=te(12)),li(t,r),Zs(e.v,r),r}function I6(e){var t=Dr(e),r=My(e);return[t,r,"n"]}function L6(e,t,r){return r==null&&(r=te(12)),ai(t,r),By(e.v,r),r}function M6(e){var t=oi(e),r=My(e);return[t,r,"n"]}function B6(e,t,r){return r==null&&(r=te(8)),li(t,r),By(e.v,r),r}function $6(e){var t=Dr(e),r=Ch(e);return[t,r,"is"]}function U6(e){var t=Dr(e),r=Ut(e);return[t,r,"str"]}function W6(e,t,r){return r==null&&(r=te(12+4*e.v.length)),ai(t,r),wt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function H6(e){var t=oi(e),r=Ut(e);return[t,r,"str"]}function z6(e,t,r){return r==null&&(r=te(8+4*e.v.length)),li(t,r),wt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function V6(e,t,r){var n=e.l+t,s=Dr(e);s.r=r["!row"];var i=e.read_shift(1),a=[s,i,"b"];if(r.cellFormula){e.l+=2;var o=Hu(e,n-e.l,r);a[3]=la(o,null,s,r.supbooks,r)}else e.l=n;return a}function G6(e,t,r){var n=e.l+t,s=Dr(e);s.r=r["!row"];var i=e.read_shift(1),a=[s,i,"e"];if(r.cellFormula){e.l+=2;var o=Hu(e,n-e.l,r);a[3]=la(o,null,s,r.supbooks,r)}else e.l=n;return a}function q6(e,t,r){var n=e.l+t,s=Dr(e);s.r=r["!row"];var i=_a(e),a=[s,i,"n"];if(r.cellFormula){e.l+=2;var o=Hu(e,n-e.l,r);a[3]=la(o,null,s,r.supbooks,r)}else e.l=n;return a}function K6(e,t,r){var n=e.l+t,s=Dr(e);s.r=r["!row"];var i=Ut(e),a=[s,i,"str"];if(r.cellFormula){e.l+=2;var o=Hu(e,n-e.l,r);a[3]=la(o,null,s,r.supbooks,r)}else e.l=n;return a}var X6=ci,Y6=wa;function J6(e,t){return t==null&&(t=te(4)),t.write_shift(4,e),t}function Q6(e,t){var r=e.l+t,n=ci(e),s=Ah(e),i=Ut(e),a=Ut(e),o=Ut(e);e.l=r;var c={rfx:n,relId:s,loc:i,display:o};return a&&(c.Tooltip=a),c}function Z6(e,t){var r=te(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));wa({s:yt(e[0]),e:yt(e[0])},r),Oh("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return wt(s||"",r),wt(e[1].Tooltip||"",r),wt("",r),r.slice(0,r.l)}function eO(){}function tO(e,t,r){var n=e.l+t,s=$y(e),i=e.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=H5(e,n-e.l,r);a[1]=o}else e.l=n;return a}function rO(e,t,r){var n=e.l+t,s=ci(e),i=[s];if(r.cellFormula){var a=V5(e,n-e.l,r);i[1]=a,e.l=n}else e.l=n;return i}function nO(e,t,r){r==null&&(r=te(18));var n=zu(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var Sw=["left","right","top","bottom","header","footer"];function sO(e){var t={};return Sw.forEach(function(r){t[r]=_a(e)}),t}function iO(e,t){return t==null&&(t=te(6*8)),_w(e),Sw.forEach(function(r){Zs(e[r],t)}),t}function aO(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function oO(e,t,r){r==null&&(r=te(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function lO(e){var t=te(24);return t.write_shift(4,4),t.write_shift(4,1),wa(e,t),t}function cO(e,t){return t==null&&(t=te(16*4+2)),t.write_shift(2,e.password?sw(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function uO(){}function dO(){}function fO(e,t,r,n,s,i,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=lr(t),t.z=t.z||at[14],t.v=or(Yt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=bs(s.cellXfs,t,s),t.l&&i["!links"].push([We(c),t.l]),t.c&&i["!comments"].push([We(c),t.c]),t.t){case"s":case"str":return s.bookSST?(o=Lh(s.Strings,t.v,s.revStrings),c.t="s",c.v=o,a?ie(e,18,O6(t,c)):ie(e,7,C6(t,c))):(c.t="str",a?ie(e,17,z6(t,c)):ie(e,6,W6(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?ie(e,13,B6(t,c)):ie(e,2,L6(t,c)):a?ie(e,16,R6(t,c)):ie(e,5,P6(t,c)),!0;case"b":return c.t="b",a?ie(e,15,S6(t,c)):ie(e,4,_6(t,c)),!0;case"e":return c.t="e",a?ie(e,14,N6(t,c)):ie(e,3,b6(t,c)),!0}return a?ie(e,12,y6(t,c)):ie(e,1,x6(t,c)),!0}function hO(e,t,r,n){var s=Xe(t["!ref"]||"A1"),i,a="",o=[];ie(e,145);var c=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=d;++u){a=Ft(u),u6(e,t,s,u);var f=!1;if(u<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(o[h]=$t(h)),i=o[h]+a;var p=c?(t[u]||[])[h]:t[i];if(!p){f=!1;continue}f=fO(e,p,u,h,n,t,f)}}ie(e,146)}function mO(e,t){!t||!t["!merges"]||(ie(e,177,J6(t["!merges"].length)),t["!merges"].forEach(function(r){ie(e,176,Y6(r))}),ie(e,178))}function pO(e,t){!t||!t["!cols"]||(ie(e,390),t["!cols"].forEach(function(r,n){r&&ie(e,60,nO(n,r))}),ie(e,391))}function gO(e,t){!t||!t["!ref"]||(ie(e,648),ie(e,649,lO(Xe(t["!ref"]))),ie(e,650))}function xO(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Be(r,-1,n[1].Target.replace(/#.*$/,""),Re.HLINK);ie(e,494,Z6(n,s))}}),delete t["!links"]}function vO(e,t,r,n){if(t["!comments"].length>0){var s=Be(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Re.VML);ie(e,551,Oh("rId"+s)),t["!legacy"]=s}}function yO(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:dt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=yr(i);o.s.r==o.e.r&&(o.e.r=yr(t["!ref"]).e.r,i=dt(o));for(var c=0;c<a.length;++c){var d=a[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ie(e,161,wa(Xe(i))),ie(e,162)}}function wO(e,t,r){ie(e,133),ie(e,137,oO(t,r)),ie(e,138),ie(e,134)}function _O(e,t){t["!protect"]&&ie(e,535,cO(t["!protect"]))}function EO(e,t,r,n){var s=ar(),i=r.SheetNames[e],a=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=Xe(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],ie(s,129),(r.vbaraw||a["!outline"])&&ie(s,147,p6(o,a["!outline"])),ie(s,148,f6(c)),wO(s,a,r.Workbook),pO(s,a),hO(s,a,e,t),_O(s,a),yO(s,a,r,e),mO(s,a),xO(s,a,n),a["!margins"]&&ie(s,476,iO(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&gO(s,a),vO(s,a,e,n),ie(s,130),s.end()}function SO(e,t){e.l+=10;var r=Ut(e);return{name:r}}var TO=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function bO(e){return!e.Workbook||!e.Workbook.WBProps?"false":rj(e.Workbook.WBProps.date1904)?"true":"false"}var kO="][*?/\\".split("");function Tw(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return kO.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function NO(e,t,r){e.forEach(function(n,s){Tw(n);for(var i=0;i<s;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[s]&&t[s].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function jO(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];NO(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Y5(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function bw(e){var t=[ft];t[t.length]=fe("workbook",null,{xmlns:va[0],"xmlns:r":vt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(TO.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=fe("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var a={name:$e(e.SheetNames[i].slice(0,31))};if(a.sheetId=""+(i+1),a["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=fe("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=fe("definedName",$e(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function CO(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=cf(e),r.name=Ut(e),r}function AO(e,t){return t||(t=te(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Oh(e.strRelID,t),wt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function OO(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Ut(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function FO(e,t){t||(t=te(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Ly(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function PO(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=bj(e),a=z5(e,0,r),o=Ah(e);e.l=n;var c={Name:i,Ptg:a};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function DO(e,t){ie(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ie(e,156,AO(s))}ie(e,144)}function RO(e,t){t||(t=te(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return wt("SheetJS",t),wt(Hc.version,t),wt(Hc.version,t),wt("7262",t),t.length>t.l?t.slice(0,t.l):t}function IO(e,t){t||(t=te(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function LO(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(ie(e,135),ie(e,158,IO(s)),ie(e,136))}}function MO(e,t){var r=ar();return ie(r,131),ie(r,128,RO()),ie(r,153,FO(e.Workbook&&e.Workbook.WBProps||null)),LO(r,e),DO(r,e),ie(r,132),r.end()}function BO(e,t,r){return(t.slice(-4)===".bin"?MO:bw)(e)}function $O(e,t,r,n,s){return(t.slice(-4)===".bin"?EO:Ew)(e,r,n,s)}function UO(e,t,r){return(t.slice(-4)===".bin"?iA:ow)(e,r)}function WO(e,t,r){return(t.slice(-4)===".bin"?FC:nw)(e,r)}function HO(e,t,r){return(t.slice(-4)===".bin"?_A:fw)(e)}function zO(e){return(e.slice(-4)===".bin"?hA:uw)()}function VO(e,t){var r=[];return e.Props&&r.push(Uj(e.Props,t)),e.Custprops&&r.push(Wj(e.Props,e.Custprops)),r.join("")}function GO(){return""}function qO(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var i=[];i.push(fe("NumberFormat",null,{"ss:Format":$e(at[n.numFmtId])}));var a={"ss:ID":"s"+(21+s)};r.push(fe("Style",i.join(""),a))}),fe("Styles",r.join(""))}function kw(e){return fe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Rh(e.Ref,{r:0,c:0})})}function KO(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(kw(s)))}return fe("Names",r.join(""))}function XO(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],a=0;a<s.length;++a){var o=s[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(kw(o)))}return i.join("")}function YO(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(fe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(fe("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(fe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(fe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(jt("ProtectContents","True")),e["!protect"].objects&&s.push(jt("ProtectObjects","True")),e["!protect"].scenarios&&s.push(jt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(jt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(jt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&s.push("<"+a[1]+"/>")})),s.length==0?"":fe("WorksheetOptions",s.join(""),{xmlns:fr.x})}function JO(e){return e.map(function(t){var r=tj(t.t||""),n=fe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return fe("Comment",n,{"ss:Author":t.a})}).join("")}function QO(e,t,r,n,s,i,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+$e(Rh(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var c=yt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=$e(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=$e(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=a.c||d[u].s.r!=a.r||(d[u].e.c>d[u].s.c&&(o["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(o["ss:MergeDown"]=d[u].e.r-d[u].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=nl[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||at[14]);break;case"s":f="String",h=ej(e.v||"");break}var p=bs(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=a.c+1;var x=e.v!=null?h:"",m=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(m+=JO(e.c)),fe("Cell",m,o)}function ZO(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=aw(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function eF(e,t,r,n){if(!e["!ref"])return"";var s=Xe(e["!ref"]),i=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,_){Ph(g);var y=!!g.width,v=zu(_,g),w={"ss:Index":_+1};y&&(w["ss:Width"]=Qc(v.width)),g.hidden&&(w["ss:Hidden"]="1"),o.push(fe("Column",null,w))});for(var c=Array.isArray(e),d=s.s.r;d<=s.e.r;++d){for(var u=[ZO(d,(e["!rows"]||[])[d])],f=s.s.c;f<=s.e.c;++f){var h=!1;for(a=0;a!=i.length;++a)if(!(i[a].s.c>f)&&!(i[a].s.r>d)&&!(i[a].e.c<f)&&!(i[a].e.r<d)){(i[a].s.c!=f||i[a].s.r!=d)&&(h=!0);break}if(!h){var p={r:d,c:f},x=We(p),m=c?(e[d]||[])[f]:e[x];u.push(QO(m,x,e,t,r,n,p))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function tF(e,t,r){var n=[],s=r.SheetNames[e],i=r.Sheets[s],a=i?XO(i,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=i?eF(i,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(YO(i,t,e,r)),n.join("")}function rF(e,t){t||(t={}),e.SSF||(e.SSF=lr(at)),e.SSF&&(Bu(),Mu(e.SSF),t.revssf=$u(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],bs(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(VO(e,t)),r.push(GO()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(fe("Worksheet",tF(n,t,e),{"ss:Name":$e(e.SheetNames[n])}));return r[2]=qO(e,t),r[3]=KO(e),ft+fe("Workbook",r.join(""),{xmlns:fr.ss,"xmlns:o":fr.o,"xmlns:x":fr.x,"xmlns:ss":fr.ss,"xmlns:dt":fr.dt,"xmlns:html":fr.html})}var Wd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function nF(e,t){var r=[],n=[],s=[],i=0,a,o=og(wg,"n"),c=og(_g,"n");if(e.Props)for(a=Dt(e.Props),i=0;i<a.length;++i)(Object.prototype.hasOwnProperty.call(o,a[i])?r:Object.prototype.hasOwnProperty.call(c,a[i])?n:s).push([a[i],e.Props[a[i]]]);if(e.Custprops)for(a=Dt(e.Custprops),i=0;i<a.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},a[i])||(Object.prototype.hasOwnProperty.call(o,a[i])?r:Object.prototype.hasOwnProperty.call(c,a[i])?n:s).push([a[i],e.Custprops[a[i]]]);var d=[];for(i=0;i<s.length;++i)Yy.indexOf(s[i][0])>-1||qy.indexOf(s[i][0])>-1||s[i][1]!=null&&d.push(s[i]);n.length&&He.utils.cfb_add(t,"/SummaryInformation",kg(n,Wd.SI,c,_g)),(r.length||d.length)&&He.utils.cfb_add(t,"/DocumentSummaryInformation",kg(r,Wd.DSI,o,wg,d.length?d:null,Wd.UDI))}function sF(e,t){var r=t||{},n=He.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return He.utils.cfb_add(n,s,Nw(e,r)),r.biff==8&&(e.Props||e.Custprops)&&nF(e,n),r.biff==8&&e.vbaraw&&EA(n,He.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var iF={0:{f:l6},1:{f:g6},2:{f:I6},3:{f:T6},4:{f:w6},5:{f:F6},6:{f:U6},7:{f:j6},8:{f:K6},9:{f:q6},10:{f:V6},11:{f:G6},12:{f:v6},13:{f:M6},14:{f:k6},15:{f:E6},16:{f:D6},17:{f:H6},18:{f:A6},19:{f:Ch},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:PO},40:{},42:{},43:{f:UC},44:{f:BC},45:{f:zC},46:{f:GC},47:{f:VC},48:{},49:{f:vj},50:{},51:{f:lA},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:yC},62:{f:$6},63:{f:mA},64:{f:uO},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:cn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:aO},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:m6},148:{f:d6,p:16},151:{f:eO},152:{},153:{f:OO},154:{},155:{},156:{f:CO},157:{},158:{},159:{T:1,f:CC},160:{T:-1},161:{T:1,f:ci},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:X6},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:aA},336:{T:-1},337:{f:dA,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:cf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:hC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:tO},427:{f:rO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:sO},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:h6},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Q6},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:cf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:yA},633:{T:1},634:{T:-1},635:{T:1,f:xA},636:{T:-1},637:{f:Ej},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:SO},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:dO},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function he(e,t,r,n){var s=t;if(!isNaN(s)){var i=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&kh(r)&&e.push(r)}}function aF(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return he(e,t,r,s);var i=t;if(!isNaN(i)){for(var a=r.parts||[],o=0,c=0,d=0;d+(a[o]||8224)<=8224;)d+=a[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<s;){for(u=e.next(4),u.write_shift(2,60),d=0;d+(a[o]||8224)<=8224;)d+=a[o]||8224,o++;u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function il(e,t,r){return e||(e=te(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function oF(e,t,r,n){var s=te(9);return il(s,e,t),Qy(r,n||"b",s),s}function lF(e,t,r){var n=te(8+2*r.length);return il(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function cF(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?or(Yt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?he(e,2,SC(r,n,s)):he(e,3,EC(r,n,s));return;case"b":case"e":he(e,5,oF(r,n,t.v,t.t));return;case"s":case"str":he(e,4,lF(r,n,(t.v||"").slice(0,255)));return}he(e,1,il(null,r,n))}function uF(e,t,r,n){var s=Array.isArray(t),i=Xe(t["!ref"]||"A1"),a,o="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),a=dt(i)}for(var d=i.s.r;d<=i.e.r;++d){o=Ft(d);for(var u=i.s.c;u<=i.e.c;++u){d===i.s.r&&(c[u]=$t(u)),a=c[u]+o;var f=s?(t[d]||[])[u]:t[a];f&&cF(e,f,d,u)}}}function dF(e,t){for(var r=t||{},n=ar(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return he(n,r.biff==4?1033:r.biff==3?521:9,Fh(e,16,r)),uF(n,e.Sheets[e.SheetNames[s]],s,r),he(n,10),n.end()}function fF(e,t,r){he(e,49,iC({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function hF(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&he(e,1054,lC(s,t[s],r))})}function mF(e,t){var r=te(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),he(e,2151,r),r=te(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),tw(Xe(t["!ref"]||"A1"),r),r.write_shift(4,4),he(e,2152,r)}function pF(e,t){for(var r=0;r<16;++r)he(e,224,jg({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){he(e,224,jg(n,0,t))})}function gF(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];he(e,440,gC(n)),n[1].Tooltip&&he(e,2048,xC(n))}delete t["!links"]}function xF(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&he(e,125,wC(zu(s,n),s))})}}function vF(e,t,r,n,s){var i=16+bs(s.cellXfs,t,s);if(t.v==null&&!t.bf){he(e,513,ei(r,n,i));return}if(t.bf)he(e,6,W5(t,r,n,s,i));else switch(t.t){case"d":case"n":var a=t.t=="d"?or(Yt(t.v)):t.v;he(e,515,fC(r,n,a,i));break;case"b":case"e":he(e,517,dC(r,n,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var o=Lh(s.Strings,t.v,s.revStrings);he(e,253,aC(r,n,o,i))}else he(e,516,oC(r,n,(t.v||"").slice(0,255),i,s));break;default:he(e,513,ei(r,n,i))}}function yF(e,t,r){var n=ar(),s=r.SheetNames[e],i=r.Sheets[s]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[e]||{},c=Array.isArray(i),d=t.biff==8,u,f="",h=[],p=Xe(i["!ref"]||"A1"),x=d?65536:16384;if(p.e.c>255||p.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,x-1)}he(n,2057,Fh(r,16,t)),he(n,13,Tr(1)),he(n,12,Tr(100)),he(n,15,qt(!0)),he(n,17,qt(!1)),he(n,16,Zs(.001)),he(n,95,qt(!0)),he(n,42,qt(!1)),he(n,43,qt(!1)),he(n,130,Tr(1)),he(n,128,uC()),he(n,131,qt(!1)),he(n,132,qt(!1)),d&&xF(n,i["!cols"]),he(n,512,cC(p,t)),d&&(i["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){f=Ft(m);for(var g=p.s.c;g<=p.e.c;++g){m===p.s.r&&(h[g]=$t(g)),u=h[g]+f;var _=c?(i[m]||[])[g]:i[u];_&&(vF(n,_,m,g,t),d&&_.l&&i["!links"].push([u,_.l]))}}var y=o.CodeName||o.name||s;return d&&he(n,574,sC((a.Views||[])[0])),d&&(i["!merges"]||[]).length&&he(n,229,pC(i["!merges"])),d&&gF(n,i),he(n,442,ew(y)),d&&mF(n,i),he(n,10),n.end()}function wF(e,t,r){var n=ar(),s=(e||{}).Workbook||{},i=s.Sheets||[],a=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(he(n,2057,Fh(e,5,r)),r.bookType=="xla"&&he(n,135),he(n,225,o?Tr(1200):null),he(n,193,Vj(2)),c&&he(n,191),c&&he(n,192),he(n,226),he(n,92,eC("SheetJS",r)),he(n,66,Tr(o?1200:1252)),o&&he(n,353,Tr(0)),o&&he(n,448),he(n,317,_C(e.SheetNames.length)),o&&e.vbaraw&&he(n,211),o&&e.vbaraw){var d=a.CodeName||"ThisWorkbook";he(n,442,ew(d))}he(n,156,Tr(17)),he(n,25,qt(!1)),he(n,18,qt(!1)),he(n,19,Tr(0)),o&&he(n,431,qt(!1)),o&&he(n,444,Tr(0)),he(n,61,nC()),he(n,64,qt(!1)),he(n,141,Tr(0)),he(n,34,qt(bO(e)=="true")),he(n,14,qt(!0)),o&&he(n,439,qt(!1)),he(n,218,Tr(0)),fF(n,e,r),hF(n,e.SSF,r),pF(n,r),o&&he(n,352,qt(!1));var u=n.end(),f=ar();o&&he(f,140,vC()),o&&r.Strings&&aF(f,252,rC(r.Strings)),he(f,10);var h=f.end(),p=ar(),x=0,m=0;for(m=0;m<e.SheetNames.length;++m)x+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var g=u.length+x+h.length;for(m=0;m<e.SheetNames.length;++m){var _=i[m]||{};he(p,133,tC({pos:g,hs:_.Hidden||0,dt:0,name:e.SheetNames[m]},r)),g+=t[m].length}var y=p.end();if(x!=y.length)throw new Error("BS8 "+x+" != "+y.length);var v=[];return u.length&&v.push(u),y.length&&v.push(y),h.length&&v.push(h),Nt(v)}function _F(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=lr(at)),e&&e.SSF&&(Bu(),Mu(e.SSF),r.revssf=$u(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Mh(r),r.cellXfs=[],bs(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=yF(s,r,e);return n.unshift(wF(e,n,r)),Nt(n)}function Nw(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=yr(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return _F(e,t);case 4:case 3:case 2:return dF(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function EF(e,t,r,n){for(var s=e["!merges"]||[],i=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,c=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>a)&&!(s[d].e.r<r||s[d].e.c<a)){if(s[d].s.r<r||s[d].s.c<a){o=-1;break}o=s[d].e.r-s[d].s.r+1,c=s[d].e.c-s[d].s.c+1;break}if(!(o<0)){var u=We({r,c:a}),f=n.dense?(e[r]||[])[a]:e[u],h=f&&f.v!=null&&(f.h||Z3(f.w||(On(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+u,i.push(fe("td",h,p))}}var x="<tr>";return x+i.join("")+"</tr>"}var SF='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',TF="</body></html>";function bF(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function jw(e,t){var r=t||{},n=r.header!=null?r.header:SF,s=r.footer!=null?r.footer:TF,i=[n],a=yr(e["!ref"]);r.dense=Array.isArray(e),i.push(bF(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(EF(e,a,o,r));return i.push("</table>"+s),i.join("")}function Cw(e,t,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?yt(n.origin):n.origin;s=a.r,i=a.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),d={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var u=yr(e["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),s==-1&&(d.e.r=s=u.e.r+1)}var f=[],h=0,p=e["!rows"]||(e["!rows"]=[]),x=0,m=0,g=0,_=0,y=0,v=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&m<c;++x){var w=o[x];if(Rg(w)){if(n.display)continue;p[m]={hidden:!0}}var N=w.children;for(g=_=0;g<N.length;++g){var E=N[g];if(!(n.display&&Rg(E))){var T=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):nj(E.innerHTML),M=E.getAttribute("data-z")||E.getAttribute("z");for(h=0;h<f.length;++h){var P=f[h];P.s.c==_+i&&P.s.r<m+s&&m+s<=P.e.r&&(_=P.e.c+1-i,h=-1)}v=+E.getAttribute("colspan")||1,((y=+E.getAttribute("rowspan")||1)>1||v>1)&&f.push({s:{r:m+s,c:_+i},e:{r:m+s+(y||1)-1,c:_+i+(v||1)-1}});var B={t:"s",v:T},W=E.getAttribute("data-t")||E.getAttribute("t")||"";T!=null&&(T.length==0?B.t=W||"z":n.raw||T.trim().length==0||W=="s"||(T==="TRUE"?B={t:"b",v:!0}:T==="FALSE"?B={t:"b",v:!1}:isNaN(En(T))?isNaN(Lo(T).getDate())||(B={t:"d",v:Yt(T)},n.cellDates||(B={t:"n",v:or(B.v)}),B.z=n.dateNF||at[14]):B={t:"n",v:En(T)})),B.z===void 0&&M!=null&&(B.z=M);var Y="",J=E.getElementsByTagName("A");if(J&&J.length)for(var Te=0;Te<J.length&&!(J[Te].hasAttribute("href")&&(Y=J[Te].getAttribute("href"),Y.charAt(0)!="#"));++Te);Y&&Y.charAt(0)!="#"&&(B.l={Target:Y}),n.dense?(e[m+s]||(e[m+s]=[]),e[m+s][_+i]=B):e[We({c:_+i,r:m+s})]=B,d.e.c<_+i&&(d.e.c=_+i),_+=v}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),d.e.r=Math.max(d.e.r,m-1+s),e["!ref"]=dt(d),m>=c&&(e["!fullref"]=dt((d.e.r=o.length-x+m-1+s,d))),e}function Aw(e,t){var r=t||{},n=r.dense?[]:{};return Cw(n,e,t)}function kF(e,t){return ii(Aw(e,t),t)}function Rg(e){var t="",r=NF(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function NF(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var jF=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Bo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ft+t}}(),Ig=function(){var e=function(i){return $e(i).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,a,o){var c=[];c.push('      <table:table table:name="'+$e(a.SheetNames[o])+`" table:style-name="ta1">
`);var d=0,u=0,f=yr(i["!ref"]||"A1"),h=i["!merges"]||[],p=0,x=Array.isArray(i);if(i["!cols"])for(u=0;u<=f.e.c;++u)c.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var m="",g=i["!rows"]||[];for(d=0;d<f.s.r;++d)m=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+m+`></table:table-row>
`);for(;d<=f.e.r;++d){for(m=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+m+`>
`),u=0;u<f.s.c;++u)c.push(t);for(;u<=f.e.c;++u){var _=!1,y={},v="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>u)&&!(h[p].s.r>d)&&!(h[p].e.c<u)&&!(h[p].e.r<d)){(h[p].s.c!=u||h[p].s.r!=d)&&(_=!0),y["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,y["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(_){c.push(r);continue}var w=We({r:d,c:u}),N=x?(i[d]||[])[u]:i[w];if(N&&N.f&&(y["table:formula"]=$e(K5(N.f)),N.F&&N.F.slice(0,w.length)==w)){var E=yr(N.F);y["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,y["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!N){c.push(t);continue}switch(N.t){case"b":v=N.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=N.v?"true":"false";break;case"n":v=N.w||String(N.v||0),y["office:value-type"]="float",y["office:value"]=N.v||0;break;case"s":case"str":v=N.v==null?"":N.v,y["office:value-type"]="string";break;case"d":v=N.w||Yt(N.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Yt(N.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(t);continue}var T=e(v);if(N.l&&N.l.Target){var M=N.l.Target;M=M.charAt(0)=="#"?"#"+X5(M.slice(1)):M,M.charAt(0)!="#"&&!M.match(/^\w+:/)&&(M="../"+M),T=fe("text:a",T,{"xlink:href":M.replace(/&/g,"&amp;")})}c.push("          "+fe("table:table-cell",fe("text:p",T,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(i,a){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(d){return a.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var u=0;u<d["!cols"].length;++u)if(d["!cols"][u]){var f=d["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Ph(f),f.ods=o;var h=d["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(d){return a.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var u=0;u<d["!rows"].length;++u)if(d["!rows"][u]){d["!rows"][u].ods=c;var f=d["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(a,o){var c=[ft],d=Bo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Bo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+d+u+`>
`),c.push(Vy().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),s(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)c.push(n(a.Sheets[a.SheetNames[f]],a,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function Ow(e,t){if(t.bookType=="fods")return Ig(e,t);var r=Eh(),n="",s=[],i=[];return n="mimetype",je(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",je(r,n,Ig(e,t)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",je(r,n,jF(e,t)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",je(r,n,ft+Vy()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",je(r,n,$j(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",je(r,n,Mj(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function tu(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function CF(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Hr(Mo(e))}function AF(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function vs(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function OF(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function $o(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Le(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Xi(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ht(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=$o(e,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=$o(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var d={data:o,type:i};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function St(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Le(n*8+s.type)),s.type==2&&t.push(Le(s.data.length)),t.push(s.data))})}),vs(t)}function Ir(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=$o(e,n),i=ht(e.slice(n[0],n[0]+s));n[0]+=s;var a={id:Xi(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=ht(o.data),d=Xi(c[3][0].data);a.messages.push({meta:c,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=i[3])!=null&&t[0]&&(a.merge=Xi(i[3][0].data)>>>0>0),r.push(a)}return r}function wi(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Le(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Le(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(a){s.push(a.data),a.meta[3]=[{type:0,data:Le(a.data.length)}],n[2].push({data:St(a.meta),type:2})});var i=St(n);t.push(Le(i.length)),t.push(i),s.forEach(function(a){return t.push(a)})}),vs(t)}function FF(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=$o(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[vs(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(s.push(s[0].slice(-c)),d-=c;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-c,-c+d))}}var u=vs(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Lr(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(FF(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return vs(t)}function _i(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=Le(n),a=i.length;t.push(i),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,s[0]=0,s[1]=a&255,s[2]=a>>8&255,s[3]=a>>16&255,r+=n}return vs(t)}function Hd(e,t){var r=new Uint8Array(32),n=tu(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,OF(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,s)}function zd(e,t){var r=new Uint8Array(32),n=tu(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,s)}function Bn(e){var t=ht(e);return $o(t[1][0].data)}function PF(e,t,r){var n,s,i,a;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(i=e[8])==null?void 0:i[0])==null?void 0:a.data)&&Xi(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,d=tu(e[7][0].data),u=0,f=[],h=tu(e[4][0].data),p=0,x=[],m=0;m<t.length;++m){if(t[m]==null){d.setUint16(m*2,65535,!0),h.setUint16(m*2,65535);continue}d.setUint16(m*2,u,!0),h.setUint16(m*2,p,!0);var g,_;switch(typeof t[m]){case"string":g=Hd({t:"s",v:t[m]},r),_=zd({t:"s",v:t[m]},r);break;case"number":g=Hd({t:"n",v:t[m]},r),_=zd({t:"n",v:t[m]},r);break;case"boolean":g=Hd({t:"b",v:t[m]},r),_=zd({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}f.push(g),u+=g.length,x.push(_),p+=_.length,++c}for(e[2][0].data=Le(c);m<e[7][0].data.length/2;++m)d.setUint16(m*2,65535,!0),h.setUint16(m*2,65535,!0);return e[6][0].data=vs(f),e[3][0].data=vs(x),c}function DF(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=yr(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(dt(n)));var i=ru(r,{range:n,header:1}),a=["~Sh33tJ5~"];i.forEach(function(F){return F.forEach(function(C){typeof C=="string"&&a.push(C)})});var o={},c=[],d=He.read(t.numbers,{type:"base64"});d.FileIndex.map(function(F,C){return[F,d.FullPaths[C]]}).forEach(function(F){var C=F[0],L=F[1];if(C.type==2&&C.name.match(/\.iwa/)){var H=C.content,Q=Lr(H),ne=Ir(Q);ne.forEach(function(ae){c.push(ae.id),o[ae.id]={deps:[],location:L,type:Xi(ae.messages[0].meta[1][0].data)}})}}),c.sort(function(F,C){return F-C});var u=c.filter(function(F){return F>1}).map(function(F){return[F,Le(F)]});d.FileIndex.map(function(F,C){return[F,d.FullPaths[C]]}).forEach(function(F){var C=F[0];if(F[1],!!C.name.match(/\.iwa/)){var L=Ir(Lr(C.content));L.forEach(function(H){H.messages.forEach(function(Q){u.forEach(function(ne){H.messages.some(function(ae){return Xi(ae.meta[1][0].data)!=11006&&AF(ae.data,ne[1])})&&o[ne[0]].deps.push(H.id)})})})}});for(var f=He.find(d,o[1].location),h=Ir(Lr(f.content)),p,x=0;x<h.length;++x){var m=h[x];m.id==1&&(p=m)}var g=Bn(ht(p.messages[0].data)[1][0].data);for(f=He.find(d,o[g].location),h=Ir(Lr(f.content)),x=0;x<h.length;++x)m=h[x],m.id==g&&(p=m);for(g=Bn(ht(p.messages[0].data)[2][0].data),f=He.find(d,o[g].location),h=Ir(Lr(f.content)),x=0;x<h.length;++x)m=h[x],m.id==g&&(p=m);for(g=Bn(ht(p.messages[0].data)[2][0].data),f=He.find(d,o[g].location),h=Ir(Lr(f.content)),x=0;x<h.length;++x)m=h[x],m.id==g&&(p=m);var _=ht(p.messages[0].data);{_[6][0].data=Le(n.e.r+1),_[7][0].data=Le(n.e.c+1);var y=Bn(_[46][0].data),v=He.find(d,o[y].location),w=Ir(Lr(v.content));{for(var N=0;N<w.length&&w[N].id!=y;++N);if(w[N].id!=y)throw"Bad ColumnRowUIDMapArchive";var E=ht(w[N].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var T=0;T<=n.e.c;++T){var M=[];M[1]=M[2]=[{type:0,data:Le(T+420690)}],E[1].push({type:2,data:St(M)}),E[2].push({type:0,data:Le(T)}),E[3].push({type:0,data:Le(T)})}E[4]=[],E[5]=[],E[6]=[];for(var P=0;P<=n.e.r;++P)M=[],M[1]=M[2]=[{type:0,data:Le(P+726270)}],E[4].push({type:2,data:St(M)}),E[5].push({type:0,data:Le(P)}),E[6].push({type:0,data:Le(P)});w[N].messages[0].data=St(E)}v.content=_i(wi(w)),v.size=v.content.length,delete _[46];var B=ht(_[4][0].data);{B[7][0].data=Le(n.e.r+1);var W=ht(B[1][0].data),Y=Bn(W[2][0].data);v=He.find(d,o[Y].location),w=Ir(Lr(v.content));{if(w[0].id!=Y)throw"Bad HeaderStorageBucket";var J=ht(w[0].messages[0].data);for(P=0;P<i.length;++P){var Te=ht(J[2][0].data);Te[1][0].data=Le(P),Te[4][0].data=Le(i[P].length),J[2][P]={type:J[2][0].type,data:St(Te)}}w[0].messages[0].data=St(J)}v.content=_i(wi(w)),v.size=v.content.length;var ye=Bn(B[2][0].data);v=He.find(d,o[ye].location),w=Ir(Lr(v.content));{if(w[0].id!=ye)throw"Bad HeaderStorageBucket";for(J=ht(w[0].messages[0].data),T=0;T<=n.e.c;++T)Te=ht(J[2][0].data),Te[1][0].data=Le(T),Te[4][0].data=Le(n.e.r+1),J[2][T]={type:J[2][0].type,data:St(Te)};w[0].messages[0].data=St(J)}v.content=_i(wi(w)),v.size=v.content.length;var se=Bn(B[4][0].data);(function(){for(var F=He.find(d,o[se].location),C=Ir(Lr(F.content)),L,H=0;H<C.length;++H){var Q=C[H];Q.id==se&&(L=Q)}var ne=ht(L.messages[0].data);{ne[3]=[];var ae=[];a.forEach(function(oe,xe){ae[1]=[{type:0,data:Le(xe)}],ae[2]=[{type:0,data:Le(1)}],ae[3]=[{type:2,data:CF(oe)}],ne[3].push({type:2,data:St(ae)})})}L.messages[0].data=St(ne);var A=wi(C),ee=_i(A);F.content=ee,F.size=F.content.length})();var le=ht(B[3][0].data);{var z=le[1][0];delete le[2];var U=ht(z.data);{var Z=Bn(U[2][0].data);(function(){for(var F=He.find(d,o[Z].location),C=Ir(Lr(F.content)),L,H=0;H<C.length;++H){var Q=C[H];Q.id==Z&&(L=Q)}var ne=ht(L.messages[0].data);{delete ne[6],delete le[7];var ae=new Uint8Array(ne[5][0].data);ne[5]=[];for(var A=0,ee=0;ee<=n.e.r;++ee){var oe=ht(ae);A+=PF(oe,i[ee],a),oe[1][0].data=Le(ee),ne[5].push({data:St(oe),type:2})}ne[1]=[{type:0,data:Le(n.e.c+1)}],ne[2]=[{type:0,data:Le(n.e.r+1)}],ne[3]=[{type:0,data:Le(A)}],ne[4]=[{type:0,data:Le(n.e.r+1)}]}L.messages[0].data=St(ne);var xe=wi(C),_e=_i(xe);F.content=_e,F.size=F.content.length})()}z.data=St(U)}B[3][0].data=St(le)}_[4][0].data=St(B)}p.messages[0].data=St(_);var G=wi(h),k=_i(G);return f.content=k,f.size=f.content.length,d}function RF(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Mh(e){RF([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function IF(e,t){return t.bookType=="ods"?Ow(e,t):t.bookType=="numbers"?DF(e,t):t.bookType=="xlsb"?LF(e,t):MF(e,t)}function LF(e,t){Ii=1024,e&&!e.SSF&&(e.SSF=lr(at)),e&&e.SSF&&(Bu(),Mu(e.SSF),t.revssf=$u(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ho?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=hw.indexOf(t.bookType)>-1,s=Wy();Mh(t=t||{});var i=Eh(),a="",o=0;if(t.cellXfs=[],bs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",je(i,a,Gy(e.Props,t)),s.coreprops.push(a),Be(t.rels,2,a,Re.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,je(i,a,Ky(e.Props)),s.extprops.push(a),Be(t.rels,3,a,Re.EXT_PROPS),e.Custprops!==e.Props&&Dt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",je(i,a,Xy(e.Custprops)),s.custprops.push(a),Be(t.rels,4,a,Re.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,je(i,a,$O(o-1,a,t,e,u)),s.sheets.push(a),Be(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Re.WS[0])}if(f){var p=f["!comments"],x=!1,m="";p&&p.length>0&&(m="xl/comments"+o+"."+r,je(i,m,HO(p,m)),s.comments.push(m),Be(u,-1,"../comments"+o+"."+r,Re.CMNT),x=!0),f["!legacy"]&&x&&je(i,"xl/drawings/vmlDrawing"+o+".vml",dw(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&je(i,zy(a),qi(u))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,je(i,a,WO(t.Strings,a,t)),s.strs.push(a),Be(t.wbrels,-1,"sharedStrings."+r,Re.SST)),a="xl/workbook."+r,je(i,a,BO(e,a)),s.workbooks.push(a),Be(t.rels,1,a,Re.WB),a="xl/theme/theme1.xml",je(i,a,cw(e.Themes,t)),s.themes.push(a),Be(t.wbrels,-1,"theme/theme1.xml",Re.THEME),a="xl/styles."+r,je(i,a,UO(e,a,t)),s.styles.push(a),Be(t.wbrels,-1,"styles."+r,Re.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",je(i,a,e.vbaraw),s.vba.push(a),Be(t.wbrels,-1,"vbaProject.bin",Re.VBA)),a="xl/metadata."+r,je(i,a,zO(a)),s.metadata.push(a),Be(t.wbrels,-1,"metadata."+r,Re.XLMETA),je(i,"[Content_Types].xml",Hy(s,t)),je(i,"_rels/.rels",qi(t.rels)),je(i,"xl/_rels/workbook."+r+".rels",qi(t.wbrels)),delete t.revssf,delete t.ssf,i}function MF(e,t){Ii=1024,e&&!e.SSF&&(e.SSF=lr(at)),e&&e.SSF&&(Bu(),Mu(e.SSF),t.revssf=$u(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ho?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=hw.indexOf(t.bookType)>-1,s=Wy();Mh(t=t||{});var i=Eh(),a="",o=0;if(t.cellXfs=[],bs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",je(i,a,Gy(e.Props,t)),s.coreprops.push(a),Be(t.rels,2,a,Re.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,je(i,a,Ky(e.Props)),s.extprops.push(a),Be(t.rels,3,a,Re.EXT_PROPS),e.Custprops!==e.Props&&Dt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",je(i,a,Xy(e.Custprops)),s.custprops.push(a),Be(t.rels,4,a,Re.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,je(i,a,Ew(o-1,t,e,f)),s.sheets.push(a),Be(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Re.WS[0])}if(h){var x=h["!comments"],m=!1,g="";if(x&&x.length>0){var _=!1;x.forEach(function(y){y[1].forEach(function(v){v.T==!0&&(_=!0)})}),_&&(g="xl/threadedComments/threadedComment"+o+"."+r,je(i,g,pA(x,u,t)),s.threadedcomments.push(g),Be(f,-1,"../threadedComments/threadedComment"+o+"."+r,Re.TCMNT)),g="xl/comments"+o+"."+r,je(i,g,fw(x)),s.comments.push(g),Be(f,-1,"../comments"+o+"."+r,Re.CMNT),m=!0}h["!legacy"]&&m&&je(i,"xl/drawings/vmlDrawing"+o+".vml",dw(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&je(i,zy(a),qi(f))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,je(i,a,nw(t.Strings,t)),s.strs.push(a),Be(t.wbrels,-1,"sharedStrings."+r,Re.SST)),a="xl/workbook."+r,je(i,a,bw(e)),s.workbooks.push(a),Be(t.rels,1,a,Re.WB),a="xl/theme/theme1.xml",je(i,a,cw(e.Themes,t)),s.themes.push(a),Be(t.wbrels,-1,"theme/theme1.xml",Re.THEME),a="xl/styles."+r,je(i,a,ow(e,t)),s.styles.push(a),Be(t.wbrels,-1,"styles."+r,Re.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",je(i,a,e.vbaraw),s.vba.push(a),Be(t.wbrels,-1,"vbaProject.bin",Re.VBA)),a="xl/metadata."+r,je(i,a,uw()),s.metadata.push(a),Be(t.wbrels,-1,"metadata."+r,Re.XLMETA),u.length>1&&(a="xl/persons/person.xml",je(i,a,gA(u)),s.people.push(a),Be(t.wbrels,-1,"persons/person.xml",Re.PEOPLE)),je(i,"[Content_Types].xml",Hy(s,t)),je(i,"_rels/.rels",qi(t.rels)),je(i,"xl/_rels/workbook."+r+".rels",qi(t.wbrels)),delete t.revssf,delete t.ssf,i}function BF(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=An(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Fw(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return tl(t.file,He.write(e,{type:Ie?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return He.write(e,t)}function $F(e,t){var r=lr(t||{}),n=IF(e,r);return UF(n,r)}function UF(e,t){var r={},n=Ie?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?He.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Lu(s))}return t.password&&typeof encrypt_agile<"u"?Fw(encrypt_agile(s,t.password),t):t.type==="file"?tl(t.file,s):t.type=="string"?lo(s):s}function WF(e,t){var r=t||{},n=sF(e,r);return Fw(n,r)}function en(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Io(Mo(n));case"binary":return Mo(n);case"string":return e;case"file":return tl(t.file,n,"utf8");case"buffer":return Ie?In(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):en(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function HF(e,t){switch(t.type){case"base64":return Io(e);case"binary":return e;case"string":return e;case"file":return tl(t.file,e,"binary");case"buffer":return Ie?In(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function $l(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Io(r):t.type=="string"?lo(r):r;case"file":return tl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Pw(e,t){x3(),jO(e);var r=lr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Pw(e,r);return r.type="array",Lu(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return en(rF(e,r),r);case"slk":case"sylk":return en(bC.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return en(jw(e.Sheets[e.SheetNames[s]],r),r);case"txt":return HF(Dw(e.Sheets[e.SheetNames[s]],r),r);case"csv":return en(Bh(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return en(kC.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return $l(TC.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return en(NC.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return en(DC.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return en(rw.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return en(Ow(e,r),r);case"wk1":return $l(Cg.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return $l(Cg.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),$l(Nw(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),WF(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return $F(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function zF(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function VF(e,t,r){var n={};return n.type="file",n.file=t,zF(n),Pw(e,n)}function GF(e,t,r,n,s,i,a,o){var c=Ft(r),d=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!a||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=a?e[r][p]:e[n[p]+c];if(x===void 0||x.t===void 0){if(d===void 0)continue;i[p]!=null&&(h[i[p]]=d);continue}var m=x.v;switch(x.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[p]!=null){if(m==null)if(x.t=="e"&&m===null)h[i[p]]=null;else if(d!==void 0)h[i[p]]=d;else if(u&&m===null)h[i[p]]=null;else continue;else h[i[p]]=u&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?m:On(x,m,o);m!=null&&(f=!1)}}return{row:h,isempty:f}}function ru(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof u){case"string":c=Xe(u);break;case"number":c=Xe(e["!ref"]),c.s.r=u;break;default:c=u}n>0&&(s=0);var f=Ft(c.s.r),h=[],p=[],x=0,m=0,g=Array.isArray(e),_=c.s.r,y=0,v={};g&&!e[_]&&(e[_]=[]);var w=d.skipHidden&&e["!cols"]||[],N=d.skipHidden&&e["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(w[y]||{}).hidden)switch(h[y]=$t(y),r=g?e[_][y]:e[h[y]+f],n){case 1:i[y]=y-c.s.c;break;case 2:i[y]=h[y];break;case 3:i[y]=d.header[y-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=On(r,null,d),m=v[a]||0,!m)v[a]=1;else{do o=a+"_"+m++;while(v[o]);v[a]=m,v[o]=1}i[y]=o}for(_=c.s.r+s;_<=c.e.r;++_)if(!(N[_]||{}).hidden){var E=GF(e,c,_,h,n,i,g,d);(E.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(p[x++]=E.row)}return p.length=x,p}var Lg=/"/g;function qF(e,t,r,n,s,i,a,o){for(var c=!0,d=[],u="",f=Ft(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=o.dense?(e[r]||[])[h]:e[n[h]+f];if(p==null)u="";else if(p.v!=null){c=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:On(p,null,o));for(var x=0,m=0;x!==u.length;++x)if((m=u.charCodeAt(x))===s||m===i||m===34||o.forceQuotes){u='"'+u.replace(Lg,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(c=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(Lg,'""')+'"')):u="";d.push(u)}return o.blankrows===!1&&c?null:d.join(a)}function Bh(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=Xe(e["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(h[x]||{}).hidden||(f[x]=$t(x));for(var m=0,g=s.s.r;g<=s.e.r;++g)(p[g]||{}).hidden||(u=qF(e,s,g,f,a,c,i,n),u!=null&&(n.strip&&(u=u.replace(d,"")),(u||n.blankrows!==!1)&&r.push((m++?o:"")+u)));return delete n.dense,r.join("")}function Dw(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Bh(e,t);return r}function KF(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=Xe(e["!ref"]),i="",a=[],o,c=[],d=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)a[o]=$t(o);for(var u=s.s.r;u<=s.e.r;++u)for(i=Ft(u),o=s.s.c;o<=s.e.c;++o)if(t=a[o]+i,r=d?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function Rw(e,t,r){var n=r||{},s=+!n.skipHeader,i=e||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?yt(n.origin):n.origin;a=c.r,o=c.c}var d,u={s:{c:0,r:0},e:{c:o,r:a+t.length-1+s}};if(i["!ref"]){var f=Xe(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(a=f.e.r+1,u.e.r=a+t.length-1+s)}else a==-1&&(a=0,u.e.r=t.length-1+s);var h=n.header||[],p=0;t.forEach(function(m,g){Dt(m).forEach(function(_){(p=h.indexOf(_))==-1&&(h[p=h.length]=_);var y=m[_],v="z",w="",N=We({c:o+p,r:a+g+s});d=Uo(i,N),y&&typeof y=="object"&&!(y instanceof Date)?i[N]=y:(typeof y=="number"?v="n":typeof y=="boolean"?v="b":typeof y=="string"?v="s":y instanceof Date?(v="d",n.cellDates||(v="n",y=or(y)),w=n.dateNF||at[14]):y===null&&n.nullError&&(v="e",y=0),d?(d.t=v,d.v=y,delete d.w,delete d.R,w&&(d.z=w)):i[N]=d={t:v,v:y},w&&(d.z=w))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var x=Ft(a);if(s)for(p=0;p<h.length;++p)i[$t(p+o)+x]={t:"s",v:h[p]};return i["!ref"]=dt(u),i}function XF(e,t){return Rw(null,e,t)}function Uo(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=yt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Uo(e,We(t)):Uo(e,We({r:t,c:r||0}))}function YF(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function JF(){return{SheetNames:[],Sheets:{}}}function QF(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=a+s)!=-1;++s);}if(Tw(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function ZF(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=YF(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function eP(e,t){return e.z=t,e}function Iw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function tP(e,t,r){return Iw(e,"#"+t,r)}function rP(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function nP(e,t,r,n){for(var s=typeof t!="string"?t:Xe(t),i=typeof t=="string"?t:dt(t),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var c=Uo(e,a,o);c.t="n",c.F=i,delete c.v,a==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Vd={encode_col:$t,encode_row:Ft,encode_cell:We,encode_range:dt,decode_col:jh,decode_row:Nh,split_cell:xj,decode_cell:yt,decode_range:yr,format_cell:On,sheet_add_aoa:Iy,sheet_add_json:Rw,sheet_add_dom:Cw,aoa_to_sheet:ya,json_to_sheet:XF,table_to_sheet:Aw,table_to_book:kF,sheet_to_csv:Bh,sheet_to_txt:Dw,sheet_to_json:ru,sheet_to_html:jw,sheet_to_formulae:KF,sheet_to_row_object_array:ru,sheet_get_cell:Uo,book_new:JF,book_append_sheet:QF,book_set_sheet_visibility:ZF,cell_set_number_format:eP,cell_set_hyperlink:Iw,cell_set_internal_link:tP,cell_add_comment:rP,sheet_set_array_formula:nP,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function sP(){const{currentDate:e,view:t,setView:r,goToNextPeriod:n,goToPreviousPeriod:s,goToToday:i,getSchedulesForEquipment:a,addSchedule:o,refreshSchedules:c}=Jo(),[d,u]=b.useState(!1),[f,h]=b.useState(null),[p,x]=b.useState(null),[m,g]=b.useState([]),[_,y]=b.useState(!1),[v,w]=b.useState(null),[N,E]=b.useState(null);b.useEffect(()=>{T()},[]);const T=async()=>{try{const{data:G,error:k}=await me.from("sample_equipment").select("*").order("name");k?(console.error("Error fetching sample equipment:",k),g(Ic)):g(G||[])}catch(G){console.error("Error fetching sample equipment:",G),g(Ic)}},P=(()=>{switch(t){case"day":return[e];case"week":const G=Ot(e,{weekStartsOn:1});return Array.from({length:7},(H,Q)=>Bt(G,Q));case"month":const k=ku(e),F=Tu(e),C=Ot(k,{weekStartsOn:1}),L=Bt(Ot(Bt(F,6),{weekStartsOn:1}),6);return bu({start:C,end:L});default:return[]}})(),[B,W]=b.useState([]);b.useEffect(()=>{Y()},[e,t]);const Y=async()=>{try{if(P.length===0)return;const G=be(P[0],"yyyy-MM-dd"),k=be(P[P.length-1],"yyyy-MM-dd"),{data:F,error:C}=await me.from("schedules").select("*").gte("start_time",`${G}T00:00:00.000Z`).lte("start_time",`${k}T23:59:59.999Z`).order("start_time");C?console.error("Error fetching sample schedules:",C):W(F||[])}catch(G){console.error("Error fetching sample schedules:",G)}},J=(G,k)=>B.filter(F=>{var L;return new Date(F.start_time).toDateString()===k.toDateString()&&((L=F.equipment)==null?void 0:L.some(H=>H.id===G&&H.type==="sample"))}).map(F=>({...F,startTime:new Date(F.start_time),endTime:new Date(F.end_time)})),Te=(G,k)=>{h({id:G.id,type:"sample"}),x(k),u(!0)},ye=async G=>{var k,F;try{const{error:C}=await me.from("schedules").insert([{type:G.type,title:G.title,details:G.details,start_time:(k=G.startTime)==null?void 0:k.toISOString(),end_time:(F=G.endTime)==null?void 0:F.toISOString(),is_all_day:G.isAllDay,participants:G.participants,equipment:G.equipment,reminders:G.reminders,meet_link:G.meetLink,meeting_type:G.meetingType,created_by:G.createdBy,quantity:G.quantity,assigned_to:G.assignedTo,notes:G.notes}]);if(C)throw C;await c(),await Y()}catch(C){console.error("Error saving sample reservation:",C),alert("")}},se=({isOpen:G,onClose:k})=>{const[F,C]=b.useState([]),[L,H]=b.useState(!1);b.useEffect(()=>{G&&v&&N&&Q()},[G,v,N]);const Q=async()=>{if(!(!v||!N)){H(!0);try{const A=be(v,"yyyy-MM-dd"),{data:ee,error:oe}=await me.from("schedules").select("*").gte("start_time",`${A}T00:00:00.000Z`).lte("start_time",`${A}T23:59:59.999Z`).order("start_time");if(oe)throw oe;const xe=(ee||[]).filter(_e=>{var Ce;return(Ce=_e.equipment)==null?void 0:Ce.some(Oe=>Oe.id===N&&Oe.type==="sample")});C(xe.map((_e,Ce)=>({..._e,order:Ce+1})))}catch(A){console.error("Error loading orders:",A)}finally{H(!1)}}},ne=(A,ee)=>{const oe=[...F],xe=ee==="up"?A-1:A+1;xe<0||xe>=oe.length||([oe[A],oe[xe]]=[oe[xe],oe[A]],oe[A].order=A+1,oe[xe].order=xe+1,C(oe))},ae=async()=>{try{H(!0);const A=F.map((ee,oe)=>me.from("schedules").update({order:oe+1}).eq("id",ee.id));await Promise.all(A),alert(""),k()}catch(A){console.error("Error saving order:",A),alert("")}finally{H(!1)}};return G?l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full max-h-[80vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),l.jsx("button",{onClick:k,className:"text-gray-400 hover:text-gray-500",children:l.jsx(Rn,{className:"h-6 w-6"})})]}),L?l.jsx("div",{className:"text-center py-4",children:"..."}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"space-y-2 mb-4",children:F.map((A,ee)=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"font-medium",children:[A.order,". ",A.title]}),l.jsx("div",{className:"text-sm text-gray-500",children:A.details})]}),l.jsxs("div",{className:"flex flex-col space-y-1",children:[l.jsx("button",{onClick:()=>ne(ee,"up"),disabled:ee===0,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30 disabled:cursor-not-allowed",children:l.jsx(gN,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>ne(ee,"down"),disabled:ee===F.length-1,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30 disabled:cursor-not-allowed",children:l.jsx(pN,{className:"h-4 w-4"})})]})]},A.id))}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx("button",{onClick:k,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:""}),l.jsx("button",{onClick:ae,disabled:L,className:"px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 disabled:opacity-50",children:""})]})]})]})}):null},le=()=>{try{const G=[];P.forEach(H=>{m.forEach(Q=>{J(Q.id,H).forEach((ae,A)=>{G.push({:be(H,"yyyy/MM/dd",{locale:jr}),:be(H,"EEEE",{locale:jr}),:Q.name,:Q.type,:A+1,:ae.title,:ae.details,:be(ae.startTime,"HH:mm"),:be(ae.endTime,"HH:mm"),:ae.quantity||"",:ae.assigned_to||"",:ae.notes||""})})})});const k=Vd.book_new(),F=Vd.json_to_sheet(G),C=[{wch:12},{wch:8},{wch:15},{wch:15},{wch:6},{wch:20},{wch:25},{wch:8},{wch:8},{wch:6},{wch:10},{wch:15}];F["!cols"]=C,Vd.book_append_sheet(k,F,"");const L=`_${be(new Date,"yyyyMMdd")}.xlsx`;VF(k,L)}catch(G){console.error("Error exporting to Excel:",G),alert("Excel")}},z=()=>t==="month"?Z():U(),U=()=>l.jsx("div",{className:"overflow-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-48",children:""}),P.map((G,k)=>l.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("span",{children:be(G,t==="day"?"yyyyMd EEEE":"EEEE",{locale:jr})}),t!=="day"&&l.jsx("span",{className:`mt-1 text-sm ${ps(G)?"bg-blue-100 text-blue-800 rounded-full w-7 h-7 flex items-center justify-center":""}`,children:be(G,"d")})]})},k))]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(G=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-purple-100 flex items-center justify-center",children:l.jsx(sa,{className:"h-6 w-6 text-purple-600"})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:G.name}),l.jsx("div",{className:"text-xs text-gray-500",children:G.type})]})]})}),P.map((k,F)=>{const C=J(G.id,k);return l.jsxs("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-500 relative group border border-gray-100",children:[l.jsx("button",{onClick:()=>Te(G,k),className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200 bg-purple-100 rounded-full p-1",children:l.jsx(Cn,{className:"h-4 w-4 text-purple-600"})}),C.length>0&&l.jsx("button",{onClick:()=>{w(k),E(G.id),y(!0)},className:"absolute top-1 left-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200 bg-yellow-100 rounded-full p-1",title:"",children:l.jsx(mN,{className:"h-4 w-4 text-yellow-600"})}),l.jsx("div",{className:t==="day"?"min-h-[120px]":"min-h-[80px]",children:C.map((L,H)=>l.jsxs("div",{className:"mb-1 px-2 py-1 rounded text-xs bg-purple-100 text-purple-800 border-l-4 border-purple-500 cursor-pointer hover:bg-purple-200",onClick:()=>{},children:[l.jsxs("div",{className:"font-medium flex items-center justify-between",children:[l.jsxs("span",{children:[H+1,". ",be(L.startTime,"HH:mm"),"-",be(L.endTime,"HH:mm")]}),L.quantity&&l.jsxs("span",{className:"bg-purple-200 text-purple-800 px-1 rounded text-xs",children:[L.quantity,""]})]}),l.jsx("div",{className:"truncate",children:L.title}),l.jsx("div",{className:"text-xs text-purple-600",children:L.details})]},L.id))})]},F)})]},G.id))})]})}),Z=()=>{const G=[];for(let k=0;k<P.length;k+=7)G.push(P.slice(k,k+7));return l.jsxs("div",{className:"overflow-auto",children:[l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200 bg-gray-50",children:["","","","","","",""].map((k,F)=>l.jsx("div",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:k},F))}),G.map((k,F)=>l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:k.map((C,L)=>{const H=Nu(C,e),Q=m.flatMap(ne=>J(ne.id,C));return l.jsxs("div",{className:`min-h-[120px] p-2 border-r border-gray-200 ${H?"bg-white":"bg-gray-50 text-gray-400"}`,children:[l.jsx("div",{className:`text-sm font-medium mb-1 ${ps(C)?"bg-blue-100 text-blue-800 rounded-full w-6 h-6 flex items-center justify-center":""}`,children:be(C,"d")}),l.jsxs("div",{className:"space-y-1",children:[Q.slice(0,3).map(ne=>{const ae=m.find(A=>{var ee;return(ee=ne.equipment)==null?void 0:ee.some(oe=>oe.id===A.id&&oe.type==="sample")});return l.jsx("div",{onClick:()=>{},className:"text-xs px-1 py-0.5 rounded truncate cursor-pointer hover:opacity-80 bg-purple-100 text-purple-800",title:`${ae==null?void 0:ae.name}: ${ne.title}`,children:l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(sa,{className:"h-3 w-3 flex-shrink-0"}),l.jsx("span",{className:"truncate",children:ne.title})]})},ne.id)}),Q.length>3&&l.jsxs("div",{className:"text-xs text-gray-500",children:["+",Q.length-3,""]})]})]},L)})},F))]})};return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:""}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsxs("button",{onClick:le,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:[l.jsx(wN,{className:"h-5 w-5 mr-1"}),"Excel"]}),l.jsxs("button",{onClick:()=>{h(null),x(null),u(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:[l.jsx(Cn,{className:"h-5 w-5 mr-1"}),""]})]})]}),l.jsxs("div",{className:"bg-white shadow rounded-lg",children:[l.jsx("div",{className:"px-4 py-5 border-b border-gray-200 sm:px-6",children:l.jsxs("div",{className:"flex items-center justify-between flex-wrap sm:flex-nowrap",children:[l.jsx("div",{children:l.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:be(e,"yyyyM",{locale:jr})})}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("div",{className:"inline-flex shadow-sm rounded-md",children:[l.jsx("button",{type:"button",onClick:()=>r("day"),className:`relative inline-flex items-center px-4 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium ${t==="day"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>r("week"),className:`relative inline-flex items-center px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium ${t==="week"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>r("month"),className:`relative inline-flex items-center px-4 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium ${t==="month"?"text-blue-600 z-10 bg-blue-50":"text-gray-700 hover:bg-gray-50"}`,children:""})]}),l.jsxs("div",{className:"inline-flex rounded-md shadow-sm",children:[l.jsxs("button",{type:"button",onClick:s,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx(Ru,{className:"h-5 w-5"})]}),l.jsx("button",{type:"button",onClick:i,className:"relative inline-flex items-center px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",children:""}),l.jsxs("button",{type:"button",onClick:n,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx(Zo,{className:"h-5 w-5"})]})]})]})]})}),z()]}),l.jsx(Iu,{isOpen:d,onClose:()=>u(!1),onSubmit:ye,selectedDate:p||void 0,selectedEquipment:f||void 0,type:"sample"}),l.jsx(se,{isOpen:_,onClose:()=>y(!1)})]})}const La={async notifyLeaveRequestSubmitted(e,t,r){const n={vacation:"",late:"",early:""},s=`${t.name}${n[e.type]}`;for(const i of r)await Ze.send({title:"",body:s,userId:i.id,type:"leave_request",data:{requestId:e.id,submitterId:t.id,leaveType:e.type,date:e.date.toISOString()}}),await Ze.logNotification({userId:i.id,type:"in_app",category:"leave_request_submitted",subject:"",content:s,metadata:{requestId:e.id,submitterId:t.id,leaveType:e.type,date:e.date.toISOString()},status:"sent"})},async notifyGroupApprovalComplete(e,t,r){if(!r)return;const n={vacation:"",late:"",early:""},s=`${t.name}${n[e.type]}`;await Ze.send({title:"",body:s,userId:r.id,type:"leave_approval_required",data:{requestId:e.id,submitterId:t.id,leaveType:e.type,date:e.date.toISOString()}}),await Ze.logNotification({userId:r.id,type:"in_app",category:"leave_request_submitted",subject:"",content:s,metadata:{requestId:e.id,submitterId:t.id,leaveType:e.type,date:e.date.toISOString()},status:"sent"})},async notifyFinalApprovalComplete(e,t,r,n=[],s=[]){const i={vacation:"",late:"",early:""},a=r?"":"",o=`${a}`,c=`${i[e.type]}${a}`;if(await Ze.send({title:o,body:c,userId:t.id,type:r?"leave_approved":"leave_rejected",data:{requestId:e.id,leaveType:e.type,date:e.date.toISOString(),approved:r}}),await Ze.logNotification({userId:t.id,type:"in_app",category:r?"leave_request_approved":"leave_request_rejected",subject:o,content:c,metadata:{requestId:e.id,leaveType:e.type,date:e.date.toISOString(),approved:r},status:"sent"}),r){for(const d of n)d.id!==t.id&&await Ze.send({title:"",body:`${t.name}${i[e.type]}`,userId:d.id,type:"leave_approved_info",data:{requestId:e.id,submitterId:t.id,leaveType:e.type,date:e.date.toISOString()}});for(const d of s)await Ze.send({title:"",body:`${t.name}${i[e.type]}`,userId:d.id,type:"leave_hr_notification",data:{requestId:e.id,submitterId:t.id,leaveType:e.type,date:e.date.toISOString()}})}},async notifyApprovalProgress(e,t,r,n){const s=n?"":"";await Ze.send({title:"",body:`${r.name}${s}`,userId:t.id,type:"leave_progress",data:{requestId:e.id,approverId:r.id,approved:n,date:e.date.toISOString()}})}};function iP(){const{currentUser:e}=Ht(),[t,r]=b.useState("my"),[n,s]=b.useState(!1),[i,a]=b.useState({}),[o,c]=b.useState([]),[d,u]=b.useState(!0),[f,h]=b.useState([]),[p,x]=b.useState([]),[m,g]=b.useState([]),[_,y]=b.useState([]);b.useEffect(()=>{E(),N(),v(),w()},[]);const v=async()=>{try{const{data:se,error:le}=await me.from("users").select("*").order("name");if(le)console.error("Error fetching users:",le),g(yn);else{const z=(se==null?void 0:se.map(U=>({id:U.id,employeeId:U.employee_id,name:U.name,nameKana:U.name_kana,email:U.email,phone:U.phone,department:U.department,role:U.role,defaultWorkDays:U.default_work_days||[]})))||[];g(z)}}catch(se){console.error("Error fetching users:",se),g(yn)}},w=async()=>{try{const{data:se,error:le}=await me.from("users").select("*").eq("department","").order("name");if(le)console.error("Error fetching HR members:",le),y(yn.filter(z=>z.department===""));else{const z=(se==null?void 0:se.map(U=>({id:U.id,employeeId:U.employee_id,name:U.name,nameKana:U.name_kana,email:U.email,phone:U.phone,department:U.department,role:U.role,defaultWorkDays:U.default_work_days||[]})))||[];y(z)}}catch(se){console.error("Error fetching HR members:",se),y(yn.filter(le=>le.department===""))}},N=async()=>{try{const{data:se,error:le}=await me.from("groups").select("*").eq("type","leave").order("name");le?(console.error("Error fetching leave groups:",le),h(Pc.filter(z=>z.type==="leave"))):h(se||[])}catch(se){console.error("Error fetching leave groups:",se),h(Pc.filter(le=>le.type==="leave"))}},E=async()=>{try{const{data:se,error:le}=await me.from("leave_requests").select("*").order("created_at",{ascending:!1});if(le)console.error("Failed to fetch leave requests:",le),console.warn("Using mock data for leave requests"),c(Fp);else if(se){const z=se.map(U=>({id:U.id,type:U.type,userId:U.user_id,date:new Date(U.date),reason:U.reason,status:U.status,approvers:U.approvers||[],createdAt:new Date(U.created_at)}));c(z)}}catch(se){console.error("Error fetching leave requests:",se),console.warn("Using mock data for leave requests"),c(Fp)}finally{u(!1)}},M=(()=>{const se=new Set;return f.forEach(le=>{var z;(z=le.members)==null||z.forEach(U=>{se.add(U)})}),p.forEach(le=>{se.add(le)}),Array.from(se).map(le=>m.find(z=>z.id===le)).filter(le=>le!==void 0)})(),P=m.find(se=>se.role==="president"),B=o.filter(se=>t==="my"?se.userId===(e==null?void 0:e.id):t==="pending"?se.approvers.some(le=>le.userId===(e==null?void 0:e.id)&&le.status==="pending"):t==="approved"?se.approvers.some(le=>le.userId===(e==null?void 0:e.id)&&le.status!=="pending"):!1),W=async se=>{var U;if(se.preventDefault(),!i.date){pe.error("");return}if(!((U=i.reason)!=null&&U.trim())){pe.error("");return}const le=new Date(i.date);if(o.find(Z=>Z.userId===(e==null?void 0:e.id)&&be(Z.date,"yyyy-MM-dd")===be(le,"yyyy-MM-dd")&&Z.status!=="rejected")){pe.error("");return}try{const Z=[...M.map(F=>({userId:F.id,status:"pending",timestamp:null,step:1})),...P&&!M.find(F=>F.id===P.id)?[{userId:P.id,status:"pending",timestamp:null,step:2}]:[]],{data:G,error:k}=await me.from("leave_requests").insert([{type:i.type||"vacation",user_id:(e==null?void 0:e.id)||"",date:new Date(i.date||new Date).toISOString().split("T")[0],reason:i.reason||"",status:"pending",approvers:Z}]).select().single();if(k){console.error("Error saving leave request:",k),pe.error("");return}else if(G){const F={id:G.id,type:G.type,userId:G.user_id,date:new Date(G.date),reason:G.reason,status:G.status,approvers:G.approvers||[],createdAt:new Date(G.created_at)};if(c([...o,F]),pe.success(""),e)try{await La.notifyLeaveRequestSubmitted(F,e,M)}catch(C){console.error("Failed to send notification:",C)}}s(!1),a({}),x([])}catch(Z){console.error("Error:",Z),pe.error("")}},Y=async(se,le)=>{const z=o.find(Q=>Q.id===se);if(!z)return;const U=z.approvers.map(Q=>Q.userId===(e==null?void 0:e.id)?{...Q,status:le?"approved":"rejected",timestamp:new Date}:Q),Z=U.filter(Q=>Q.step===1),G=U.filter(Q=>Q.step===2),k=Z.length>0&&Z.every(Q=>Q.status==="approved"),F=Z.some(Q=>Q.status==="rejected"),C=G.length===0||G.every(Q=>Q.status==="approved"),L=G.some(Q=>Q.status==="rejected");let H="pending";F||L?H="rejected":k&&C?H="approved":H="pending";try{const{error:Q}=await me.from("leave_requests").update({status:H,approvers:U}).eq("id",se);if(Q)console.error("Error updating leave request:",Q),pe.error("");else{const ne=o.map(A=>A.id===se?{...A,status:H,approvers:U}:A);c(ne);const ae=m.find(A=>A.id===z.userId);if(ae&&e)try{if(await La.notifyApprovalProgress(z,ae,e,le),le)if(k&&G.length>0&&!C)await La.notifyGroupApprovalComplete(z,ae,P),pe.success("");else if(H==="approved"){const A=M.filter(ee=>Z.some(oe=>oe.userId===ee.id));await La.notifyFinalApprovalComplete(z,ae,!0,A,_),pe.success("")}else pe.success("");else H==="rejected"&&await La.notifyFinalApprovalComplete(z,ae,!1,[],[]),pe.success("")}catch(A){console.error("Failed to send notification:",A),le?H==="approved"?pe.success(""):pe.success(""):pe.success("")}}}catch(Q){console.error("Error:",Q),pe.error("")}},J=async se=>{if(confirm(""))try{const{error:le}=await me.from("leave_requests").delete().eq("id",se);if(le)console.error("Error deleting leave request:",le),pe.error("");else{const z=o.filter(U=>U.id!==se);c(z),pe.success("")}}catch(le){console.error("Error:",le),pe.error("")}},Te=se=>se==="approved"?l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[l.jsx(Vn,{className:"h-4 w-4 mr-1"}),""]}):se==="rejected"?l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[l.jsx(Rs,{className:"h-4 w-4 mr-1"}),""]}):l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[l.jsx(Do,{className:"h-4 w-4 mr-1"}),""]}),ye=se=>{if(!se.approvers||se.approvers.length===0)return Te(se.status);const le=se.approvers.filter(U=>U.status==="approved").length,z=se.approvers.length;return l.jsxs("div",{className:"space-y-1",children:[Te(se.status),l.jsxs("div",{className:"text-xs text-gray-600",children:[l.jsx("div",{className:"font-medium",children:":"}),se.approvers.map((U,Z)=>{const G=m.find(k=>k.id===U.userId);return l.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[U.status==="approved"?l.jsx(Vn,{className:"h-3 w-3 text-green-600"}):U.status==="rejected"?l.jsx(Rs,{className:"h-3 w-3 text-red-600"}):l.jsx(Do,{className:"h-3 w-3 text-yellow-600"}),l.jsxs("span",{className:"text-xs",children:[G?G.name:"Unknown",U.timestamp?` (${be(new Date(U.timestamp),"MM/dd")})`:""]})]},Z)}),l.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[le,"/",z," "]})]})]})};return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>s(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-rose-600 hover:bg-rose-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500",children:[l.jsx(Cn,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsxs("div",{className:"bg-white shadow rounded-lg",children:[l.jsx("div",{className:"border-b border-gray-200",children:l.jsxs("nav",{className:"-mb-px flex","aria-label":"Tabs",children:[l.jsx("button",{onClick:()=>r("my"),className:`w-1/3 py-4 px-1 text-center border-b-2 font-medium text-sm ${t==="my"?"border-rose-500 text-rose-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:""}),l.jsx("button",{onClick:()=>r("pending"),className:`w-1/3 py-4 px-1 text-center border-b-2 font-medium text-sm ${t==="pending"?"border-rose-500 text-rose-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:""}),l.jsx("button",{onClick:()=>r("approved"),className:`w-1/3 py-4 px-1 text-center border-b-2 font-medium text-sm ${t==="approved"?"border-rose-500 text-rose-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:""})]})}),l.jsx("div",{className:"overflow-auto",children:d?l.jsxs("div",{className:"px-6 py-10 text-center text-gray-500",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-rose-600 mx-auto mb-4"}),"..."]}):B.length>0?l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col\\",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"relative px-6 py-3",children:l.jsx("span",{className:"sr-only",children:""})})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:B.map(se=>{const le=m.find(z=>z.id===se.userId);return l.jsxs("tr",{children:[l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:(le==null?void 0:le.name)||""}),l.jsx("div",{className:"text-sm text-gray-500",children:le==null?void 0:le.department})]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${se.type==="vacation"?"bg-blue-100 text-blue-800":se.type==="late"?"bg-yellow-100 text-yellow-800":"bg-purple-100 text-purple-800"}`,children:se.type==="vacation"?"":se.type==="late"?"":""})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("div",{className:"text-sm text-gray-900",children:be(new Date(se.date),"yyyy/MM/dd")})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("div",{className:"text-sm text-gray-900",children:se.reason})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ye(se)}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:be(new Date(se.createdAt),"yyyy/MM/dd")}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[t==="pending"&&l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>Y(se.id,!0),className:"text-green-600 hover:text-green-900",children:""}),l.jsx("button",{onClick:()=>Y(se.id,!1),className:"text-red-600 hover:text-red-900",children:""})]}),t==="my"&&se.status==="pending"&&l.jsx("button",{onClick:()=>J(se.id),className:"text-gray-600 hover:text-gray-900",children:""})]})]},se.id)})})]}):l.jsx("div",{className:"px-6 py-10 text-center text-gray-500",children:""})})]}),n&&l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),l.jsx("button",{onClick:()=>s(!1),className:"text-gray-400 hover:text-gray-500",children:l.jsx(Rn,{className:"h-6 w-6"})})]}),l.jsxs("form",{onSubmit:W,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:i.type||"vacation",onChange:se=>a({...i,type:se.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"vacation",children:""}),l.jsx("option",{value:"late",children:""}),l.jsx("option",{value:"early",children:""})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"date",value:i.date?be(new Date(i.date),"yyyy-MM-dd"):"",onChange:se=>a({...i,date:new Date(se.target.value)}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("textarea",{value:i.reason||"",onChange:se=>a({...i,reason:se.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsxs("div",{className:"space-y-2 bg-gray-50 p-3 rounded-md max-h-32 overflow-y-auto",children:[f.length===0?l.jsx("p",{className:"text-sm text-gray-500",children:""}):f.flatMap(se=>{var le;return(le=se.members)==null?void 0:le.map(z=>{const U=m.find(Z=>Z.id===z);return U?l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-rose-100 flex items-center justify-center",children:l.jsx("span",{className:"text-sm font-medium text-rose-600",children:U.name.charAt(0)})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:U.name}),l.jsx("p",{className:"text-xs text-gray-500",children:U.department})]})]},U.id):null})}).filter(Boolean),P&&l.jsxs("div",{className:"border-t pt-2 mt-2",children:[l.jsx("p",{className:"text-xs text-gray-500 mb-2",children:""}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-purple-100 flex items-center justify-center",children:l.jsx("span",{className:"text-sm font-medium text-purple-600",children:P.name.charAt(0)})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:P.name}),l.jsx("p",{className:"text-xs text-gray-500",children:P.department})]})]})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:""}),l.jsx(af,{selectedParticipants:p,onChange:x,showBusinessGroups:!0,showLeaveGroups:!1})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx("button",{type:"button",onClick:()=>s(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:""}),l.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-rose-600 hover:bg-rose-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500",children:""})]})]})]})})]})}function aP({user:e,onClose:t}){const[r,n]=b.useState(!1),[s,i]=b.useState(null),a=async()=>{n(!0);try{const{data:c}=await me.from("groups").select("id, members").filter("members","cs",`{${e.id}}`),{count:d}=await me.from("schedules").select("*",{count:"exact",head:!0}).or(`created_by.eq.${e.id},updated_by.eq.${e.id}`),{data:u}=await me.from("schedules").select("id, participants").filter("participants","cs",`{${e.id}}`),{count:f}=await me.from("leave_requests").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{count:h}=await me.from("vehicles").select("*",{count:"exact",head:!0}).eq("created_by",e.id),{count:p}=await me.from("rooms").select("*",{count:"exact",head:!0}).eq("created_by",e.id);i({groups:(c==null?void 0:c.length)||0,schedulesCreated:d||0,schedulesParticipant:(u==null?void 0:u.length)||0,leaveRequests:f||0,vehicles:h||0,rooms:p||0})}catch(c){console.error("Error checking dependencies:",c)}finally{n(!1)}},o=s&&(s.groups>0||s.schedulesCreated>0||s.schedulesParticipant>0||s.leaveRequests>0||s.vehicles>0||s.rooms>0);return l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[l.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:[": ",e.name]}),!s&&l.jsx("div",{className:"mb-4",children:l.jsx("button",{onClick:a,disabled:r,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50",children:r?"...":""})}),s&&l.jsxs("div",{className:"space-y-3 mb-4",children:[l.jsxs("div",{className:`flex items-center ${s.groups>0?"text-red-600":"text-green-600"}`,children:[s.groups>0?l.jsx(Rs,{className:"h-5 w-5 mr-2"}):l.jsx(Vn,{className:"h-5 w-5 mr-2"}),l.jsxs("span",{children:[": ",s.groups,""]})]}),l.jsxs("div",{className:`flex items-center ${s.schedulesCreated>0?"text-red-600":"text-green-600"}`,children:[s.schedulesCreated>0?l.jsx(Rs,{className:"h-5 w-5 mr-2"}):l.jsx(Vn,{className:"h-5 w-5 mr-2"}),l.jsxs("span",{children:[": ",s.schedulesCreated,""]})]}),l.jsxs("div",{className:`flex items-center ${s.schedulesParticipant>0?"text-red-600":"text-green-600"}`,children:[s.schedulesParticipant>0?l.jsx(Rs,{className:"h-5 w-5 mr-2"}):l.jsx(Vn,{className:"h-5 w-5 mr-2"}),l.jsxs("span",{children:[": ",s.schedulesParticipant,""]})]}),l.jsxs("div",{className:`flex items-center ${s.leaveRequests>0?"text-yellow-600":"text-green-600"}`,children:[s.leaveRequests>0?l.jsx(ty,{className:"h-5 w-5 mr-2"}):l.jsx(Vn,{className:"h-5 w-5 mr-2"}),l.jsxs("span",{children:[": ",s.leaveRequests,""]})]}),l.jsxs("div",{className:`flex items-center ${s.vehicles>0?"text-red-600":"text-green-600"}`,children:[s.vehicles>0?l.jsx(Rs,{className:"h-5 w-5 mr-2"}):l.jsx(Vn,{className:"h-5 w-5 mr-2"}),l.jsxs("span",{children:[": ",s.vehicles,""]})]}),l.jsxs("div",{className:`flex items-center ${s.rooms>0?"text-red-600":"text-green-600"}`,children:[s.rooms>0?l.jsx(Rs,{className:"h-5 w-5 mr-2"}):l.jsx(Vn,{className:"h-5 w-5 mr-2"}),l.jsxs("span",{children:[": ",s.rooms,""]})]}),o&&l.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:l.jsx("p",{className:"text-sm text-yellow-800",children:""})}),!o&&l.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-md",children:l.jsx("p",{className:"text-sm text-green-800",children:""})})]}),l.jsx("div",{className:"flex justify-end space-x-3",children:l.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:""})})]})})}function oP(){const[e,t]=b.useState([]),[r,n]=b.useState(!1),[s,i]=b.useState(null),[a,o]=b.useState({}),[c,d]=b.useState(!0),[u,f]=b.useState(null);b.useEffect(()=>{h()},[]);const h=async()=>{try{d(!0);const{data:g,error:_}=await me.from("users").select("*").order("name_kana");if(_)console.error("Error fetching users:",_),t(yn);else{const y=(g==null?void 0:g.map(v=>({id:v.id,employeeId:v.employee_id,name:v.name,nameKana:v.name_kana,email:v.email,phone:v.phone,department:v.department,role:v.role,defaultWorkDays:v.default_work_days||[{day:1,startTime:"09:00",endTime:"18:00"},{day:2,startTime:"09:00",endTime:"18:00"},{day:3,startTime:"09:00",endTime:"18:00"},{day:4,startTime:"09:00",endTime:"18:00"},{day:5,startTime:"09:00",endTime:"18:00"}]})))||[];t(y)}}catch(g){console.error("Error fetching users:",g),t(yn)}finally{d(!1)}},p=async g=>{var y,v,w;g.preventDefault();const _=[];if((y=a.name)!=null&&y.trim()||_.push(""),(v=a.email)!=null&&v.trim()?a.email.endsWith("@terao-f.co.jp")||_.push("@terao-f.co.jp"):_.push(""),(w=a.employeeId)!=null&&w.trim()||_.push(""),a.department||_.push(""),a.role||_.push(""),_.length>0){pe.error(_[0]);return}try{const N=[{day:1,startTime:"09:00",endTime:"18:00"},{day:2,startTime:"09:00",endTime:"18:00"},{day:3,startTime:"09:00",endTime:"18:00"},{day:4,startTime:"09:00",endTime:"18:00"},{day:5,startTime:"09:00",endTime:"18:00"}];if(s){const{error:E}=await me.from("users").update({employee_id:a.employeeId||"",name:a.name||"",name_kana:a.nameKana||"",email:a.email||"",phone:a.phone||"",department:a.department||"",role:a.role||"employee",default_work_days:a.defaultWorkDays||N,updated_at:new Date().toISOString()}).eq("id",s.id);if(E)throw E;pe.success("")}else{const{error:E}=await me.from("users").insert([{employee_id:a.employeeId||"",name:a.name||"",name_kana:a.nameKana||"",email:a.email||"",phone:a.phone||"",department:a.department||"",role:a.role||"employee",default_work_days:N}]);if(E)throw E;pe.success("")}await h(),n(!1),i(null),o({})}catch(N){console.error("Error saving user:",N),pe.error("")}},x=g=>{i(g),o(g),n(!0)},m=async g=>{var _,y;if(confirm(""))try{const v=e.find(N=>N.id===g);if(!v){pe.error("");return}console.log("Attempting to delete user:",{id:g,name:v.name,role:v.role});const{error:w}=await me.from("users").delete().eq("id",g);if(w){console.error("Detailed deletion error:",w),w.code==="23503"?pe.error(""):w.code==="42501"?pe.error(""):(_=w.message)!=null&&_.includes("row-level security")?pe.error(""):pe.error(`: ${w.message||""}`),w.code==="23503"?pe.error(""):w.code==="42501"?pe.error(": "):(y=w.message)!=null&&y.includes("row-level security")?pe.error(""):pe.error(`: ${w.message||""}`);return}pe.success(""),await h()}catch(v){console.error("Unexpected error deleting user:",v),pe.error(`: ${(v==null?void 0:v.message)||""}`)}};return c?l.jsx("div",{className:"h-full flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"..."})]})}):l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{i(null),o({}),n(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[l.jsx(AN,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"relative px-6 py-3",children:l.jsx("span",{className:"sr-only",children:""})})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(g=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:l.jsx("span",{className:"text-indigo-700 font-medium text-sm",children:g.name.charAt(0)})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:g.name}),l.jsx("div",{className:"text-sm text-gray-500",children:g.nameKana}),l.jsx("div",{className:"text-xs text-gray-400",children:g.employeeId})]})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("div",{className:"text-sm text-gray-900",children:g.department})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.role==="president"?"bg-purple-100 text-purple-800":g.role==="admin"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:g.role==="president"?"":g.role==="admin"?"":""})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[l.jsx("div",{children:g.email}),l.jsx("div",{children:g.phone})]}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[l.jsx("button",{onClick:()=>x(g),className:"text-indigo-600 hover:text-indigo-900 mr-3",title:"",children:l.jsx(io,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>f(g),className:"text-yellow-600 hover:text-yellow-900 mr-3",title:"",children:l.jsx(_N,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>m(g.id),className:"text-red-600 hover:text-red-900",title:"",children:l.jsx(ao,{className:"h-4 w-4"})})]})]},g.id))})]})}),r&&l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:s?"":""}),l.jsx("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-500",children:l.jsx(Rn,{className:"h-6 w-6"})})]}),l.jsxs("form",{onSubmit:p,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:a.employeeId||"",onChange:g=>o({...a,employeeId:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:a.name||"",onChange:g=>o({...a,name:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:a.nameKana||"",onChange:g=>o({...a,nameKana:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"email",value:a.email||"",onChange:g=>o({...a,email:g.target.value}),placeholder:"example@terao-f.co.jp",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),l.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"@terao-f.co.jp"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"tel",value:a.phone||"",onChange:g=>o({...a,phone:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:a.department||"",onChange:g=>o({...a,department:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"CAD-CAM",children:"CAD-CAM"}),l.jsx("option",{value:"WEB",children:"WEB"}),l.jsx("option",{value:"",children:""})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:a.role||"",onChange:g=>o({...a,role:g.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"employee",children:""}),l.jsx("option",{value:"admin",children:""}),l.jsx("option",{value:"president",children:""})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:""}),l.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:s?"":""})]})]})]})}),u&&l.jsx(aP,{user:u,onClose:()=>f(null)})]})}function lP(){const[e,t]=b.useState([]),[r,n]=b.useState(!1),[s,i]=b.useState(null),[a,o]=b.useState({}),[c,d]=b.useState(!0);b.useEffect(()=>{u()},[]);const u=async()=>{try{d(!0);const{data:x,error:m}=await me.from("groups").select("*").order("type, name");if(m)console.error("Error fetching groups:",m),t(Pc);else{const g=(x==null?void 0:x.map(_=>({id:_.id,name:_.name,type:_.type,members:_.members||[],createdBy:_.created_by,createdAt:new Date(_.created_at)})))||[];t(g)}}catch(x){console.error("Error fetching groups:",x),t(Pc)}finally{d(!1)}},f=async x=>{x.preventDefault();try{if(s){const{error:m}=await me.from("groups").update({name:a.name||"",type:a.type||"department",members:a.members||[],updated_at:new Date().toISOString()}).eq("id",s.id);if(m)throw m;pe.success("")}else{const{error:m}=await me.from("groups").insert([{name:a.name||"",type:a.type||"department",members:a.members||[],created_by:"550e8400-e29b-41d4-a716-446655440001"}]);if(m)throw m;pe.success("")}await u(),n(!1),i(null),o({})}catch(m){console.error("Error saving group:",m),pe.error("")}},h=x=>{i(x),o(x),n(!0)},p=async x=>{if(confirm(""))try{const{error:m}=await me.from("groups").delete().eq("id",x);if(m)throw m;pe.success(""),await u()}catch(m){console.error("Error deleting group:",m),pe.error("")}};return c?l.jsx("div",{className:"h-full flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"..."})]})}):l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{i(null),o({}),n(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[l.jsx(zr,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"relative px-6 py-3",children:l.jsx("span",{className:"sr-only",children:""})})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(x=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:l.jsx(zr,{className:"h-5 w-5 text-indigo-600"})}),l.jsx("div",{className:"ml-4",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:x.name})})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${x.type==="department"?"bg-green-100 text-green-800":x.type==="business"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:x.type==="department"?"":x.type==="business"?"":""})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[x.members.length,""]}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(x.createdAt).toLocaleDateString("ja-JP")}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[l.jsx("button",{onClick:()=>h(x),className:"text-indigo-600 hover:text-indigo-900 mr-3",children:l.jsx(io,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>p(x.id),className:"text-red-600 hover:text-red-900",children:l.jsx(ao,{className:"h-4 w-4"})})]})]},x.id))})]})}),r&&l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:s?"":""}),l.jsx("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-500",children:l.jsx(Rn,{className:"h-6 w-6"})})]}),l.jsxs("form",{onSubmit:f,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:a.name||"",onChange:x=>o({...a,name:x.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:a.type||"",onChange:x=>o({...a,type:x.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"department",children:""}),l.jsx("option",{value:"business",children:""}),l.jsx("option",{value:"leave",children:""})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:""}),l.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:s?"":""})]})]})]})})]})}function cP(){const[e,t]=b.useState([]),[r,n]=b.useState([]),[s,i]=b.useState([]),[a,o]=b.useState(!0),[c,d]=b.useState(!1),[u,f]=b.useState(null),[h,p]=b.useState(null),[x,m]=b.useState({});b.useEffect(()=>{g()},[]);const g=async()=>{try{o(!0);const{data:w,error:N}=await me.from("rooms").select("*").order("name");N?(console.error("Error fetching rooms:",N),t(Dc)):t(w||[]);const{data:E,error:T}=await me.from("vehicles").select("*").order("name");if(T)console.error("Error fetching vehicles:",T),n(Rc);else{const B=(E==null?void 0:E.map(W=>({id:W.id,name:W.name,licensePlate:W.license_plate,type:W.type,createdBy:W.created_by})))||[];n(B)}const{data:M,error:P}=await me.from("sample_equipment").select("*").order("name");P?(console.error("Error fetching sample equipment:",P),i(Ic)):i(M||[])}catch(w){console.error("Error fetching data:",w),t(Dc),n(Rc),i(Ic)}finally{o(!1)}},_=async w=>{w.preventDefault();try{switch(u){case"room":if(h){const{error:N}=await me.from("rooms").update({name:x.name||"",updated_at:new Date().toISOString()}).eq("id",h.id);if(N)throw N;pe.success("")}else{const{error:N}=await me.from("rooms").insert([{name:x.name||"",created_by:"550e8400-e29b-41d4-a716-446655440001"}]);if(N)throw N;pe.success("")}break;case"vehicle":if(h){const{error:N}=await me.from("vehicles").update({name:x.name||"",license_plate:x.licensePlate||"",type:x.type||"",updated_at:new Date().toISOString()}).eq("id",h.id);if(N)throw N;pe.success("")}else{const{error:N}=await me.from("vehicles").insert([{name:x.name||"",license_plate:x.licensePlate||"",type:x.type||"",created_by:"550e8400-e29b-41d4-a716-446655440001"}]);if(N)throw N;pe.success("")}break;case"sample":if(h){const{error:N}=await me.from("sample_equipment").update({name:x.name||"",type:x.type||"",updated_at:new Date().toISOString()}).eq("id",h.id);if(N)throw N;pe.success("")}else{const{error:N}=await me.from("sample_equipment").insert([{name:x.name||"",type:x.type||""}]);if(N)throw N;pe.success("")}break}await g(),d(!1),p(null),m({}),f(null)}catch(N){console.error("Error saving data:",N),pe.error("")}},y=(w,N)=>{p(w),m(w),f(N),d(!0)},v=async(w,N)=>{if(confirm(""))try{let E;switch(N){case"room":({error:E}=await me.from("rooms").delete().eq("id",w));break;case"vehicle":({error:E}=await me.from("vehicles").delete().eq("id",w));break;case"sample":({error:E}=await me.from("sample_equipment").delete().eq("id",w));break}if(E)throw E;pe.success(""),await g()}catch(E){console.error("Error deleting data:",E),pe.error("")}};return a?l.jsx("div",{className:"h-full flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"..."})]})}):l.jsxs("div",{className:"h-full flex flex-col space-y-8",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{p(null),m({}),f("room"),d(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500",children:[l.jsx(oa,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"relative px-6 py-3",children:l.jsx("span",{className:"sr-only",children:""})})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(w=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-emerald-100 flex items-center justify-center",children:l.jsx(oa,{className:"h-5 w-5 text-emerald-600"})}),l.jsx("div",{className:"ml-4",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.name})})]})}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[l.jsx("button",{onClick:()=>y(w,"room"),className:"text-emerald-600 hover:text-emerald-900 mr-3",children:l.jsx(io,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>v(w.id,"room"),className:"text-red-600 hover:text-red-900",children:l.jsx(ao,{className:"h-4 w-4"})})]})]},w.id))})]})})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{p(null),m({}),f("vehicle"),d(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-amber-600 hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500",children:[l.jsx(aa,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"relative px-6 py-3",children:l.jsx("span",{className:"sr-only",children:""})})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(w=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-amber-100 flex items-center justify-center",children:l.jsx(aa,{className:"h-5 w-5 text-amber-600"})}),l.jsx("div",{className:"ml-4",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.name})})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:w.licensePlate}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:w.type}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[l.jsx("button",{onClick:()=>y(w,"vehicle"),className:"text-amber-600 hover:text-amber-900 mr-3",children:l.jsx(io,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>v(w.id,"vehicle"),className:"text-red-600 hover:text-red-900",children:l.jsx(ao,{className:"h-4 w-4"})})]})]},w.id))})]})})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""}),l.jsxs("button",{onClick:()=>{p(null),m({}),f("sample"),d(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:[l.jsx(sa,{className:"h-5 w-5 mr-1"}),""]})]}),l.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"relative px-6 py-3",children:l.jsx("span",{className:"sr-only",children:""})})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(w=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-purple-100 flex items-center justify-center",children:l.jsx(sa,{className:"h-5 w-5 text-purple-600"})}),l.jsx("div",{className:"ml-4",children:l.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.name})})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:w.type}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[l.jsx("button",{onClick:()=>y(w,"sample"),className:"text-purple-600 hover:text-purple-900 mr-3",children:l.jsx(io,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>v(w.id,"sample"),className:"text-red-600 hover:text-red-900",children:l.jsx(ao,{className:"h-4 w-4"})})]})]},w.id))})]})})]}),c&&l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:h?"":""}),l.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-500",children:l.jsx(Rn,{className:"h-6 w-6"})})]}),l.jsxs("form",{onSubmit:_,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:u==="room"?"":u==="vehicle"?"":""}),l.jsx("input",{type:"text",value:x.name||"",onChange:w=>m({...x,name:w.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),u==="vehicle"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsx("input",{type:"text",value:x.licensePlate||"",onChange:w=>m({...x,licensePlate:w.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:x.type||"",onChange:w=>m({...x,type:w.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""})]})]})]}),u==="sample"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:""}),l.jsxs("select",{value:x.type||"",onChange:w=>m({...x,type:w.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"CAD",children:"CAD"}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:""}),l.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:h?"":""})]})]})]})})]})}class uP{constructor(){this.checkInterval=null,this.isRunning=!1}start(){this.isRunning||(this.isRunning=!0,this.checkInterval=window.setInterval(()=>{this.processScheduledNotifications()},6e4),this.processScheduledNotifications())}stop(){this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.isRunning=!1}async processScheduledNotifications(){try{const t=new Date,r=new Date(t.getTime()+5*6e4),{data:n,error:s}=await me.from("scheduled_notifications").select(`
          *,
          schedules (
            id,
            title,
            type,
            start_time,
            end_time,
            details,
            meet_link,
            participants,
            equipment
          )
        `).eq("status","pending").lte("scheduled_for",r.toISOString()).order("scheduled_for",{ascending:!0});if(s){console.error("Error fetching scheduled notifications:",s);return}if(!n||n.length===0)return;for(const i of n)await this.processNotification(i)}catch(t){console.error("Error in processScheduledNotifications:",t)}}async processNotification(t){try{const r=new Date(t.scheduled_for),n=new Date;if(r>n)return;const{data:s,error:i}=await me.from("users").select("id, name, email").eq("id",t.user_id).single();if(i||!s){console.error("User not found for notification:",t.user_id),await this.markNotificationAsFailed(t.id,"User not found");return}const a=await this.getParticipantNames(t.schedules.participants),o=new Date(t.schedules.start_time),c=this.formatTimeUntil(o,n),d={schedule:{id:t.schedules.id,title:t.schedules.title,type:t.schedules.type,startTime:new Date(t.schedules.start_time),endTime:new Date(t.schedules.end_time),details:t.schedules.details,meetLink:t.schedules.meet_link,participants:a,location:this.getLocationFromEquipment(t.schedules.equipment)},user:{id:s.id,name:s.name,email:s.email},timeUntilEvent:c};await Ze.notifyScheduleReminder(d),await this.markNotificationAsSent(t.id)}catch(r){console.error("Error processing notification:",r),await this.markNotificationAsFailed(t.id,r instanceof Error?r.message:"Unknown error")}}async markNotificationAsSent(t){await me.from("scheduled_notifications").update({status:"sent"}).eq("id",t)}async markNotificationAsFailed(t,r){await me.from("scheduled_notifications").update({status:"failed"}).eq("id",t)}async getParticipantNames(t){if(!t||t.length===0)return[];const{data:r}=await me.from("users").select("name").in("id",t);return(r==null?void 0:r.map(n=>n.name))||[]}getLocationFromEquipment(t){if(!t||t.length===0)return;const r=t.filter(n=>n.type==="room");if(r.length>0)return r.map(n=>n.name).join(", ")}formatTimeUntil(t,r){const n=t.getTime()-r.getTime(),s=Math.floor(n/6e4);if(s<=0)return"";if(s<60)return`${s}`;{const i=Math.floor(s/60),a=s%60;return a===0?`${i}`:`${i}${a}`}}async sendTestReminder(t,r){try{const{data:n,error:s}=await me.from("schedules").select("*").eq("id",t).single();if(s||!n)return console.error("Schedule not found:",t),!1;const{data:i,error:a}=await me.from("users").select("id, name, email").eq("id",r).single();if(a||!i)return console.error("User not found:",r),!1;const o=await this.getParticipantNames(n.participants),c={schedule:{id:n.id,title:n.title,type:n.type,startTime:new Date(n.start_time),endTime:new Date(n.end_time),details:n.details,meetLink:n.meet_link,participants:o,location:this.getLocationFromEquipment(n.equipment)},user:{id:i.id,name:i.name,email:i.email},timeUntilEvent:"15"};return await Ze.notifyScheduleReminder(c),!0}catch(n){return console.error("Error sending test reminder:",n),!1}}}const dP=new uP;function fP(){const{currentUser:e}=Ht(),[t,r]=b.useState(!1),n=async()=>{if(e){r(!0);try{const o=await Ze.sendEmail({to:e.email,templateName:"schedule_reminder",variables:{userName:e.name,title:"",startTime:"202468 14:00",endTime:"202468 15:00",type:"",location:"A",details:"",timeUntilEvent:"15",calendarLink:window.location.origin+"/calendar"},userId:e.id});o.success?pe.success(""):pe.error(": "+o.error)}catch(o){console.error("Error sending test email:",o),pe.error("")}finally{r(!1)}}},s=async()=>{if(e){r(!0);try{if(await Zv(e.id)){const c=await Ze.sendPush({userId:e.id,title:"",body:"",icon:"/icon-192x192.png",badge:"/badge-72x72.png",tag:"test-notification",data:{type:"test",timestamp:Date.now()},requireInteraction:!1,actions:[{action:"view",title:""},{action:"dismiss",title:""}]});c.success?pe.success(""):pe.error(": "+c.error)}else pe.error("")}catch(o){console.error("Error sending test push notification:",o),pe.error("")}finally{r(!1)}}},i=async()=>{r(!0);try{await ey("",{body:"",icon:"/icon-192x192.png",badge:"/badge-72x72.png",tag:"local-test",requireInteraction:!1}),pe.success("")}catch(o){console.error("Error showing local notification:",o),pe.error("")}finally{r(!1)}},a=async()=>{if(e){r(!0);try{const o="test-schedule-"+Date.now();await dP.sendTestReminder(o,e.id)?pe.success(""):pe.error("")}catch(o){console.error("Error sending test reminder:",o),pe.error("")}finally{r(!1)}}};return e?l.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(CN,{className:"h-6 w-6 text-blue-600 mr-2"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-6",children:""}),l.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[l.jsxs("button",{onClick:n,disabled:t,className:"flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(xh,{className:"h-5 w-5 mr-2"}),""]}),l.jsxs("button",{onClick:s,disabled:t,className:"flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(Ws,{className:"h-5 w-5 mr-2"}),""]}),l.jsxs("button",{onClick:i,disabled:t,className:"flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(Ws,{className:"h-5 w-5 mr-2"}),""]}),l.jsxs("button",{onClick:a,disabled:t,className:"flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(ia,{className:"h-5 w-5 mr-2"}),""]})]}),t&&l.jsxs("div",{className:"mt-4 flex items-center justify-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-indigo-600"}),l.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"..."})]})]}):l.jsx("div",{className:"p-4 bg-yellow-50 rounded-md",children:l.jsx("p",{className:"text-yellow-800",children:""})})}function hP(){const{currentUser:e}=Ht(),[t,r]=b.useState(null),[n,s]=b.useState(!0),[i,a]=b.useState(!1),[o]=b.useState(Qo());b.useEffect(()=>{e&&c()},[e]);const c=async()=>{if(e){s(!0);try{const h=await Ze.getUserPreferences(e.id);r(h)}catch(h){console.error("Error loading preferences:",h),pe.error("")}finally{s(!1)}}},d=async()=>{if(!(!e||!t)){a(!0);try{await Ze.updateUserPreferences(e.id,t)?pe.success(""):pe.error("")}catch(h){console.error("Error saving preferences:",h),pe.error("")}finally{a(!1)}}},u=async h=>{e&&(h?await Zv(e.id)?(r(x=>x?{...x,pushEnabled:!0}:null),pe.success("")):pe.error(""):await lN(e.id)?(r(x=>x?{...x,pushEnabled:!1}:null),pe.success("")):pe.error(""))},f=(h,p)=>{r(x=>x?{...x,[h]:p}:null)};return n?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"text-gray-500",children:"..."})}):t?l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"bg-white shadow rounded-lg",children:[l.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:""}),l.jsx("p",{className:"mt-1 text-sm text-gray-600",children:""})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(xh,{className:"h-5 w-5 text-gray-400 mr-2"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("label",{className:"flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:t.emailEnabled,onChange:h=>f("emailEnabled",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700",children:""})]})}),t.emailEnabled&&l.jsxs("div",{className:"ml-6 space-y-3",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.emailScheduleCreated,onChange:h=>f("emailScheduleCreated",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.emailScheduleUpdated,onChange:h=>f("emailScheduleUpdated",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.emailScheduleDeleted,onChange:h=>f("emailScheduleDeleted",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.emailScheduleReminder,onChange:h=>f("emailScheduleReminder",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.emailLeaveRequest,onChange:h=>f("emailLeaveRequest",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.emailLeaveApproval,onChange:h=>f("emailLeaveApproval",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:"/"})]})]})]})]}),l.jsxs("div",{className:"border-t pt-6",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(jN,{className:"h-5 w-5 text-gray-400 mr-2"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""})]}),o?l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("label",{className:"flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:t.pushEnabled,onChange:h=>u(h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700",children:""})]})}),t.pushEnabled&&l.jsxs("div",{className:"ml-6 space-y-3",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.pushScheduleCreated,onChange:h=>f("pushScheduleCreated",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.pushScheduleUpdated,onChange:h=>f("pushScheduleUpdated",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.pushScheduleDeleted,onChange:h=>f("pushScheduleDeleted",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.pushScheduleReminder,onChange:h=>f("pushScheduleReminder",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.pushLeaveRequest,onChange:h=>f("pushLeaveRequest",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.pushLeaveApproval,onChange:h=>f("pushLeaveApproval",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm text-gray-700",children:"/"})]})]})]}):l.jsx("div",{className:"p-4 bg-yellow-50 rounded-md",children:l.jsx("p",{className:"text-sm text-yellow-800",children:""})})]}),l.jsxs("div",{className:"border-t pt-6",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(Do,{className:"h-5 w-5 text-gray-400 mr-2"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""})]}),l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),l.jsxs("select",{value:t.defaultReminderTime,onChange:h=>f("defaultReminderTime",parseInt(h.target.value)),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[l.jsx("option",{value:5,children:"5"}),l.jsx("option",{value:10,children:"10"}),l.jsx("option",{value:15,children:"15"}),l.jsx("option",{value:30,children:"30"}),l.jsx("option",{value:60,children:"1"}),l.jsx("option",{value:120,children:"2"}),l.jsx("option",{value:1440,children:"1"})]})]})})]}),l.jsxs("div",{className:"border-t pt-6",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(bN,{className:"h-5 w-5 text-gray-400 mr-2"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:t.quietHoursEnabled,onChange:h=>f("quietHoursEnabled",h.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),l.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700",children:""})]}),t.quietHoursEnabled&&l.jsxs("div",{className:"ml-6 grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("input",{type:"time",value:t.quietHoursStart||"22:00",onChange:h=>f("quietHoursStart",h.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("input",{type:"time",value:t.quietHoursEnd||"07:00",onChange:h=>f("quietHoursEnd",h.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]})]}),t.quietHoursEnabled&&l.jsx("p",{className:"ml-6 text-sm text-gray-500",children:""})]})]})]}),l.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end",children:l.jsx("button",{onClick:d,disabled:i,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:i?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"..."]}):l.jsxs(l.Fragment,{children:[l.jsx(vN,{className:"h-4 w-4 mr-2"}),""]})})})]}),l.jsx("div",{className:"mt-8",children:l.jsx(fP,{})})]}):l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"text-gray-500",children:""})})}function Ul({children:e,minRole:t,redirectTo:r="/user-switch"}){const{isAuthenticated:n,currentUser:s}=Ht();return!n||!s?l.jsx(pv,{to:r,replace:!0}):t&&s.role!=="president"&&t==="admin"&&s.role!=="admin"?l.jsx("div",{className:"flex h-screen items-center justify-center bg-gray-50",children:l.jsxs("div",{className:"text-center p-8",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:""}),l.jsx("p",{className:"text-gray-600 mb-4",children:""}),l.jsx("button",{onClick:()=>window.history.back(),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:""})]})}):l.jsx(l.Fragment,{children:e})}function Lw(){const{permissions:e,rolePermissions:t,hasPermission:r,hasAnyPermission:n,hasAllPermissions:s,canAccessResource:i,logSecurityEvent:a}=Ev(),{currentUser:o}=Ht(),c=b.useMemo(()=>({canReadUsers:()=>r("users:read"),canWriteUsers:()=>r("users:write"),canDeleteUsers:()=>r("users:delete"),canManageRoles:()=>r("users:manage_roles"),canReadGroups:()=>r("groups:read"),canWriteGroups:()=>r("groups:write"),canDeleteGroups:()=>r("groups:delete"),canManageGroupMembers:()=>r("groups:manage_members"),canReadEquipment:()=>r("equipment:read"),canWriteEquipment:()=>r("equipment:write"),canDeleteEquipment:()=>r("equipment:delete"),canReadSchedules:()=>r("schedules:read"),canWriteSchedules:()=>r("schedules:write"),canDeleteSchedules:()=>r("schedules:delete"),canReadAllSchedules:()=>r("schedules:read_all"),canManageOthersSchedules:()=>r("schedules:manage_others"),canReadLeaveRequests:()=>r("leave:read"),canWriteLeaveRequests:()=>r("leave:write"),canApproveLeaveRequests:()=>r("leave:approve"),canReadAllLeaveRequests:()=>r("leave:read_all"),canAccessAdmin:()=>r("admin:access"),canManageSystemSettings:()=>r("admin:system_settings"),canViewAuditLogs:()=>r("admin:audit_logs"),canBackupSystem:()=>r("system:backup"),canPerformMaintenance:()=>r("system:maintenance")}),[r]),d=b.useMemo(()=>({canViewAllUsers:t.dataAccess.canViewAllUsers,canViewAllSchedules:t.dataAccess.canViewAllSchedules,canViewAllLeaveRequests:t.dataAccess.canViewAllLeaveRequests,canModifyOthersData:t.dataAccess.canModifyOthersData}),[t]),u=b.useMemo(()=>({canAccessUser:(m,g="read")=>i("user",g,m),canAccessSchedule:(m,g="read")=>i("schedule",g,m),canAccessLeaveRequest:(m,g="read")=>i("leave_request",g,m),canAccessGroup:(m,g="read")=>i("group",g,m),canAccessEquipment:(m="read")=>i("equipment",m)}),[i]),f=b.useMemo(()=>({isPresident:()=>(o==null?void 0:o.role)==="president",isAdmin:()=>(o==null?void 0:o.role)==="admin",isEmployee:()=>(o==null?void 0:o.role)==="employee",isAdminOrAbove:()=>(o==null?void 0:o.role)==="admin"||(o==null?void 0:o.role)==="president",hasRole:m=>(o==null?void 0:o.role)===m,hasAnyRole:m=>o?m.includes(o.role):!1}),[o]);return{permissions:e,rolePermissions:t,hasPermission:r,hasAnyPermission:n,hasAllPermissions:s,canAccessResource:i,...c,...d,...u,...f,enforcePermission:(m,g)=>{if(!r(m))throw a({type:"permission_denied",action:g||`Attempted action requiring permission: ${m}`,resource:m.split(":")[0],severity:"medium"}),new Error(`Permission denied: ${m}`)},enforceAnyPermission:(m,g)=>{if(!n(m))throw a({type:"permission_denied",action:g||`Attempted action requiring any of permissions: ${m.join(", ")}`,details:{requiredPermissions:m},severity:"medium"}),new Error(`Permission denied: Requires any of ${m.join(", ")}`)},enforceResourceAccess:(m,g,_)=>{if(!i(m,g,_))throw a({type:"permission_denied",action:`Attempted ${g} on ${m}`,resource:m,resourceId:_,severity:"medium"}),new Error(`Access denied: Cannot ${g} ${m}`)}}}function Mg({children:e,permission:t,permissions:r,requireAll:n=!1,role:s,roles:i,minRole:a,resource:o,action:c="read",resourceOwnerId:d,fallback:u=null,customCheck:f}){const{hasPermission:h,hasAnyPermission:p,hasAllPermissions:x,canAccessResource:m,hasRole:g,hasAnyRole:_,isAdminOrAbove:y}=Lw(),v=w=>{setTimeout(()=>{console.log("PermissionGate - :",w)},0)};return f?f()?l.jsx(l.Fragment,{children:e}):(v({type:"permission_denied",action:"Failed custom permission check",severity:"low"}),l.jsx(l.Fragment,{children:u})):t?h(t)?l.jsx(l.Fragment,{children:e}):(v({type:"permission_denied",action:`Access denied for permission: ${t}`,severity:"low"}),l.jsx(l.Fragment,{children:u})):r?(n?x(r):p(r))?l.jsx(l.Fragment,{children:e}):(v({type:"permission_denied",action:`Access denied for permissions: ${r.join(", ")} (requireAll: ${n})`,severity:"low"}),l.jsx(l.Fragment,{children:u})):s?g(s)?l.jsx(l.Fragment,{children:e}):(v({type:"permission_denied",action:`Access denied for role: ${s}`,severity:"low"}),l.jsx(l.Fragment,{children:u})):i?_(i)?l.jsx(l.Fragment,{children:e}):(v({type:"permission_denied",action:`Access denied for roles: ${i.join(", ")}`,severity:"low"}),l.jsx(l.Fragment,{children:u})):a?a==="admin"&&!y()?(v({type:"permission_denied",action:`Access denied for minimum role: ${a}`,severity:"low"}),l.jsx(l.Fragment,{children:u})):l.jsx(l.Fragment,{children:e}):o?m(o,c,d)?l.jsx(l.Fragment,{children:e}):(v({type:"permission_denied",action:`Access denied for resource: ${o} (action: ${c})`,resource:o,resourceId:d,severity:"low"}),l.jsx(l.Fragment,{children:u})):l.jsx(l.Fragment,{children:e})}function Bg({onClose:e}){const t=ma(),{currentUser:r,logout:n}=Ht(),{canReadSchedules:s,canWriteSchedules:i,canReadLeaveRequests:a,canAccessAdmin:o,canViewAuditLogs:c,isAdminOrAbove:d}=Lw(),[u,f]=b.useState(0);b.useEffect(()=>{r&&a()&&h()},[r,a]);const h=async()=>{try{const{data:g,error:_}=await me.from("leave_requests").select("id, approvers").eq("status","pending");if(_){console.error("Error fetching pending leave requests:",_);return}const y=g==null?void 0:g.filter(v=>!v.approvers||!Array.isArray(v.approvers)?!1:v.approvers.some(w=>w.userId===(r==null?void 0:r.id)&&w.status==="pending"));f((y==null?void 0:y.length)||0)}catch(g){console.error("Error fetching pending leave requests count:",g)}},p=[{name:"",href:"/",icon:l.jsx(xN,{className:"h-6 w-6"}),show:!0},{name:"",href:"/calendar/my",icon:l.jsx(ia,{className:"h-6 w-6"}),show:s()},{name:"",href:"/calendar/vehicle",icon:l.jsx(aa,{className:"h-6 w-6"}),show:i()},{name:"",href:"/calendar/room",icon:l.jsx(oa,{className:"h-6 w-6"}),show:i()},{name:"",href:"/calendar/sample",icon:l.jsx(sa,{className:"h-6 w-6"}),show:i()},{name:"",href:"/leave",icon:l.jsx(Do,{className:"h-6 w-6"}),show:a(),badge:u},{name:"",href:"/settings/notifications",icon:l.jsx(Ws,{className:"h-6 w-6"}),show:!0}],x=[{name:"",href:"/admin/users",icon:l.jsx(zr,{className:"h-6 w-6"}),permission:"users:read"},{name:"",href:"/admin/groups",icon:l.jsx(zr,{className:"h-6 w-6"}),permission:"groups:read"},{name:"",href:"/admin/equipment",icon:l.jsx(kN,{className:"h-6 w-6"}),permission:"equipment:read"},{name:"",href:"/admin/audit",icon:l.jsx(NN,{className:"h-6 w-6"}),permission:"admin:audit_logs"}],m=()=>{e&&e()};return l.jsxs("div",{className:"flex flex-col h-0 flex-1 bg-white border-r border-gray-200",children:[l.jsxs("div",{className:"flex-1 flex flex-col pt-5 pb-4 overflow-y-auto",children:[l.jsx("div",{className:"flex items-center flex-shrink-0 px-4",children:l.jsx("span",{className:"text-2xl font-bold text-blue-600",children:""})}),l.jsxs("nav",{className:"mt-5 flex-1 px-2 bg-white space-y-1",children:[p.map(g=>{if(!g.show)return null;const _=t.pathname===g.href||g.href!=="/"&&t.pathname.startsWith(g.href);return l.jsxs(yp,{to:g.href,onClick:m,className:`
                  group flex items-center px-2 py-2 text-sm font-medium rounded-md
                  ${_?"bg-blue-100 text-blue-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}
                `,children:[l.jsx("div",{className:`mr-3 ${_?"text-blue-500":"text-gray-400 group-hover:text-gray-500"}`,children:g.icon}),l.jsx("span",{className:"flex-1",children:g.name}),g.badge&&g.badge>0&&l.jsx("span",{className:"ml-2 bg-red-500 text-white text-xs font-medium px-2 py-0.5 rounded-full",children:g.badge})]},g.name)}),l.jsx(Mg,{permission:"admin:access",children:l.jsxs("div",{className:"pt-6",children:[l.jsx("div",{className:"px-3 mb-2 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:""}),x.map(g=>{const _=t.pathname===g.href;return l.jsx(Mg,{permission:g.permission,children:l.jsxs(yp,{to:g.href,onClick:m,className:`
                        group flex items-center px-2 py-2 text-sm font-medium rounded-md
                        ${_?"bg-blue-100 text-blue-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}
                      `,children:[l.jsx("div",{className:`mr-3 ${_?"text-blue-500":"text-gray-400 group-hover:text-gray-500"}`,children:g.icon}),g.name]})},g.name)})]})})]})]}),l.jsx("div",{className:"flex-shrink-0 flex border-t border-gray-200 p-4",children:l.jsx("div",{className:"flex items-center",children:l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-700",children:r==null?void 0:r.name}),l.jsx("div",{className:"text-xs text-gray-500",children:r==null?void 0:r.department})]})})})]})}var mP=Object.defineProperty,pP=(e,t,r)=>t in e?mP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Gd=(e,t,r)=>(pP(e,typeof t!="symbol"?t+"":t,r),r);let gP=class{constructor(){Gd(this,"current",this.detect()),Gd(this,"handoffState","pending"),Gd(this,"currentId",0)}set(t){this.current!==t&&(this.handoffState="pending",this.currentId=0,this.current=t)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},Gs=new gP,Ar=(e,t)=>{Gs.isServer?b.useEffect(e,t):b.useLayoutEffect(e,t)};function fs(e){let t=b.useRef(e);return Ar(()=>{t.current=e},[e]),t}let it=function(e){let t=fs(e);return Ct.useCallback((...r)=>t.current(...r),[t])};function xP(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(t=>setTimeout(()=>{throw t}))}function Fn(){let e=[],t={addEventListener(r,n,s,i){return r.addEventListener(n,s,i),t.add(()=>r.removeEventListener(n,s,i))},requestAnimationFrame(...r){let n=requestAnimationFrame(...r);return t.add(()=>cancelAnimationFrame(n))},nextFrame(...r){return t.requestAnimationFrame(()=>t.requestAnimationFrame(...r))},setTimeout(...r){let n=setTimeout(...r);return t.add(()=>clearTimeout(n))},microTask(...r){let n={current:!0};return xP(()=>{n.current&&r[0]()}),t.add(()=>{n.current=!1})},style(r,n,s){let i=r.style.getPropertyValue(n);return Object.assign(r.style,{[n]:s}),this.add(()=>{Object.assign(r.style,{[n]:i})})},group(r){let n=Fn();return r(n),this.add(()=>n.dispose())},add(r){return e.push(r),()=>{let n=e.indexOf(r);if(n>=0)for(let s of e.splice(n,1))s()}},dispose(){for(let r of e.splice(0))r()}};return t}function Vu(){let[e]=b.useState(Fn);return b.useEffect(()=>()=>e.dispose(),[e]),e}function vP(){let e=typeof document>"u";return"useSyncExternalStore"in Jd?(t=>t.useSyncExternalStore)(Jd)(()=>()=>{},()=>!1,()=>!e):!1}function $h(){let e=vP(),[t,r]=b.useState(Gs.isHandoffComplete);return t&&Gs.isHandoffComplete===!1&&r(!1),b.useEffect(()=>{t!==!0&&r(!0)},[t]),b.useEffect(()=>Gs.handoff(),[]),e?!1:t}var $g;let Uh=($g=Ct.useId)!=null?$g:function(){let e=$h(),[t,r]=Ct.useState(e?()=>Gs.nextId():null);return Ar(()=>{t===null&&r(Gs.nextId())},[t]),t!=null?""+t:void 0};function gr(e,t,...r){if(e in t){let s=t[e];return typeof s=="function"?s(...r):s}let n=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(s=>`"${s}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,gr),n}function Gu(e){return Gs.isServer?null:e instanceof Node?e.ownerDocument:e!=null&&e.hasOwnProperty("current")&&e.current instanceof Node?e.current.ownerDocument:document}let df=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var ff=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e))(ff||{}),yP=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(yP||{}),wP=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(wP||{});function Mw(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(df)).sort((t,r)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}var Wh=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Wh||{});function Hh(e,t=0){var r;return e===((r=Gu(e))==null?void 0:r.body)?!1:gr(t,{0(){return e.matches(df)},1(){let n=e;for(;n!==null;){if(n.matches(df))return!0;n=n.parentElement}return!1}})}function Bw(e){let t=Gu(e);Fn().nextFrame(()=>{t&&!Hh(t.activeElement,0)&&EP(e)})}var _P=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(_P||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function EP(e){e==null||e.focus({preventScroll:!0})}let SP=["textarea","input"].join(",");function TP(e){var t,r;return(r=(t=e==null?void 0:e.matches)==null?void 0:t.call(e,SP))!=null?r:!1}function $w(e,t=r=>r){return e.slice().sort((r,n)=>{let s=t(r),i=t(n);if(s===null||i===null)return 0;let a=s.compareDocumentPosition(i);return a&Node.DOCUMENT_POSITION_FOLLOWING?-1:a&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function bP(e,t){return kP(Mw(),t,{relativeTo:e})}function kP(e,t,{sorted:r=!0,relativeTo:n=null,skipElements:s=[]}={}){let i=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,a=Array.isArray(e)?r?$w(e):e:Mw(e);s.length>0&&a.length>1&&(a=a.filter(p=>!s.includes(p))),n=n??i.activeElement;let o=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,a.indexOf(n))-1;if(t&4)return Math.max(0,a.indexOf(n))+1;if(t&8)return a.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),d=t&32?{preventScroll:!0}:{},u=0,f=a.length,h;do{if(u>=f||u+f<=0)return 0;let p=c+u;if(t&16)p=(p+f)%f;else{if(p<0)return 3;if(p>=f)return 1}h=a[p],h==null||h.focus(d),u+=o}while(h!==i.activeElement);return t&6&&TP(h)&&h.select(),2}function NP(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function jP(){return/Android/gi.test(window.navigator.userAgent)}function CP(){return NP()||jP()}function Wl(e,t,r){let n=fs(t);b.useEffect(()=>{function s(i){n.current(i)}return document.addEventListener(e,s,r),()=>document.removeEventListener(e,s,r)},[e,r])}function AP(e,t,r){let n=fs(t);b.useEffect(()=>{function s(i){n.current(i)}return window.addEventListener(e,s,r),()=>window.removeEventListener(e,s,r)},[e,r])}function OP(e,t,r=!0){let n=b.useRef(!1);b.useEffect(()=>{requestAnimationFrame(()=>{n.current=r})},[r]);function s(a,o){if(!n.current||a.defaultPrevented)return;let c=o(a);if(c===null||!c.getRootNode().contains(c)||!c.isConnected)return;let d=function u(f){return typeof f=="function"?u(f()):Array.isArray(f)||f instanceof Set?f:[f]}(e);for(let u of d){if(u===null)continue;let f=u instanceof HTMLElement?u:u.current;if(f!=null&&f.contains(c)||a.composed&&a.composedPath().includes(f))return}return!Hh(c,Wh.Loose)&&c.tabIndex!==-1&&a.preventDefault(),t(a,c)}let i=b.useRef(null);Wl("pointerdown",a=>{var o,c;n.current&&(i.current=((c=(o=a.composedPath)==null?void 0:o.call(a))==null?void 0:c[0])||a.target)},!0),Wl("mousedown",a=>{var o,c;n.current&&(i.current=((c=(o=a.composedPath)==null?void 0:o.call(a))==null?void 0:c[0])||a.target)},!0),Wl("click",a=>{CP()||i.current&&(s(a,()=>i.current),i.current=null)},!0),Wl("touchend",a=>s(a,()=>a.target instanceof HTMLElement?a.target:null),!0),AP("blur",a=>s(a,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function FP(...e){return b.useMemo(()=>Gu(...e),[...e])}function Ug(e){var t;if(e.type)return e.type;let r=(t=e.as)!=null?t:"button";if(typeof r=="string"&&r.toLowerCase()==="button")return"button"}function PP(e,t){let[r,n]=b.useState(()=>Ug(e));return Ar(()=>{n(Ug(e))},[e.type,e.as]),Ar(()=>{r||t.current&&t.current instanceof HTMLButtonElement&&!t.current.hasAttribute("type")&&n("button")},[r,t]),r}let DP=Symbol();function Ea(...e){let t=b.useRef(e);b.useEffect(()=>{t.current=e},[e]);let r=it(n=>{for(let s of t.current)s!=null&&(typeof s=="function"?s(n):s.current=n)});return e.every(n=>n==null||(n==null?void 0:n[DP]))?void 0:r}function Wg(e){return[e.screenX,e.screenY]}function RP(){let e=b.useRef([-1,-1]);return{wasMoved(t){let r=Wg(t);return e.current[0]===r[0]&&e.current[1]===r[1]?!1:(e.current=r,!0)},update(t){e.current=Wg(t)}}}function IP({container:e,accept:t,walk:r,enabled:n=!0}){let s=b.useRef(t),i=b.useRef(r);b.useEffect(()=>{s.current=t,i.current=r},[t,r]),Ar(()=>{if(!e||!n)return;let a=Gu(e);if(!a)return;let o=s.current,c=i.current,d=Object.assign(f=>o(f),{acceptNode:o}),u=a.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,d,!1);for(;u.nextNode();)c(u.currentNode)},[e,n,s,i])}function nu(...e){return Array.from(new Set(e.flatMap(t=>typeof t=="string"?t.split(" "):[]))).filter(Boolean).join(" ")}var su=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(su||{}),rs=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(rs||{});function Sa({ourProps:e,theirProps:t,slot:r,defaultTag:n,features:s,visible:i=!0,name:a,mergeRefs:o}){o=o??LP;let c=Uw(t,e);if(i)return Hl(c,r,n,a,o);let d=s??0;if(d&2){let{static:u=!1,...f}=c;if(u)return Hl(f,r,n,a,o)}if(d&1){let{unmount:u=!0,...f}=c;return gr(u?0:1,{0(){return null},1(){return Hl({...f,hidden:!0,style:{display:"none"}},r,n,a,o)}})}return Hl(c,r,n,a,o)}function Hl(e,t={},r,n,s){let{as:i=r,children:a,refName:o="ref",...c}=qd(e,["unmount","static"]),d=e.ref!==void 0?{[o]:e.ref}:{},u=typeof a=="function"?a(t):a;"className"in c&&c.className&&typeof c.className=="function"&&(c.className=c.className(t));let f={};if(t){let h=!1,p=[];for(let[x,m]of Object.entries(t))typeof m=="boolean"&&(h=!0),m===!0&&p.push(x);h&&(f["data-headlessui-state"]=p.join(" "))}if(i===b.Fragment&&Object.keys(Hg(c)).length>0){if(!b.isValidElement(u)||Array.isArray(u)&&u.length>1)throw new Error(['Passing props on "Fragment"!',"",`The current component <${n} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(c).map(m=>`  - ${m}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(m=>`  - ${m}`).join(`
`)].join(`
`));let h=u.props,p=typeof(h==null?void 0:h.className)=="function"?(...m)=>nu(h==null?void 0:h.className(...m),c.className):nu(h==null?void 0:h.className,c.className),x=p?{className:p}:{};return b.cloneElement(u,Object.assign({},Uw(u.props,Hg(qd(c,["ref"]))),f,d,{ref:s(u.ref,d.ref)},x))}return b.createElement(i,Object.assign({},qd(c,["ref"]),i!==b.Fragment&&d,i!==b.Fragment&&f),u)}function LP(...e){return e.every(t=>t==null)?void 0:t=>{for(let r of e)r!=null&&(typeof r=="function"?r(t):r.current=t)}}function Uw(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},r={};for(let n of e)for(let s in n)s.startsWith("on")&&typeof n[s]=="function"?(r[s]!=null||(r[s]=[]),r[s].push(n[s])):t[s]=n[s];if(t.disabled||t["aria-disabled"])return Object.assign(t,Object.fromEntries(Object.keys(r).map(n=>[n,void 0])));for(let n in r)Object.assign(t,{[n](s,...i){let a=r[n];for(let o of a){if((s instanceof Event||(s==null?void 0:s.nativeEvent)instanceof Event)&&s.defaultPrevented)return;o(s,...i)}}});return t}function ui(e){var t;return Object.assign(b.forwardRef(e),{displayName:(t=e.displayName)!=null?t:e.name})}function Hg(e){let t=Object.assign({},e);for(let r in t)t[r]===void 0&&delete t[r];return t}function qd(e,t=[]){let r=Object.assign({},e);for(let n of t)n in r&&delete r[n];return r}let zh=b.createContext(null);zh.displayName="OpenClosedContext";var mr=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(mr||{});function Vh(){return b.useContext(zh)}function Ww({value:e,children:t}){return Ct.createElement(zh.Provider,{value:e},t)}function MP(e){let t=e.parentElement,r=null;for(;t&&!(t instanceof HTMLFieldSetElement);)t instanceof HTMLLegendElement&&(r=t),t=t.parentElement;let n=(t==null?void 0:t.getAttribute("disabled"))==="";return n&&BP(r)?!1:n}function BP(e){if(!e)return!1;let t=e.previousElementSibling;for(;t!==null;){if(t instanceof HTMLLegendElement)return!1;t=t.previousElementSibling}return!0}function $P(e){throw new Error("Unexpected object: "+e)}var Gr=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(Gr||{});function UP(e,t){let r=t.resolveItems();if(r.length<=0)return null;let n=t.resolveActiveIndex(),s=n??-1;switch(e.focus){case 0:{for(let i=0;i<r.length;++i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 1:{for(let i=s-1;i>=0;--i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 2:{for(let i=s+1;i<r.length;++i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 3:{for(let i=r.length-1;i>=0;--i)if(!t.resolveDisabled(r[i],i,r))return i;return n}case 4:{for(let i=0;i<r.length;++i)if(t.resolveId(r[i],i,r)===e.id)return i;return n}case 5:return null;default:$P(e)}}var bt=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(bt||{});function Gh(){let e=b.useRef(!1);return Ar(()=>(e.current=!0,()=>{e.current=!1}),[]),e}let zg=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function Vg(e){var t,r;let n=(t=e.innerText)!=null?t:"",s=e.cloneNode(!0);if(!(s instanceof HTMLElement))return n;let i=!1;for(let o of s.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))o.remove(),i=!0;let a=i?(r=s.innerText)!=null?r:"":n;return zg.test(a)&&(a=a.replace(zg,"")),a}function WP(e){let t=e.getAttribute("aria-label");if(typeof t=="string")return t.trim();let r=e.getAttribute("aria-labelledby");if(r){let n=r.split(" ").map(s=>{let i=document.getElementById(s);if(i){let a=i.getAttribute("aria-label");return typeof a=="string"?a.trim():Vg(i).trim()}return null}).filter(Boolean);if(n.length>0)return n.join(", ")}return Vg(e).trim()}function HP(e){let t=b.useRef(""),r=b.useRef("");return it(()=>{let n=e.current;if(!n)return"";let s=n.innerText;if(t.current===s)return r.current;let i=WP(n).trim().toLowerCase();return t.current=s,r.current=i,i})}var zP=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(zP||{}),VP=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(VP||{}),GP=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItem=5]="RegisterItem",e[e.UnregisterItem=6]="UnregisterItem",e))(GP||{});function Kd(e,t=r=>r){let r=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,n=$w(t(e.items.slice()),i=>i.dataRef.current.domRef.current),s=r?n.indexOf(r):null;return s===-1&&(s=null),{items:n,activeItemIndex:s}}let qP={1(e){return e.menuState===1?e:{...e,activeItemIndex:null,menuState:1}},0(e){return e.menuState===0?e:{...e,__demoMode:!1,menuState:0}},2:(e,t)=>{var r;let n=Kd(e),s=UP(t,{resolveItems:()=>n.items,resolveActiveIndex:()=>n.activeItemIndex,resolveId:i=>i.id,resolveDisabled:i=>i.dataRef.current.disabled});return{...e,...n,searchQuery:"",activeItemIndex:s,activationTrigger:(r=t.trigger)!=null?r:1}},3:(e,t)=>{let r=e.searchQuery!==""?0:1,n=e.searchQuery+t.value.toLowerCase(),s=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+r).concat(e.items.slice(0,e.activeItemIndex+r)):e.items).find(a=>{var o;return((o=a.dataRef.current.textValue)==null?void 0:o.startsWith(n))&&!a.dataRef.current.disabled}),i=s?e.items.indexOf(s):-1;return i===-1||i===e.activeItemIndex?{...e,searchQuery:n}:{...e,searchQuery:n,activeItemIndex:i,activationTrigger:1}},4(e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},5:(e,t)=>{let r=Kd(e,n=>[...n,{id:t.id,dataRef:t.dataRef}]);return{...e,...r}},6:(e,t)=>{let r=Kd(e,n=>{let s=n.findIndex(i=>i.id===t.id);return s!==-1&&n.splice(s,1),n});return{...e,...r,activationTrigger:1}}},qh=b.createContext(null);qh.displayName="MenuContext";function qu(e){let t=b.useContext(qh);if(t===null){let r=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,qu),r}return t}function KP(e,t){return gr(t.type,qP,e,t)}let XP=b.Fragment;function YP(e,t){let{__demoMode:r=!1,...n}=e,s=b.useReducer(KP,{__demoMode:r,menuState:r?0:1,buttonRef:b.createRef(),itemsRef:b.createRef(),items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:i,itemsRef:a,buttonRef:o},c]=s,d=Ea(t);OP([o,a],(p,x)=>{var m;c({type:1}),Hh(x,Wh.Loose)||(p.preventDefault(),(m=o.current)==null||m.focus())},i===0);let u=it(()=>{c({type:1})}),f=b.useMemo(()=>({open:i===0,close:u}),[i,u]),h={ref:d};return Ct.createElement(qh.Provider,{value:s},Ct.createElement(Ww,{value:gr(i,{0:mr.Open,1:mr.Closed})},Sa({ourProps:h,theirProps:n,slot:f,defaultTag:XP,name:"Menu"})))}let JP="button";function QP(e,t){var r;let n=Uh(),{id:s=`headlessui-menu-button-${n}`,...i}=e,[a,o]=qu("Menu.Button"),c=Ea(a.buttonRef,t),d=Vu(),u=it(m=>{switch(m.key){case bt.Space:case bt.Enter:case bt.ArrowDown:m.preventDefault(),m.stopPropagation(),o({type:0}),d.nextFrame(()=>o({type:2,focus:Gr.First}));break;case bt.ArrowUp:m.preventDefault(),m.stopPropagation(),o({type:0}),d.nextFrame(()=>o({type:2,focus:Gr.Last}));break}}),f=it(m=>{switch(m.key){case bt.Space:m.preventDefault();break}}),h=it(m=>{if(MP(m.currentTarget))return m.preventDefault();e.disabled||(a.menuState===0?(o({type:1}),d.nextFrame(()=>{var g;return(g=a.buttonRef.current)==null?void 0:g.focus({preventScroll:!0})})):(m.preventDefault(),o({type:0})))}),p=b.useMemo(()=>({open:a.menuState===0}),[a]),x={ref:c,id:s,type:PP(e,a.buttonRef),"aria-haspopup":"menu","aria-controls":(r=a.itemsRef.current)==null?void 0:r.id,"aria-expanded":a.menuState===0,onKeyDown:u,onKeyUp:f,onClick:h};return Sa({ourProps:x,theirProps:i,slot:p,defaultTag:JP,name:"Menu.Button"})}let ZP="div",eD=su.RenderStrategy|su.Static;function tD(e,t){var r,n;let s=Uh(),{id:i=`headlessui-menu-items-${s}`,...a}=e,[o,c]=qu("Menu.Items"),d=Ea(o.itemsRef,t),u=FP(o.itemsRef),f=Vu(),h=Vh(),p=h!==null?(h&mr.Open)===mr.Open:o.menuState===0;b.useEffect(()=>{let y=o.itemsRef.current;y&&o.menuState===0&&y!==(u==null?void 0:u.activeElement)&&y.focus({preventScroll:!0})},[o.menuState,o.itemsRef,u]),IP({container:o.itemsRef.current,enabled:o.menuState===0,accept(y){return y.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:y.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(y){y.setAttribute("role","none")}});let x=it(y=>{var v,w;switch(f.dispose(),y.key){case bt.Space:if(o.searchQuery!=="")return y.preventDefault(),y.stopPropagation(),c({type:3,value:y.key});case bt.Enter:if(y.preventDefault(),y.stopPropagation(),c({type:1}),o.activeItemIndex!==null){let{dataRef:N}=o.items[o.activeItemIndex];(w=(v=N.current)==null?void 0:v.domRef.current)==null||w.click()}Bw(o.buttonRef.current);break;case bt.ArrowDown:return y.preventDefault(),y.stopPropagation(),c({type:2,focus:Gr.Next});case bt.ArrowUp:return y.preventDefault(),y.stopPropagation(),c({type:2,focus:Gr.Previous});case bt.Home:case bt.PageUp:return y.preventDefault(),y.stopPropagation(),c({type:2,focus:Gr.First});case bt.End:case bt.PageDown:return y.preventDefault(),y.stopPropagation(),c({type:2,focus:Gr.Last});case bt.Escape:y.preventDefault(),y.stopPropagation(),c({type:1}),Fn().nextFrame(()=>{var N;return(N=o.buttonRef.current)==null?void 0:N.focus({preventScroll:!0})});break;case bt.Tab:y.preventDefault(),y.stopPropagation(),c({type:1}),Fn().nextFrame(()=>{bP(o.buttonRef.current,y.shiftKey?ff.Previous:ff.Next)});break;default:y.key.length===1&&(c({type:3,value:y.key}),f.setTimeout(()=>c({type:4}),350));break}}),m=it(y=>{switch(y.key){case bt.Space:y.preventDefault();break}}),g=b.useMemo(()=>({open:o.menuState===0}),[o]),_={"aria-activedescendant":o.activeItemIndex===null||(r=o.items[o.activeItemIndex])==null?void 0:r.id,"aria-labelledby":(n=o.buttonRef.current)==null?void 0:n.id,id:i,onKeyDown:x,onKeyUp:m,role:"menu",tabIndex:0,ref:d};return Sa({ourProps:_,theirProps:a,slot:g,defaultTag:ZP,features:eD,visible:p,name:"Menu.Items"})}let rD=b.Fragment;function nD(e,t){let r=Uh(),{id:n=`headlessui-menu-item-${r}`,disabled:s=!1,...i}=e,[a,o]=qu("Menu.Item"),c=a.activeItemIndex!==null?a.items[a.activeItemIndex].id===n:!1,d=b.useRef(null),u=Ea(t,d);Ar(()=>{if(a.__demoMode||a.menuState!==0||!c||a.activationTrigger===0)return;let N=Fn();return N.requestAnimationFrame(()=>{var E,T;(T=(E=d.current)==null?void 0:E.scrollIntoView)==null||T.call(E,{block:"nearest"})}),N.dispose},[a.__demoMode,d,c,a.menuState,a.activationTrigger,a.activeItemIndex]);let f=HP(d),h=b.useRef({disabled:s,domRef:d,get textValue(){return f()}});Ar(()=>{h.current.disabled=s},[h,s]),Ar(()=>(o({type:5,id:n,dataRef:h}),()=>o({type:6,id:n})),[h,n]);let p=it(()=>{o({type:1})}),x=it(N=>{if(s)return N.preventDefault();o({type:1}),Bw(a.buttonRef.current)}),m=it(()=>{if(s)return o({type:2,focus:Gr.Nothing});o({type:2,focus:Gr.Specific,id:n})}),g=RP(),_=it(N=>g.update(N)),y=it(N=>{g.wasMoved(N)&&(s||c||o({type:2,focus:Gr.Specific,id:n,trigger:0}))}),v=it(N=>{g.wasMoved(N)&&(s||c&&o({type:2,focus:Gr.Nothing}))}),w=b.useMemo(()=>({active:c,disabled:s,close:p}),[c,s,p]);return Sa({ourProps:{id:n,ref:u,role:"menuitem",tabIndex:s===!0?void 0:-1,"aria-disabled":s===!0?!0:void 0,disabled:void 0,onClick:x,onFocus:m,onPointerEnter:_,onMouseEnter:_,onPointerMove:y,onMouseMove:y,onPointerLeave:v,onMouseLeave:v},theirProps:i,slot:w,defaultTag:rD,name:"Menu.Item"})}let sD=ui(YP),iD=ui(QP),aD=ui(tD),oD=ui(nD),Ma=Object.assign(sD,{Button:iD,Items:aD,Item:oD});function lD(e=0){let[t,r]=b.useState(e),n=Gh(),s=b.useCallback(c=>{n.current&&r(d=>d|c)},[t,n]),i=b.useCallback(c=>!!(t&c),[t]),a=b.useCallback(c=>{n.current&&r(d=>d&~c)},[r,n]),o=b.useCallback(c=>{n.current&&r(d=>d^c)},[r]);return{flags:t,addFlag:s,hasFlag:i,removeFlag:a,toggleFlag:o}}function cD(e){let t={called:!1};return(...r)=>{if(!t.called)return t.called=!0,e(...r)}}function Xd(e,...t){e&&t.length>0&&e.classList.add(...t)}function Yd(e,...t){e&&t.length>0&&e.classList.remove(...t)}function uD(e,t){let r=Fn();if(!e)return r.dispose;let{transitionDuration:n,transitionDelay:s}=getComputedStyle(e),[i,a]=[n,s].map(c=>{let[d=0]=c.split(",").filter(Boolean).map(u=>u.includes("ms")?parseFloat(u):parseFloat(u)*1e3).sort((u,f)=>f-u);return d}),o=i+a;if(o!==0){r.group(d=>{d.setTimeout(()=>{t(),d.dispose()},o),d.addEventListener(e,"transitionrun",u=>{u.target===u.currentTarget&&d.dispose()})});let c=r.addEventListener(e,"transitionend",d=>{d.target===d.currentTarget&&(t(),c())})}else t();return r.add(()=>t()),r.dispose}function dD(e,t,r,n){let s=r?"enter":"leave",i=Fn(),a=n!==void 0?cD(n):()=>{};s==="enter"&&(e.removeAttribute("hidden"),e.style.display="");let o=gr(s,{enter:()=>t.enter,leave:()=>t.leave}),c=gr(s,{enter:()=>t.enterTo,leave:()=>t.leaveTo}),d=gr(s,{enter:()=>t.enterFrom,leave:()=>t.leaveFrom});return Yd(e,...t.base,...t.enter,...t.enterTo,...t.enterFrom,...t.leave,...t.leaveFrom,...t.leaveTo,...t.entered),Xd(e,...t.base,...o,...d),i.nextFrame(()=>{Yd(e,...t.base,...o,...d),Xd(e,...t.base,...o,...c),uD(e,()=>(Yd(e,...t.base,...o),Xd(e,...t.base,...t.entered),a()))}),i.dispose}function fD({immediate:e,container:t,direction:r,classes:n,onStart:s,onStop:i}){let a=Gh(),o=Vu(),c=fs(r);Ar(()=>{e&&(c.current="enter")},[e]),Ar(()=>{let d=Fn();o.add(d.dispose);let u=t.current;if(u&&c.current!=="idle"&&a.current)return d.dispose(),s.current(c.current),d.add(dD(u,n.current,c.current==="enter",()=>{d.dispose(),i.current(c.current)})),d.dispose},[r])}function $n(e=""){return e.split(/\s+/).filter(t=>t.length>1)}let Ku=b.createContext(null);Ku.displayName="TransitionContext";var hD=(e=>(e.Visible="visible",e.Hidden="hidden",e))(hD||{});function mD(){let e=b.useContext(Ku);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function pD(){let e=b.useContext(Xu);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let Xu=b.createContext(null);Xu.displayName="NestingContext";function Yu(e){return"children"in e?Yu(e.children):e.current.filter(({el:t})=>t.current!==null).filter(({state:t})=>t==="visible").length>0}function Hw(e,t){let r=fs(e),n=b.useRef([]),s=Gh(),i=Vu(),a=it((p,x=rs.Hidden)=>{let m=n.current.findIndex(({el:g})=>g===p);m!==-1&&(gr(x,{[rs.Unmount](){n.current.splice(m,1)},[rs.Hidden](){n.current[m].state="hidden"}}),i.microTask(()=>{var g;!Yu(n)&&s.current&&((g=r.current)==null||g.call(r))}))}),o=it(p=>{let x=n.current.find(({el:m})=>m===p);return x?x.state!=="visible"&&(x.state="visible"):n.current.push({el:p,state:"visible"}),()=>a(p,rs.Unmount)}),c=b.useRef([]),d=b.useRef(Promise.resolve()),u=b.useRef({enter:[],leave:[],idle:[]}),f=it((p,x,m)=>{c.current.splice(0),t&&(t.chains.current[x]=t.chains.current[x].filter(([g])=>g!==p)),t==null||t.chains.current[x].push([p,new Promise(g=>{c.current.push(g)})]),t==null||t.chains.current[x].push([p,new Promise(g=>{Promise.all(u.current[x].map(([_,y])=>y)).then(()=>g())})]),x==="enter"?d.current=d.current.then(()=>t==null?void 0:t.wait.current).then(()=>m(x)):m(x)}),h=it((p,x,m)=>{Promise.all(u.current[x].splice(0).map(([g,_])=>_)).then(()=>{var g;(g=c.current.shift())==null||g()}).then(()=>m(x))});return b.useMemo(()=>({children:n,register:o,unregister:a,onStart:f,onStop:h,wait:d,chains:u}),[o,a,n,f,h,u,d])}function gD(){}let xD=["beforeEnter","afterEnter","beforeLeave","afterLeave"];function Gg(e){var t;let r={};for(let n of xD)r[n]=(t=e[n])!=null?t:gD;return r}function vD(e){let t=b.useRef(Gg(e));return b.useEffect(()=>{t.current=Gg(e)},[e]),t}let yD="div",zw=su.RenderStrategy;function wD(e,t){var r,n;let{beforeEnter:s,afterEnter:i,beforeLeave:a,afterLeave:o,enter:c,enterFrom:d,enterTo:u,entered:f,leave:h,leaveFrom:p,leaveTo:x,...m}=e,g=b.useRef(null),_=Ea(g,t),y=(r=m.unmount)==null||r?rs.Unmount:rs.Hidden,{show:v,appear:w,initial:N}=mD(),[E,T]=b.useState(v?"visible":"hidden"),M=pD(),{register:P,unregister:B}=M;b.useEffect(()=>P(g),[P,g]),b.useEffect(()=>{if(y===rs.Hidden&&g.current){if(v&&E!=="visible"){T("visible");return}return gr(E,{hidden:()=>B(g),visible:()=>P(g)})}},[E,g,P,B,v,y]);let W=fs({base:$n(m.className),enter:$n(c),enterFrom:$n(d),enterTo:$n(u),entered:$n(f),leave:$n(h),leaveFrom:$n(p),leaveTo:$n(x)}),Y=vD({beforeEnter:s,afterEnter:i,beforeLeave:a,afterLeave:o}),J=$h();b.useEffect(()=>{if(J&&E==="visible"&&g.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[g,E,J]);let Te=N&&!w,ye=w&&v&&N,se=!J||Te?"idle":v?"enter":"leave",le=lD(0),z=it(C=>gr(C,{enter:()=>{le.addFlag(mr.Opening),Y.current.beforeEnter()},leave:()=>{le.addFlag(mr.Closing),Y.current.beforeLeave()},idle:()=>{}})),U=it(C=>gr(C,{enter:()=>{le.removeFlag(mr.Opening),Y.current.afterEnter()},leave:()=>{le.removeFlag(mr.Closing),Y.current.afterLeave()},idle:()=>{}})),Z=Hw(()=>{T("hidden"),B(g)},M),G=b.useRef(!1);fD({immediate:ye,container:g,classes:W,direction:se,onStart:fs(C=>{G.current=!0,Z.onStart(g,C,z)}),onStop:fs(C=>{G.current=!1,Z.onStop(g,C,U),C==="leave"&&!Yu(Z)&&(T("hidden"),B(g))})});let k=m,F={ref:_};return ye?k={...k,className:nu(m.className,...W.current.enter,...W.current.enterFrom)}:G.current&&(k.className=nu(m.className,(n=g.current)==null?void 0:n.className),k.className===""&&delete k.className),Ct.createElement(Xu.Provider,{value:Z},Ct.createElement(Ww,{value:gr(E,{visible:mr.Open,hidden:mr.Closed})|le.flags},Sa({ourProps:F,theirProps:k,defaultTag:yD,features:zw,visible:E==="visible",name:"Transition.Child"})))}function _D(e,t){let{show:r,appear:n=!1,unmount:s=!0,...i}=e,a=b.useRef(null),o=Ea(a,t);$h();let c=Vh();if(r===void 0&&c!==null&&(r=(c&mr.Open)===mr.Open),![!0,!1].includes(r))throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[d,u]=b.useState(r?"visible":"hidden"),f=Hw(()=>{u("hidden")}),[h,p]=b.useState(!0),x=b.useRef([r]);Ar(()=>{h!==!1&&x.current[x.current.length-1]!==r&&(x.current.push(r),p(!1))},[x,r]);let m=b.useMemo(()=>({show:r,appear:n,initial:h}),[r,n,h]);b.useEffect(()=>{if(r)u("visible");else if(!Yu(f))u("hidden");else{let v=a.current;if(!v)return;let w=v.getBoundingClientRect();w.x===0&&w.y===0&&w.width===0&&w.height===0&&u("hidden")}},[r,f]);let g={unmount:s},_=it(()=>{var v;h&&p(!1),(v=e.beforeEnter)==null||v.call(e)}),y=it(()=>{var v;h&&p(!1),(v=e.beforeLeave)==null||v.call(e)});return Ct.createElement(Xu.Provider,{value:f},Ct.createElement(Ku.Provider,{value:m},Sa({ourProps:{...g,as:b.Fragment,children:Ct.createElement(Vw,{ref:o,...g,...i,beforeEnter:_,beforeLeave:y})},theirProps:{},defaultTag:b.Fragment,features:zw,visible:d==="visible",name:"Transition"})))}function ED(e,t){let r=b.useContext(Ku)!==null,n=Vh()!==null;return Ct.createElement(Ct.Fragment,null,!r&&n?Ct.createElement(hf,{ref:t,...e}):Ct.createElement(Vw,{ref:t,...e}))}let hf=ui(_D),Vw=ui(wD),SD=ui(ED),TD=Object.assign(hf,{Child:SD,Root:hf});function bD(){const{currentUser:e,logout:t,switchUser:r}=Ht(),[n,s]=b.useState(!1),[i,a]=b.useState(!1),[o,c]=b.useState([]);b.useEffect(()=>{n&&d()},[n]);const d=async()=>{try{const{data:h,error:p}=await me.from("users").select("*").order("name_kana");if(p){console.error(":",p);return}const x=(h==null?void 0:h.map(m=>({id:m.id,employeeId:m.employee_id,name:m.name,nameKana:m.name_kana,email:m.email,phone:m.phone,department:m.department,role:m.role,defaultWorkDays:m.default_work_days||[]})))||[];c(x)}catch(h){console.error("fetchUsers :",h)}},u=async h=>{a(!0);try{console.log(":",h.name),r(h),s(!1)}catch(p){console.error("Failed to switch user:",p)}finally{a(!1)}},f=()=>{console.log(""),t(),window.location.replace("/user-switch")};return l.jsxs(l.Fragment,{children:[l.jsx(Ma,{as:"div",className:"ml-3 relative",children:({open:h})=>l.jsxs(l.Fragment,{children:[l.jsx("div",{children:l.jsxs(Ma.Button,{className:"max-w-xs bg-white flex items-center text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[l.jsx("span",{className:"sr-only",children:""}),l.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-600 flex items-center justify-center text-white",children:e==null?void 0:e.name.charAt(0)})]})}),l.jsx(TD,{show:h,as:b.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:l.jsxs(Ma.Items,{static:!0,className:"origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 focus:outline-none",children:[l.jsxs("div",{className:"px-4 py-2",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:e==null?void 0:e.name}),l.jsx("p",{className:"text-xs text-gray-500 truncate",children:e==null?void 0:e.email})]}),l.jsx("div",{className:"border-t border-gray-100"}),l.jsx(Ma.Item,{children:({active:p})=>l.jsxs("button",{onClick:()=>s(!0),className:`${p?"bg-gray-100":""} flex w-full px-4 py-2 text-sm text-gray-700`,children:[l.jsx(ry,{className:"mr-3 h-5 w-5 text-gray-400","aria-hidden":"true"}),l.jsx("span",{children:""})]})}),l.jsx(Ma.Item,{children:({active:p})=>l.jsxs("button",{onClick:f,className:`${p?"bg-gray-100":""} flex w-full px-4 py-2 text-sm text-gray-700`,children:[l.jsx(SN,{className:"mr-3 h-5 w-5 text-gray-400","aria-hidden":"true"}),l.jsx("span",{children:""})]})})]})})]})}),n&&l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full max-h-[80vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),l.jsx("button",{onClick:()=>s(!1),className:"text-gray-400 hover:text-gray-500",children:l.jsx(Rn,{className:"h-6 w-6"})})]}),l.jsx("div",{className:"space-y-2",children:o.filter(h=>h.id!==(e==null?void 0:e.id)).map(h=>l.jsxs("button",{type:"button",onClick:()=>u(h),disabled:i,className:"w-full flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 transition-colors",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:l.jsx("span",{className:"text-blue-600 font-medium text-sm",children:h.name.charAt(0)})}),l.jsxs("div",{className:"ml-3 flex-1 text-left",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:h.name}),l.jsxs("div",{className:"text-xs text-gray-500",children:[h.department,"  ",h.role==="president"?"":h.role==="admin"?"":""]})]}),l.jsx(EN,{className:"h-4 w-4 text-gray-400"})]},h.id))}),l.jsx("div",{className:"flex justify-end mt-6",children:l.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:""})})]})})]})}function kD(){const{currentUser:e}=Ht(),t=pa(),[r,n]=b.useState(!1),[s,i]=b.useState([]),[a,o]=b.useState(0),[c,d]=b.useState(!1);b.useEffect(()=>{if(e)return u(),f()},[e]);const u=async()=>{if(e){d(!0);try{console.log(`=== : ${e.name} (${e.id}) ===`);const w=await Ze.getUserNotificationLogs(e.id,50);console.log(":",w.length),console.log(":",w),i(w);const N=w.filter(E=>!E.isRead).length;console.log(":",N),o(N)}catch(w){console.error("Error loading notifications:",w),i([]),o(0)}finally{d(!1)}}},f=()=>{if(!e)return()=>{};const w=me.channel(`notifications:${e.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notification_logs",filter:`user_id=eq.${e.id}`},N=>{const E=y(N.new);i(T=>[E,...T].slice(0,20)),o(T=>T+1),E.type==="push"&&E.status==="sent"&&h(E)}).subscribe();return()=>{me.removeChannel(w)}},h=async w=>{if("Notification"in window&&Notification.permission==="granted"){const N=new Notification(w.subject||"",{body:w.content||"",icon:"/icon-192x192.png",badge:"/badge-72x72.png",tag:w.id,timestamp:new Date(w.createdAt).getTime()});N.onclick=()=>{p(w),N.close()}}},p=async w=>{switch(w.isRead||await Ze.markNotificationAsRead(w.id)&&(i(E=>E.map(T=>T.id===w.id?{...T,isRead:!0,readAt:new Date}:T)),o(E=>Math.max(0,E-1))),w.metadata,w.category){case"schedule_created":case"schedule_updated":case"schedule_reminder":n(!1),t("/calendar/my");break;case"leave_request_submitted":case"leave_request_approved":case"leave_request_rejected":n(!1),t("/leave");break;default:n(!1),t("/")}},x=w=>{switch(w){case"schedule_created":case"schedule_updated":case"schedule_deleted":case"schedule_reminder":return l.jsx(ia,{className:"h-5 w-5"});case"leave_request_submitted":case"leave_request_approved":case"leave_request_rejected":return l.jsx(zr,{className:"h-5 w-5"});default:return l.jsx(Ws,{className:"h-5 w-5"})}},m=w=>{switch(w){case"sent":return"text-green-600";case"failed":return"text-red-600";case"pending":return"text-yellow-600";default:return"text-gray-600"}},g=w=>{switch(w.category){case"schedule_created":return"";case"schedule_updated":return"";case"schedule_deleted":return"";case"schedule_reminder":return"";case"leave_request_submitted":return"";case"leave_request_approved":return"";case"leave_request_rejected":return"";default:return""}},_=w=>{const E=new Date().getTime()-new Date(w).getTime(),T=Math.floor(E/6e4),M=Math.floor(T/60),P=Math.floor(M/24);return T<1?"":T<60?`${T}`:M<24?`${M}`:P<7?`${P}`:be(new Date(w),"MM/dd",{locale:jr})},y=w=>({id:w.id,userId:w.user_id,type:w.type,category:w.category,subject:w.subject,content:w.content,metadata:w.metadata,status:w.status,errorMessage:w.error_message,sentAt:w.sent_at?new Date(w.sent_at):void 0,createdAt:new Date(w.created_at),isRead:w.is_read||!1,readAt:w.read_at?new Date(w.read_at):void 0}),v=async()=>{if(!e)return;await Ze.markAllNotificationsAsRead(e.id)&&(i(N=>N.map(E=>({...E,isRead:!0,readAt:new Date}))),o(0))};return l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>n(!r),className:"relative p-2 text-gray-600 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 rounded-full",children:[l.jsx(Ws,{className:"h-6 w-6"}),a>0&&l.jsx("span",{className:"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full",children:a>9?"9+":a})]}),r&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>n(!1)}),l.jsxs("div",{className:"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 z-40",children:[l.jsx("div",{className:"p-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""}),l.jsxs("div",{className:"flex items-center space-x-2",children:[a>0&&l.jsx("button",{onClick:v,className:"text-sm text-indigo-600 hover:text-indigo-500",children:""}),l.jsx("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-500",children:l.jsx(Rn,{className:"h-5 w-5"})})]})]})}),l.jsx("div",{className:"max-h-96 overflow-y-auto",children:c?l.jsx("div",{className:"p-4 text-center text-gray-500",children:"..."}):s.length===0?l.jsxs("div",{className:"p-8 text-center text-gray-500",children:[l.jsx(Ws,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),l.jsx("p",{children:""})]}):l.jsx("div",{className:"divide-y divide-gray-200",children:s.map(w=>l.jsxs("div",{className:`p-4 hover:bg-gray-50 cursor-pointer transition-colors relative ${w.isRead?"":"bg-blue-50"}`,onClick:()=>p(w),children:[!w.isRead&&l.jsx("div",{className:"absolute left-1 top-1/2 transform -translate-y-1/2 w-2 h-2 bg-blue-600 rounded-full"}),l.jsxs("div",{className:"flex items-start",children:[l.jsx("div",{className:`flex-shrink-0 ${m(w.status)} ${w.isRead?"opacity-60":""}`,children:x(w.category)}),l.jsxs("div",{className:"ml-3 flex-1",children:[l.jsx("p",{className:`text-sm font-medium ${w.isRead?"text-gray-700":"text-gray-900"}`,children:w.subject||g(w)}),w.content&&l.jsx("p",{className:`mt-1 text-sm line-clamp-2 ${w.isRead?"text-gray-600":"text-gray-700"}`,children:w.content}),l.jsxs("div",{className:"mt-2 flex items-center text-xs text-gray-500",children:[l.jsxs("span",{className:"flex items-center",children:[w.type==="email"?l.jsx(xh,{className:"h-3 w-3 mr-1"}):l.jsx(Ws,{className:"h-3 w-3 mr-1"}),_(w.createdAt)]}),w.status==="failed"&&l.jsxs("span",{className:"ml-2 flex items-center text-red-600",children:[l.jsx(ty,{className:"h-3 w-3 mr-1"}),""]})]})]})]})]},w.id))})}),s.length>0&&l.jsx("div",{className:"p-4 border-t border-gray-200",children:l.jsx("a",{href:"/settings/notifications",className:"text-sm text-indigo-600 hover:text-indigo-500 font-medium",children:""})})]})]})]})}function ND({children:e}){const{sessionInfo:t,checkSessionValidity:r,extendSession:n,logSecurityEvent:s,securitySettings:i}=Ev(),{currentUser:a,logout:o}=Ht(),c=pa(),[d,u]=b.useState(!1),[f,h]=b.useState(0),[p,x]=b.useState(Date.now()),m=5*60*1e3;b.useEffect(()=>{const w=()=>{x(Date.now()),n()},N=["mousedown","keydown","scroll","touchstart","click"];return N.forEach(E=>{document.addEventListener(E,w,!0)}),()=>{N.forEach(E=>{document.removeEventListener(E,w,!0)})}},[n]),b.useEffect(()=>{if(!t||!a)return;const w=setInterval(()=>{if(!r()){s({type:"security_violation",action:"Session expired - forcing logout",severity:"medium"}),g("");return}const N=new Date,E=t.expiresAt.getTime()-N.getTime();E<=m&&E>0?(h(Math.ceil(E/1e3)),u(!0)):u(!1),N.getTime()-p>i.sessionTimeout*60*1e3&&(s({type:"security_violation",action:"Session timeout due to inactivity",severity:"medium"}),g(""))},3e4);return()=>clearInterval(w)},[t,a,p,r,s,i.sessionTimeout]);const g=w=>{u(!1),o(),c("/login",{replace:!0,state:{message:w,type:"warning"}})},_=()=>{n(),u(!1),s({type:"admin_action",action:"User extended session",severity:"low"})},y=()=>{s({type:"logout",action:"User logged out from timeout warning",severity:"low"}),u(!1),o(),c("/login")},v=w=>{const N=Math.floor(w/60),E=w%60;return`${N}:${E.toString().padStart(2,"0")}`};return l.jsxs(l.Fragment,{children:[e,d&&l.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:l.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[l.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"}),l.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen",children:""}),l.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",children:[l.jsxs("div",{className:"sm:flex sm:items-start",children:[l.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 sm:mx-0 sm:h-10 sm:w-10",children:l.jsx("svg",{className:"h-6 w-6 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.728-.833-2.498 0L4.316 15.5c-.77.833.192 2.5 1.732 2.5z"})})}),l.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[l.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:""}),l.jsxs("div",{className:"mt-2",children:[l.jsxs("p",{className:"text-sm text-gray-500",children:["",l.jsx("br",{}),": ",l.jsx("span",{className:"font-mono font-bold text-red-600",children:v(f)})]}),l.jsx("p",{className:"text-sm text-gray-500 mt-2",children:" "})]})]})]}),l.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[l.jsx("button",{type:"button",onClick:_,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:""}),l.jsx("button",{type:"button",onClick:y,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:w-auto sm:text-sm",children:""})]})]})]})})]})}function jD(){const[e,t]=b.useState(!1);Ht();const r=()=>{t(!e)};return l.jsx(ND,{children:l.jsxs("div",{className:"h-screen flex overflow-hidden bg-gray-100",children:[l.jsxs("div",{className:`fixed inset-0 flex z-40 md:hidden ${e?"block":"hidden"}`,children:[l.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:r}),l.jsxs("div",{className:"relative flex-1 flex flex-col max-w-xs w-full bg-white",children:[l.jsx("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:l.jsxs("button",{className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:r,children:[l.jsx("span",{className:"sr-only",children:"Close sidebar"}),l.jsx(Rn,{className:"h-6 w-6 text-white"})]})}),l.jsx(Bg,{onClose:r})]})]}),l.jsx("div",{className:"hidden md:flex md:flex-shrink-0",children:l.jsx("div",{className:"flex flex-col w-64",children:l.jsx(Bg,{})})}),l.jsxs("div",{className:"flex flex-col w-0 flex-1 overflow-hidden",children:[l.jsxs("div",{className:"relative z-10 flex-shrink-0 flex h-16 bg-white shadow",children:[l.jsxs("button",{className:"px-4 border-r border-gray-200 text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500 md:hidden",onClick:r,children:[l.jsx("span",{className:"sr-only",children:"Open sidebar"}),l.jsx(TN,{className:"h-6 w-6"})]}),l.jsxs("div",{className:"flex-1 px-4 flex justify-between",children:[l.jsx("div",{className:"flex-1 flex items-center",children:l.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:""})}),l.jsxs("div",{className:"ml-4 flex items-center md:ml-6 space-x-4",children:[l.jsx(kD,{}),l.jsx(bD,{})]})]})]}),l.jsx("main",{className:"flex-1 relative overflow-y-auto focus:outline-none",children:l.jsx("div",{className:"py-6",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8",children:l.jsx(kS,{})})})})]})]})})}function CD(){return b.useEffect(()=>(uN(),()=>{}),[]),l.jsx(RS,{children:l.jsx(CT,{children:l.jsx(OT,{children:l.jsxs(iN,{children:[l.jsx(jT,{position:"top-right"}),l.jsxs(jS,{children:[l.jsx(Et,{path:"/user-switch",element:l.jsx(ON,{})}),l.jsxs(Et,{path:"/",element:l.jsx(Ul,{children:l.jsx(jD,{})}),children:[l.jsx(Et,{index:!0,element:l.jsx(o3,{})}),l.jsxs(Et,{path:"calendar",children:[l.jsx(Et,{index:!0,element:l.jsx(pv,{to:"/calendar/my",replace:!0})}),l.jsx(Et,{path:"my",element:l.jsx(f3,{})}),l.jsx(Et,{path:"vehicle",element:l.jsx(h3,{})}),l.jsx(Et,{path:"room",element:l.jsx(m3,{})}),l.jsx(Et,{path:"sample",element:l.jsx(sP,{})})]}),l.jsx(Et,{path:"leave",element:l.jsx(iP,{})}),l.jsx(Et,{path:"settings",children:l.jsx(Et,{path:"notifications",element:l.jsx(hP,{})})}),l.jsxs(Et,{path:"admin",children:[l.jsx(Et,{path:"users",element:l.jsx(Ul,{minRole:"admin",children:l.jsx(oP,{})})}),l.jsx(Et,{path:"groups",element:l.jsx(Ul,{minRole:"admin",children:l.jsx(lP,{})})}),l.jsx(Et,{path:"equipment",element:l.jsx(Ul,{minRole:"admin",children:l.jsx(cP,{})})})]})]})]})]})})})})}iv(document.getElementById("root")).render(l.jsx(b.StrictMode,{children:l.jsx(CD,{})}));
